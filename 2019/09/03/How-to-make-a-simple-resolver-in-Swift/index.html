<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="—title: How to make a simple resolver in Swiftdate: 2017-05-10T22:09:27Zupdated: 2019-05-23T18:40:30Z —Issue #25—The Marvel worldAnt ManWe know Ant Man is Hank Pym 1234567891011121314struct AntManSuit">
<meta name="keywords" content="ios, android,javascript, react">
<meta property="og:type" content="article">
<meta property="og:title" content="onmyway133">
<meta property="og:url" content="http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="—title: How to make a simple resolver in Swiftdate: 2017-05-10T22:09:27Zupdated: 2019-05-23T18:40:30Z —Issue #25—The Marvel worldAnt ManWe know Ant Man is Hank Pym 1234567891011121314struct AntManSuit">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-09-03T14:37:05.625Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onmyway133">
<meta name="twitter:description" content="—title: How to make a simple resolver in Swiftdate: 2017-05-10T22:09:27Zupdated: 2019-05-23T18:40:30Z —Issue #25—The Marvel worldAnt ManWe know Ant Man is Hank Pym 1234567891011121314struct AntManSuit">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>onmyway133</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/09/03/How-to-group-digits-in-Swift/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/09/03/How-to-debug-Auto-Layout/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&text="><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&is_video=false&description="><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=&body=Check out this article: http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&name=&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#—Issue-25—The-Marvel-world"><span class="toc-number">1.</span> <span class="toc-text">—Issue #25—The Marvel world</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ant-Man"><span class="toc-number">1.1.</span> <span class="toc-text">Ant Man</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#More-suits"><span class="toc-number">1.2.</span> <span class="toc-text">More suits</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dependency-Injection"><span class="toc-number">2.</span> <span class="toc-text">Dependency Injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dependency-Inversion-Principle"><span class="toc-number">3.</span> <span class="toc-text">Dependency Inversion Principle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inversion-of-Control-Container"><span class="toc-number">4.</span> <span class="toc-text">Inversion of Control Container</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-vs-library"><span class="toc-number">4.1.</span> <span class="toc-text">Framework vs library</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Command-line-vs-GUI"><span class="toc-number">4.2.</span> <span class="toc-text">Command line vs GUI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IoC-container"><span class="toc-number">4.3.</span> <span class="toc-text">IoC container</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Features"><span class="toc-number">5.</span> <span class="toc-text">Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Swinject"><span class="toc-number">5.1.</span> <span class="toc-text">Swinject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dip"><span class="toc-number">5.2.</span> <span class="toc-text">Dip</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-your-own-simple-IoC-container"><span class="toc-number">6.</span> <span class="toc-text">Build your own simple IoC container</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">onmyway133</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-09-03T14:37:05.619Z" itemprop="datePublished">2019-09-03</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>—title: How to make a simple resolver in Swift<br>date: 2017-05-10T22:09:27Z<br>updated: 2019-05-23T18:40:30Z</p>
<h2 id="—Issue-25—The-Marvel-world"><a href="#—Issue-25—The-Marvel-world" class="headerlink" title="—Issue #25—The Marvel world"></a>—<strong>Issue <a href="https://github.com/onmyway133/blog/issues/25" target="_blank" rel="noopener">#25</a></strong>—The Marvel world</h2><h3 id="Ant-Man"><a href="#Ant-Man" class="headerlink" title="Ant Man"></a>Ant Man</h3><p>We know Ant Man is Hank Pym</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AntManSuit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HankPym</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> suit = <span class="type">AntManSuit</span>(name: <span class="string">"Ant Man ID #101"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fight</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Fighting with the suit named "</span> + suit.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> hankPym = <span class="type">HankPym</span>()</span><br><span class="line">hankPym.fight()</span><br></pre></td></tr></table></figure>

<p>Everytime HankPym is created, he always uses the Ant Man suit. This time he is so coupled to the role Ant Man</p>
<h3 id="More-suits"><a href="#More-suits" class="headerlink" title="More suits"></a>More suits</h3><p>Well, he does not have to be too dependent on the Ant Man suit. We know Hank Pym is a genius scientist, he has more suits to use. Let’s make it decoupled</p>
<p>Using Dependency Injection</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Suit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AntManSuit</span>: <span class="title">Suit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">YellowJacketSuit</span>: <span class="title">Suit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HankPym</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> suit: <span class="type">Suit</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fight</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Fighting with the suit named "</span> + suit.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> suit = <span class="type">YellowJacketSuit</span>(name: <span class="string">"Yellow Jacket ID #33"</span>)</span><br><span class="line"><span class="keyword">let</span> hankPym = <span class="type">HankPym</span>(suit: suit)</span><br><span class="line">hankPym.fight()</span><br></pre></td></tr></table></figure>

<p>Now Hank Pym can be more flexible on which suit to use.</p>
<h2 id="Dependency-Injection"><a href="#Dependency-Injection" class="headerlink" title="Dependency Injection"></a>Dependency Injection</h2><p>The technique we just saw is called <code>Dependency Injection</code>, in which Hank Pym does not need to create the Suit, it will be provided through constructor or property.</p>
<h2 id="Dependency-Inversion-Principle"><a href="#Dependency-Inversion-Principle" class="headerlink" title="Dependency Inversion Principle"></a>Dependency Inversion Principle</h2><p>In the first example, Hank Pym is dependent on the concrete implementation of the Suit</p>
<p>In the second example, both Hank Pym and the suits are dependent on the Suit protocol. This way Hank Pym only knows about the Suit protocol, and future suits must be crafted to that it conforms to the Suit protocol</p>
<p>This way the dependency is inverted</p>
<blockquote>
<p>High level modules should not depend upon low level modules. Both should depend upon abstractions.</p>
</blockquote>
<blockquote>
<p>What is the high level policy? It is the abstractions that underlie the application, the<br>truths that do not vary when the details are changed</p>
</blockquote>
<h2 id="Inversion-of-Control-Container"><a href="#Inversion-of-Control-Container" class="headerlink" title="Inversion of Control Container"></a>Inversion of Control Container</h2><p>You may ask yourself <a href="http://programmers.stackexchange.com/questions/205681/why-is-inversion-of-control-named-that-way" target="_blank" rel="noopener">Why is Inversion of Control named that way?</a></p>
<h3 id="Framework-vs-library"><a href="#Framework-vs-library" class="headerlink" title="Framework vs library"></a>Framework vs library</h3><p>People said “the framework calls you but you call the library”</p>
<h3 id="Command-line-vs-GUI"><a href="#Command-line-vs-GUI" class="headerlink" title="Command line vs GUI"></a>Command line vs GUI</h3><p>See <a href="http://stackoverflow.com/a/3108/1418457" target="_blank" rel="noopener">What is Inversion of Control?</a></p>
<p>For example, in an old school menu, you might have:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print &quot;enter your name&quot;</span><br><span class="line">read name</span><br><span class="line">print &quot;enter your address&quot;</span><br><span class="line">read address</span><br><span class="line">etc...</span><br><span class="line">store in database</span><br></pre></td></tr></table></figure>

<p>thereby controlling the flow of user interaction.</p>
<p>In a GUI program or some such, instead we say</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">when the user types in field a, store it in NAME</span><br><span class="line">when the user types in field b, store it in ADDRESS</span><br><span class="line">when the user clicks the save button, call StoreInDatabase</span><br></pre></td></tr></table></figure>

<p>You how have a brief understanding of how IoC means</p>
<h3 id="IoC-container"><a href="#IoC-container" class="headerlink" title="IoC container"></a>IoC container</h3><p>In the 2nd example of the Suit protocol, you can see how there is a inversion of control. What if there is a container that contains all the Suit conformances?</p>
<p>Let’s use my <a href="https://github.com/onmyway133/Resolver" target="_blank" rel="noopener">Resolver</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> resolver = <span class="type">Resolver</span>()</span><br><span class="line">resolver.register &#123;</span><br><span class="line">    <span class="type">YellowJacketSuit</span>(name: <span class="string">"YellowJacket ID #404"</span>) <span class="keyword">as</span> <span class="type">Suit</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> suit = <span class="keyword">try</span>! resolver.resolve() <span class="keyword">as</span> <span class="type">Suit</span></span><br><span class="line"><span class="keyword">let</span> hankPym = <span class="type">HankPym</span>(suit: suit)</span><br></pre></td></tr></table></figure>

<p>Quite helpful, right? :]</p>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>Actually, IoC container helps you more than that.</p>
<ul>
<li>Circular Dependency Injection</li>
<li>Auto Injection</li>
<li>Object Scope</li>
<li>…</li>
</ul>
<p>There are some IoC containers in Swift</p>
<h3 id="Swinject"><a href="#Swinject" class="headerlink" title="Swinject"></a><a href="https://github.com/Swinject/Swinject" target="_blank" rel="noopener">Swinject</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> container = <span class="type">Container</span>()</span><br><span class="line">container.register(<span class="type">AnimalType</span>.<span class="keyword">self</span>) &#123; <span class="number">_</span> <span class="keyword">in</span> <span class="type">Cat</span>(name: <span class="string">"Mimi"</span>) &#125;</span><br><span class="line">container.register(<span class="type">PersonType</span>.<span class="keyword">self</span>) &#123; r <span class="keyword">in</span></span><br><span class="line">     <span class="type">PetOwner</span>(pet: r.resolve(<span class="type">AnimalType</span>.<span class="keyword">self</span>)!)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Swinject requires explicit type declaration. It has SwinjectStoryboard, which helps configuring the dependency for your view controller</p>
<h3 id="Dip"><a href="#Dip" class="headerlink" title="Dip"></a><a href="https://github.com/AliSoftware/Dip" target="_blank" rel="noopener">Dip</a></h3><p>Dip leverages generic and encourage protocols</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">container.register &#123; <span class="type">ServiceImp</span>() <span class="keyword">as</span> <span class="type">Service</span> &#125;</span><br><span class="line"><span class="keyword">let</span> service = <span class="keyword">try</span>! container.resolve() <span class="keyword">as</span> <span class="type">Service</span></span><br></pre></td></tr></table></figure>

<p>You ‘ll learn a lot just by reading Dip source code, on how factory and factory type are stored and checked using generic</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">resolve</span>&lt;T, F&gt;<span class="params">(tag tag: Tag? = <span class="literal">nil</span>, builder: F-&gt;T)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> key = <span class="type">DefinitionKey</span>(protocolType: <span class="type">T</span>.<span class="keyword">self</span>, factoryType: <span class="type">F</span>.<span class="keyword">self</span>, associatedTag: tag)</span><br><span class="line">    <span class="keyword">let</span> nilTagKey = tag.<span class="built_in">map</span> &#123; <span class="number">_</span> <span class="keyword">in</span> <span class="type">DefinitionKey</span>(protocolType: <span class="type">T</span>.<span class="keyword">self</span>, factoryType: <span class="type">F</span>.<span class="keyword">self</span>, associatedTag: <span class="literal">nil</span>) &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> definition = (<span class="keyword">self</span>.definitions[key] ?? <span class="keyword">self</span>.definitions[nilTagKey]) <span class="keyword">as</span>? <span class="type">DefinitionOf</span>&lt;<span class="type">T</span>, <span class="type">F</span>&gt; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="type">DipError</span>.<span class="type">DefinitionNotFound</span>(key)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> usingKey: <span class="type">DefinitionKey?</span> = definition.scope == .<span class="type">ObjectGraph</span> ? key : <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">return</span> _resolve(tag, key: usingKey, definition: definition, builder: builder)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Build-your-own-simple-IoC-container"><a href="#Build-your-own-simple-IoC-container" class="headerlink" title="Build your own simple IoC container"></a>Build your own simple IoC container</h2><p>You may have discovered, that the idea of all those framework is to use closure as factory method</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> factory = &#123;</span><br><span class="line">    <span class="type">YellowJacketSuit</span>(name: <span class="string">"YellowJacket ID #007"</span>) <span class="keyword">as</span> <span class="type">Suit</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> suit = factory()</span><br></pre></td></tr></table></figure>

<p>All we have to do is to store these factories closure</p>
<p>Take a look at my gist <a href="https://gist.github.com/onmyway133/3244cde1eaf8f2cd2ecb" target="_blank" rel="noopener">SimpleResolver.swift</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleResolver</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> factories = [<span class="type">String</span>: <span class="type">Any</span>]()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">factory</span>&lt;T&gt;<span class="params">(factory: <span class="params">()</span></span></span> -&gt; <span class="type">T</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> key = <span class="type">String</span>(<span class="type">T</span>.<span class="keyword">self</span>)</span><br><span class="line">        factories[key] = factory</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">resolve</span>&lt;T&gt;<span class="params">()</span></span> -&gt; <span class="type">T</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> key = <span class="type">String</span>(<span class="type">T</span>.<span class="keyword">self</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> factory = factories[key] <span class="keyword">as</span>? () -&gt; <span class="type">T</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> factory()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">fatalError</span>(<span class="string">"Registration not found"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> resolver = <span class="type">SimpleResolver</span>()</span><br><span class="line"></span><br><span class="line">resolver.factory &#123;</span><br><span class="line">    <span class="type">YellowJacketSuit</span>(name: <span class="string">"YellowJacket IS #009"</span>) <span class="keyword">as</span> <span class="type">Suit</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> suit = resolver.resolve() <span class="keyword">as</span> <span class="type">Suit</span></span><br><span class="line"><span class="built_in">print</span>(suit.name)</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://yoichitgy.github.io/post/dependency-injection-framework-for-swift-introduction-to-swinject/" target="_blank" rel="noopener">Dependency Injection Framework for Swift - Introduction to Swinject</a></li>
<li><a href="http://ilya.puchka.me/ioc-container-in-swift/" target="_blank" rel="noopener">IoC container in Swift</a></li>
<li><a href="https://github.com/chakrit/swift-ioc" target="_blank" rel="noopener">swift-ioc</a></li>
<li><a href="https://github.com/AliSoftware/Dip" target="_blank" rel="noopener">Dip</a></li>
<li><a href="http://typhoonframework.org/" target="_blank" rel="noopener">Typhoon</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#—Issue-25—The-Marvel-world"><span class="toc-number">1.</span> <span class="toc-text">—Issue #25—The Marvel world</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ant-Man"><span class="toc-number">1.1.</span> <span class="toc-text">Ant Man</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#More-suits"><span class="toc-number">1.2.</span> <span class="toc-text">More suits</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dependency-Injection"><span class="toc-number">2.</span> <span class="toc-text">Dependency Injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dependency-Inversion-Principle"><span class="toc-number">3.</span> <span class="toc-text">Dependency Inversion Principle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inversion-of-Control-Container"><span class="toc-number">4.</span> <span class="toc-text">Inversion of Control Container</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-vs-library"><span class="toc-number">4.1.</span> <span class="toc-text">Framework vs library</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Command-line-vs-GUI"><span class="toc-number">4.2.</span> <span class="toc-text">Command line vs GUI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IoC-container"><span class="toc-number">4.3.</span> <span class="toc-text">IoC container</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Features"><span class="toc-number">5.</span> <span class="toc-text">Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Swinject"><span class="toc-number">5.1.</span> <span class="toc-text">Swinject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dip"><span class="toc-number">5.2.</span> <span class="toc-text">Dip</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-your-own-simple-IoC-container"><span class="toc-number">6.</span> <span class="toc-text">Build your own simple IoC container</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&text="><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&is_video=false&description="><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=&body=Check out this article: http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&title="><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/09/03/How-to-make-a-simple-resolver-in-Swift/&name=&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Khoa Pham
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
