<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>how to make linear gradient view with bridging in react native | onmyway133</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="ios, android, kotlin, mac, swift, electron, javascript, node">
  
  
  
  
  <meta name="description" content="Issue #264 Original post https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7  React Native lets us build mobile apps using only Javascript. It">
<meta name="keywords" content="javascript,react native">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Make Linear Gradient View with Bridging in React Native">
<meta property="og:url" content="https://onmyway133.github.io/blog/How-to-Make-Linear-Gradient-View-with-Bridging-in-React-Native/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="Issue #264 Original post https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7  React Native lets us build mobile apps using only Javascript. It">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/2000/1*SZnOwVTr15PY7uHYqaeaXw.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/2000/1*v9ecOYKhfHenOfFD_YyXjA.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/2000/1*7v9qtfOAGPF2lqvWrrOysg.png">
<meta property="og:updated_time" content="2019-07-02T18:14:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to Make Linear Gradient View with Bridging in React Native">
<meta name="twitter:description" content="Issue #264 Original post https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7  React Native lets us build mobile apps using only Javascript. It">
<meta name="twitter:image" content="https://cdn-images-1.medium.com/max/2000/1*SZnOwVTr15PY7uHYqaeaXw.png">
  
    <link rel="alternate" href="/atom.xml" title="onmyway133" type="application/atom+xml">
  
  <link rel="icon" href="/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/about/"] = "About"; 

  themeMenus["/apps/"] = "apps"; 

  themeMenus["/writing/"] = "writing"; 

  themeMenus["/archives"] = "Archives"; 

  themeMenus["/speaking/"] = "speaking"; 

  themeMenus["/opensource/"] = "open source"; 

  themeMenus["/projects/"] = "projects"; 

  themeMenus["/news/"] = "news"; 

  themeMenus["/gumroad/"] = "gumroad"; 

  themeMenus["/atom.xml"] = "rss"; 

</script>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="onmyway133" rel="home"> onmyway133 </a>
            
          </h1>

          
            <div class="site-description">What you don&#39;t know is what you haven&#39;t learned</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about/">About</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/apps/">apps</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/writing/">writing</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/speaking/">speaking</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/opensource/">open source</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/projects/">projects</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/news/">news</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/gumroad/">gumroad</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/atom.xml">rss</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "https://avatars1.githubusercontent.com/u/2284279?s=460&v=4".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-How-to-Make-Linear-Gradient-View-with-Bridging-in-React-Native" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      How to Make Linear Gradient View with Bridging in React Native
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-Make-Linear-Gradient-View-with-Bridging-in-React-Native/" class="article-date">
	  <time datetime="2019-05-23T15:57:46.000Z" itemprop="datePublished">May 23, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/264" target="_blank" rel="noopener">#264</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7" target="_blank" rel="noopener">https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7</a></p>
<hr>
<p>React Native lets us build mobile apps using only Javascript. It works by providing a common interface that talks to native iOS and Android components. There are enough essentials components to get started, but the cooler thing is that it is easy to build our own, hence we are not limited by React Native. In this post we will implement a linear gradient view, which is not supported by default in React Native, using native UI component, particularly CAGradientLayer in iOS and GradientDrawable in Android.</p>
<p>In Javascript there are hundreds of libraries for a single problem and you should check if you really need it or not. A search on Google for linear gradient shows a bunch of libraries, like <a href="https://github.com/react-native-community/react-native-linear-gradient" target="_blank" rel="noopener">react-native-linear-gradient</a>. The less <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3" target="_blank" rel="noopener">dependencies</a> the better. Linear gradient is in fact very easy to build and we probably don’t need to add extra dependencies. Also <a href="https://dev.to/acro5piano/struggle-to-install-react-native-linear-gradient--2omm" target="_blank" rel="noopener">integrating</a> <a href="https://medium.com/react-native-training/fixing-react-native-issues-and-happy-deploy-to-bitrise-fabric-circleci-44da4ab1487b" target="_blank" rel="noopener">and</a> <a href="https://medium.com/react-native-training/firebase-sdk-with-firestore-for-react-native-apps-in-2018-aa89a67d6934" target="_blank" rel="noopener">following</a> <a href="https://medium.com/react-native-training/facebook-sdk-with-login-for-react-native-apps-in-2018-196601804f66" target="_blank" rel="noopener">updates</a> with 3rd libraries are painful, I would avoid that as much as possible.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*SZnOwVTr15PY7uHYqaeaXw.png" alt></p>
<h2 id="Native-UI-component-vs-Native-module"><a href="#Native-UI-component-vs-Native-module" class="headerlink" title="Native UI component vs Native module"></a>Native UI component vs Native module</h2><p>In React Native, there are native UI component and native module. React Native moves pretty fast so most of the articles will be outdated, it’s best to consult official documentation for the latest React Native version. This post will try to give you overview of the whole picture because for now the official guide seems not completed.</p>
<ul>
<li><p><a href="https://facebook.github.io/react-native/docs/native-modules-ios" target="_blank" rel="noopener">Native Modules in iOS</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-modules-android" target="_blank" rel="noopener">Native Modules in Android</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-components-ios" target="_blank" rel="noopener">Native UI Components in iOS</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-components-android" target="_blank" rel="noopener">Native UI Components in Android</a></p>
</li>
</ul>
<p>In simple explanation, native UI component is about making UIView in iOS or View in Android available as React.Component and used in render function in Javascript.</p>
<blockquote>
<p>There are tons of native UI widgets out there ready to be used in the latest apps — some of them are part of the platform, others are available as third-party libraries, and still more might be in use in your very own portfolio. React Native has several of the most critical platform components already wrapped, like ScrollView and TextInput, but not all of them, and certainly not ones you might have written yourself for a previous app.</p>
</blockquote>
<p>Native module is more general in that we make any native class available in Javascript.</p>
<blockquote>
<p>Sometimes an app needs access to platform API, and React Native doesn’t have a corresponding module yet. Maybe you want to reuse some existing Objective-C, Swift or C++ code without having to reimplement it in JavaScript, or write some high performance, multi-threaded code such as for image processing, a database, or any number of advanced extensions.</p>
</blockquote>
<h2 id="View-Manager"><a href="#View-Manager" class="headerlink" title="View Manager"></a>View Manager</h2><p>To expose native UI views, we use the ViewManager as the bridge, it is RCTViewManager in iOS and SimpleViewManager in Android. Then inside this ViewManager we can just return our custom view. I see it’s good to use Objective C/Java for the ViewManager to match React Native classes, and the custom view we can use either Swift/Objective C in iOS and Kotlin/Java in Android.</p>
<p>I prefer to use Swift, but in this post to remove the overhead of introducing bridging header from Swift to Objective C, we use Objective C for simplicity. We also add the native source code directly into iOS and Android project, but in the future we can extract them easily to a React Native library.</p>
<p>For now let ‘s use the name RNGradientViewManager and RNGradientView to stay consistent between iOS and Android. The RN prefix is arbitrary, you can use any prefix you want, but here I use it to indicate that these classes are meant to be used in Javascript side in React Native.</p>
<h2 id="Implement-in-iOS"><a href="#Implement-in-iOS" class="headerlink" title="Implement in iOS"></a>Implement in iOS</h2><h3 id="Project-structure"><a href="#Project-structure" class="headerlink" title="Project structure"></a>Project structure</h3><p>Add these Objective-C classes to the projects, I usually place them inside NativeComponents folder</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*v9ecOYKhfHenOfFD_YyXjA.png" alt></p>
<blockquote>
<p>Native views are created and manipulated by subclasses of RCTViewManager. These subclasses are similar in function to view controllers, but are essentially singletons - only one instance of each is created by the bridge. They expose native views to the RCTUIManager, which delegates back to them to set and update the properties of the views as necessary. The RCTViewManagers are also typically the delegates for the views, sending events back to JavaScript via the bridge.</p>
</blockquote>
<h3 id="RNGradientViewManager"><a href="#RNGradientViewManager" class="headerlink" title="RNGradientViewManager"></a>RNGradientViewManager</h3><p>Create a RNGradientViewManager that inherits from RCTViewManager</p>
<p><strong>RNGradientViewManager.h</strong></p>
<pre><code>#import &lt;React/RCTViewManager.h&gt;
@interface RNGradientViewManager : RCTViewManager
@end</code></pre><p><strong>RNGradientViewManager.m</strong></p>
<pre><code>#import &quot;RNGradientViewManager.h&quot;
#import &quot;RNGradientView.h&quot;

[@implementation](http://twitter.com/implementation) RNGradientViewManager

RCT_EXPORT_MODULE()

- (UIView *)view {
  return [[RNGradientView alloc] init];
}

RCT_EXPORT_VIEW_PROPERTY(progress, NSNumber);
RCT_EXPORT_VIEW_PROPERTY(cornerRadius, NSNumber);
RCT_EXPORT_VIEW_PROPERTY(fromColor, UIColor);
RCT_EXPORT_VIEW_PROPERTY(toColor, UIColor);

[@end](http://twitter.com/end)</code></pre><p>In iOS we use macro RCT_EXPORT_MODULE() to automatically register the module with the bridge when it loads. The optional js_name argument will be used as the JS module name. If omitted, the JS module name will match the Objective-C class name.</p>
<pre><code>#define RCT_EXPORT_MODULE(js_name)</code></pre><p>The ViewManager, not the View, is the facade to the Javascript side, so we expose properties using RCT_EXPORT_VIEW_PROPERTY . Note that we do that inside @implementation RNGradientViewManager</p>
<p>Here we specify the types as NSNumber and UIColor , and later in Javascript we can just pass number and color hex string, and React Native can do the conversions for us. In older versions of React Native, we need processColor in Javascript or RCTConvert color in iOS side, but we don’t need to perform manual conversion now.</p>
<h3 id="RNGradientView"><a href="#RNGradientView" class="headerlink" title="RNGradientView"></a>RNGradientView</h3><p>In the Native UI component <a href="https://facebook.github.io/react-native/docs/native-components-ios" target="_blank" rel="noopener">example</a> for iOS, they use WKWebView but here we make a RNGradientView which subclasses from <a href="https://github.com/facebook/react-native/blob/master/React/Views/RCTView.h" target="_blank" rel="noopener">RCTView</a> to take advantage of many features of React Native views, and to avoid some problems we can get if using a normal UIView</p>
<p><strong>RNGradientView.h</strong></p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;
#import &lt;React/RCTView.h&gt;

[@interface](http://twitter.com/interface) RNGradientView : RCTView

[@end](http://twitter.com/end)</code></pre><p><strong>RNGradientView.m</strong></p>
<pre><code>#import &quot;RNGradientView.h&quot;
#import &lt;UIKit/UIKit.h&gt;

[@interface](http://twitter.com/interface) RNGradientView()
[@property](http://twitter.com/property) CAGradientLayer *gradientLayer;

[@property](http://twitter.com/property) UIColor *_fromColor;
[@property](http://twitter.com/property) UIColor *_toColor;
[@property](http://twitter.com/property) NSNumber *_progress;
[@property](http://twitter.com/property) NSNumber *_cornerRadius;
[@end](http://twitter.com/end)

[@implementation](http://twitter.com/implementation) RNGradientView

// MARK: - Init

- (instancetype)initWithFrame:(CGRect)frame
{
  self = [super initWithFrame:frame];
  if (self) {
    self.gradientLayer = [self makeGradientLayer];
    [self.layer addSublayer:self.gradientLayer];

self._fromColor = [UIColor blackColor];
    self._toColor = [UIColor whiteColor];
    self._progress = [@0](http://twitter.com/0).5;

[self update];
  }
  return self;
}

// MARK: - Life cycle

- (void)layoutSubviews {
  [super layoutSubviews];

self.gradientLayer.frame = CGRectMake(
    0, 0,
    self.bounds.size.width*self._progress.floatValue,
    self.bounds.size.height
  );
}

// MARK: - Properties

- (void)setFromColor:(UIColor *)color {
  self._fromColor = color;
  [self update];
}

- (void)setToColor:(UIColor *)color {
  self._toColor = color;
  [self update];
}

- (void)setProgress:(NSNumber *)progress {
  self._progress = progress;
  [self update];
}

- (void)setCornerRadius:(NSNumber *)cornerRadius {
  self._cornerRadius = cornerRadius;
  [self update];
}

// MARK: - Helper

- (void)update {
  self.gradientLayer.colors = @[
    (id)self._fromColor.CGColor,
    (id)self._toColor.CGColor
  ];

self.gradientLayer.cornerRadius = self._cornerRadius.floatValue;

[self setNeedsLayout];
}

- (CAGradientLayer *)makeGradientLayer {
  CAGradientLayer *gradientLayer = [CAGradientLayer layer];

gradientLayer.masksToBounds = true;

gradientLayer.startPoint = CGPointMake(0.0, 0.5);
  gradientLayer.endPoint = CGPointMake(1.0, 0.5);
  gradientLayer.anchorPoint = CGPointZero;

return gradientLayer;
}

[@end](http://twitter.com/end)</code></pre><p>We can implement anything we want in this native view, in this case we use CAGradientLayer to get nicely displayed linear gradient. Since RNGradientViewManager exposes some properties like progress, cornerRadius, fromColor, toColor we need to implement some setters as they will be called by React Native when we update values in Javascript side. In the setter we call setNeedsLayout to tell the view to invalidate the layout, hence layoutSubviews will be called again.</p>
<h3 id="requireNativeComponent"><a href="#requireNativeComponent" class="headerlink" title="requireNativeComponent"></a>requireNativeComponent</h3><p>Open project in Visual Studio Code, add GradientView.js to src/nativeComponents . The folder name is arbitrary, but it’s good to stay organised.</p>
<pre><code>import { requireNativeComponent } from &apos;react-native&apos;

module.exports = requireNativeComponent(&apos;RNGradientView&apos;, null)</code></pre><p>Here we use <a href="https://github.com/facebook/react-native/blob/master/Libraries/ReactNative/requireNativeComponent.js" target="_blank" rel="noopener">requireNativeComponent</a> to load our RNGradientView . We only need this one Javascript file for interacting with both iOS and Android. You can name the module as RNGradientView but I think the practice in Javascript is that we don’t use prefix, so we name just GradientView .</p>
<pre><code>const requireNativeComponent = (uiViewClassName: string): string =&gt;
  createReactNativeComponentClass(uiViewClassName, () =&gt;
    getNativeComponentAttributes(uiViewClassName),
  );

module.exports = requireNativeComponent;</code></pre><p>Before I tried to use export default for the native component, but this way the view is not rendered at all, even if I wrap it inside React.Component . It seems we must use module.exports for the native component to be properly loaded.</p>
<p>Now using it is as easy as declare the GradientView with JSX syntax</p>
<pre><code>import GradientView from &apos;nativeComponents/GradientView&apos;

export default class Profile extends React.Component {
  render() {
    return (
      &lt;SafeAreaView style={styles.container}&gt;
        &lt;GradientView
          style={styles.progress}
          fromColor={R.colors.progress.from}
          toColor={R.colors.progress.to}
          cornerRadius={5.0}
          progress={0.8} /&gt;
    )
  }
}</code></pre><h2 id="Implement-in-Android"><a href="#Implement-in-Android" class="headerlink" title="Implement in Android"></a>Implement in Android</h2><h3 id="Project-structure-1"><a href="#Project-structure-1" class="headerlink" title="Project structure"></a>Project structure</h3><p>Add these Java classes to the projects, I usually place them inside nativeComponents folder</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*7v9qtfOAGPF2lqvWrrOysg.png" alt></p>
<h3 id="RNGradientManager"><a href="#RNGradientManager" class="headerlink" title="RNGradientManager"></a>RNGradientManager</h3><p>Create a RNGradientManager that extends SimpleViewManager<br><strong>RNGradientManager.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import android.support.annotation.Nullable;
import com.facebook.react.uimanager.SimpleViewManager;
import com.facebook.react.uimanager.ThemedReactContext;
import com.facebook.react.uimanager.annotations.ReactProp;

public class RNGradientViewManager extends SimpleViewManager&lt;RNGradientView&gt; {
    [@Override](http://twitter.com/Override)
    public String getName() {
        return &quot;RNGradientView&quot;;
    }

[@Override](http://twitter.com/Override)
    protected RNGradientView createViewInstance(ThemedReactContext reactContext) {
        return new RNGradientView(reactContext);
    }

// Properties

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;progress&quot;)
    public void setProgress(RNGradientView view, [@Nullable](http://twitter.com/Nullable) float progress) {
        view.setProgress(progress);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;cornerRadius&quot;)
    public void setCornerRadius(RNGradientView view, [@Nullable](http://twitter.com/Nullable) float cornerRadius) {
        view.setCornerRadius(cornerRadius);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;fromColor&quot;, customType = &quot;Color&quot;)
    public void setFromColor(RNGradientView view, [@Nullable](http://twitter.com/Nullable) int color) {
        view.setFromColor(color);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;toColor&quot;, customType = &quot;Color&quot;)
    public void setToColor(RNGradientView view, [@Nullable](http://twitter.com/Nullable) int color) {
        view.setToColor(color);
    }
}</code></pre><p>We usually use <a href="https://developer.android.com/reference/android/graphics/Color" target="_blank" rel="noopener">Color</a> as android.graphics.Color , but for the GradientDrawable that we are going to use, it use color as ARGB integer. So it’s nifty that React Native deals with Color as int type. We also need to specify customType = “Color” as Color is something kinda custom.</p>
<h3 id="RNGradientView-1"><a href="#RNGradientView-1" class="headerlink" title="RNGradientView"></a>RNGradientView</h3><p>This is where we implement our view, we can do that in Kotlin if we like.</p>
<p><strong>RNGradientView.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import android.content.Context;
import android.graphics.drawable.GradientDrawable;
import android.graphics.drawable.ScaleDrawable;
import android.support.annotation.Nullable;
import android.util.AttributeSet;
import android.view.Gravity;
import android.view.View;

public class RNGradientView extends View {

    float progress;
    float cornerRadius;
    int fromColor;
    int toColor;

    public RNGradientView(Context context) {
        super(context);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs) {
        super(context, attrs);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }

    // update

    void update() {
        GradientDrawable gradient = new GradientDrawable();
        gradient.setColors(new int[] {
            this.fromColor,
            this.toColor
        });
         gradient.setOrientation(GradientDrawable.Orientation.*LEFT_RIGHT*);
        gradient.setGradientType(GradientDrawable.*LINEAR_GRADIENT*);
        gradient.setShape(GradientDrawable.*RECTANGLE*);
        gradient.setCornerRadius(this.cornerRadius * 4);

        ScaleDrawable scale = new ScaleDrawable(gradient, Gravity.*LEFT*, 1, -1);
        scale.setLevel((int)(this.progress * 10000));

        this.setBackground(scale);
    }

    // Getter &amp; setter

    public void setProgress(float progress) {
        this.progress = progress;
        this.update();
    }

    public void setCornerRadius(float cornerRadius) {
        this.cornerRadius = cornerRadius;
        this.update();
    }

    public void setFromColor(int fromColor) {
        this.fromColor = fromColor;
        this.update();
    }

    public void setToColor(int toColor) {
        this.toColor = toColor;
        this.update();
    }
}</code></pre><p>Pay attention to the <a href="https://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html#setColors(int[])" target="_blank" rel="noopener">setColors</a> as it use an array of int</p>
<blockquote>
<p>Sets the colors used to draw the gradient.<br>Each color is specified as an ARGB integer and the array must contain at least 2 colors.</p>
</blockquote>
<p>If we call setBackground with the GradientDrawable it will be stretched to fill the view. In our case we want to support progress which determines how long the gradient should show. To fix that we use <a href="https://developer.android.com/reference/android/graphics/drawable/ScaleDrawable" target="_blank" rel="noopener">ScaleDrawable</a> which is a Drawable that changes the size of another Drawable based on its current level value.</p>
<p>The same value for cornerRadius works in iOS, but for Android we need to use higher values, that’s why the multiplication in gradient.setCornerRadius(this.cornerRadius * 4)</p>
<h3 id="Shape-drawable"><a href="#Shape-drawable" class="headerlink" title="Shape drawable"></a>Shape drawable</h3><p>Another way to implement gradient is to use Shape Drawable with xml , it’s the equivalent of using xib in iOS. We can create something like gradient.xml and put that inside /res/drawable</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;shape xmlns:android=&quot;[http://schemas.android.com/apk/res/android](http://schemas.android.com/apk/res/android)&quot;
    android:shape=&quot;rectangle&quot;&gt;
    &lt;gradient
        android:startColor=&quot;#3B5998&quot;
        android:endColor=&quot;#00000000&quot;
        android:angle=&quot;45&quot;/&gt;    
&lt;/shape&gt;</code></pre><p>For more information, you can read<br><a href="https://android.jlelse.eu/android-shape-drawables-tutorial-17fbece6fef5" target="_blank" rel="noopener"><strong>Android Shape Drawables Tutorial</strong><br><em>Have you ever wanted to reduce your Android application’s size or make it look more interesting? If yes, then you…</em>android.jlelse.eu</a></p>
<p>We can also use the class directly <a href="https://developer.android.com/reference/android/graphics/drawable/ShapeDrawable" target="_blank" rel="noopener">ShapeDrawable</a> in code</p>
<blockquote>
<p>A Drawable object that draws primitive shapes. A ShapeDrawable takes a <a href="https://developer.android.com/reference/android/graphics/drawable/shapes/Shape.html" target="_blank" rel="noopener">Shape</a> object and manages its presence on the screen. If no Shape is given, then the ShapeDrawable will default to a <a href="https://developer.android.com/reference/android/graphics/drawable/shapes/RectShape.html" target="_blank" rel="noopener">RectShape</a>.<br>This object can be defined in an XML file with the <shape> element.</shape></p>
</blockquote>
<h3 id="GradientManagerPackage"><a href="#GradientManagerPackage" class="headerlink" title="GradientManagerPackage"></a>GradientManagerPackage</h3><p>In iOS we use RCT_EXPORT_MODULE to register the component, but in Android, things are done explicitly using Package . A package can register both native module and native UI component. In this case we deal with just UI component, so let’s return RNGradientManager in createViewManagers</p>
<p><strong>GradientManagerPackage.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import com.facebook.react.ReactPackage;
import com.facebook.react.bridge.NativeModule;
import com.facebook.react.bridge.ReactApplicationContext;
import com.facebook.react.uimanager.ViewManager;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

public class RNGradientViewPackage implements ReactPackage {
    [@Override](http://twitter.com/Override)
    public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) {
        return Collections.emptyList();
    }

[@Override](http://twitter.com/Override)
    public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) {
        return Arrays.&lt;ViewManager&gt;asList(
            new RNGradientViewManager()
        );
    }
}</code></pre><p>Then head over to MainApplication.java to declare our package</p>
<pre><code>[@Override](http://twitter.com/Override)
protected List&lt;ReactPackage&gt; getPackages() {
  return Arrays.&lt;ReactPackage&gt;asList(
      new MainReactPackage(),
      new RNGradientViewPackage()
  );
}</code></pre><p>That’s it for Android. We already have the GradientView.js written earlier, when running the app in Android, it will look up and load our RNGradientView</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Hope you learn something about native UI component. In the post we only touch the surfaces on what native UI component can do, which is just passing configurations from Javascript to native. There are a lot more to discover, like event handling, thread, styles, custom types, please consult the official documentation for correct guidance.</p>
<ul>
<li><a href="https://facebook.github.io/react-native/docs/native-components-ios" target="_blank" rel="noopener">Native UI Components for iOS</a></li>
<li><a href="https://facebook.github.io/react-native/docs/native-components-android" target="_blank" rel="noopener">Native UI Components for Android</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-native/">react native</a></li></ul>

      
            
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/Get-to-know-different-JavaScript-environments-in-React-Native/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Get to know different JavaScript environments in React Native
        
      </div>
    </a>
  
  
    <a href="/blog/How-to-dismiss-keyboard-with-react-navigation-in-React-Native-apps/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">How to dismiss keyboard with react-navigation in React Native apps</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article" style="overflow-y: scroll; max-width: 28%;">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Native-UI-component-vs-Native-module"><span class="nav-number">1.</span> <span class="nav-text">Native UI component vs Native module</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#View-Manager"><span class="nav-number">2.</span> <span class="nav-text">View Manager</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Implement-in-iOS"><span class="nav-number">3.</span> <span class="nav-text">Implement in iOS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Project-structure"><span class="nav-number">3.1.</span> <span class="nav-text">Project structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RNGradientViewManager"><span class="nav-number">3.2.</span> <span class="nav-text">RNGradientViewManager</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RNGradientView"><span class="nav-number">3.3.</span> <span class="nav-text">RNGradientView</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#requireNativeComponent"><span class="nav-number">3.4.</span> <span class="nav-text">requireNativeComponent</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Implement-in-Android"><span class="nav-number">4.</span> <span class="nav-text">Implement in Android</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Project-structure-1"><span class="nav-number">4.1.</span> <span class="nav-text">Project structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RNGradientManager"><span class="nav-number">4.2.</span> <span class="nav-text">RNGradientManager</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RNGradientView-1"><span class="nav-number">4.3.</span> <span class="nav-text">RNGradientView</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shape-drawable"><span class="nav-number">4.4.</span> <span class="nav-text">Shape drawable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GradientManagerPackage"><span class="nav-number">4.5.</span> <span class="nav-text">GradientManagerPackage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Where-to-go-from-here"><span class="nav-number">5.</span> <span class="nav-text">Where to go from here</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2020 onmyway133 All Rights Reserved.
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about/" class="mobile-nav-link">About</a>
  
    <a href="/apps/" class="mobile-nav-link">Apps</a>
  
    <a href="/writing/" class="mobile-nav-link">Writing</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/speaking/" class="mobile-nav-link">Speaking</a>
  
    <a href="/opensource/" class="mobile-nav-link">Open Source</a>
  
    <a href="/projects/" class="mobile-nav-link">Projects</a>
  
    <a href="/news/" class="mobile-nav-link">News</a>
  
    <a href="/gumroad/" class="mobile-nav-link">Gumroad</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-40119591-5', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->












  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
