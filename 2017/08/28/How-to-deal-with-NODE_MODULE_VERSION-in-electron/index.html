<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Issue #69NODE_MODULE_VERSIONToday I was trying to install sharp with yarn add sharp to work in my electron app, but I get the following error  Uncaught Error: The module ‘/Users/khoa/MyElectronApp/nod">
<meta name="keywords" content="ios, android,javascript, react">
<meta property="og:type" content="article">
<meta property="og:title" content="How to deal with NODE_MODULE_VERSION in electron">
<meta property="og:url" content="https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="Issue #69NODE_MODULE_VERSIONToday I was trying to install sharp with yarn add sharp to work in my electron app, but I get the following error  Uncaught Error: The module ‘/Users/khoa/MyElectronApp/nod">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-05-23T16:57:53.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to deal with NODE_MODULE_VERSION in electron">
<meta name="twitter:description" content="Issue #69NODE_MODULE_VERSIONToday I was trying to install sharp with yarn add sharp to work in my electron app, but I get the following error  Uncaught Error: The module ‘/Users/khoa/MyElectronApp/nod">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>How to deal with NODE_MODULE_VERSION in electron</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/08/29/How-to-observe-object-deinit-in-Swift/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/08/21/Norsk/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&text=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&is_video=false&description=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How to deal with NODE_MODULE_VERSION in electron&body=Check out this article: https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&name=How to deal with NODE_MODULE_VERSION in electron&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Issue-69"><span class="toc-number">1.</span> <span class="toc-text">Issue #69</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NODE-MODULE-VERSION"><span class="toc-number">1.1.</span> <span class="toc-text">NODE_MODULE_VERSION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Native-node-module"><span class="toc-number">1.2.</span> <span class="toc-text">Native node module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-version"><span class="toc-number">1.3.</span> <span class="toc-text">Node version</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Electron-version"><span class="toc-number">1.4.</span> <span class="toc-text">Electron version</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-electron-rebuild"><span class="toc-number">1.5.</span> <span class="toc-text">Using electron-rebuild</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Read-more"><span class="toc-number">1.6.</span> <span class="toc-text">Read more</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        How to deal with NODE_MODULE_VERSION in electron
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">onmyway133</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2017-08-28T11:00:49.000Z" itemprop="datePublished">2017-08-28</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Issue-69"><a href="#Issue-69" class="headerlink" title="Issue #69"></a><strong>Issue <a href="https://github.com/onmyway133/blog/issues/69" target="_blank" rel="noopener">#69</a></strong></h2><h3 id="NODE-MODULE-VERSION"><a href="#NODE-MODULE-VERSION" class="headerlink" title="NODE_MODULE_VERSION"></a>NODE_MODULE_VERSION</h3><p>Today I was trying to install <a href="https://github.com/lovell/sharp" target="_blank" rel="noopener">sharp</a> with <code>yarn add sharp</code> to work in my electron app, but I get the following error</p>
<blockquote>
<p>Uncaught Error: The module ‘/Users/khoa/MyElectronApp/node_modules/sharp/build/Release/sharp.node’<br>was compiled against a different Node.js version using<br>NODE_MODULE_VERSION 57. This version of Node.js requires<br>NODE_MODULE_VERSION 54. Please try re-compiling or re-installing<br>the module</p>
</blockquote>
<h3 id="Native-node-module"><a href="#Native-node-module" class="headerlink" title="Native node module"></a>Native node module</h3><p>Searching a bit, it was because <code>sharp</code> is a <a href="https://nodejs.org/api/addons.html" target="_blank" rel="noopener">native node module</a> which uses <a href="https://github.com/jcupitt/libvips" target="_blank" rel="noopener">libvips</a> under the hood</p>
<blockquote>
<p>Node.js Addons are dynamically-linked shared objects, written in C++, that can be loaded into Node.js using the require() function, and used just as if they were an ordinary Node.js module. They are used primarily to provide an interface between JavaScript running in Node.js and C/C++ libraries.</p>
</blockquote>
<p>More on how to build native node module can be found here <a href="https://blog.risingstack.com/writing-native-node-js-modules/" target="_blank" rel="noopener">https://blog.risingstack.com/writing-native-node-js-modules/</a></p>
<h3 id="Node-version"><a href="#Node-version" class="headerlink" title="Node version"></a>Node version</h3><p>I’m using <a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">nvm</a> to manage node version, and <code>nvm list</code> shows <code>8.4.0</code> as the latest node version I’m using. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v6.10.1</span><br><span class="line">v7.8.0</span><br><span class="line">v7.9.0</span><br><span class="line">v8.0.0</span><br><span class="line">-&gt; v8.4.0</span><br><span class="line">system</span><br></pre></td></tr></table></figure>

<p>Searching on <a href="https://nodejs.org/en/download/releases/" target="_blank" rel="noopener">Node releases</a>  reveals that Node 8.4.0 has <code>NODE_MODULE_VERSION</code> of 57, so that is the node version npm uses to compile <code>sharp</code></p>
<p>However, I can’t seem to find the <code>NODE_MODULE_VERSION</code> 54 that <code>sharp</code> is using. I tried node <code>8.0.0</code> which is believed to have <code>NODE_MODULE_VERSION</code> 54 but it didn’t work</p>
<h3 id="Electron-version"><a href="#Electron-version" class="headerlink" title="Electron version"></a>Electron version</h3><p>As the time of this post, <code>electron</code> is at version <code>7.9.0</code>, you can check here <a href="https://github.com/electron/electron/blob/master/.node-version" target="_blank" rel="noopener">https://github.com/electron/electron/blob/master/.node-version</a> or by running <code>process.versions</code> in  Javascript console</p>
<h3 id="Using-electron-rebuild"><a href="#Using-electron-rebuild" class="headerlink" title="Using electron-rebuild"></a>Using electron-rebuild</h3><p>So after I read this <a href="https://electron.atom.io/docs/tutorial/using-native-node-modules/" target="_blank" rel="noopener">Using Native Node Modules</a>, I install <code>electron-rebuilder</code> to recompile <code>sharp</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn add electron-rebuild --dev</span><br><span class="line">yarn add sharp</span><br><span class="line">./node_modules/.bin/electron-rebuild</span><br></pre></td></tr></table></figure>

<p>It works now 🎉 </p>
<h3 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h3><ul>
<li><a href="https://blog.risingstack.com/writing-native-node-js-modules/" target="_blank" rel="noopener">https://blog.risingstack.com/writing-native-node-js-modules/</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Issue-69"><span class="toc-number">1.</span> <span class="toc-text">Issue #69</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NODE-MODULE-VERSION"><span class="toc-number">1.1.</span> <span class="toc-text">NODE_MODULE_VERSION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Native-node-module"><span class="toc-number">1.2.</span> <span class="toc-text">Native node module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-version"><span class="toc-number">1.3.</span> <span class="toc-text">Node version</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Electron-version"><span class="toc-number">1.4.</span> <span class="toc-text">Electron version</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-electron-rebuild"><span class="toc-number">1.5.</span> <span class="toc-text">Using electron-rebuild</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Read-more"><span class="toc-number">1.6.</span> <span class="toc-text">Read more</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&text=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&is_video=false&description=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How to deal with NODE_MODULE_VERSION in electron&body=Check out this article: https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&title=How to deal with NODE_MODULE_VERSION in electron"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://onmyway133.github.io/2017/08/28/How-to-deal-with-NODE_MODULE_VERSION-in-electron/&name=How to deal with NODE_MODULE_VERSION in electron&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Khoa Pham
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
