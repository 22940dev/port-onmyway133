<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Tag: iOS - onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">iOS</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-17T10:53:31.000Z" title="2019-06-17T10:53:31.000Z">2019-06-17</time><span class="level-item">3 minutes read (About 413 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Links-for-WWDC/">Links for WWDC</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/313" target="_blank" rel="noopener">#313</a></strong></p>
<h2 id="iOS-10"><a href="#iOS-10" class="headerlink" title="iOS 10"></a>iOS 10</h2><p>➕<a href="https://developer.apple.com/documentation/usernotifications" target="_blank" rel="noopener">UserNotifications</a></p>
<blockquote>
<p>Push user-facing notifications to the user’s device from a server, or generate them locally from your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" target="_blank" rel="noopener">UIViewPropertyAnimator</a></p>
<blockquote>
<p>A class that animates changes to views and allows the dynamic modification of those animations.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer" target="_blank" rel="noopener">NSPersistentContainer</a></p>
<blockquote>
<p>A container that encapsulates the Core Data stack in your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uifeedbackgenerator" target="_blank" rel="noopener">UIFeedbackGenerator</a></p>
<blockquote>
<p>The abstract superclass for all feedback generators.</p>
</blockquote>
<h2 id="iOS-10-3"><a href="#iOS-10-3" class="headerlink" title="iOS 10.3"></a>iOS 10.3</h2><p>➕<a href="https://developer.apple.com/documentation/storekit/skstorereviewcontroller" target="_blank" rel="noopener">SKStoreReviewController</a></p>
<blockquote>
<p>An object that controls the process of requesting App Store ratings and reviews from users.</p>
</blockquote>
<h2 id="iOS-11"><a href="#iOS-11" class="headerlink" title="iOS 11"></a>iOS 11</h2><p>➕<a href="https://developer.apple.com/documentation/uikit/uiview/2891102-safearealayoutguide" target="_blank" rel="noopener">safeAreaLayoutGuide</a></p>
<blockquote>
<p>The layout guide representing the portion of your view that is unobscured by bars and other content.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coreml" target="_blank" rel="noopener">CoreML</a></p>
<blockquote>
<p>Integrate machine learning models into your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/vision" target="_blank" rel="noopener">Vision</a></p>
<blockquote>
<p>Apply computer vision algorithms to perform a variety of tasks on input images and video.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/arkit" target="_blank" rel="noopener">ARKit</a></p>
<blockquote>
<p>Integrate iOS device camera and motion features to produce augmented reality experiences in your app or game.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/devicecheck" target="_blank" rel="noopener">DeviceCheck</a></p>
<blockquote>
<p>Access per-device, per-developer data that your associated server can use in its business logic.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/drag_and_drop" target="_blank" rel="noopener">Drag and Drop</a></p>
<blockquote>
<p>Bring drag and drop to your app by using interaction APIs with your views.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/corenfc" target="_blank" rel="noopener">CoreNFC</a></p>
<blockquote>
<p>Detect NFC tags and read messages that contain NDEF data.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/quartzcore/calayer/2877488-maskedcorners" target="_blank" rel="noopener">maskedCorners</a></p>
<blockquote>
<p>Animatable corner radius</p>
</blockquote>
<h2 id="iOS-12"><a href="#iOS-12" class="headerlink" title="iOS 12"></a>iOS 12</h2><p>➕<a href="https://developer.apple.com/documentation/authenticationservices" target="_blank" rel="noopener">AuthenticationServices</a></p>
<blockquote>
<p>Make it easy for users to log into apps and services.</p>
</blockquote>
<h2 id="iOS-13"><a href="#iOS-13" class="headerlink" title="iOS 13"></a>iOS 13</h2><ul>
<li><a href="https://www.hackingwithswift.com/articles/193/whats-new-in-ios-13" target="_blank" rel="noopener">https://www.hackingwithswift.com/articles/193/whats-new-in-ios-13</a></li>
<li><a href="https://onesignal.com/blog/ios-13-introduces-4-breaking-changes-to-notifications/" target="_blank" rel="noopener">https://onesignal.com/blog/ios-13-introduces-4-breaking-changes-to-notifications/</a></li>
</ul>
<p>➕<a href="https://developer.apple.com/documentation/swiftui" target="_blank" rel="noopener">SwiftUI</a></p>
<blockquote>
<p>Declare the user interface and behavior for your app on every platform.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/combine" target="_blank" rel="noopener">Combine</a></p>
<blockquote>
<p>Customize handling of asynchronous events by combining event-processing operators.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/cryptokit" target="_blank" rel="noopener">CryptoKit</a></p>
<blockquote>
<p>Perform cryptographic operations securely and efficiently.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uisearchtextfield" target="_blank" rel="noopener">UISearchTextField</a></p>
<blockquote>
<p>Expose UISearchTextField on UISearchBar</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/metrickit" target="_blank" rel="noopener">MetricKit</a></p>
<p>➕CoreSVG</p>
<ul>
<li><a href="https://github.com/SDWebImage/SDWebImageSVGCoder" target="_blank" rel="noopener">https://github.com/SDWebImage/SDWebImageSVGCoder</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-17T10:53:31.000Z" title="2019-06-17T10:53:31.000Z">2019-06-17</time><span class="level-item">3 minutes read (About 406 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/What-is-new-in-iOS/">What is new in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/313" target="_blank" rel="noopener">#313</a></strong></p>
<h2 id="iOS-10"><a href="#iOS-10" class="headerlink" title="iOS 10"></a>iOS 10</h2><p>➕<a href="https://developer.apple.com/documentation/usernotifications" target="_blank" rel="noopener">UserNotifications</a></p>
<blockquote>
<p>Push user-facing notifications to the user’s device from a server, or generate them locally from your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" target="_blank" rel="noopener">UIViewPropertyAnimator</a></p>
<blockquote>
<p>A class that animates changes to views and allows the dynamic modification of those animations.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer" target="_blank" rel="noopener">NSPersistentContainer</a></p>
<blockquote>
<p>A container that encapsulates the Core Data stack in your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uifeedbackgenerator" target="_blank" rel="noopener">UIFeedbackGenerator</a></p>
<blockquote>
<p>The abstract superclass for all feedback generators.</p>
</blockquote>
<h2 id="iOS-10-3"><a href="#iOS-10-3" class="headerlink" title="iOS 10.3"></a>iOS 10.3</h2><p>➕<a href="https://developer.apple.com/documentation/storekit/skstorereviewcontroller" target="_blank" rel="noopener">SKStoreReviewController</a></p>
<blockquote>
<p>An object that controls the process of requesting App Store ratings and reviews from users.</p>
</blockquote>
<h2 id="iOS-11"><a href="#iOS-11" class="headerlink" title="iOS 11"></a>iOS 11</h2><p>➕<a href="https://developer.apple.com/documentation/uikit/uiview/2891102-safearealayoutguide" target="_blank" rel="noopener">safeAreaLayoutGuide</a></p>
<blockquote>
<p>The layout guide representing the portion of your view that is unobscured by bars and other content.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coreml" target="_blank" rel="noopener">CoreML</a></p>
<blockquote>
<p>Integrate machine learning models into your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/vision" target="_blank" rel="noopener">Vision</a></p>
<blockquote>
<p>Apply computer vision algorithms to perform a variety of tasks on input images and video.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/arkit" target="_blank" rel="noopener">ARKit</a></p>
<blockquote>
<p>Integrate iOS device camera and motion features to produce augmented reality experiences in your app or game.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/devicecheck" target="_blank" rel="noopener">DeviceCheck</a></p>
<blockquote>
<p>Access per-device, per-developer data that your associated server can use in its business logic.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/drag_and_drop" target="_blank" rel="noopener">Drag and Drop</a></p>
<blockquote>
<p>Bring drag and drop to your app by using interaction APIs with your views.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/corenfc" target="_blank" rel="noopener">CoreNFC</a></p>
<blockquote>
<p>Detect NFC tags and read messages that contain NDEF data.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/quartzcore/calayer/2877488-maskedcorners" target="_blank" rel="noopener">maskedCorners</a></p>
<blockquote>
<p>Animatable corner radius</p>
</blockquote>
<h2 id="iOS-12"><a href="#iOS-12" class="headerlink" title="iOS 12"></a>iOS 12</h2><p>➕<a href="https://developer.apple.com/documentation/authenticationservices" target="_blank" rel="noopener">AuthenticationServices</a></p>
<blockquote>
<p>Make it easy for users to log into apps and services.</p>
</blockquote>
<h2 id="iOS-13"><a href="#iOS-13" class="headerlink" title="iOS 13"></a>iOS 13</h2><ul>
<li><a href="https://www.hackingwithswift.com/articles/193/whats-new-in-ios-13" target="_blank" rel="noopener">https://www.hackingwithswift.com/articles/193/whats-new-in-ios-13</a></li>
<li><a href="https://onesignal.com/blog/ios-13-introduces-4-breaking-changes-to-notifications/" target="_blank" rel="noopener">https://onesignal.com/blog/ios-13-introduces-4-breaking-changes-to-notifications/</a></li>
</ul>
<p>➕<a href="https://developer.apple.com/documentation/swiftui" target="_blank" rel="noopener">SwiftUI</a></p>
<blockquote>
<p>Declare the user interface and behavior for your app on every platform.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/combine" target="_blank" rel="noopener">Combine</a></p>
<blockquote>
<p>Customize handling of asynchronous events by combining event-processing operators.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/cryptokit" target="_blank" rel="noopener">CryptoKit</a></p>
<blockquote>
<p>Perform cryptographic operations securely and efficiently.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uisearchtextfield" target="_blank" rel="noopener">UISearchTextField</a></p>
<blockquote>
<p>Expose UISearchTextField on UISearchBar</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/metrickit" target="_blank" rel="noopener">MetricKit</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-17T10:53:31.000Z" title="2019-06-17T10:53:31.000Z">2019-06-17</time><span class="level-item">3 minutes read (About 387 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/What&#039;s-new-in-iOS/">What&#039;s new in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/313" target="_blank" rel="noopener">#313</a></strong></p>
<h2 id="iOS-10"><a href="#iOS-10" class="headerlink" title="iOS 10"></a>iOS 10</h2><p>➕<a href="https://developer.apple.com/documentation/usernotifications" target="_blank" rel="noopener">UserNotifications</a></p>
<blockquote>
<p>Push user-facing notifications to the user’s device from a server, or generate them locally from your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" target="_blank" rel="noopener">UIViewPropertyAnimator</a></p>
<blockquote>
<p>A class that animates changes to views and allows the dynamic modification of those animations.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer" target="_blank" rel="noopener">NSPersistentContainer</a></p>
<blockquote>
<p>A container that encapsulates the Core Data stack in your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uifeedbackgenerator" target="_blank" rel="noopener">UIFeedbackGenerator</a></p>
<blockquote>
<p>The abstract superclass for all feedback generators.</p>
</blockquote>
<h2 id="iOS-10-3"><a href="#iOS-10-3" class="headerlink" title="iOS 10.3"></a>iOS 10.3</h2><p>➕<a href="https://developer.apple.com/documentation/storekit/skstorereviewcontroller" target="_blank" rel="noopener">SKStoreReviewController</a></p>
<blockquote>
<p>An object that controls the process of requesting App Store ratings and reviews from users.</p>
</blockquote>
<h2 id="iOS-11"><a href="#iOS-11" class="headerlink" title="iOS 11"></a>iOS 11</h2><p>➕<a href="https://developer.apple.com/documentation/uikit/uiview/2891102-safearealayoutguide" target="_blank" rel="noopener">safeAreaLayoutGuide</a></p>
<blockquote>
<p>The layout guide representing the portion of your view that is unobscured by bars and other content.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coreml" target="_blank" rel="noopener">CoreML</a></p>
<blockquote>
<p>Integrate machine learning models into your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/vision" target="_blank" rel="noopener">Vision</a></p>
<blockquote>
<p>Apply computer vision algorithms to perform a variety of tasks on input images and video.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/arkit" target="_blank" rel="noopener">ARKit</a></p>
<blockquote>
<p>Integrate iOS device camera and motion features to produce augmented reality experiences in your app or game.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/devicecheck" target="_blank" rel="noopener">DeviceCheck</a></p>
<blockquote>
<p>Access per-device, per-developer data that your associated server can use in its business logic.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/drag_and_drop" target="_blank" rel="noopener">Drag and Drop</a></p>
<blockquote>
<p>Bring drag and drop to your app by using interaction APIs with your views.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/corenfc" target="_blank" rel="noopener">CoreNFC</a></p>
<blockquote>
<p>Detect NFC tags and read messages that contain NDEF data.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/quartzcore/calayer/2877488-maskedcorners" target="_blank" rel="noopener">maskedCorners</a></p>
<blockquote>
<p>Animatable corner radius</p>
</blockquote>
<h2 id="iOS-12"><a href="#iOS-12" class="headerlink" title="iOS 12"></a>iOS 12</h2><p>➕<a href="https://developer.apple.com/documentation/authenticationservices" target="_blank" rel="noopener">AuthenticationServices</a></p>
<blockquote>
<p>Make it easy for users to log into apps and services.</p>
</blockquote>
<h2 id="iOS-13"><a href="#iOS-13" class="headerlink" title="iOS 13"></a>iOS 13</h2><p>➕<a href="https://developer.apple.com/documentation/swiftui" target="_blank" rel="noopener">SwiftUI</a></p>
<blockquote>
<p>Declare the user interface and behavior for your app on every platform.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/combine" target="_blank" rel="noopener">Combine</a></p>
<blockquote>
<p>Customize handling of asynchronous events by combining event-processing operators.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/cryptokit" target="_blank" rel="noopener">CryptoKit</a></p>
<blockquote>
<p>Perform cryptographic operations securely and efficiently.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uisearchtextfield" target="_blank" rel="noopener">UISearchTextField</a></p>
<blockquote>
<p>Expose UISearchTextField on UISearchBar</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/metrickit" target="_blank" rel="noopener">MetricKit</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-17T10:53:31.000Z" title="2019-06-17T10:53:31.000Z">2019-06-17</time><span class="level-item">3 minutes read (About 413 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-new-APIs-in-iOS/">How to use new APIs  in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/313" target="_blank" rel="noopener">#313</a></strong></p>
<h2 id="iOS-10"><a href="#iOS-10" class="headerlink" title="iOS 10"></a>iOS 10</h2><p>➕<a href="https://developer.apple.com/documentation/usernotifications" target="_blank" rel="noopener">UserNotifications</a></p>
<blockquote>
<p>Push user-facing notifications to the user’s device from a server, or generate them locally from your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" target="_blank" rel="noopener">UIViewPropertyAnimator</a></p>
<blockquote>
<p>A class that animates changes to views and allows the dynamic modification of those animations.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer" target="_blank" rel="noopener">NSPersistentContainer</a></p>
<blockquote>
<p>A container that encapsulates the Core Data stack in your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uifeedbackgenerator" target="_blank" rel="noopener">UIFeedbackGenerator</a></p>
<blockquote>
<p>The abstract superclass for all feedback generators.</p>
</blockquote>
<h2 id="iOS-10-3"><a href="#iOS-10-3" class="headerlink" title="iOS 10.3"></a>iOS 10.3</h2><p>➕<a href="https://developer.apple.com/documentation/storekit/skstorereviewcontroller" target="_blank" rel="noopener">SKStoreReviewController</a></p>
<blockquote>
<p>An object that controls the process of requesting App Store ratings and reviews from users.</p>
</blockquote>
<h2 id="iOS-11"><a href="#iOS-11" class="headerlink" title="iOS 11"></a>iOS 11</h2><p>➕<a href="https://developer.apple.com/documentation/uikit/uiview/2891102-safearealayoutguide" target="_blank" rel="noopener">safeAreaLayoutGuide</a></p>
<blockquote>
<p>The layout guide representing the portion of your view that is unobscured by bars and other content.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/coreml" target="_blank" rel="noopener">CoreML</a></p>
<blockquote>
<p>Integrate machine learning models into your app.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/vision" target="_blank" rel="noopener">Vision</a></p>
<blockquote>
<p>Apply computer vision algorithms to perform a variety of tasks on input images and video.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/arkit" target="_blank" rel="noopener">ARKit</a></p>
<blockquote>
<p>Integrate iOS device camera and motion features to produce augmented reality experiences in your app or game.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/devicecheck" target="_blank" rel="noopener">DeviceCheck</a></p>
<blockquote>
<p>Access per-device, per-developer data that your associated server can use in its business logic.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/drag_and_drop" target="_blank" rel="noopener">Drag and Drop</a></p>
<blockquote>
<p>Bring drag and drop to your app by using interaction APIs with your views.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/corenfc" target="_blank" rel="noopener">CoreNFC</a></p>
<blockquote>
<p>Detect NFC tags and read messages that contain NDEF data.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/quartzcore/calayer/2877488-maskedcorners" target="_blank" rel="noopener">maskedCorners</a></p>
<blockquote>
<p>Animatable corner radius</p>
</blockquote>
<h2 id="iOS-12"><a href="#iOS-12" class="headerlink" title="iOS 12"></a>iOS 12</h2><p>➕<a href="https://developer.apple.com/documentation/authenticationservices" target="_blank" rel="noopener">AuthenticationServices</a></p>
<blockquote>
<p>Make it easy for users to log into apps and services.</p>
</blockquote>
<h2 id="iOS-13"><a href="#iOS-13" class="headerlink" title="iOS 13"></a>iOS 13</h2><ul>
<li><a href="https://www.hackingwithswift.com/articles/193/whats-new-in-ios-13" target="_blank" rel="noopener">https://www.hackingwithswift.com/articles/193/whats-new-in-ios-13</a></li>
<li><a href="https://onesignal.com/blog/ios-13-introduces-4-breaking-changes-to-notifications/" target="_blank" rel="noopener">https://onesignal.com/blog/ios-13-introduces-4-breaking-changes-to-notifications/</a></li>
</ul>
<p>➕<a href="https://developer.apple.com/documentation/swiftui" target="_blank" rel="noopener">SwiftUI</a></p>
<blockquote>
<p>Declare the user interface and behavior for your app on every platform.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/combine" target="_blank" rel="noopener">Combine</a></p>
<blockquote>
<p>Customize handling of asynchronous events by combining event-processing operators.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/cryptokit" target="_blank" rel="noopener">CryptoKit</a></p>
<blockquote>
<p>Perform cryptographic operations securely and efficiently.</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/uikit/uisearchtextfield" target="_blank" rel="noopener">UISearchTextField</a></p>
<blockquote>
<p>Expose UISearchTextField on UISearchBar</p>
</blockquote>
<p>➕<a href="https://developer.apple.com/documentation/metrickit" target="_blank" rel="noopener">MetricKit</a></p>
<p>➕CoreSVG</p>
<ul>
<li><a href="https://github.com/SDWebImage/SDWebImageSVGCoder" target="_blank" rel="noopener">https://github.com/SDWebImage/SDWebImageSVGCoder</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-14T09:28:25.000Z" title="2019-06-14T09:28:25.000Z">2019-06-14</time><span class="level-item">a few seconds read (About 58 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-cell-at-center-during-scroll-in-UICollectionView/">How to get cell at center during scroll in UICollectionView</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/311" target="_blank" rel="noopener">#311</a></strong></p>
<p>See Omnia <a href="https://github.com/onmyway133/Omnia/blob/master/Sources/iOS/UICollectionView.swift#L30" target="_blank" rel="noopener">https://github.com/onmyway133/Omnia/blob/master/Sources/iOS/UICollectionView.swift#L30</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">HorizontalUsersViewController</span>: <span class="title">UIScrollViewDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">scrollViewDidEndDecelerating</span><span class="params">(<span class="number">_</span> scrollView: UIScrollView)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> point = view.convert(collectionView.center, to: collectionView)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> indexPath = collectionView.indexPathForItem(at: point),</span><br><span class="line">            indexPath.item &lt; users.<span class="built_in">count</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> user = users[indexPath.item]</span><br><span class="line">        delegate?.didScrollTo(user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-14T09:27:14.000Z" title="2019-06-14T09:27:14.000Z">2019-06-14</time><span class="level-item">a few seconds read (About 18 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-downsample-image-in-iOS/">How to downsample image in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/310" target="_blank" rel="noopener">#310</a></strong></p>
<ul>
<li><a href="https://www.swiftjectivec.com/optimizing-images/" target="_blank" rel="noopener">https://www.swiftjectivec.com/optimizing-images/</a></li>
<li><a href="https://nshipster.com/image-resizing/" target="_blank" rel="noopener">https://nshipster.com/image-resizing/</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-13T12:02:15.000Z" title="2019-06-13T12:02:15.000Z">2019-06-13</time><span class="level-item">a few seconds read (About 86 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-location-in-Apple-Maps-and-Google-Maps-app-in-iOS/">How to show location in Apple Maps and Google Maps app in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/309" target="_blank" rel="noopener">#309</a></strong></p>
<h2 id="Apple-Maps"><a href="#Apple-Maps" class="headerlink" title="Apple Maps"></a>Apple Maps</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> placemark = <span class="type">MKPlacemark</span>(coordinate: coordinate, addressDictionary: <span class="literal">nil</span>)</span><br><span class="line"><span class="keyword">let</span> mapItem = <span class="type">MKMapItem</span>(placemark: placemark)</span><br><span class="line">mapItem.name = shop.name</span><br><span class="line">mapItem.openInMaps(launchOptions: [:])</span><br></pre></td></tr></table></figure>

<h2 id="Google-Maps"><a href="#Google-Maps" class="headerlink" title="Google Maps"></a>Google Maps</h2><ul>
<li><a href="https://developers.google.com/maps/documentation/urls/ios-urlscheme" target="_blank" rel="noopener">https://developers.google.com/maps/documentation/urls/ios-urlscheme</a></li>
<li>Use <code>q</code> to show pin</li>
</ul>
<p>Since iOS 9, we need to declare <code>LSApplicationQueriesSchemes</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>LSApplicationQueriesSchemes<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>comgooglemaps<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> string = <span class="string">"comgooglemaps://"</span></span><br><span class="line">string += <span class="string">"?q=Food"</span></span><br><span class="line">string += <span class="string">"&amp;center=\(coordinate.latitude),\(coordinate.longitude)"</span></span><br><span class="line">string += <span class="string">"&amp;zoom=15"</span></span><br><span class="line"><span class="keyword">let</span> googleUrl = <span class="type">URL</span>(string: string)!</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="type">UIApplication</span>.shared.canOpenURL(<span class="type">URL</span>(string: <span class="string">"comgooglemaps://"</span>)!) &#123;</span><br><span class="line">    <span class="type">UIApplication</span>.shared.<span class="keyword">open</span>(googleUrl)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-13T09:49:44.000Z" title="2019-06-13T09:49:44.000Z">2019-06-13</time><span class="level-item">a few seconds read (About 27 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-format-distance-in-iOS/">How to format distance in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/307" target="_blank" rel="noopener">#307</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MapKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> formatter = <span class="type">MKDistanceFormatter</span>()</span><br><span class="line">formatter.unitStyle = .abbreviated</span><br><span class="line">formatter.units = .metric</span><br><span class="line">distanceLabel.text = formatter.string(fromDistance: <span class="built_in">distance</span>) <span class="comment">// 700m, 1.7km</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-12T09:11:26.000Z" title="2019-06-12T09:11:26.000Z">2019-06-12</time><span class="level-item">a few seconds read (About 89 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-test-drive-view-in-iOS/">How to test drive view in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/303" target="_blank" rel="noopener">#303</a></strong></p>
<p>Instead of setting up custom framework and Playground, we can just display that specific view as root view controller</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">window.rootViewController = makeTestPlayground()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeTestPlayground</span><span class="params">()</span></span> -&gt; <span class="type">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> content = <span class="type">UserCell</span>()</span><br><span class="line">    content.nameLabel.text = <span class="string">"Thor"</span></span><br><span class="line">    content.streetLabel.text = <span class="string">"Asgard"</span></span><br><span class="line">    content.weaponLabel.text = <span class="string">"Hammer"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> viewController = <span class="type">UIViewController</span>()</span><br><span class="line">    viewController.view.backgroundColor = .white</span><br><span class="line">    viewController.view.addSubview(content)</span><br><span class="line"></span><br><span class="line">    <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">        content.centerXAnchor.constraint(equalTo: viewController.view.centerXAnchor),</span><br><span class="line">        content.centerYAnchor.constraint(equalTo: viewController.view.centerYAnchor),</span><br><span class="line">        content.widthAnchor.constraint(equalTo: viewController.view.widthAnchor, multiplier0.<span class="number">9</span>),</span><br><span class="line">        content.heightAnchor.constraint(equalToConstant: <span class="number">200</span>)</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> viewController</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-12T08:35:42.000Z" title="2019-06-12T08:35:42.000Z">2019-06-12</time><span class="level-item">4 minutes read (About 566 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-carousel-layout-for-UICollectionView-in-iOS/">How to make carousel layout for UICollectionView in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/302" target="_blank" rel="noopener">#302</a></strong></p>
<h3 id="Based-on-AnimatedCollectionViewLayout"><a href="#Based-on-AnimatedCollectionViewLayout" class="headerlink" title="Based on AnimatedCollectionViewLayout"></a>Based on <a href="https://github.com/KelvinJin/AnimatedCollectionViewLayout" target="_blank" rel="noopener">AnimatedCollectionViewLayout</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CarouselLayout</span>: <span class="title">UICollectionViewFlowLayout</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutAttributesForElements</span><span class="params">(<span class="keyword">in</span> rect: CGRect)</span></span> -&gt; [<span class="type">UICollectionViewLayoutAttributes</span>]? &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> attributes = <span class="keyword">super</span>.layoutAttributesForElements(<span class="keyword">in</span>: rect) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = collectionView <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> attributes.<span class="built_in">map</span>(&#123; transform(collectionView: collectionView, attribute: $<span class="number">0</span>) &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">shouldInvalidateLayout</span><span class="params">(forBoundsChange newBounds: CGRect)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">transform</span><span class="params">(collectionView: UICollectionView, attribute: UICollectionViewLayoutAttributes)</span></span> -&gt; <span class="type">UICollectionViewLayoutAttributes</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> a = attribute</span><br><span class="line">        <span class="keyword">let</span> width = collectionView.frame.size.width</span><br><span class="line">        <span class="keyword">let</span> itemOffset = a.center.x - collectionView.contentOffset.x</span><br><span class="line">        <span class="keyword">let</span> middleOffset = (itemOffset / width) - <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">        change(</span><br><span class="line">            width: collectionView.frame.size.width,</span><br><span class="line">            attribute: attribute,</span><br><span class="line">            middleOffset: middleOffset</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> attribute</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">change</span><span class="params">(width: CGFloat, attribute: UICollectionViewLayoutAttributes, middleOffset: CGFloat)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> alpha: <span class="type">CGFloat</span> = <span class="number">0.8</span></span><br><span class="line">        <span class="keyword">let</span> itemSpacing: <span class="type">CGFloat</span> = <span class="number">0.21</span></span><br><span class="line">        <span class="keyword">let</span> scale: <span class="type">CGFloat</span> = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> scaleFactor = scale - <span class="number">0.1</span> * <span class="built_in">abs</span>(middleOffset)</span><br><span class="line">        <span class="keyword">let</span> scaleTransform = <span class="type">CGAffineTransform</span>(scaleX: scaleFactor, y: scaleFactor)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> translationX = -(width * itemSpacing * middleOffset)</span><br><span class="line">        <span class="keyword">let</span> translationTransform = <span class="type">CGAffineTransform</span>(translationX: translationX, y: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        attribute.alpha = <span class="number">1.0</span> - <span class="built_in">abs</span>(middleOffset) + alpha</span><br><span class="line">        attribute.transform = translationTransform.concatenating(scaleTransform)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>How to use</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> layout = <span class="type">CarouselLayout</span>()</span><br><span class="line"></span><br><span class="line">layout.scrollDirection = .horizontal</span><br><span class="line">layout.sectionInset = .zero</span><br><span class="line">layout.minimumInteritemSpacing = <span class="number">0</span></span><br><span class="line">layout.minimumLineSpacing = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>We can inset cell content and use <code>let scale: CGFloat = 1.0</code> to avoid scaling down center cell</p>
<h3 id="Based-on-CityCollectionViewFlowLayout"><a href="#Based-on-CityCollectionViewFlowLayout" class="headerlink" title="Based on CityCollectionViewFlowLayout"></a>Based on <a href="https://github.com/appcoda/Interactive-Animation/blob/master/CityGuide/Layout/CityCollectionViewFlowLayout.swift" target="_blank" rel="noopener">CityCollectionViewFlowLayout</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CityCollectionViewFlowLayout</span>: <span class="title">UICollectionViewFlowLayout</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> lastCollectionViewSize: <span class="type">CGSize</span> = <span class="type">CGSize</span>.zero</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> scaleOffset: <span class="type">CGFloat</span> = <span class="number">200</span></span><br><span class="line">    <span class="keyword">var</span> scaleFactor: <span class="type">CGFloat</span> = <span class="number">0.9</span></span><br><span class="line">    <span class="keyword">var</span> alphaFactor: <span class="type">CGFloat</span> = <span class="number">0.3</span></span><br><span class="line">    <span class="keyword">var</span> lineSpacing: <span class="type">CGFloat</span> = <span class="number">25.0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder <span class="number">_</span>: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(itemSize: <span class="type">CGSize</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        <span class="keyword">self</span>.itemSize = itemSize</span><br><span class="line">        minimumLineSpacing = lineSpacing</span><br><span class="line">        scrollDirection = .horizontal</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setItemSize</span><span class="params">(itemSize: CGSize)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.itemSize = itemSize</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">invalidateLayout</span><span class="params">(with context: UICollectionViewLayoutInvalidationContext)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.invalidateLayout(with: context)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = <span class="keyword">self</span>.collectionView <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> collectionView.bounds.size != lastCollectionViewSize &#123;</span><br><span class="line">            configureContentInset()</span><br><span class="line">            lastCollectionViewSize = collectionView.bounds.size</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">targetContentOffset</span><span class="params">(forProposedContentOffset proposedContentOffset: CGPoint, withScrollingVelocity velocity: CGPoint)</span></span> -&gt; <span class="type">CGPoint</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = <span class="keyword">self</span>.collectionView <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> proposedContentOffset</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> proposedRect = <span class="type">CGRect</span>(x: proposedContentOffset.x, y: <span class="number">0</span>, width: collectionView.bounds.width, height: collectionView.bounds.height)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> layoutAttributes = <span class="keyword">self</span>.layoutAttributesForElements(<span class="keyword">in</span>: proposedRect) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> proposedContentOffset</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> candidateAttributes: <span class="type">UICollectionViewLayoutAttributes?</span></span><br><span class="line">        <span class="keyword">let</span> proposedContentOffsetCenterX = proposedContentOffset.x + collectionView.bounds.width / <span class="number">2</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> attributes <span class="keyword">in</span> layoutAttributes &#123;</span><br><span class="line">            <span class="keyword">if</span> attributes.representedElementCategory != .cell &#123;</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> candidateAttributes == <span class="literal">nil</span> &#123;</span><br><span class="line">                candidateAttributes = attributes</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(attributes.center.x - proposedContentOffsetCenterX) &lt; <span class="built_in">abs</span>(candidateAttributes!.center.x - proposedContentOffsetCenterX) &#123;</span><br><span class="line">                candidateAttributes = attributes</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> aCandidateAttributes = candidateAttributes <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> proposedContentOffset</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> newOffsetX = aCandidateAttributes.center.x - collectionView.bounds.size.width / <span class="number">2</span></span><br><span class="line">        <span class="keyword">let</span> offset = newOffsetX - collectionView.contentOffset.x</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (velocity.x &lt; <span class="number">0</span> &amp;&amp; offset &gt; <span class="number">0</span>) || (velocity.x &gt; <span class="number">0</span> &amp;&amp; offset &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> pageWidth = itemSize.width + minimumLineSpacing</span><br><span class="line">            newOffsetX += velocity.x &gt; <span class="number">0</span> ? pageWidth : -pageWidth</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="type">CGPoint</span>(x: newOffsetX, y: proposedContentOffset.y)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">shouldInvalidateLayout</span><span class="params">(forBoundsChange <span class="number">_</span>: CGRect)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutAttributesForElements</span><span class="params">(<span class="keyword">in</span> rect: CGRect)</span></span> -&gt; [<span class="type">UICollectionViewLayoutAttributes</span>]? &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = <span class="keyword">self</span>.collectionView,</span><br><span class="line">            <span class="keyword">let</span> superAttributes = <span class="keyword">super</span>.layoutAttributesForElements(<span class="keyword">in</span>: rect) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">super</span>.layoutAttributesForElements(<span class="keyword">in</span>: rect)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> contentOffset = collectionView.contentOffset</span><br><span class="line">        <span class="keyword">let</span> size = collectionView.bounds.size</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> visibleRect = <span class="type">CGRect</span>(x: contentOffset.x, y: contentOffset.y, width: size.width, height: size.height)</span><br><span class="line">        <span class="keyword">let</span> visibleCenterX = visibleRect.midX</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">case</span> <span class="keyword">let</span> newAttributesArray <span class="keyword">as</span> [<span class="type">UICollectionViewLayoutAttributes</span>] = <span class="type">NSArray</span>(array: superAttributes, copyItems: <span class="literal">true</span>) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        newAttributesArray.forEach &#123;</span><br><span class="line">            <span class="keyword">let</span> distanceFromCenter = visibleCenterX - $<span class="number">0</span>.center.x</span><br><span class="line">            <span class="keyword">let</span> absDistanceFromCenter = <span class="built_in">min</span>(<span class="built_in">abs</span>(distanceFromCenter), <span class="keyword">self</span>.scaleOffset)</span><br><span class="line">            <span class="keyword">let</span> scale = absDistanceFromCenter * (<span class="keyword">self</span>.scaleFactor - <span class="number">1</span>) / <span class="keyword">self</span>.scaleOffset + <span class="number">1</span></span><br><span class="line">            $<span class="number">0</span>.transform3D = <span class="type">CATransform3DScale</span>(<span class="type">CATransform3DIdentity</span>, scale, scale, <span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> alpha = absDistanceFromCenter * (<span class="keyword">self</span>.alphaFactor - <span class="number">1</span>) / <span class="keyword">self</span>.scaleOffset + <span class="number">1</span></span><br><span class="line">            $<span class="number">0</span>.alpha = alpha</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> newAttributesArray</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">configureContentInset</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = <span class="keyword">self</span>.collectionView <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> inset = collectionView.bounds.size.width / <span class="number">2</span> - itemSize.width / <span class="number">2</span></span><br><span class="line">        collectionView.contentInset = <span class="type">UIEdgeInsets</span>.<span class="keyword">init</span>(top: <span class="number">0</span>, <span class="keyword">left</span>: inset, bottom: <span class="number">0</span>, <span class="keyword">right</span>: inset)</span><br><span class="line">        collectionView.contentOffset = <span class="type">CGPoint</span>(x: -inset, y: <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">resetContentInset</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = <span class="keyword">self</span>.collectionView <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        collectionView.contentInset = <span class="type">UIEdgeInsets</span>.<span class="keyword">init</span>(top: <span class="number">0</span>, <span class="keyword">left</span>: <span class="number">0</span>, bottom: <span class="number">0</span>, <span class="keyword">right</span>: <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-12T06:30:14.000Z" title="2019-06-12T06:30:14.000Z">2019-06-12</time><span class="level-item">2 minutes read (About 336 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-simple-pan-to-dismiss-view-in-iOS/">How to make simple pan to dismiss view in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/301" target="_blank" rel="noopener">#301</a></strong></p>
<p>Make it more composable using <code>UIViewController</code> subclass and <code>ThroughView</code> to pass hit events to underlying views.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PanViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> animator = <span class="type">UIViewPropertyAnimator</span>(duration: <span class="number">0</span>, curve: .easeOut)</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> panGR = <span class="type">UIPanGestureRecognizer</span>(target: <span class="keyword">self</span>, action: #selector(handlePan(<span class="number">_</span>: )))</span><br><span class="line">    <span class="keyword">let</span> slideView = <span class="type">UIView</span>()</span><br><span class="line">    <span class="keyword">let</span> gripView = <span class="type">UIView</span>()</span><br><span class="line">    <span class="keyword">var</span> options: <span class="type">Options</span> = <span class="type">Options</span>()</span><br><span class="line">    <span class="keyword">var</span> didHide: (() -&gt; <span class="type">Void</span>)?</span><br><span class="line">    <span class="keyword">let</span> pullDownVelocity: <span class="type">CGFloat</span> = <span class="number">70</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Options</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> contentView: <span class="type">UIView</span> = <span class="type">UIView</span>()</span><br><span class="line">        <span class="keyword">var</span> percentHeight: <span class="type">CGFloat</span> = <span class="number">0.24</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">loadView</span><span class="params">()</span></span> &#123;</span><br><span class="line">        view = <span class="type">ThroughView</span>()</span><br><span class="line">        view.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        slideView.layer.cornerRadius = <span class="number">10</span></span><br><span class="line">        slideView.clipsToBounds = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">        gripView.backgroundColor = <span class="type">UIColor</span>.yellow</span><br><span class="line">        gripView.layer.cornerRadius = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        view.addSubview(slideView)</span><br><span class="line">        slideView.addSubview(gripView)</span><br><span class="line">        slideView.addGestureRecognizer(panGR)</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            slideView.leftAnchor.constraint(equalTo: view.leftAnchor),</span><br><span class="line">            slideView.rightAnchor.constraint(equalTo: view.rightAnchor),</span><br><span class="line">            slideView.heightAnchor.constraint(equalTo: view.heightAnchor),</span><br><span class="line">            slideView.topAnchor.constraint(equalTo: view.bottomAnchor)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            gripView.centerXAnchor.constraint(equalTo: slideView.centerXAnchor),</span><br><span class="line">            gripView.topAnchor.constraint(equalTo: slideView.topAnchor, constant: <span class="number">16</span>),</span><br><span class="line">            gripView.widthAnchor.constraint(equalToConstant: <span class="number">30</span>),</span><br><span class="line">            gripView.heightAnchor.constraint(equalToConstant: <span class="number">2</span>)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">apply</span><span class="params">(options: Options)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.options.contentView.removeFromSuperview()</span><br><span class="line">        slideView.insertSubview(options.contentView, at: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            options.contentView.leftAnchor.constraint(equalTo: slideView.leftAnchor),</span><br><span class="line">            options.contentView.rightAnchor.constraint(equalTo: slideView.rightAnchor),</span><br><span class="line">            options.contentView.topAnchor.constraint(equalTo: slideView.topAnchor),</span><br><span class="line">            options.contentView.heightAnchor.constraint(equalTo: slideView.heightAnchor, multiplier: options.percentHeight)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.options = options</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">handlePan</span><span class="params">(<span class="number">_</span> gr: UIPanGestureRecognizer)</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> gr.state &#123;</span><br><span class="line">        <span class="keyword">case</span> .began:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> .changed:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> .ended:</span><br><span class="line">            <span class="keyword">let</span> velocity = gr.velocity(<span class="keyword">in</span>: slideView)</span><br><span class="line">            <span class="keyword">if</span> velocity.y &gt; pullDownVelocity &#123;</span><br><span class="line">                hide()</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">show</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> parentView = view.superview <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        animator = <span class="keyword">self</span>.makeAnimator()</span><br><span class="line">        animator.addAnimations &#123;</span><br><span class="line">            <span class="keyword">self</span>.slideView.transform = <span class="type">CGAffineTransform</span>(</span><br><span class="line">                translationX: <span class="number">0</span>,</span><br><span class="line">                y: -parentView.bounds.height * <span class="keyword">self</span>.options.percentHeight - parentView.safeAreaInsets.bottom</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        animator.startAnimation()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">hide</span><span class="params">()</span></span> &#123;</span><br><span class="line">        animator = <span class="keyword">self</span>.makeAnimator()</span><br><span class="line">        animator.addAnimations &#123;</span><br><span class="line">            <span class="keyword">self</span>.slideView.transform = <span class="type">CGAffineTransform</span>.identity</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        animator.addCompletion(&#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.didHide?()</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        animator.startAnimation()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makeAnimator</span><span class="params">()</span></span> -&gt; <span class="type">UIViewPropertyAnimator</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIViewPropertyAnimator</span>(duration: <span class="number">0.25</span>, dampingRatio: <span class="number">1.0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThroughView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didMoveToSuperview</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.didMoveToSuperview()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> superview = superview <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([pinEdges(view: superview)])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">point</span><span class="params">(inside point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> slideView = subviews.first <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> slideView.hitTest(convert(point, to: slideView), with: event) != <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-27T06:44:05.000Z" title="2019-05-27T06:44:05.000Z">2019-05-27</time><span class="level-item">3 minutes read (About 386 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-indicator-under-tab-bar-buttons-in-iOS/">How to add indicator under tab bar buttons in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/288" target="_blank" rel="noopener">#288</a></strong></p>
<h2 id="selectionIndicatorImage"><a href="#selectionIndicatorImage" class="headerlink" title="selectionIndicatorImage"></a>selectionIndicatorImage</h2><ul>
<li><a href="https://developer.apple.com/documentation/uikit/uitabbar/1623456-selectionindicatorimage" target="_blank" rel="noopener">https://developer.apple.com/documentation/uikit/uitabbar/1623456-selectionindicatorimage</a></li>
<li>Should design image with enough height, transparent background and indicator at the bottom</li>
</ul>
<blockquote>
<p>Use this property to specify a custom selection image. Your image is rendered on top of the tab bar but behind the contents of the tab bar item itself. The default value of this property is nil, which causes the tab bar to apply a default highlight to the selected item</p>
</blockquote>
<h2 id="Custom-UITabBar-or-UITabBarController"><a href="#Custom-UITabBar-or-UITabBarController" class="headerlink" title="Custom UITabBar or UITabBarController"></a>Custom UITabBar or UITabBarController</h2><ul>
<li>Hide existing <code>tabBar</code> <code>tabBar.isHidden = true</code></li>
<li>Position custom buttons</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomTabBarController</span>: <span class="title">UITabBarController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> bar = <span class="type">UIView</span>()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> buttons = [<span class="type">UIButton</span>]()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> viewControllers: [<span class="type">UIViewController</span>]? &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">        	populate(viewControllers: viewControllers)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        tabBar.isHidden = <span class="literal">true</span></span><br><span class="line">        bar.backgroundColor = <span class="type">R</span>.color.background</span><br><span class="line">        view.addSubview(bar)</span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            bar.leftAnchor.constraint(equalTo: view.leftAnchor),</span><br><span class="line">            bar.rightAnchor.constraint(equalTo: view.rightAnchor),</span><br><span class="line">            bar.bottomAnchor.constraint(equalTo: view.bottomAnchor),</span><br><span class="line">			bar.topAnchor.constraint(equalTo: tabBar.topAnchor)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">populate</span><span class="params">(viewControllers: [UIViewController])</span></span> &#123;</span><br><span class="line">        buttons.forEach &#123;</span><br><span class="line">            $<span class="number">0</span>.removeFromSuperview()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        buttons = viewControllers.<span class="built_in">map</span>(&#123;</span><br><span class="line">            <span class="keyword">let</span> button = <span class="type">UIButton</span>()</span><br><span class="line">            button.setImage($<span class="number">0</span>.tabBarItem.image, <span class="keyword">for</span>: .normal)</span><br><span class="line">            bar.addSubview(button)</span><br><span class="line">            <span class="keyword">return</span> button</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        view.setNeedsLayout()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLayoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLayoutSubviews()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> padding: <span class="type">CGFloat</span> = <span class="number">20</span></span><br><span class="line">        <span class="keyword">let</span> buttonSize = <span class="type">CGSize</span>(width: <span class="number">30</span>, height: <span class="number">44</span>)</span><br><span class="line">        <span class="keyword">let</span> width = view.bounds.width - padding * <span class="number">20</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (index, button) <span class="keyword">in</span> buttons.enumerated() &#123;</span><br><span class="line">            button.center = <span class="type">CGPoint</span>(x: bar.center.x, y: bar.frame.height/<span class="number">2</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Handle-UITabBarControllerDelegate"><a href="#Handle-UITabBarControllerDelegate" class="headerlink" title="Handle UITabBarControllerDelegate"></a>Handle UITabBarControllerDelegate</h2><ul>
<li>Override <code>func tabBar(_ tabBar: UITabBar, didSelect item: UITabBarItem)</code></li>
<li><code>tabBar.subviews</code> contains 1 private <code>UITabBarBackground</code> and many private <code>UITabBarButton</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomTabBarController</span>: <span class="title">UITabBarController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> indicator: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">R</span>.color.primary</span><br><span class="line">        view.frame.size = <span class="type">CGSize</span>(width: <span class="number">32</span>, height: <span class="number">2</span>)</span><br><span class="line">        view.layer.cornerRadius = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">        tabBar.addSubview(indicator)</span><br><span class="line">        <span class="keyword">self</span>.delegate = <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">animate</span><span class="params">(index: Int)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> buttons = tabBar.subviews</span><br><span class="line">            .<span class="built_in">filter</span>(&#123; <span class="type">String</span>(describing: $<span class="number">0</span>).<span class="built_in">contains</span>(<span class="string">"Button"</span>) &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> index &lt; buttons.<span class="built_in">count</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> selectedButton = buttons[index]</span><br><span class="line">        <span class="type">UIView</span>.animate(</span><br><span class="line">            withDuration: <span class="number">0.25</span>,</span><br><span class="line">            delay: <span class="number">0</span>,</span><br><span class="line">            options: .curveEaseInOut,</span><br><span class="line">            animations: &#123;</span><br><span class="line">                <span class="keyword">let</span> point = <span class="type">CGPoint</span>(</span><br><span class="line">                    x: selectedButton.center.x,</span><br><span class="line">                    y: selectedButton.frame.maxY - <span class="number">1</span></span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line">                <span class="keyword">self</span>.indicator.center = point</span><br><span class="line">            &#125;,</span><br><span class="line">            completion: <span class="literal">nil</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLayoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLayoutSubviews()</span><br><span class="line"></span><br><span class="line">        animate(index: selectedIndex)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CustomTabBarController</span>: <span class="title">UITabBarControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tabBar</span><span class="params">(<span class="number">_</span> tabBar: UITabBar, didSelect item: UITabBarItem)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> items = tabBar.items,</span><br><span class="line">            <span class="keyword">let</span> index = items.firstIndex(of: item)</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        animate(index: index)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In iOS 13, we need to use <code>viewDidAppear</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidAppear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line"></span><br><span class="line">    moveIndicator(index: selectedIndex, animated: <span class="literal">false</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:26:31.000Z" title="2019-05-23T16:26:31.000Z">2019-05-23</time><span class="level-item">5 minutes read (About 686 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-wrong-status-bar-orientation-in-iOS/">How to fix wrong status bar orientation in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/280" target="_blank" rel="noopener">#280</a></strong></p>
<p>Original post <a href="https://medium.com/fantageek/how-to-fix-wrong-status-bar-orientation-in-ios-f044f840b9ed" target="_blank" rel="noopener">https://medium.com/fantageek/how-to-fix-wrong-status-bar-orientation-in-ios-f044f840b9ed</a></p>
<hr>
<p>When I first started iOS, it was iOS 8 at that time, I had a bug that took my nearly a day to figure out. The issue was that the status bar always orients to device orientation despite I already locked my main ViewController to portrait. This was why I started <a href="https://github.com/onmyway133/notes" target="_blank" rel="noopener">notes</a> project on GitHub detailing what issues I ‘ve been facing.<br><a href="https://github.com/onmyway133/notes/issues/2" target="_blank" rel="noopener"><strong>ViewController is locked to portrait but the status bar rotates when device rotates · Issue #2 ·…</strong><br><em>PROBLEM The rootViewController is locked to portrait. When I rotates, the view controller is portrait, but the status…</em>github.com</a></p>
<p>Now it is iOS 12, and to my surprise people still have this issues. Today I will revise this issue in iOS 12 project and use Swift.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*kcHatZeSPOe939JafbdixA.png" alt></p>
<h2 id="Supported-interface-orientations"><a href="#Supported-interface-orientations" class="headerlink" title="Supported interface orientations"></a>Supported interface orientations</h2><p>Most apps only support portrait mode, with 1 or 2 screens being in landscape for image viewing or video player. So we usually declare Portrait, Landscape Left and Landscape Right.</p>
<p><img src="https://cdn-images-1.medium.com/max/3008/1*mfb71QV7FBufjo3fVm8cuw.png" alt></p>
<p>Since iOS 7, apps have simple design with focus on content. UIViewController was given bigger role in appearance specification.</p>
<p>Supposed that we have a MainViewController as the rootViewController and we want this to be locked in portrait mode.</p>
<pre><code>[@UIApplicationMain](http://twitter.com/UIApplicationMain)
class AppDelegate: UIResponder, UIApplicationDelegate {
 var window: UIWindow?
 func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {
   window = UIWindow(frame: UIScreen.main.bounds)
   window?.rootViewController = MainViewController()
   window?.makeKeyAndVisible()
   return true
 }
}</code></pre><p>There is a property called <a href="https://developer.apple.com/documentation/bundleresources/information_property_list/uiviewcontrollerbasedstatusbarappearance" target="_blank" rel="noopener">UIViewControllerBasedStatusBarAppearance</a> that we can specify in Info.plist to assert that we want UIViewController to dynamically control status bar appearance.</p>
<blockquote>
<p>A Boolean value indicating whether the status bar appearance is based on the style preferred for the current view controller.</p>
</blockquote>
<p>Start by declaring in Info.plist</p>
<pre><code>&lt;key&gt;UIViewControllerBasedStatusBarAppearance&lt;/key&gt;
&lt;true/&gt;</code></pre><p>And in MainViewController , lock status bar to portrait</p>
<pre><code>import UIKit

class MainViewController: UIViewController {

let label = UILabel()

override func viewDidLoad() {
    super.viewDidLoad()

view.backgroundColor = .yellow

label.textColor = .red
    label.text = &quot;MainViewController&quot;
    label.font = UIFont.preferredFont(forTextStyle: .headline)
    label.sizeToFit()

view.addSubview(label)
  }

override func viewDidLayoutSubviews() {
    super.viewDidLayoutSubviews()

label.center = CGPoint(x: view.bounds.size.width/2, y: view.bounds.size.height/2)
  }

override var supportedInterfaceOrientations: UIInterfaceOrientationMask {
    return .portrait
  }
}</code></pre><p>The idea is that no matter orientation the device is, the status bar always stays in portrait mode, the same as our MainViewController .</p>
<p>But to my surprise, this is not the case !!! As you can see in the screenshot below, the MainViewController is in portrait, but the status bar is not.</p>
<p><img src="https://cdn-images-1.medium.com/max/3588/1*UFfkghJFiLN1nxnxX7Qr6g.png" alt></p>
<h2 id="Stop-mixing-code-and-Storyboard"><a href="#Stop-mixing-code-and-Storyboard" class="headerlink" title="Stop mixing code and Storyboard"></a>Stop mixing code and Storyboard</h2><p>It took me a while to figure out that while I declare UIWindow in code, I also have MainStoryboard that configures UIWindow</p>
<pre><code>&lt;key&gt;UIMainStoryboardFile&lt;/key&gt;
&lt;string&gt;Main&lt;/string&gt;</code></pre><p>And this UIWindow from Storyboard has a default root ViewController</p>
<pre><code>import UIKit

class ViewController: UIViewController {

override func viewDidLoad() {
    super.viewDidLoad()

  }
}</code></pre><h2 id="The-meaning-of-UIViewControllerBasedStatusBarAppearance"><a href="#The-meaning-of-UIViewControllerBasedStatusBarAppearance" class="headerlink" title="The meaning of UIViewControllerBasedStatusBarAppearance"></a>The meaning of UIViewControllerBasedStatusBarAppearance</h2><p>In iOS, the status bar is hidden in landscape by default.</p>
<ul>
<li><p>Setting UIViewControllerBasedStatusBarAppearance to false means that we want this default behaviour</p>
</li>
<li><p>Setting UIViewControllerBasedStatusBarAppearance to true means we want to have control over the status bar appearance. So to hide the status bar, we must override prefersStatusBarHidden in the rootViewController, the presented view controller or the full screen view controller</p>
</li>
</ul>
<p>As you can see, the problem is that the ViewController from UIWindow in Storyboard clashes with our MainViewController in code, hence a lot of confusion.</p>
<p>The solution is simple, remove Main.storyboard and don’t use that in project</p>
<pre><code>&lt;key&gt;UIMainStoryboardFile&lt;/key&gt;
&lt;string&gt;Main&lt;/string&gt;</code></pre><p>Now we get our desired behaviour, status bar and view controllers are always locked to portrait regardless of the device orientation.</p>
<p><img src="https://cdn-images-1.medium.com/max/3588/1*cLVlNzcn3ryJNd5xjxXUoQ.png" alt></p>
<p>If you use code like me to setup UI, remember to clean up the generated storyboard and ViewController that comes default when project was generated by Xcode.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:25:01.000Z" title="2019-05-23T16:25:01.000Z">2019-05-23</time><span class="level-item">10 minutes read (About 1512 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Best-places-to-learn-iOS-development/">Best places to learn iOS development</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/278" target="_blank" rel="noopener">#278</a></strong></p>
<p>Original post <a href="https://medium.com/fantageek/best-places-to-learn-ios-development-85ebebe890cf" target="_blank" rel="noopener">https://medium.com/fantageek/best-places-to-learn-ios-development-85ebebe890cf</a></p>
<hr>
<p>It’s good to be software engineers, when you get paid to do what you like best. The good thing about software development is it ‘s changing fast, and challenging. This is also the not good thing, when you need to continuously learn and adapt to keep up with the trends.</p>
<p>This is for those who have been iOS developers for some time. If you have a lot of free time to spend, then congratulations. If you do not, you know the luxury of free time, then it’s time to learn wisely, by selecting only the good resources. But where should I learn from?</p>
<p>Welcome to the technology age, where there are tons to things to keep track of, iOS releases, SDK, 3rd frameworks, build tools, patterns, … Here are my list that I tend to open very often. It is opinionated and date aware. If it was several years ago, then <a href="http://nshipster.com/" target="_blank" rel="noopener">http://nshipster.com/</a>, <a href="https://www.objc.io/" target="_blank" rel="noopener">https://www.objc.io/</a> should be in the top of the list.</p>
<p>I like to keep track of stuff, via my lists <a href="https://github.com/onmyway133/fantastic-ios" target="_blank" rel="noopener">https://github.com/onmyway133/fantastic-ios</a>, <a href="https://github.com/onmyway133/fantastic-ios-architecture" target="_blank" rel="noopener">https://github.com/onmyway133/fantastic-ios-architecture</a>, <a href="https://github.com/onmyway133/fantastic-ios-animation" target="_blank" rel="noopener">https://github.com/onmyway133/fantastic-ios-animation</a>. Also you should use services like <a href="https://feedly.com/" target="_blank" rel="noopener">https://feedly.com/</a> to organise your subscription feed.</p>
<p>The point of this is for continuous learning, so it should be succinct. There is no particular order.</p>
<h2 id="1-Raywenderlich"><a href="#1-Raywenderlich" class="headerlink" title="1. Raywenderlich"></a>1. Raywenderlich</h2><p><a href="https://www.raywenderlich.com/" target="_blank" rel="noopener"><strong>Ray Wenderlich | High quality programming tutorials: iOS, Android, Swift, Kotlin, Unity, and more</strong><br><em>Password Autofill allows our apps to automatically populate the username and password and believe it or not, it only…</em>www.raywenderlich.com</a></p>
<p>This is probably one of the most visited site for learning iOS development. All the tutorials are well designed and easy to follow. If you can, you can subscribe to videos <a href="https://videos.raywenderlich.com/courses" target="_blank" rel="noopener">https://videos.raywenderlich.com/courses</a>. I myself find watching video much more relaxing. And the team is reviving its Podcast <a href="https://www.raywenderlich.com/rwpodcast" target="_blank" rel="noopener">https://www.raywenderlich.com/rwpodcast</a> which I really recommend</p>
<h2 id="2-Swift-Talk"><a href="#2-Swift-Talk" class="headerlink" title="2. Swift Talk"></a>2. Swift Talk</h2><p><a href="https://talk.objc.io/" target="_blank" rel="noopener"><strong>Swift Talk · objc.io</strong><br><em>We use the child view controller we created last time to factor out more code from the large view controller.</em>talk.objc.io</a></p>
<p>The people behind objc.io started their swift talks last year. I’m a fan of clean code, so these talks are really helpful when they show how to organise and write code. Also, they have awesome guests from some companies too.</p>
<h2 id="3-NSScreencast"><a href="#3-NSScreencast" class="headerlink" title="3. NSScreencast"></a>3. NSScreencast</h2><p>If you have less time, then this is great option. These covers many aspects of the iOS SDKs, and the videos are weekly.<br><a href="http://nsscreencast.com/episodes" target="_blank" rel="noopener"><strong>NSScreencast: Bite-sized Screencasts for iOS Development</strong><br><em>Quality videos on iOS development, released each week.</em>nsscreencast.com</a></p>
<h2 id="4-Swift-By-Sundell"><a href="#4-Swift-By-Sundell" class="headerlink" title="4. Swift By Sundell"></a>4. Swift By Sundell</h2><p>I actually learn a lot from reading John ‘s blog. He shows various tips on iOS programming and the Swift language. Also his podcast is a must subscribe <a href="https://www.swiftbysundell.com/podcast/" target="_blank" rel="noopener">https://www.swiftbysundell.com/podcast/</a>. I’ve listened to many podcasts, but I like this best.<br><a href="https://www.swiftbysundell.com" target="_blank" rel="noopener"><strong>All posts</strong><br><em>Like many abstractions and patterns in programming, the goal of the builder pattern is to reduce the need to keep…</em>www.swiftbysundell.com</a></p>
<h2 id="5-AppCoda"><a href="#5-AppCoda" class="headerlink" title="5. AppCoda"></a>5. AppCoda</h2><p>I like this because the content is short, and focused. I can easily follow and grasp the gist immediately. And it has large collection of various contents.<br><a href="https://www.appcoda.com/" target="_blank" rel="noopener"><strong>AppCoda - Learn Swift &amp; iOS Programming by Doing</strong><br><em>AppCoda is an educational startup that focuses on teaching people how to learn Swift &amp; iOS programming blog. Our…</em>www.appcoda.com</a></p>
<h2 id="6-Use-Your-Loaf"><a href="#6-Use-Your-Loaf" class="headerlink" title="6. Use Your Loaf"></a>6. Use Your Loaf</h2><p>This has updated posts for every new SDK features. Also, the content is short and to the points. It’s like wikipedia for iOS development.<br><a href="https://useyourloaf.com/" target="_blank" rel="noopener"><strong>Use Your Loaf</strong><br><em>If you are upgrading to Xcode 10 and migrating to Swift 4.2 you are likely to see a number of errors because Swift 4.2…</em>useyourloaf.com</a></p>
<h2 id="7-iOS-Goodies"><a href="#7-iOS-Goodies" class="headerlink" title="7. iOS Goodies"></a>7. iOS Goodies</h2><p>The number of newsletters now is like stars on the sky. Among them I like iOS Goodies the best. It is driven by community <a href="https://github.com/iOS-Goodies/iOS-Goodies" target="_blank" rel="noopener">https://github.com/iOS-Goodies/iOS-Goodies</a> and contains lots of new awesome stuff each week.<br><a href="http://ios-goodies.com/" target="_blank" rel="noopener"><strong>iOS Goodies</strong><br><em>weekly iOS newsletter curated by Marius Constantinescu logo by José Torre founded by Rui Peres and Tiago Almeida</em>ios-goodies.com</a></p>
<h2 id="8-Erica-Sadun"><a href="#8-Erica-Sadun" class="headerlink" title="8. Erica Sadun"></a>8. Erica Sadun</h2><p>This is a bit advanced where it discusses Swift languages. But it’s good to read if you want to get yourself to know more about hidden language features.<br><a href="http://ericasadun.com/" target="_blank" rel="noopener"><strong>Erica Sadun</strong><br><em>Recently, some of my simulators launched and loaded just fine. Others simply went black. It didn’t seem to matter which…</em>ericasadun.com</a></p>
<h2 id="9-Swifting"><a href="#9-Swifting" class="headerlink" title="9. Swifting"></a>9. Swifting</h2><p>I just discovered this recently, but I kinda like the blog. The number of posts are growing, and those are good reads about iOS SDKs.<br><a href="https://swifting.io/" target="_blank" rel="noopener"><strong>swifting.io</strong><br><em>Our dear friend and a founder of swifting.io - Michał, had an accident two months ago. He had a bad luck and got hit by…</em>swifting.io</a></p>
<h2 id="10-Khanlou"><a href="#10-Khanlou" class="headerlink" title="10. Khanlou"></a>10. Khanlou</h2><p>I learn many good patterns and clean code from reading this blog. He suggests many ideas on refactoring code. Really recommend.<br><a href="http://khanlou.com/" target="_blank" rel="noopener"><strong>Khanlou</strong><br><em>To convert this into an infinite collection, we need to think about a few things. First, how will we represent an index…</em>khanlou.com</a></p>
<h2 id="11-Ole-Begemann"><a href="#11-Ole-Begemann" class="headerlink" title="11. Ole Begemann"></a>11. Ole Begemann</h2><p>This has been in my favorite list for a long time. Although this is a bit advanced, it is good to dive deep into Swift.<br><a href="https://oleb.net/blog/" target="_blank" rel="noopener"><strong>Articles - Ole Begemann</strong><br><em>Edit description</em>oleb.net</a></p>
<h2 id="12-Krzysztof-Zablocki"><a href="#12-Krzysztof-Zablocki" class="headerlink" title="12. Krzysztof Zabłocki"></a>12. Krzysztof Zabłocki</h2><p>This is my favorite, too. This shows many practical advices for iOS development. He also talks about build tool that I really like.<br><a href="http://merowing.info/post/" target="_blank" rel="noopener"><strong>Posts</strong><br><em>Have you ever written tests? Usually, they use equality asserts, e.g. XCTAssertEqual, what happens if the object isn’t…</em>merowing.info</a></p>
<h2 id="13-Realm-News"><a href="#13-Realm-News" class="headerlink" title="13. Realm News"></a>13. Realm News</h2><p>Realm collects a huge collection of iOS videos from conferences and meet ups, and it has transcripts too. It’s more than enough to fill your free time.<br><a href="https://academy.realm.io/" target="_blank" rel="noopener"><strong>Realm Academy - Expert content from the mobile experts</strong><br><em>Developer videos, articles and tutorials from top conferences, top authors, and community leaders.</em>academy.realm.io</a></p>
<h2 id="14-Big-Nerd-Ranch"><a href="#14-Big-Nerd-Ranch" class="headerlink" title="14. Big Nerd Ranch"></a>14. Big Nerd Ranch</h2><p>This has posts in both iOS and Android. But I really like the contents, very good.<br><a href="https://www.bignerdranch.com/blog/" target="_blank" rel="noopener"><strong>App Development and Design Blog | Big Nerd Ranch</strong><br><em>Our blog offers app development and design tutorials, tips and tricks for software engineering and insights for team…</em>www.bignerdranch.com</a></p>
<h2 id="15-Cocoa-with-Love"><a href="#15-Cocoa-with-Love" class="headerlink" title="15. Cocoa with Love"></a>15. Cocoa with Love</h2><p>This is very advanced, and suitable for hardcore fans. I feel small when reading the posts.<br><a href="http://www.cocoawithlove.com/" target="_blank" rel="noopener"><strong>Cocoa with Love</strong><br><em>The upcoming CwlViews library offers a syntax for constructing views that has a profound effect on the Cocoa…</em>www.cocoawithlove.com</a></p>
<h2 id="16-Atomic-Spin"><a href="#16-Atomic-Spin" class="headerlink" title="16. Atomic Spin"></a>16. Atomic Spin</h2><p>I really enjoy reading blog posts from Atomic Object. There are posts for many platforms, and about life, so you need to filter for iOS development.<br><a href="https://spin.atomicobject.com/" target="_blank" rel="noopener"><strong>Atomic Spin</strong><br><em>More and more studies have shown that the most effective teams are the ones whose members trust each other and feel…</em>spin.atomicobject.com</a></p>
<h2 id="17-Raizlabs"><a href="#17-Raizlabs" class="headerlink" title="17. Raizlabs"></a>17. Raizlabs</h2><p>This has very good articles about iOS. Highly recommend.<br><a href="https://www.raizlabs.com/dev/" target="_blank" rel="noopener"><strong>React Native Animations: Part 2 - RaizException - Raizlabs Developer Blog</strong><br><em>When we build apps for our clients, beautiful designs and interactions are important. But equally important is…</em>www.raizlabs.com</a></p>
<h2 id="18-Invasive-Code"><a href="#18-Invasive-Code" class="headerlink" title="18. Invasive Code"></a>18. Invasive Code</h2><p>This has topics for many iOS features. All the contents are good and succinct.<br><a href="https://www.invasivecode.com/weblog/" target="_blank" rel="noopener"><strong>iOS Development - <em>Computer Vision iOS Apps</em></strong><br>Computer Vision iOS Appswww.invasivecode.com</a></p>
<h2 id="19-Think-and-Build"><a href="#19-Think-and-Build" class="headerlink" title="19. Think and Build"></a>19. Think and Build</h2><p>I like posts about animation and replicating app features. This has all of them.</p>
<p><a href="http://www.thinkandbuild.it/" target="_blank" rel="noopener">http://www.thinkandbuild.it/</a></p>
<h2 id="20-Little-Bites-of-Cocoa"><a href="#20-Little-Bites-of-Cocoa" class="headerlink" title="20. Little Bites of Cocoa"></a>20. Little Bites of Cocoa</h2><p>This has a series of small tips, on how to use iOS SDKs and other 3rd frameworks. Good to know.<br><a href="https://littlebitesofcocoa.com/" target="_blank" rel="noopener"><strong>Little Bites of Cocoa - Tips and techniques for iOS and Mac development - Weekday mornings at 9:42…</strong><br><em>Tips and techniques for iOS and Mac development - Weekday mornings at 9:42 AM. The goal of each of these ‘bites’ is to…</em>littlebitesofcocoa.com</a></p>
<h2 id="21-Samwize"><a href="#21-Samwize" class="headerlink" title="21. Samwize ()"></a>21. Samwize ()</h2><p>All the posts are good, short and to the points. Really like this.<br><a href="http://samwize.com/" target="_blank" rel="noopener"><strong>@samwize</strong><br><em>¯_(ツ)_/¯</em>samwize.com</a></p>
<p>I think that’s enough. Feel free to share and suggest other awesome blogs that I might miss. Also, it’s good to contribute back to community by writing your blog posts. You will learn a lot by sharing.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T08:08:34.000Z" title="2019-05-21T08:08:34.000Z">2019-05-21</time><span class="level-item">a few seconds read (About 32 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-move-tab-bar-icons-down-in-iOS/">How to move tab bar icons down in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/250" target="_blank" rel="noopener">#250</a></strong></p>
<p><code>UITabBarItem</code> subclasses from <code>UIBarItem</code> which has <code>imageInsets</code>. We need both <code>top</code> and <code>bottom</code> to avoid shrinking</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewController1.tabBarItem.imageInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">10</span>, <span class="keyword">left</span>: <span class="number">0</span>, bottom: -<span class="number">10</span>, <span class="keyword">right</span>: <span class="number">0</span>)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T06:48:44.000Z" title="2019-05-21T06:48:44.000Z">2019-05-21</time><span class="level-item">a minute read (About 142 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-test-LaunchScreen-in-iOS/">How to test LaunchScreen in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/249" target="_blank" rel="noopener">#249</a></strong></p>
<p>Making splash screen with <code>LaunchScreen.storyboard</code> is now the default way to do in iOS. Testing it with UITests is a bit tricky as this screen is showed the system, and if we test that, we are just testing the system.</p>
<p>What we should test is the content we put in the LaunchScreen storyboard. Is it showing correctly on different screen sizes? Is it missing any texts or images?</p>
<p>One way to test that is via Unit Test. LaunchScreen storyboard always come with 1 <code>UIViewController</code> configured as an initial view controller</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LauncScreenTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testLaunchScreen</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> launchScreen = <span class="type">UIStoryboard</span>(name: <span class="string">"LaunchScreen"</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">let</span> viewController = launchScreen.instantiateInitialViewController()!</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> label = viewController.view.subviews.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UILabel</span> &#125;).first!</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(label.text, <span class="string">"Welcome to my app"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> imageView = viewController.view.subviews.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UIImageView</span> &#125;).first!</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(imageView.image)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-20T08:13:11.000Z" title="2019-05-20T08:13:11.000Z">2019-05-20</time><span class="level-item">a few seconds read (About 69 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-enable-black-mode-in-Google-Maps-in-iOS/">How to enable black mode in Google Maps in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/246" target="_blank" rel="noopener">#246</a></strong></p>
<p>Use GMSMapStyle <a href="https://developers.google.com/maps/documentation/android-sdk/styling" target="_blank" rel="noopener">https://developers.google.com/maps/documentation/android-sdk/styling</a><br>Export styling json from <a href="https://mapstyle.withgoogle.com/" target="_blank" rel="noopener">https://mapstyle.withgoogle.com/</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mapStyleUrl = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"mapStyle"</span>, withExtension: <span class="string">"json"</span>)!</span><br><span class="line">mapView.mapStyle = <span class="keyword">try</span>? <span class="type">GMSMapStyle</span>(contentsOfFileURL: mapStyleUrl)</span><br></pre></td></tr></table></figure>

<p>To change overall color, search for mostly <code>&quot;elementType&quot;: &quot;geometry&quot;</code> and <code>&quot;featureType&quot;: &quot;water&quot;</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"elementType"</span>: <span class="string">"geometry"</span>,</span><br><span class="line">    <span class="attr">"stylers"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"color"</span>: <span class="string">"#424242"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"featureType"</span>: <span class="string">"water"</span>,</span><br><span class="line">    <span class="attr">"elementType"</span>: <span class="string">"geometry"</span>,</span><br><span class="line">    <span class="attr">"stylers"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"color"</span>: <span class="string">"#2E2E2E"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-19T16:33:17.000Z" title="2019-05-19T16:33:17.000Z">2019-05-19</time><span class="level-item">17 minutes read (About 2510 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Favorite-WWDC-2018-sessions/">Favorite WWDC 2018 sessions</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/245" target="_blank" rel="noopener">#245</a></strong></p>
<p>Original post <a href="https://medium.com/fantageek/my-favourite-wwdc-2018-sessions-363d3fc9c9d5" target="_blank" rel="noopener">https://medium.com/fantageek/my-favourite-wwdc-2018-sessions-363d3fc9c9d5</a></p>
<hr>
<h1 id="Favourite-WWDC-2018-sessions"><a href="#Favourite-WWDC-2018-sessions" class="headerlink" title="Favourite WWDC 2018 sessions"></a>Favourite WWDC 2018 sessions</h1><p>This year I failed the lottery ticket to WWDC, and I also missed the keynote live stream because I was <a href="https://twitter.com/onmyway133/status/1003584883116167169" target="_blank" rel="noopener">sailing</a> on the Christian Radich outside Oslo fjord that day. Luckily all the videos are available on <a href="https://developer.apple.com/videos/wwdc2018/" target="_blank" rel="noopener">Apple Developer site</a> very shortly, and we can watch them now on Chrome or the <a href="https://github.com/insidegui/WWDC" target="_blank" rel="noopener">unofficial WWDC</a> app on macOS. I recommend the <a href="https://github.com/insidegui/WWDC" target="_blank" rel="noopener">WWDC</a> macOS app as it allows to mark favourites and filter, also offers the ability to adjust play speed to 1.25 or 1.5 saves me some time watching.</p>
<p>This year WWDC focuses a lot on privacy, stability, and speed, which are all I wish, so many thanks to Apple engineers who made that happen, and the resit to install the so called <a href="https://twitter.com/bagelturf/status/1004444007424905216?s=21" target="_blank" rel="noopener">more stable iOS 12</a> is real. As an iOS engineers, I like to focus more about the necessary things to me, that is about the Swift programming language, new changes in Cocoa Touch, enhancements in Xcode and testing tricks. I also like to explore more <a href="https://medium.com/flawless-app-stories/detecting-avengers-superheroes-in-your-ios-app-with-ibm-watson-and-coreml-fe38e493a4d1" target="_blank" rel="noopener">about</a> <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-turi-create-and-coreml-5ddce0dc8e26" target="_blank" rel="noopener">machine</a> <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-azure-custom-vision-and-coreml-645e93f35eee" target="_blank" rel="noopener">learning</a> so I’m very glad that Apple is investing more into this technology with the introduction of Turi Create and Create ML.</p>
<p>To me, APIs come and get deprecated very often and it’s good to know them, but the most important thing is to invest in your programming, debugging and testing skill which you can apply in many other platforms.</p>
<p>Continued from last year <a href="https://medium.com/@onmyway133/my-favourite-wwdc-2017-sessions-a777fa5aabaf" target="_blank" rel="noopener">favourites</a> list, below are my favourite sessions with personal notes. Things are listed in no particular order. Hope you find it useful.</p>
<h3 id="Platforms-State-of-the-Union"><a href="#Platforms-State-of-the-Union" class="headerlink" title="Platforms State of the Union"></a><a href="https://developer.apple.com/videos/play/wwdc2018/102/" target="_blank" rel="noopener">Platforms State of the Union</a></h3><p>If you don’t have time, you should watch only this session. Platform State of the Union is like keynote for developers as it highlights important changes.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*5zkWPlmZ9oYfY9-O.jpg" alt></p>
<ul>
<li><p>Privacy: Apple confirms on its commitment in privacy and security, also introduces password management feature and auto fill on iOS 12. Generating strong password, integrating with 3rd password management and quickly populating OTP field from SMS message have never been easier. <a href="https://support.apple.com/en-us/HT202491" target="_blank" rel="noopener">GateKeeper</a> gets some improvements as well and begins to require app to be notarised.</p>
</li>
<li><p>iOS 12: huge improvement in performance, Siri gets smarter with Shortcut support, group calling in FaceTime and grouped notification. Also for emoji fan, Memoji was introduced.</p>
</li>
<li><p>macOS 10.14 Mojave: more with Dark Mode. They demo mostly with Xcode in dark mode, which looks so cool. This year WWDC banner give hints about iOS and macOS cross-platform apps, which is partially true with <a href="https://www.imore.com/marzipan" target="_blank" rel="noopener">Marzipan</a>, a way to allow iOS apps to run on the mac.</p>
</li>
<li><p>Xcode 10: with improvements in code editing and source control changes bar indicator. Debugging with memory debug tool, LLDB performance enhancement and particular the new build system completely rewritten in Swift with parallel tasks are exciting news.</p>
</li>
<li><p>Swift 4.2: if you follow swift repo then <a href="https://github.com/ole/whats-new-in-swift-4-2" target="_blank" rel="noopener">Swift 4.2</a> may not be very surprising. There are also announcements for Swift 5 plan.</p>
</li>
<li><p>Machine Learning: is never hotter than this. This year we see huge investments in machine learning with Create ML, Turi Create, Natural Language frameworks, CoreML 2, new detection capabilities in Vision.</p>
</li>
<li><p>ARKit 2, watchOS 5, tvOS 12, AppStore Connect and AppStore Connect APIs are some other important news you don’t want to miss.</p>
</li>
</ul>
<h3 id="What’s-new-in-Swift"><a href="#What’s-new-in-Swift" class="headerlink" title="What’s new in Swift"></a><a href="https://developer.apple.com/videos/play/wwdc2018/401/" target="_blank" rel="noopener">What’s new in Swift</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*JQCScM5dRcK9dX-_.jpg" alt></p>
<p>Together with this session, I recommend you to read <a href="https://www.hackingwithswift.com/articles/77/whats-new-in-swift-4-2" target="_blank" rel="noopener">What’s new in Swift 4.2</a> summary which is very succinct. Besides improvement in complication and runtime, Swift 4.2 offers some new features: iterable enum case, synthesised Equatable and Hashable, handy functions for shuffling, random generating. To me, the need to explicitly handle Implicitly unwrapped optional is also a reasonable change.</p>
<h3 id="What’s-New-in-Cocoa-Touch"><a href="#What’s-New-in-Cocoa-Touch" class="headerlink" title="What’s New in Cocoa Touch"></a><a href="https://developer.apple.com/videos/play/wwdc2018/202/" target="_blank" rel="noopener">What’s New in Cocoa Touch</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*n1X4HddAZ-4ZHpaf.jpg" alt></p>
<p>This is a brief introduction to all changes coming to iOS 12, together with tips on how to be a good iOS citizen. Learn what can affect scrolling experience and prefetching technique, memory consumption and automatic backing stores, how to get the best from UIImage and UIImageView . <a href="https://developer.apple.com/videos/play/wwdc2018/220/" target="_blank" rel="noopener">AutoLayout</a> engine got a lot of performance improvement so it won’t bother you any more. To me the most satisfying is to get all the UIKit notifications and classes reorganised under nested types, which makes code reasoning very easy.</p>
<h3 id="Getting-the-Most-out-of-Playgrounds-in-Xcode"><a href="#Getting-the-Most-out-of-Playgrounds-in-Xcode" class="headerlink" title="Getting the Most out of Playgrounds in Xcode"></a><a href="https://developer.apple.com/videos/play/wwdc2018/402/" target="_blank" rel="noopener">Getting the Most out of Playgrounds in Xcode</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*cl4xdnHojOq-PNBc.jpg" alt></p>
<p>I’ve <a href="https://medium.com/flawless-app-stories/playground-driven-development-in-swift-cf167489fe7b" target="_blank" rel="noopener">written about Playground</a> before and I’m very glad that Apple also invests a lot in it. The way people can interact and train model [Create ML](<a href="http://Introducing" target="_blank" rel="noopener">http://Introducing</a> Create ML) in Playground is mesmerising. People may question how Playground works so well in session’s demos, but we can’t resist the new changes coming to Playground like Step by Step execution, markup rendering improvements and also how easy it is to consume custom frameworks. We can also now publish our own <a href="https://developer.apple.com/videos/play/wwdc2018/413/" target="_blank" rel="noopener">Playground through subscription</a>.</p>
<h3 id="What’s-New-in-Core-ML"><a href="#What’s-New-in-Core-ML" class="headerlink" title="What’s New in Core ML"></a><a href="https://developer.apple.com/videos/play/wwdc2018/708/" target="_blank" rel="noopener">What’s New in Core ML</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*1-xUL2gFr-Ys8WQT.jpg" alt></p>
<p>Apple starts the machine learning trend last year with the introduction of Core ML. We might be excited and frustrated at the same time as Core ML is powerful but there’s no way we can customise it. Now the <a href="https://developer.apple.com/videos/play/wwdc2018/708/" target="_blank" rel="noopener">2</a> <a href="https://developer.apple.com/videos/play/wwdc2018/709/" target="_blank" rel="noopener">parts</a> tell us how to implement custom layer and model, techniques to reduce model size like quantisation and flexible model. This makes the foundation for improvement in <a href="https://developer.apple.com/videos/play/wwdc2018/717/" target="_blank" rel="noopener">Vision</a> in object tracking and the debut of <a href="https://developer.apple.com/videos/play/wwdc2018/713/" target="_blank" rel="noopener">Natural Language</a> framework. Machine learning has never been easier.</p>
<h3 id="What’s-New-in-Testing"><a href="#What’s-New-in-Testing" class="headerlink" title="What’s New in Testing"></a><a href="https://developer.apple.com/videos/play/wwdc2018/403/" target="_blank" rel="noopener">What’s New in Testing</a></h3><p>I can’t miss any testing sessions as it is part of every day’s work. How can your program avoids regression bugs and ready for refactoring without any tests?</p>
<p>This session shows improvement in coverage and the introduction of xccov tool to help us build automation on top of coverage report. Parallel distributed testing in Xcode 10 can save us some time to have coffee. Another wonderful news is that tests have multiple order execution mode to avoid bugs due to implicit dependencies.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*7Gw1utFOl4C3PKqV.jpg" alt></p>
<h3 id="Testing-Tips-amp-Tricks-🌟"><a href="#Testing-Tips-amp-Tricks-🌟" class="headerlink" title="Testing Tips &amp; Tricks 🌟"></a><a href="https://developer.apple.com/videos/play/wwdc2018/417/" target="_blank" rel="noopener">Testing Tips &amp; Tricks</a> 🌟</h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*OHjJdWEhHj7Fc4rq.jpg" alt></p>
<p>This is my most favourite. The session starts with a pyramid of tests with unit integration and end-to-end test analogy explanation, then to some very cool tips and tricks.</p>
<ul>
<li>Testing network request: I like the separation of APIRequest and APIRequestLoader with URLSession , dependency injection with default parameter and the customisation of URLProtocol in URLSessionConfiguration</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2066/1*xJzqnw37CZKFhhMwym2HHQ.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2684/1*VUxjS-DpOfee7d5zTA1vrg.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2326/1*rgRwQla_YK3ADRwxZ4xpkg.png" alt></p>
<ul>
<li>Testing notification: Notification is system wide and I try to avoid it as much as possible. This shows how to inject dependency with default parameter and use of own NotificationCenter instead of NotificationCenter.default to ease testing</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2602/1*mXiNRzit8VcFM4_GNM3ebg.png" alt></p>
<ul>
<li><p>Testing location: build abstraction with LocationProvider and LocationFetcher . How to use custom protocol and protocol for delegate to mock during test</p>
</li>
<li><p>Testing timer: how to use and mock RunLoop behaviour with Timer</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*obf6GcsXcHAbGFy-lUENNw.png" alt></p>
<h3 id="Advanced-Debugging-with-Xcode-and-LLDB"><a href="#Advanced-Debugging-with-Xcode-and-LLDB" class="headerlink" title="Advanced Debugging with Xcode and LLDB"></a><a href="https://developer.apple.com/videos/play/wwdc2018/412/" target="_blank" rel="noopener">Advanced Debugging with Xcode and LLDB</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*6c81NEXU7tKYPEbQ.jpg" alt></p>
<p>LLDB has been improved to enable to debugging reliability experience, issues with AST context corruption, Swift type resolution are now things in the past. We can review how to use some common LLDB commands with handy arguments, and how to use Xcode breakpoint to its best.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ZtVpOaDnmt4VsDTHRiB6Ww.png" alt></p>
<h3 id="A-Tour-of-UICollectionView-🌟"><a href="#A-Tour-of-UICollectionView-🌟" class="headerlink" title="A Tour of UICollectionView 🌟"></a><a href="https://developer.apple.com/videos/play/wwdc2018/225/" target="_blank" rel="noopener">A Tour of UICollectionView</a> 🌟</h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*skJgSTHlTohIj_DT.jpg" alt></p>
<p>I begin to use UICollectionView more than UITableView , and it also has same code as NSCollectionView,which is more comfortable solution than the horrible NSTableView .</p>
<ul>
<li>Item size in UICollectionViewLayout : I often rely on UICollectionViewDelegateFlowLayout to specify item size but after watching this session, I feel like moving size related code to Layout object feels more like a good way to go</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2718/1*FS6OykJZ_zIPTzaWPPYk6g.png" alt></p>
<ul>
<li><p>Mosaic layout: This is not new, but good to watch again. You learn how to implement custom layout using cached layout attributes</p>
</li>
<li><p>Data Source update: I didn’t expect Apple mentions this, but it is a good lesson on how UICollectionView handles batch update. I ‘ve written about this before in my <a href="https://medium.com/flawless-app-stories/a-better-way-to-update-uicollectionview-data-in-swift-with-diff-framework-924db158db86" target="_blank" rel="noopener">A better way to update UICollectionView data in Swift with diff framework</a> and that post gets a lot of attractions. In this session we need to remember that *<em>ordering matters in data source update, but not in collection view update *</em>❗️❗️❗️</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*VMqhNo3bXxI-79e-r9iNvA.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*KiWef6geZ3z0-jRaWNuqRg.png" alt></p>
<h3 id="Swift-Generics"><a href="#Swift-Generics" class="headerlink" title="Swift Generics"></a><a href="https://developer.apple.com/videos/play/wwdc2018/406/" target="_blank" rel="noopener">Swift Generics</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*KWRTeiOV8FBNK3Mu.jpg" alt></p>
<p>Generic was a core feature of Swift since the beginning, we all know that it helps us to implement generic code that can work with many types in a type safe manner. This session reminds that I ‘ve never learned enough, especially the reasonable design behind it.</p>
<p>The sessions showcases Collection protocol and its protocol inheritances: MutableCollection , BidirectionalCollection , RandomAccessCollection and how they can be combined to provide generic functionalities for conformers. The associatedtype requirement in each protocol, especially Index and Element, is very minimal and has enough constraints for the protocol to implement lots of necessary functionalities in its protocol extension, which is eye opening for me. I very like to read open source, so looking at the <a href="https://github.com/apple/swift/blob/master/stdlib/public/core/BidirectionalCollection.swift" target="_blank" rel="noopener">source code</a> for such protocols helps me understand more.</p>
<p><img src="https://cdn-images-1.medium.com/max/2102/1*QIepiAZqK4QmX2IbLFKz0w.png" alt></p>
<p>The part about <a href="https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle" target="_blank" rel="noopener">Fisher Yates shuffle algorithm</a> details how we can come up with necessary protocol while still make them generic</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*actyrEg4E4qSFYu--K6uzA.png" alt></p>
<p>Pay attention to when they mention count and map , you can learn more how each concrete type can hook into the customisation point in protocol extension</p>
<p><img src="https://cdn-images-1.medium.com/max/2704/1*IG15tCSq49SqgvgJrXHDWw.png" alt></p>
<p>Finally learn the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle" target="_blank" rel="noopener">Liskov substitution principle</a> with protocol in class inheritance. You should also <a href="https://developer.apple.com/videos/play/wwdc2018/229/" target="_blank" rel="noopener">Using Collections Effectively</a> for how to utilise handy functions in Collection.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*oIKcsw6-H37i2A1t.jpg" alt></p>
<h3 id="Data-You-Can-Trust"><a href="#Data-You-Can-Trust" class="headerlink" title="Data You Can Trust"></a><a href="https://developer.apple.com/videos/play/wwdc2018/222/" target="_blank" rel="noopener">Data You Can Trust</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*Iv80a99O1g6k-oO4.jpg" alt></p>
<p>Although Codable has a lot to offers in term of data integrity, this is good to know about to make sure the data you receive is actually the right data in correct format and structure. <a href="https://twitter.com/mgratzer/status/1003882651038683136" target="_blank" rel="noopener">CommonCrypto</a> is also part of new iOS SDK so you don’t need my <a href="https://github.com/onmyway133/Arcane" target="_blank" rel="noopener">Arcane</a> library to handle encryption and hashing in your apps.</p>
<h3 id="Embracing-Algorithms"><a href="#Embracing-Algorithms" class="headerlink" title="Embracing Algorithms"></a><a href="https://developer.apple.com/videos/play/wwdc2018/223/" target="_blank" rel="noopener">Embracing Algorithms</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*qocdXtZ8cCAJ0mKV.jpg" alt></p>
<p>This is the most pleasant to watch as it is like a conversation between the speaker and the imaginary manager Crusty. Here I learn how to be aware of algorithm complexity and also how to utilise built in Foundation functions which are already optimised for performance.</p>
<p>After this session I can’t help myself but going to Swift repo to read the <a href="https://github.com/apple/swift/blob/master/test/Prototypes/Algorithms.swift" target="_blank" rel="noopener">Algorithms.swift</a> file immediately.</p>
<h3 id="Image-and-Graphics-Best-Practices"><a href="#Image-and-Graphics-Best-Practices" class="headerlink" title="Image and Graphics Best Practices"></a><a href="https://developer.apple.com/videos/play/wwdc2018/219/" target="_blank" rel="noopener">Image and Graphics Best Practices</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*-qDMSLxL89PuOm-m.jpg" alt></p>
<p>Learn how image encoding and decoding works through data and image buffer and how that affects memory and performance. There are techniques like downsampling that can tackle this problem. This also recommends against using backing store, and instead, use UIImageView</p>
<p><img src="https://cdn-images-1.medium.com/max/2766/1*mt70wBlbwC9Kz18vXN5THQ.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*uV9Ata-pPnb-US3WrI6Y_A.png" alt></p>
<h3 id="A-Guide-to-Turi-Create"><a href="#A-Guide-to-Turi-Create" class="headerlink" title="A Guide to Turi Create"></a><a href="https://developer.apple.com/videos/play/wwdc2018/712/" target="_blank" rel="noopener">A Guide to Turi Create</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*yWr3HKYpIslcV-Zz.jpg" alt></p>
<p>I’ve <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-turi-create-and-coreml-5ddce0dc8e26" target="_blank" rel="noopener">written about Turi Create</a> before, but it is just scratching the surface of the many tasks offered by Turi. This year Apple releases <a href="https://github.com/apple/turicreate/releases/tag/5.0b1" target="_blank" rel="noopener">Turi Create 5</a> with style transfer task, Vision Feature Print, GPU acceleration and recommender model improvements. I can’t wait to explore. And if you take a look at MLDataTable in Create ML framework, it looks like this has Turi ‘s SFrame under the hood.</p>
<p>That’s it. Thanks for reading. What are your favourite sessions this year? Please share in the comment section below</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-13T11:43:49.000Z" title="2019-05-13T11:43:49.000Z">2019-05-13</time><span class="level-item">a minute read (About 206 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-CAReplicatorLayer-to-make-activity-indicator-in-iOS/">How to use CAReplicatorLayer to make activity indicator in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/230" target="_blank" rel="noopener">#230</a></strong></p>
<p><a href="https://developer.apple.com/documentation/quartzcore/careplicatorlayer" target="_blank" rel="noopener">CAReplicatorLayer</a> is a layer that creates a specified number of sublayer copies with varying geometric, temporal, and color transformations</p>
<p>Here we use <code>instanceTransform</code> which applies transformation matrix around the center of the replicator layer</p>
<p>Below is how we use <code>replicatorLayer</code> to replicate lots of <code>line</code> and rotate them around the center.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> replicatorLayer = <span class="type">CAReplicatorLayer</span>()</span><br><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: #keyPath(<span class="type">CALayer</span>.opacity))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> line = <span class="type">CALayer</span>()</span><br><span class="line"><span class="keyword">let</span> lineCount: <span class="type">Int</span> = <span class="number">12</span></span><br><span class="line"><span class="keyword">let</span> duration: <span class="type">TimeInterval</span> = <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> lineSize: <span class="type">CGSize</span> = <span class="type">CGSize</span>(width: <span class="number">20</span>, height: <span class="number">6</span>)</span><br><span class="line"><span class="keyword">let</span> lineColor: <span class="type">UIColor</span> = <span class="type">UIColor</span>.darkGray</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> angle = <span class="type">CGFloat</span>.pi * <span class="number">2</span> / <span class="type">CGFloat</span>(lineCount)</span><br><span class="line"><span class="keyword">let</span> rotation = <span class="type">CATransform3DMakeRotation</span>(angle, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">replicatorLayer.instanceTransform = rotation</span><br><span class="line">replicatorLayer.instanceCount = lineCount</span><br><span class="line">replicatorLayer.instanceDelay = duration / <span class="type">TimeInterval</span>(lineCount)</span><br><span class="line"></span><br><span class="line">line.backgroundColor = lineColor.cgColor</span><br><span class="line">line.frame.size = lineSize</span><br><span class="line">line.cornerRadius = lineSize.height / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">animation.fromValue = <span class="number">1.0</span></span><br><span class="line">animation.toValue = <span class="number">0.0</span></span><br><span class="line">animation.repeatCount = <span class="type">Float</span>.greatestFiniteMagnitude</span><br><span class="line">animation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: .linear)</span><br><span class="line">animation.duration = duration</span><br><span class="line"></span><br><span class="line">replicatorLayer.addSublayer(line)</span><br><span class="line">layer.addSublayer(replicatorLayer)</span><br><span class="line"></span><br><span class="line"><span class="comment">// x: </span></span><br><span class="line"><span class="comment">// y: half the height, changing affects rotation of lines</span></span><br><span class="line">line.position = <span class="type">CGPoint</span>(x: <span class="number">48</span>, y: <span class="number">75</span>)</span><br><span class="line"></span><br><span class="line">line.add(animation, forKey: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>Pay attention to <code>position</code> of the <code>line</code>. The larger the <code>x</code>, the closer to center. <code>y</code> should be half the height of the replicator layer size, changing it affects the skewness of the <code>line</code>.</p>
<img width="584" alt="indicator" src="https://user-images.githubusercontent.com/2284279/57626103-809f2100-7595-11e9-9851-2df8b6013757.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-13T10:20:29.000Z" title="2019-05-13T10:20:29.000Z">2019-05-13</time><span class="level-item">a minute read (About 114 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-do-rotation-for-CALayer-in-iOS/">How to do rotation for CALayer in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/229" target="_blank" rel="noopener">#229</a></strong></p>
<h2 id="Use-keypath"><a href="#Use-keypath" class="headerlink" title="Use keypath"></a>Use keypath</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animation = <span class="type">CASpringAnimation</span>(keyPath: #keyPath(<span class="type">CALayer</span>.transform))</span><br><span class="line">animation.fromValue = <span class="number">0</span></span><br><span class="line">animation.valueFunction = <span class="type">CAValueFunction</span>(name: <span class="type">CAValueFunctionName</span>.rotateZ)</span><br><span class="line">animation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: .easeIn)</span><br><span class="line"></span><br><span class="line">animation.toValue = <span class="type">CGFloat</span>.pi / <span class="number">4</span></span><br></pre></td></tr></table></figure>

<h2 id="Avoid-setting-frame-many-times"><a href="#Avoid-setting-frame-many-times" class="headerlink" title="Avoid setting frame many times"></a>Avoid setting frame many times</h2><p>Otherwise, <code>frame</code> is the box that covers the rotation transform, and <code>backgroundColor</code> now fills that huge box</p>
<p><img src="https://user-images.githubusercontent.com/2284279/57622665-67df3d00-758e-11e9-9e4c-f2baec78b4af.jpg" alt="abc"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.layoutSubviews()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> line.frame.width &lt;= <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    line.backgroundColor = <span class="type">UIColor</span>.red.cgColor</span><br><span class="line">    line.cornerRadius = <span class="number">3</span></span><br><span class="line">	line.frame.size = <span class="type">CGSize</span>(width: bounds.width*<span class="number">0.6</span>, height: <span class="number">6</span>)</span><br><span class="line">    line.position = layer.position</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Auto-Layout"><a href="#Auto-Layout" class="headerlink" title="Auto Layout"></a>Auto Layout</h2><p>Avoid using Auto Layout for the rotated view</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-13T09:17:43.000Z" title="2019-05-13T09:17:43.000Z">2019-05-13</time><span class="level-item">a minute read (About 171 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-not-use-isRemovedOnCompletion-for-CAAnimation-in-iOS/">How to not use isRemovedOnCompletion for CAAnimation in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/228" target="_blank" rel="noopener">#228</a></strong></p>
<p>CAAnimation is about presentation layer, after animation completes, the view snaps back to its original state. If we want to keep the state after animation, then the wrong way is to use <code>CAMediaTimingFillMode.forward</code> and <code>isRemovedOnCompletion</code></p>
<h2 id="Animation-never-ends"><a href="#Animation-never-ends" class="headerlink" title="Animation never ends"></a>Animation never ends</h2><p><code>forwards</code> <a href="https://developer.apple.com/documentation/quartzcore/camediatimingfillmode/1427658-forwards" target="_blank" rel="noopener">https://developer.apple.com/documentation/quartzcore/camediatimingfillmode/1427658-forwards</a></p>
<blockquote>
<p>The receiver remains visible in its final state when the animation is completed.</p>
</blockquote>
<p><code>isRemovedOnCompletion</code></p>
<p><a href="https://developer.apple.com/documentation/quartzcore/caanimation/1412458-isremovedoncompletion" target="_blank" rel="noopener">https://developer.apple.com/documentation/quartzcore/caanimation/1412458-isremovedoncompletion</a></p>
<blockquote>
<p>When true, the animation is removed from the target layer’s animations once its active duration has passed. Defaults to true.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">layer.fillMode = .forwards</span><br><span class="line">animation. isRemovedOnCompletion = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>This is to tell the animation to never ends and keep its last presentation state. Wrong approach ❗️</p>
<h2 id="Set-final-state-before-calling-animation"><a href="#Set-final-state-before-calling-animation" class="headerlink" title="Set final state before calling animation"></a>Set final state before calling animation</h2><p>The presentation state is just for animation, the source of truth lies in the layer itself. We need to set the final state before calling animation</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: #keyPath(<span class="type">CAShapeLayer</span>.strokeEnd))</span><br><span class="line"></span><br><span class="line">shapeLayer.strokeEnd = <span class="number">1.0</span></span><br><span class="line">shapeLayer.add(animation, forKey: <span class="string">""</span>)</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T12:30:28.000Z" title="2019-05-07T12:30:28.000Z">2019-05-07</time><span class="level-item">a minute read (About 223 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-simple-search-box-in-iOS/">How to make simple search box in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/227" target="_blank" rel="noopener">#227</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchBox</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> textField: <span class="type">UITextField</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> textField = <span class="type">UITextField</span>()</span><br><span class="line">        <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(image: <span class="type">R</span>.image.search()!)</span><br><span class="line">        imageView.frame.size = <span class="type">CGSize</span>(width: <span class="number">20</span> + <span class="number">8</span>, height: <span class="number">20</span>)</span><br><span class="line">        imageView.contentMode = .scaleAspectFit</span><br><span class="line">        textField.leftView = imageView</span><br><span class="line">        textField.leftViewMode = .always</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> textField</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> filterButton: <span class="type">UIButton</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> button = <span class="type">UIButton</span>(type: .custom)</span><br><span class="line">        button.setImage(<span class="type">R</span>.image.<span class="built_in">filter</span>()!, <span class="keyword">for</span>: .normal)</span><br><span class="line">        button.imageEdgeInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">10</span>, <span class="keyword">left</span>: <span class="number">10</span>, bottom: <span class="number">10</span>, <span class="keyword">right</span>: <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> button</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> backView: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = .white</span><br><span class="line">        view.layer.cornerRadius = <span class="number">10</span></span><br><span class="line">        view.layer.borderColor = <span class="type">R</span>.color.lightGray.cgColor</span><br><span class="line">        view.layer.borderWidth = <span class="number">0.5</span></span><br><span class="line">        view.layer.shadowOffset = <span class="type">CGSize</span>(width: <span class="number">1</span>, height: <span class="number">1</span>)</span><br><span class="line">        view.layer.shadowOpacity = <span class="number">0.8</span></span><br><span class="line">        view.layer.shadowColor = <span class="type">R</span>.color.lightGray.cgColor</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line"></span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([backView, textField, filterButton])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            filterButton.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">8</span>),</span><br><span class="line">            filterButton.centerYAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line">            filterButton.heightAnchor.constraint(equalToConstant: <span class="number">44</span>),</span><br><span class="line">            filterButton.widthAnchor.constraint(equalToConstant: <span class="number">44</span>),</span><br><span class="line"></span><br><span class="line">            textField.centerYAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line">            textField.leftAnchor.constraint(equalTo: leftAnchor, constant: <span class="number">16</span>),</span><br><span class="line">            textField.rightAnchor.constraint(equalTo: filterButton.leftAnchor, constant: -<span class="number">8</span>)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            backView.pinEdges(view: <span class="keyword">self</span>, inset: <span class="type">UIEdgeInsets</span>(top: <span class="number">4</span>, <span class="keyword">left</span>: <span class="number">4</span>, bottom: -<span class="number">4</span>, <span class="keyword">right</span>: -<span class="number">4</span>))</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To apply padding to <code>leftView</code>, increase <code>width</code> and use <code>contentMode</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">imageView.frame.size = <span class="type">CGSize</span>(width: <span class="number">20</span> + <span class="number">8</span>, height: <span class="number">20</span>)</span><br><span class="line">imageView.contentMode = .scaleAspectFit</span><br></pre></td></tr></table></figure>

<p>To make image in button smaller, use <code>imageEdgeInsets</code> with all positive values<br>To have round and shadow, specify <code>shadowOpacity</code>, <code>cornerRadius</code>, <code>shadowOffset</code></p>
<img width="584" alt="searchbox" src="https://user-images.githubusercontent.com/2284279/57307753-6a045000-70e5-11e9-9f2d-db5835f5b21b.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T10:43:16.000Z" title="2019-05-07T10:43:16.000Z">2019-05-07</time><span class="level-item">a few seconds read (About 27 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-capture-video-in-iOS-simulator/">How to capture video in iOS simulator</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/226" target="_blank" rel="noopener">#226</a></strong></p>
<p>Take screenshot</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl io booted screenshot image.png</span><br></pre></td></tr></table></figure>

<p>Record video</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl io booted recordVideo video.mp4</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T07:17:28.000Z" title="2019-05-07T07:17:28.000Z">2019-05-07</time><span class="level-item">a minute read (About 127 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-custom-fonts-in-iOS/">How to use custom fonts in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/225" target="_blank" rel="noopener">#225</a></strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>UIAppFonts<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Bold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-BoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-ExtraBold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-ExtraBoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Italic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Light.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-LightItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Regular.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-SemiBold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-SemiBoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Read <a href="https://developer.apple.com/documentation/uikit/text_display_and_fonts/adding_a_custom_font_to_your_app" target="_blank" rel="noopener">Adding a Custom Font to Your App</a></p>
<blockquote>
<p>The name of the font isn’t always obvious, and rarely matches the font file name. A quick way to find the font name is to get the list of fonts available to your app, which you can do with the following code:</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> family <span class="keyword">in</span> <span class="type">UIFont</span>.familyNames.sorted() &#123;</span><br><span class="line">    <span class="keyword">let</span> names = <span class="type">UIFont</span>.fontNames(forFamilyName: family)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Family: \(family) Font names: \(names)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T06:54:17.000Z" title="2019-05-07T06:54:17.000Z">2019-05-07</time><span class="level-item">a minute read (About 146 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-create-UITabBarController-programmatically-in-iOS/">How to create UITabBarController programmatically in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/224" target="_blank" rel="noopener">#224</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tabBarController = <span class="type">UITabBarController</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> navigationController1 = <span class="type">UINavigationController</span>(rootViewController: viewController1)</span><br><span class="line"><span class="keyword">let</span> navigationController2 = <span class="type">UINavigationController</span>(rootViewController: viewController2)</span><br><span class="line"><span class="keyword">let</span> navigationController3 = <span class="type">UINavigationController</span>(rootViewController: viewController3)</span><br><span class="line"></span><br><span class="line">navigationController2.isNavigationBarHidden = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">navigationController1.tabBarItem.image = <span class="type">R</span>.image.profile()</span><br><span class="line">navigationController2.tabBarItem.image = <span class="type">R</span>.image.books()</span><br><span class="line">navigationController3.tabBarItem.image = <span class="type">R</span>.image.settings()</span><br><span class="line"></span><br><span class="line">tabBarController.tabBar.tintColor = .yellow</span><br><span class="line">tabBarController.viewControllers = [navigationController1, navigationController2, navigationController3]</span><br></pre></td></tr></table></figure>

<p>Use <code>tintColor</code> instead of the deprecated <code>selectedImageTintColor</code> to indicate selected item color.</p>
<p>For icon size, check <a href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/custom-icons/" target="_blank" rel="noopener">Tab Bar Icon Size</a>, usually 50x50 for 2x and 75x75 for 3x</p>
<blockquote>
<p>In portrait orientation, tab bar icons appear above tab titles. In landscape orientation, the icons and titles appear side-by-side. Depending on the device and orientation, the system displays either a regular or compact tab bar. Your app should include custom tab bar icons for both sizes.</p>
</blockquote>
<img width="769" alt="tab" src="https://user-images.githubusercontent.com/2284279/57286819-71f8cb80-70b6-11e9-937e-a3572fb3bb57.png">

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-04-30T11:17:03.000Z" title="2019-04-30T11:17:03.000Z">2019-04-30</time><span class="level-item">a few seconds read (About 30 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-ignore-App-Transport-Security-in-iOS/">How to ignore App Transport Security in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/221" target="_blank" rel="noopener">#221</a></strong></p>
<h2 id="Ignore-a-host"><a href="#Ignore-a-host" class="headerlink" title="Ignore a host"></a>Ignore a host</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionDomains<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>example.com<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSIncludesSubdomains<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionAllowsInsecureHTTPLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionRequiresForwardSecrecy<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionMinimumTLSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>TLSv1.2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionAllowsInsecureHTTPLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionRequiresForwardSecrecy<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionMinimumTLSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>TLSv1.2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSRequiresCertificateTransparency<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Ignore-all"><a href="#Ignore-all" class="headerlink" title="Ignore all"></a>Ignore all</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAllowsArbitraryLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-04-30T09:12:12.000Z" title="2019-04-30T09:12:12.000Z">2019-04-30</time><span class="level-item">14 minutes read (About 2051 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Stripe-and-Apple-Pay-in-iOS/">How to use Stripe and Apple Pay in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/219" target="_blank" rel="noopener">#219</a></strong></p>
<ul>
<li><a href="https://stripe.com/docs/mobile/ios" target="_blank" rel="noopener">iOS Integration</a></li>
<li><a href="https://developer.apple.com/documentation/passkit/apple_pay/setting_up_apple_pay_requirements" target="_blank" rel="noopener">Setting Up Apple Pay Requirements</a></li>
<li><a href="https://stripe.com/docs/apple-pay" target="_blank" rel="noopener">Apple Pay</a></li>
</ul>
<h2 id="Show-basic-add-card-in-iOS"><a href="#Show-basic-add-card-in-iOS" class="headerlink" title="Show basic add card in iOS"></a>Show basic add card in iOS</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> Stripe</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MainController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showPayment</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> addCardViewController = <span class="type">STPAddCardViewController</span>()</span><br><span class="line">        addCardViewController.delegate = <span class="keyword">self</span></span><br><span class="line">        <span class="keyword">let</span> navigationController = <span class="type">UINavigationController</span>(rootViewController: addCardViewController)</span><br><span class="line"></span><br><span class="line">        present(navigationController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">STPAddCardViewControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addCardViewControllerDidCancel</span><span class="params">(<span class="number">_</span> addCardViewController: STPAddCardViewController)</span></span> &#123;</span><br><span class="line">        dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addCardViewController</span><span class="params">(<span class="number">_</span> addCardViewController: STPAddCardViewController, didCreateToken token: STPToken, completion: @escaping STPErrorBlock)</span></span> &#123;</span><br><span class="line">        <span class="number">_</span> = token.tokenId</span><br><span class="line">        completion(<span class="literal">nil</span>)</span><br><span class="line">        dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Generate-ephemeral-key"><a href="#Generate-ephemeral-key" class="headerlink" title="Generate ephemeral key"></a>Generate ephemeral key</h2><p><a href="https://stripe.com/docs/mobile/ios/standard#ephemeral-key" target="_blank" rel="noopener">https://stripe.com/docs/mobile/ios/standard#ephemeral-key</a></p>
<blockquote>
<p>In order for our prebuilt UI elements to function, you’ll need to provide them with an ephemeral key, a short-lived API key with restricted API access. You can think of an ephemeral key as a session, authorizing the SDK to retrieve and update a specific Customer object for the duration of the session.</p>
</blockquote>
<h3 id="Backend-in-Go"><a href="#Backend-in-Go" class="headerlink" title="Backend in Go"></a>Backend in Go</h3><p><a href="https://github.com/stripe/stripe-go" target="_blank" rel="noopener">https://github.com/stripe/stripe-go</a></p>
<p>Need a secret key by going to <code>Stripe dashboard -&gt; Developers -&gt; API keys -&gt; Secret key</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stripe.Key = &quot;sk_key&quot;</span><br></pre></td></tr></table></figure>

<p>Need customer id. We can manually create one in <code>Stripe dashboard -&gt; Customers</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">	<span class="string">"github.com/stripe/stripe-go"</span></span><br><span class="line">    <span class="string">"github.com/stripe/stripe-go/ephemeralkey"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	stripe.Key = <span class="string">"sk_test_mM2MkqO61n7vvbVRfeYmBgWm00Si2PtWab"</span></span><br><span class="line"></span><br><span class="line">	http.HandleFunc(<span class="string">"/ephemeral_keys"</span>, generateEphemeralKey)</span><br><span class="line">  	<span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":8080"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    	<span class="built_in">panic</span>(err)</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> EphemeralKeysRequest <span class="keyword">struct</span> &#123;</span><br><span class="line">    ApiVersion <span class="keyword">string</span> <span class="string">`json:"api_version"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateEphemeralKey</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	customerId := <span class="string">"cus_Eys6aeP5xR89ab"</span></span><br><span class="line"></span><br><span class="line">	decoder := json.NewDecoder(r.Body)</span><br><span class="line">    <span class="keyword">var</span> t EphemeralKeysRequest</span><br><span class="line">    err := decoder.Decode(&amp;t)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stripeVersion := t.ApiVersion</span><br><span class="line">    <span class="keyword">if</span> stripeVersion == <span class="string">""</span> &#123;</span><br><span class="line">        log.Printf(<span class="string">"Stripe-Version not found\n"</span>)</span><br><span class="line">        w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    params := &amp;stripe.EphemeralKeyParams&#123;</span><br><span class="line">        Customer: stripe.String(customerId),</span><br><span class="line">        StripeVersion: stripe.String(stripeVersion),</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    key, err := ephemeralkey.New(params)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Printf(<span class="string">"Stripe bindings call failed, %v\n"</span>, err)</span><br><span class="line">        w.WriteHeader(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    w.Write(key.RawJSON)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-client"><a href="#iOS-client" class="headerlink" title="iOS client"></a>iOS client</h3><p>Networking client uses <a href="https://github.com/onmyway133/blog/issues/222" target="_blank" rel="noopener">How to make simple networking client in Swift</a></p>
<p>Need an object that conforms to <code>STPCustomerEphemeralKeyProvider</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">EphemeralKeyClient</span>: <span class="title">NSObject</span>, <span class="title">STPCustomerEphemeralKeyProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">NetworkClient</span>(baseUrl: <span class="type">URL</span>(string: <span class="string">"http://localhost:8080"</span>)!)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">createCustomerKey</span><span class="params">(withAPIVersion apiVersion: String, completion: @escaping STPJSONResponseCompletionBlock)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> options = <span class="type">Options</span>()</span><br><span class="line">        options.httpMethod = .post</span><br><span class="line">        options.path = <span class="string">"ephemeral_keys"</span></span><br><span class="line">        options.parameters = [</span><br><span class="line">            <span class="string">"api_version"</span>: apiVersion</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        client.makeJson(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success(<span class="keyword">let</span> json):</span><br><span class="line">                completion(json, <span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                completion(<span class="literal">nil</span>, error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Setting up <code>STPCustomerContext</code> and <code>STPPaymentContext</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MainController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">EphemeralKeyClient</span>()</span><br><span class="line">    <span class="keyword">let</span> customerContext: <span class="type">STPCustomerContext</span></span><br><span class="line">    <span class="keyword">let</span> paymentContext: <span class="type">STPPaymentContext</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.customerContext = <span class="type">STPCustomerContext</span>(keyProvider: client)</span><br><span class="line">        <span class="keyword">self</span>.paymentContext = <span class="type">STPPaymentContext</span>(customerContext: customerContext)</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">        paymentContext.delegate = <span class="keyword">self</span></span><br><span class="line">        paymentContext.hostViewController = <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">start</span><span class="params">()</span></span> &#123;</span><br><span class="line">        paymentContext.presentShippingViewController()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Handle-charge"><a href="#Handle-charge" class="headerlink" title="Handle charge"></a>Handle charge</h2><p><a href="https://stripe.com/docs/charges" target="_blank" rel="noopener">https://stripe.com/docs/charges</a></p>
<h3 id="Backend-in-Go-1"><a href="#Backend-in-Go-1" class="headerlink" title="Backend in Go"></a>Backend in Go</h3><p>If we use <code>stripe_id</code> from card, which has the form of <code>card_xxx</code>, we need to include <code>customer</code> info</p>
<p>If we use <code>token</code>, which has the form <code>tok_xxx</code>, then no need for <code>customer</code> info</p>
<p>From <code>STPPaymentResult</code></p>
<blockquote>
<p>When you’re using <code>STPPaymentContext</code> to request your user’s payment details, this is the object that will be returned to your application when they’ve successfully made a payment. It currently just contains a <code>source</code>, but in the future will include any relevant metadata as well. You should pass <code>source.stripeID</code> to your server, and call the charge creation endpoint. This assumes you are charging a Customer, so you should specify the <code>customer</code> parameter to be that customer’s ID and the <code>source</code> parameter to the value returned here. For more information, see <a href="https://stripe.com/docs/api#create_charge" target="_blank" rel="noopener">https://stripe.com/docs/api#create_charge</a></p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">	<span class="string">"github.com/stripe/stripe-go/charge"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	stripe.Key = <span class="string">"sk_test_mM2MkqO61n7vvbVRfeYmBgWm00Si2PtWab"</span></span><br><span class="line"></span><br><span class="line">	http.HandleFunc(<span class="string">"/request_charge"</span>, handleCharge)</span><br><span class="line">  	<span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":8080"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    	<span class="built_in">panic</span>(err)</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> customerId = <span class="string">"cus_Eys6aeP5xR89ab"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> PaymentResult <span class="keyword">struct</span> &#123;</span><br><span class="line">    StripeId <span class="keyword">string</span> <span class="string">`json:"stripe_id"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleCharge</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	decoder := json.NewDecoder(r.Body)</span><br><span class="line">    <span class="keyword">var</span> t PaymentResult</span><br><span class="line">    err := decoder.Decode(&amp;t)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    params := &amp;stripe.ChargeParams&#123;</span><br><span class="line">        Amount:      stripe.Int64(<span class="number">150</span>),</span><br><span class="line">        Currency:    stripe.String(<span class="keyword">string</span>(stripe.CurrencyUSD)),</span><br><span class="line">		Description: stripe.String(<span class="string">"Charge from my Go backend"</span>),</span><br><span class="line">		Customer: stripe.String(customerId),</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">	params.SetSource(t.StripeId)</span><br><span class="line">    ch, err := charge.New(params)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Fprintf(w, <span class="string">"Could not process payment: %v"</span>, err)</span><br><span class="line">		fmt.Println(ch)</span><br><span class="line">		w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	w.WriteHeader(<span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-client-1"><a href="#iOS-client-1" class="headerlink" title="iOS client"></a>iOS client</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">NetworkClient</span>(baseUrl: <span class="type">URL</span>(string: <span class="string">"http://192.168.210.219:8080"</span>)!)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">requestCharge</span><span class="params">(source: STPSourceProtocol, completion: @escaping <span class="params">(Result&lt;<span class="params">()</span></span></span></span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> options = <span class="type">Options</span>()</span><br><span class="line">        options.httpMethod = .post</span><br><span class="line">        options.path = <span class="string">"request_charge"</span></span><br><span class="line">        options.parameters = [</span><br><span class="line">            <span class="string">"stripe_id"</span>: source.stripeID</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        client.makeJson(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            completion(result.<span class="built_in">map</span>(&#123; <span class="number">_</span> <span class="keyword">in</span> () &#125;))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">paymentContext.requestPayment()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">STPPaymentContextDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentContext</span><span class="params">(<span class="number">_</span> paymentContext: STPPaymentContext, didCreatePaymentResult paymentResult: STPPaymentResult, completion: @escaping STPErrorBlock)</span></span> &#123;</span><br><span class="line">        client.requestCharge(source: paymentResult.source, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success:</span><br><span class="line">                completion(<span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                completion(error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Token-from-card"><a href="#Token-from-card" class="headerlink" title="Token from card"></a>Token from card</h2><p>Use <code>STPAPIClient.shared().createToken</code> to get token from card <a href="https://stripe.com/docs/mobile/ios/custom#collecting-card-details" target="_blank" rel="noopener">https://stripe.com/docs/mobile/ios/custom#collecting-card-details</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cardParams = <span class="type">STPCardParams</span>()</span><br><span class="line">cardParams.number = <span class="string">"4242424242424242"</span></span><br><span class="line">cardParams.expMonth = <span class="number">10</span></span><br><span class="line">cardParams.expYear = <span class="number">2021</span></span><br><span class="line">cardParams.cvc = <span class="string">"123"</span></span><br><span class="line"></span><br><span class="line"><span class="type">STPAPIClient</span>.shared().createToken(withCard: cardParams) &#123; (token: <span class="type">STPToken?</span>, error: <span class="type">Error?</span>) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> token = token, error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Present error to user...</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    submitTokenToBackend(token, completion: &#123; (error: <span class="type">Error?</span>) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">            <span class="comment">// Present error to user...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Continue with payment...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Payment-options-and-shipping-view-controllers"><a href="#Payment-options-and-shipping-view-controllers" class="headerlink" title="Payment options and shipping view controllers"></a>Payment options and shipping view controllers</h2><p>Instead of using <code>paymentContext</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">paymentContext.pushShippingViewController()</span><br><span class="line">paymentContext.pushPaymentOptionsViewController()</span><br></pre></td></tr></table></figure>

<p>We can use view controllers <a href="https://stripe.com/docs/mobile/ios/custom#stppaymentoptionsviewcontroller" target="_blank" rel="noopener">https://stripe.com/docs/mobile/ios/custom#stppaymentoptionsviewcontroller</a> directly with <code>STPPaymentOptionsViewController</code> and <code>STPShippingAddressViewController</code>. Then implement <code>STPPaymentOptionsViewControllerDelegate</code> and <code>STPShippingAddressViewControllerDelegate</code></p>
<h2 id="Register-merchant-Id-and-Apple-Pay-certificate"><a href="#Register-merchant-Id-and-Apple-Pay-certificate" class="headerlink" title="Register merchant Id and Apple Pay certificate"></a>Register merchant Id and Apple Pay certificate</h2><p><a href="https://stripe.com/docs/apple-pay/apps" target="_blank" rel="noopener">https://stripe.com/docs/apple-pay/apps</a></p>
<p>Get Certificate signing request file from Stripe <a href="https://dashboard.stripe.com/account/apple_pay" target="_blank" rel="noopener">https://dashboard.stripe.com/account/apple_pay</a></p>
<p>We can’t register merchant id with Enterprise account</p>
<h2 id="Use-Apple-Pay"><a href="#Use-Apple-Pay" class="headerlink" title="Use Apple Pay"></a>Use Apple Pay</h2><h3 id="Go-backend"><a href="#Go-backend" class="headerlink" title="Go backend"></a>Go backend</h3><p>Use token</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ApplePayRequest <span class="keyword">struct</span> &#123;</span><br><span class="line">    Token <span class="keyword">string</span> <span class="string">`json:"token"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleChargeUsingApplePay</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	decoder := json.NewDecoder(r.Body)</span><br><span class="line">    <span class="keyword">var</span> t ApplePayRequest</span><br><span class="line">    err := decoder.Decode(&amp;t)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    params := &amp;stripe.ChargeParams&#123;</span><br><span class="line">        Amount:      stripe.Int64(<span class="number">150</span>),</span><br><span class="line">        Currency:    stripe.String(<span class="keyword">string</span>(stripe.CurrencyUSD)),</span><br><span class="line">		Description: stripe.String(<span class="string">"Charge from my Go backend for Apple Pay"</span>),</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">	params.SetSource(t.Token)</span><br><span class="line">    ch, err := charge.New(params)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Fprintf(w, <span class="string">"Could not process payment: %v"</span>, err)</span><br><span class="line">		fmt.Println(ch)</span><br><span class="line">		w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	w.WriteHeader(<span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-client-2"><a href="#iOS-client-2" class="headerlink" title="iOS client"></a>iOS client</h3><p>Update client to send <code>STPToken</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentClient</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">NetworkClient</span>(baseUrl: <span class="type">URL</span>(string: <span class="string">"localhost:8080"</span>)!)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">requestCharge</span><span class="params">(token: STPToken, completion: @escaping <span class="params">(Result&lt;<span class="params">()</span></span></span></span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> options = <span class="type">Options</span>()</span><br><span class="line">        options.httpMethod = .post</span><br><span class="line">        options.path = <span class="string">"request_charge_apple_pay"</span></span><br><span class="line">        options.parameters = [</span><br><span class="line">            <span class="string">"token"</span>: token.tokenId</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        client.make(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            completion(result.<span class="built_in">map</span>(&#123; <span class="number">_</span> <span class="keyword">in</span> () &#125;))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">useApplePay</span><span class="params">(payment: PKPayment, completion: @escaping <span class="params">(Result&lt;<span class="params">()</span></span></span></span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="type">STPAPIClient</span>.shared().createToken(with: payment, completion: &#123; (token: <span class="type">STPToken?</span>, error: <span class="type">Error?</span>) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> token = token, error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">self</span>.requestCharge(token: token, completion: completion)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Use <code>PKPaymentAuthorizationViewController</code>, not <code>PKPaymentAuthorizationController</code></p>
<p><a href="https://developer.apple.com/documentation/passkit/pkpaymentauthorizationcontroller" target="_blank" rel="noopener">https://developer.apple.com/documentation/passkit/pkpaymentauthorizationcontroller</a></p>
<blockquote>
<p>The PKPaymentAuthorizationController class performs the same role as the PKPaymentAuthorizationViewController class, but it does not depend on the UIKit framework. This means that the authorization controller can be used in places where a view controller cannot (for example, in watchOS apps or in SiriKit extensions).</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showApplePay</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> merchantId = <span class="string">"merchant.com.onmyway133.MyApp"</span></span><br><span class="line">        <span class="keyword">let</span> paymentRequest = <span class="type">Stripe</span>.paymentRequest(withMerchantIdentifier: merchantId, country: <span class="string">"US"</span>, currency: <span class="string">"USD"</span>)</span><br><span class="line">        paymentRequest.paymentSummaryItems = [</span><br><span class="line">            <span class="type">PKPaymentSummaryItem</span>(label: <span class="string">"Rubber duck"</span>, amount: <span class="number">1.5</span>)</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="type">Stripe</span>.canSubmitPaymentRequest(paymentRequest) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">assertionFailure</span>()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> authorizationViewController = <span class="type">PKPaymentAuthorizationViewController</span>(paymentRequest: paymentRequest) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">assertionFailure</span>()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        authorizationViewController.delegate = <span class="keyword">self</span></span><br><span class="line">        innerNavigationController.present(authorizationViewController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">PKPaymentAuthorizationViewControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentAuthorizationViewControllerDidFinish</span><span class="params">(<span class="number">_</span> controller: PKPaymentAuthorizationViewController)</span></span> &#123;</span><br><span class="line">        controller.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentAuthorizationViewController</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> controller: PKPaymentAuthorizationViewController,</span></span></span><br><span class="line"><span class="function"><span class="params">        didAuthorizePayment payment: PKPayment,</span></span></span><br><span class="line"><span class="function"><span class="params">        handler completion: @escaping <span class="params">(PKPaymentAuthorizationResult)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line"></span><br><span class="line">        client.useApplePay(payment: payment, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success:</span><br><span class="line">                completion(.<span class="keyword">init</span>(status: .success, errors: <span class="literal">nil</span>))</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                completion(.<span class="keyword">init</span>(status: .failure, errors: [error]))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Showing-Apple-Pay-option"><a href="#Showing-Apple-Pay-option" class="headerlink" title="Showing Apple Pay option"></a>Showing Apple Pay option</h2><p>From <code>appleMerchantIdentifier</code></p>
<blockquote>
<p>The Apple Merchant Identifier to use during Apple Pay transactions. To create one of these, see our guide at <a href="https://stripe.com/docs/mobile/apple-pay" target="_blank" rel="noopener">https://stripe.com/docs/mobile/apple-pay</a> . You must set this to a valid identifier in order to automatically enable Apple Pay.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="type">Stripe</span>.deviceSupportsApplePay() &#123;</span><br><span class="line">    <span class="type">STPPaymentConfiguration</span>.shared().appleMerchantIdentifier = <span class="string">"merchant.com.onmyway133.MyApp"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">paymentContext.pushPaymentOptionsViewController()</span><br></pre></td></tr></table></figure>

<h2 id="requestPayment-not-showing-UI"><a href="#requestPayment-not-showing-UI" class="headerlink" title="requestPayment not showing UI"></a>requestPayment not showing UI</h2><p>From <code>requestPayment</code></p>
<blockquote>
<p>Requests payment from the user. This may need to present some supplemental UI to the user, in which case it will be presented on the payment context’s <code>hostViewController</code>. For instance, if they’ve selected Apple Pay as their payment method, calling this method will show the payment sheet. If the user has a card on file, this will use that without presenting any additional UI. After this is called, the <code>paymentContext:didCreatePaymentResult:completion:</code> and <code>paymentContext:didFinishWithStatus:error:</code> methods will be called on the context’s <code>delegate</code>.</p>
</blockquote>
<p>Use <code>STPPaymentOptionsViewController</code> to show cards and Apple Pay options</p>
<p>Code for <code>requestPayment</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)requestPayment &#123;</span><br><span class="line">    WEAK(<span class="keyword">self</span>);</span><br><span class="line">    [[[<span class="keyword">self</span>.didAppearPromise voidFlatMap:^STPPromise * _Nonnull&#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.loadingPromise;</span><br><span class="line">    &#125;] onSuccess:^(__unused STPPaymentOptionTuple *tuple) &#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.state != STPPaymentContextStateNone) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>.selectedPaymentOption) &#123;</span><br><span class="line">            [<span class="keyword">self</span> presentPaymentOptionsViewControllerWithNewState:STPPaymentContextStateRequestingPayment];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span> requestPaymentShouldPresentShippingViewController]) &#123;</span><br><span class="line">            [<span class="keyword">self</span> presentShippingViewControllerWithNewState:STPPaymentContextStateRequestingPayment];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span>.selectedPaymentOption isKindOfClass:[STPCard <span class="keyword">class</span>]] ||</span><br><span class="line">                 [<span class="keyword">self</span>.selectedPaymentOption isKindOfClass:[STPSource <span class="keyword">class</span>]]) &#123;</span><br><span class="line">            <span class="keyword">self</span>.state = STPPaymentContextStateRequestingPayment;</span><br><span class="line">            STPPaymentResult *result = [[STPPaymentResult alloc] initWithSource:(<span class="keyword">id</span>&lt;STPSourceProtocol&gt;)<span class="keyword">self</span>.selectedPaymentOption];</span><br><span class="line">            [<span class="keyword">self</span>.delegate paymentContext:<span class="keyword">self</span> didCreatePaymentResult:result completion:^(<span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">                stpDispatchToMainThreadIfNecessary(^&#123;</span><br><span class="line">                    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                        [<span class="keyword">self</span> didFinishWithStatus:STPPaymentStatusError error:error];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        [<span class="keyword">self</span> didFinishWithStatus:STPPaymentStatusSuccess error:<span class="literal">nil</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span>.selectedPaymentOption isKindOfClass:[STPApplePayPaymentOption <span class="keyword">class</span>]]) &#123;</span><br><span class="line">      <span class="comment">// ....</span></span><br></pre></td></tr></table></figure>

<h2 id="Payment-options"><a href="#Payment-options" class="headerlink" title="Payment options"></a>Payment options</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">paymentOptionsViewController</span><span class="params">(<span class="number">_</span> paymentOptionsViewController: STPPaymentOptionsViewController, didSelect paymentOption: STPPaymentOption)</span></span> &#123;</span><br><span class="line">	<span class="comment">// No op</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>After user selects payment option, the change is saved in dashboard <code>https://dashboard.stripe.com/test/customers</code>, but for card only. Select Apple Pay does not reflect change in web dashboard.</p>
<p>Apple pay option is added manually locally, from <code>STPCustomer+SourceTuple.m</code> 😲</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (STPPaymentOptionTuple *)filteredSourceTupleForUIWithConfiguration:(STPPaymentConfiguration *)configuration &#123;</span><br><span class="line">    <span class="keyword">id</span>&lt;STPPaymentOption&gt; _Nullable selectedMethod = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSMutableArray</span>&lt;<span class="keyword">id</span>&lt;STPPaymentOption&gt;&gt; *methods = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">id</span>&lt;STPSourceProtocol&gt; customerSource <span class="keyword">in</span> <span class="keyword">self</span>.sources) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([customerSource isKindOfClass:[STPCard <span class="keyword">class</span>]]) &#123;</span><br><span class="line">            STPCard *card = (STPCard *)customerSource;</span><br><span class="line">            [methods addObject:card];</span><br><span class="line">            <span class="keyword">if</span> ([card.stripeID isEqualToString:<span class="keyword">self</span>.defaultSource.stripeID]) &#123;</span><br><span class="line">                selectedMethod = card;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([customerSource isKindOfClass:[STPSource <span class="keyword">class</span>]]) &#123;</span><br><span class="line">            STPSource *source = (STPSource *)customerSource;</span><br><span class="line">            <span class="keyword">if</span> (source.type == STPSourceTypeCard</span><br><span class="line">                &amp;&amp; source.cardDetails != <span class="literal">nil</span>) &#123;</span><br><span class="line">                [methods addObject:source];</span><br><span class="line">                <span class="keyword">if</span> ([source.stripeID isEqualToString:<span class="keyword">self</span>.defaultSource.stripeID]) &#123;</span><br><span class="line">                    selectedMethod = source;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [STPPaymentOptionTuple tupleWithPaymentOptions:methods</span><br><span class="line">                                    selectedPaymentOption:selectedMethod</span><br><span class="line">                                        addApplePayOption:configuration.applePayEnabled];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>STPApplePayPaymentOption<code>is not available in</code>paymentContext.paymentOptions` immediately</p>
<h2 id="Change-selected-payment-option"><a href="#Change-selected-payment-option" class="headerlink" title="Change selected payment option"></a>Change selected payment option</h2><p>In <code>STPPaymentContext</code></p>
<p><code>setSelectedPaymentOption</code> is read only and trigger <code>paymentContextDidChange</code>, but it checks if <code>the new selected payment option</code> is equal to existing selected payment option</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setSelectedPaymentOption:(<span class="keyword">id</span>&lt;STPPaymentOption&gt;)selectedPaymentOption &#123;</span><br><span class="line">    <span class="keyword">if</span> (selectedPaymentOption &amp;&amp; ![<span class="keyword">self</span>.paymentOptions containsObject:selectedPaymentOption]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.paymentOptions = [<span class="keyword">self</span>.paymentOptions arrayByAddingObject:selectedPaymentOption];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (![_selectedPaymentOption isEqual:selectedPaymentOption]) &#123;</span><br><span class="line">        _selectedPaymentOption = selectedPaymentOption;</span><br><span class="line">        stpDispatchToMainThreadIfNecessary(^&#123;</span><br><span class="line">            [<span class="keyword">self</span>.delegate paymentContextDidChange:<span class="keyword">self</span>];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>There is <code>retryLoading</code> which is called at <code>init</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)retryLoading &#123;</span><br><span class="line">    <span class="comment">// Clear any cached customer object before refetching</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.apiAdapter isKindOfClass:[STPCustomerContext <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        STPCustomerContext *customerContext = (STPCustomerContext *)<span class="keyword">self</span>.apiAdapter;</span><br><span class="line">        [customerContext clearCachedCustomer];</span><br><span class="line">    &#125;</span><br><span class="line">    WEAK(<span class="keyword">self</span>);</span><br><span class="line">    <span class="keyword">self</span>.loadingPromise = [[[STPPromise&lt;STPPaymentOptionTuple *&gt; new] onSuccess:^(STPPaymentOptionTuple *tuple) &#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">self</span>.paymentOptions = tuple.paymentOptions;</span><br><span class="line">        <span class="keyword">self</span>.selectedPaymentOption = tuple.selectedPaymentOption;</span><br><span class="line">    &#125;] onFailure:^(<span class="built_in">NSError</span> * _Nonnull error) &#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.hostViewController) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.didAppearPromise onSuccess:^(__unused <span class="keyword">id</span> value) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">self</span>.paymentOptionsViewController) &#123;</span><br><span class="line">                    [<span class="keyword">self</span> appropriatelyDismissPaymentOptionsViewController:<span class="keyword">self</span>.paymentOptionsViewController completion:^&#123;</span><br><span class="line">                        [<span class="keyword">self</span>.delegate paymentContext:<span class="keyword">self</span> didFailToLoadWithError:error];</span><br><span class="line">                    &#125;];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    [<span class="keyword">self</span>.delegate paymentContext:<span class="keyword">self</span> didFailToLoadWithError:error];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    [<span class="keyword">self</span>.apiAdapter retrieveCustomer:^(STPCustomer * _Nullable customer, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        stpDispatchToMainThreadIfNecessary(^&#123;</span><br><span class="line">            STRONG(<span class="keyword">self</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                [<span class="keyword">self</span>.loadingPromise fail:error];</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">self</span>.shippingAddress &amp;&amp; customer.shippingAddress) &#123;</span><br><span class="line">                <span class="keyword">self</span>.shippingAddress = customer.shippingAddress;</span><br><span class="line">                <span class="keyword">self</span>.shippingAddressNeedsVerification = <span class="literal">YES</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            STPPaymentOptionTuple *paymentTuple = [customer filteredSourceTupleForUIWithConfiguration:<span class="keyword">self</span>.configuration];</span><br><span class="line"></span><br><span class="line">            [<span class="keyword">self</span>.loadingPromise succeed:paymentTuple];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Which in turns call <code>STPCustomerEphemeralKeyProvider</code>. As stripe does not save Apple Pay option in dashboard, this method return list of card payment options, together with the default card as selected payment option 😲</p>
<p>Although the new <code>STPCard</code> has a different address, it is the exact same card with the same info, and the <code>isEqual</code> method of <code>STPCard</code> is</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)isEqualToCard:(<span class="keyword">nullable</span> STPCard *)other &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> == other) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!other || ![other isKindOfClass:<span class="keyword">self</span>.class]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>.stripeID isEqualToString:other.stripeID];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I raised an issue <a href="https://github.com/stripe/stripe-ios/issues/1175" target="_blank" rel="noopener">How to change selected payment option?</a> hope it gets resolved soon 😢</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-04-18T17:49:26.000Z" title="2019-04-18T17:49:26.000Z">2019-04-18</time><span class="level-item">5 minutes read (About 794 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Understanding-AVFoundation-and-MediaPlayer-frameworks-in-iOS/">Understanding AVFoundation and MediaPlayer frameworks in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/210" target="_blank" rel="noopener">#210</a></strong></p>
<p>Depending on what features we want to achieve, we need to go with either AVFoundation or MediaPlayer framework. As someone who worked with many apps that involve media playback, here are some of my observations</p>
<h2 id="MPMoviePlayerController-vs-AVPlayer"><a href="#MPMoviePlayerController-vs-AVPlayer" class="headerlink" title="MPMoviePlayerController vs AVPlayer"></a>MPMoviePlayerController vs AVPlayer</h2><p>At first, I use MPMoviePlayerController because it is very simple, in fact, it is a wrapper around AVPlayer. It offers a lot of useful notifications and properties.</p>
<p>But when my requirements change, a lot more features are needed, I need to change to AVPlayer to have more control. And that is the wisest decision I’ve ever made</p>
<p>You should use AVPlayer as soon as possible. Using it cost you just a little longer time than MPMoviePlayerController, but you have a lot of control.</p>
<h2 id="Custom-controls"><a href="#Custom-controls" class="headerlink" title="Custom controls"></a>Custom controls</h2><p>When building your own player, the built in controls of MPMoviePlayerController may not satisfy your need. I see many questions on SO are about custom controls.</p>
<h2 id="MPMoviePlayerController"><a href="#MPMoviePlayerController" class="headerlink" title="MPMoviePlayerController"></a>MPMoviePlayerController</h2><p>You have to set controlStyle to MPMovieControlStyleNone, set up Timer because currentPlaybackTime is not KVO compliance</p>
<h2 id="AVPlayer"><a href="#AVPlayer" class="headerlink" title="AVPlayer"></a>AVPlayer</h2><p>AVPlayer has no built in controls, but it has addPeriodicTimeObserverForInterval:queue:usingBlock: that makes handling the current time easily. The nicer thing about periodTimeObserver is that “The block is also invoked whenever time jumps and whenever playback starts or stops”</p>
<h2 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h2><h3 id="MPMoviePlayerController-1"><a href="#MPMoviePlayerController-1" class="headerlink" title="MPMoviePlayerController"></a>MPMoviePlayerController</h3><p>It has a lot of useful notifications, like MPMoviePlayerNowPlayingMovieDidChangeNotification, MPMoviePlayerLoadStateDidChangeNotification, MPMovieDurationAvailableNotification, …</p>
<h3 id="AVPlayer-1"><a href="#AVPlayer-1" class="headerlink" title="AVPlayer"></a>AVPlayer</h3><p>The AVPlayerItem has some notifications AVPlayerItemDidPlayToEndTimeNotification, AVPlayerItemPlaybackStalledNotification, …<br>If you want to have those same notifications as MPMoviePlayerController, you have to KVO some properties of AVPlayer like currentItem, currentTime, duration, … You have to read documents to make sure which property is KVO compliance</p>
<h2 id="Seek"><a href="#Seek" class="headerlink" title="Seek"></a>Seek</h2><h3 id="MPMoviePlayerController-2"><a href="#MPMoviePlayerController-2" class="headerlink" title="MPMoviePlayerController"></a>MPMoviePlayerController</h3><p>You can change the currentPlaybackTime to seek, but it results in jumping, because of efficiency and buffer status. I have to manually disable slider during seeking</p>
<h3 id="AVPlayer-2"><a href="#AVPlayer-2" class="headerlink" title="AVPlayer"></a>AVPlayer</h3><p>AVPlayer has this <strong>seekToTime:toleranceBefore:toleranceAfter:completionHandler:</strong> which allows you to specify the tolerance. Very nice</p>
<h2 id="Subtitle"><a href="#Subtitle" class="headerlink" title="Subtitle"></a>Subtitle</h2><h3 id="MPMoviePlayerController-3"><a href="#MPMoviePlayerController-3" class="headerlink" title="MPMoviePlayerController"></a>MPMoviePlayerController</h3><p>I have to schedule a timer that “wake” and “sleep” at the beginning and end time of a certain subtitle marker, respectively.</p>
<h3 id="AVPlayer-3"><a href="#AVPlayer-3" class="headerlink" title="AVPlayer"></a>AVPlayer</h3><p>AVPlayer has this <strong>addBoundaryTimeObserverForTimes:queue:usingBlock:</strong> that perfectly suits my need. I setup 2 boundary time observers, 1 for the beginning times, 1 for the end times. The beginning times is an array containing all beginning timestamps that a subtitle marker appears.</p>
<h2 id="Time-scale"><a href="#Time-scale" class="headerlink" title="Time scale"></a>Time scale</h2><p>AVPlayer uses CMTime that offers timescale, which is a more comfortable way to specify more accurate time</p>
<h2 id="Volume"><a href="#Volume" class="headerlink" title="Volume"></a>Volume</h2><p>AVPlayer has <strong>volume</strong> property (relative to system volume) that allows me to programmatically changes the player volume</p>
<h2 id="Playable-duration"><a href="#Playable-duration" class="headerlink" title="Playable duration"></a>Playable duration</h2><h3 id="MPMoviePlayerController-4"><a href="#MPMoviePlayerController-4" class="headerlink" title="MPMoviePlayerController"></a>MPMoviePlayerController</h3><p>It has playableDuration property</p>
<h3 id="AVPlayer-4"><a href="#AVPlayer-4" class="headerlink" title="AVPlayer"></a>AVPlayer</h3><p>You have to compute yourself. See <a href="http://stackoverflow.com/a/12260669/1418457" target="_blank" rel="noopener">http://stackoverflow.com/questions/6815316/how-can-i-get-the-playable-duration-of-avplayer</a></p>
<h2 id="Full-screen"><a href="#Full-screen" class="headerlink" title="Full screen"></a>Full screen</h2><p>MPMoviePlayerController achieves full screen mode by creating another UIWindow, you learn from this to support full screen using AVPlayer, too</p>
<h2 id="Movie-Source-Type"><a href="#Movie-Source-Type" class="headerlink" title="Movie Source Type"></a>Movie Source Type</h2><h3 id="MPMoviePlayerController-5"><a href="#MPMoviePlayerController-5" class="headerlink" title="MPMoviePlayerController"></a>MPMoviePlayerController</h3><p>It has movieSourceType that provides clues to the playback system, hence improving load time</p>
<p>“ If you know the source type of the movie, setting the value of this property before playback begins can improve the load times for the movie content.”</p>
<h3 id="AVPlayer-5"><a href="#AVPlayer-5" class="headerlink" title="AVPlayer"></a>AVPlayer</h3><p>Read <strong>Handling Different Types of Asset</strong> on <a href="https://developer.apple.com/library/ios/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html" target="_blank" rel="noopener">AV Foundation Programming Guide</a></p>
<p>“To create and prepare an HTTP live stream for playback. Initialize an instance of AVPlayerItem using the URL. (You cannot directly create an AVAsset instance to represent the media in an HTTP Live Stream.)”</p>
<h2 id="AVAsset"><a href="#AVAsset" class="headerlink" title="AVAsset"></a>AVAsset</h2><p>AVPlayer allows you to access AVAsset, which provides you more information about the playback and load state</p>
<h2 id="Allow-a-range-within-a-video-to-be-playable"><a href="#Allow-a-range-within-a-video-to-be-playable" class="headerlink" title="Allow a range within a video to be playable"></a>Allow a range within a video to be playable</h2><p>AVPlayerItem has <strong>forwardPlaybackEndTime</strong> and <strong>reversePlaybackEndTime</strong> that is used to specify a range that the player can play. When forwardPlaybackEndTime is specified and the playhead passes this points, AVPlayerItem will trigger AVPlayerItemDidPlayToEndTimeNotification</p>
<p>But it doesn’t work in my case <a href="http://stackoverflow.com/questions/25717819/forwardplaybackendtime-does-not-work" target="_blank" rel="noopener">forwardPlaybackEndTime does not work</a></p>
<h2 id="You-can-have-many-instances-of-AVPlayer-playing-at-the-same-time"><a href="#You-can-have-many-instances-of-AVPlayer-playing-at-the-same-time" class="headerlink" title="You can have many instances of AVPlayer playing at the same time"></a>You can have many instances of AVPlayer playing at the same time</h2><h3 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h3><ol>
<li><a href="https://developer.apple.com/library/mac/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html" target="_blank" rel="noopener">AV Foundation Programming Guide</a></li>
<li><a href="https://developer.apple.com/videos/wwdc/2011/" target="_blank" rel="noopener">WWDC 2011 Session 405 Exploring AV Foundation</a></li>
<li><a href="https://developer.apple.com/videos/wwdc/2011/" target="_blank" rel="noopener">WWDC 2011 Session 415 Working With Media In AV Foundation</a></li>
<li><a href="https://developer.apple.com/videos/wwdc/2014/" target="_blank" rel="noopener">WWDC 2014 Session 503 Mastering Modern Media Playback</a></li>
<li><a href="https://developer.apple.com/videos/wwdc/2011/" target="_blank" rel="noopener">WWDC 2011 Session 406 AirPlay and External Displays in iOS apps</a></li>
<li><a href="https://developer.apple.com/library/ios/samplecode/AVPlayerDemo/Introduction/Intro.html" target="_blank" rel="noopener">AVPlayerDemo</a></li>
<li><a href="https://github.com/viki-org/VKVideoPlayer" target="_blank" rel="noopener">VKVideoPlayer</a></li>
<li><a href="https://github.com/alobi/ALMoviePlayerController" target="_blank" rel="noopener">ALMoviePlayerController</a></li>
<li><a href="http://mobiliture.com/ios/tutorials/av-foundation-playing-videos/" target="_blank" rel="noopener">AV Foundation Playing Videos</a></li>
<li><a href="http://stackoverflow.com/questions/8146942/avplayer-and-mpmovieplayercontroller-differences" target="_blank" rel="noopener">AVPlayer and MPMoviePlayerController differences</a></li>
<li><a href="http://jomnius.blogspot.com/2011/04/mpmovieplayer-tips.html" target="_blank" rel="noopener">MPMoviePlayer Tips</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-04-17T05:56:24.000Z" title="2019-04-17T05:56:24.000Z">2019-04-17</time><span class="level-item">7 minutes read (About 999 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-reachability-in-iOS/">How to handle reachability in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/209" target="_blank" rel="noopener">#209</a></strong></p>
<p>Here are what I learn about reachability handling in iOS, aka checking for internet connection. Hope you will find it useful, too.</p>
<p>This post starts with techniques from Objective age, but many of the concepts still hold true</p>
<h2 id="The-naive-way"><a href="#The-naive-way" class="headerlink" title="The naive way"></a>The naive way</h2><p>Some API you already know in UIKit can be used for checking internet connection. Most of them are synchronous code, so you ‘d better call them in a background thread</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)connectedToInternet</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *string = [<span class="built_in">NSString</span> stringWithContentsOfURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://www.google.com"</span>]</span><br><span class="line">                                                encoding:<span class="built_in">NSUTF8StringEncoding</span></span><br><span class="line">                                                   error:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> string ? <span class="literal">YES</span> : <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)connectedToInternet</span><br><span class="line">&#123;</span><br><span class="line">   <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://www.google.com"</span>];</span><br><span class="line">   <span class="built_in">NSMutableURLRequest</span> *request = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:url];</span><br><span class="line">   [request setHTTPMethod:<span class="string">@"HEAD"</span>];</span><br><span class="line">   <span class="built_in">NSHTTPURLResponse</span> *response;</span><br><span class="line">   [<span class="built_in">NSURLConnection</span> sendSynchronousRequest:request returningResponse:&amp;response error: <span class="literal">NULL</span>];</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> ([response statusCode] == <span class="number">200</span>) ? <span class="literal">YES</span> : <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Using-SystemConfiguration-framework"><a href="#Using-SystemConfiguration-framework" class="headerlink" title="Using SystemConfiguration framework"></a>Using SystemConfiguration framework</h2><p>After importing the SystemConfiguration framework, you can use either SCNetworkReachabilityGetFlags to synchronously get the reachability status, or provide a callback to SCNetworkReachabilitySetCallback to be notified about reachability status change.</p>
<p>Note that <code>SCNetworkReachabilityGetFlags</code> is synchronous.</p>
<blockquote>
<p>The System Configuration framework reachability API () operates synchronously by default. Thus, seemingly innocuous routines like SCNetworkReachabilityGetFlags can get you killed by the watchdog. If you’re using the reachability API, you should use it asynchronously. This involves using the SCNetworkReachabilityScheduleWithRunLoop routine to schedule your reachability queries on the run loop</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>) isConnectionAvailable</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">SCNetworkReachabilityFlags</span> flags;</span><br><span class="line">        <span class="built_in">BOOL</span> receivedFlags;</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">SCNetworkReachabilityRef</span> reachability = <span class="built_in">SCNetworkReachabilityCreateWithName</span>(<span class="built_in">CFAllocatorGetDefault</span>(), [<span class="string">@"dipinkrishna.com"</span> UTF8String]);</span><br><span class="line">        receivedFlags = <span class="built_in">SCNetworkReachabilityGetFlags</span>(reachability, &amp;flags);</span><br><span class="line">        <span class="built_in">CFRelease</span>(reachability);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (!receivedFlags || (flags == <span class="number">0</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">TRUE</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Note that SCNetworkReachabilitySetCallback notifies only when reachability status changes</p>
<blockquote>
<p>Assigns a client to the specified target, which receives callbacks when the reachability of the target changes</p>
</blockquote>
<h2 id="Using-some-libraries"><a href="#Using-some-libraries" class="headerlink" title="Using some libraries"></a>Using some libraries</h2><p>Libraries make our life easier, but to live well with them, you must surely understand them. There are many reachability libraries on Github, but here I want to mention the most popular: Reachability from tonymillion and AFNetworkReachabilityManager (a submodule of AFNetworking) from mattt. Both use SystemConfiguration under the hood.</p>
<h2 id="Reachability"><a href="#Reachability" class="headerlink" title="Reachability"></a>Reachability</h2><p>Some people use Reachability like this</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)testInternetConnection</span><br><span class="line">&#123;   </span><br><span class="line">    internetReachableFoo = [Reachability reachabilityWithHostname:<span class="string">@"www.google.com"</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Internet is reachable</span></span><br><span class="line">    internetReachableFoo.reachableBlock = ^(Reachability*reach)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Update the UI on the main thread</span></span><br><span class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Yayyy, we have the interwebs!"</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Internet is not reachable</span></span><br><span class="line">    internetReachableFoo.unreachableBlock = ^(Reachability*reach)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Update the UI on the main thread</span></span><br><span class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Someone broke the internet :("</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    [internetReachableFoo startNotifier];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Looking into the method “startNotifier”, you will see that it only uses SCNetworkReachabilitySetCallback and it means this callback will only be called if reachability status changes.</p>
<p>If you want to know the reachability status directly, for example, the reachability status at app launch, you must use the method “isReachable”. This method under the hood uses SCNetworkReachabilityGetFlags which is synchronous, and it locks the calling thread.</p>
<p>Reachability has reachabilityForLocalWiFi, which is interesting :)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+(Reachability*)reachabilityForLocalWiFi</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">struct</span> sockaddr_in localWifiAddress;</span><br><span class="line">    bzero(&amp;localWifiAddress, <span class="keyword">sizeof</span>(localWifiAddress));</span><br><span class="line">    localWifiAddress.sin_len            = <span class="keyword">sizeof</span>(localWifiAddress);</span><br><span class="line">    localWifiAddress.sin_family         = AF_INET;</span><br><span class="line">    <span class="comment">// IN_LINKLOCALNETNUM is defined in &lt;netinet/in.h&gt; as 169.254.0.0</span></span><br><span class="line">    localWifiAddress.sin_addr.s_addr    = htonl(IN_LINKLOCALNETNUM);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> reachabilityWithAddress:&amp;localWifiAddress];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="AFNetworkReachabilityManager"><a href="#AFNetworkReachabilityManager" class="headerlink" title="AFNetworkReachabilityManager"></a>AFNetworkReachabilityManager</h2><p>With AFNetworkReachabilityManager, all you have to do is</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)trackInternetConnection</span><br><span class="line">&#123;</span><br><span class="line">    [[AFNetworkReachabilityManager sharedManager] startMonitoring];</span><br><span class="line">    [[AFNetworkReachabilityManager sharedManager] setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) &#123;</span><br><span class="line">        <span class="comment">// Handle the status</span></span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>What is nice about AFNetworkReachabilityManager is that in the “startMonitoring” method, it both uses SCNetworkReachabilitySetCallback and calls AFNetworkReachabilityStatusForFlags to get the initial reachability status in a background thread, and calls the AFNetworkReachabilityStatusBlock. So in the user ‘s point of view, all we care about is the AFNetworkReachabilityStatusBlock handler.</p>
<p>AFNetworking has all the features that Reachability has, and its code is well structured. Another cool thing about it is that it is already in your AFNetworking pod. It’s hard to find projects without AFNetworking these days</p>
<h2 id="isReachableViaWWAN-vs-isReachableViaWiFi"><a href="#isReachableViaWWAN-vs-isReachableViaWiFi" class="headerlink" title="isReachableViaWWAN vs isReachableViaWiFi"></a>isReachableViaWWAN vs isReachableViaWiFi</h2><p>Take a look at the method AFNetworkReachabilityStatusForFlags and you will know the story</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> AFNetworkReachabilityStatus AFNetworkReachabilityStatusForFlags(<span class="built_in">SCNetworkReachabilityFlags</span> flags) &#123;</span><br><span class="line">    [...]</span><br><span class="line">    status = AFNetworkReachabilityStatusUnknown;</span><br><span class="line">    <span class="keyword">if</span> (isNetworkReachable == <span class="literal">NO</span>) &#123;</span><br><span class="line">        status = AFNetworkReachabilityStatusNotReachable;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#if	TARGET_OS_IPHONE</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ((flags &amp; kSCNetworkReachabilityFlagsIsWWAN) != <span class="number">0</span>) &#123;</span><br><span class="line">        status = AFNetworkReachabilityStatusReachableViaWWAN;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        status = AFNetworkReachabilityStatusReachableViaWiFi;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>isReachableViaWWAN</code> is supposed to be for iOS Device</p>
<h2 id="How-to-use-AFNetworkReachabilityManager"><a href="#How-to-use-AFNetworkReachabilityManager" class="headerlink" title="How to use AFNetworkReachabilityManager"></a>How to use AFNetworkReachabilityManager</h2><p>I’ve asked a question here <a href="https://github.com/AFNetworking/AFNetworking/issues/2262" target="_blank" rel="noopener">Issue 2262</a>, you should take a look at it</p>
<p>The safe way is not to use the sharedManager, but use managerForDomain</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">AFNetworkReachabilityManager *afReachability = [AFNetworkReachabilityManager managerForDomain:<span class="string">@"www.google.com"</span>];</span><br><span class="line">    [afReachability setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) &#123;</span><br><span class="line">        <span class="keyword">if</span> (status &lt; AFNetworkReachabilityStatusReachableViaWWAN) &#123;</span><br><span class="line">            [FTGAlertView showMessage:<span class="string">@"No internet connection"</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    [afReachability startMonitoring];</span><br></pre></td></tr></table></figure>

<p>You should read the question 7 and 8 in the Reference below to know more about SCNetworkReachabilityCreateWithName vs SCNetworkReachabilityCreateWithAddress, and about the zero address</p>
<h2 id="Reachability-swift"><a href="#Reachability-swift" class="headerlink" title="Reachability.swift"></a>Reachability.swift</h2><p>In Swift, there is this popular <a href="https://github.com/ashleymills/Reachability.swift" target="_blank" rel="noopener">Reachability.swift</a> to check for network reachability status</p>
<h2 id="Connectivity"><a href="#Connectivity" class="headerlink" title="Connectivity"></a>Connectivity</h2><p>Sometimes, a more robust way is just to ping certain servers, that how’s <a href="https://github.com/rwbutler/Connectivity" target="_blank" rel="noopener">Connectivy</a> works</p>
<p>Also, read more <a href="https://medium.com/@rwbutler/solving-the-captive-portal-problem-on-ios-9a53ba2b381e" target="_blank" rel="noopener">Solving the Captive Portal Problem on iOS</a></p>
<blockquote>
<p>In order to detect that it has connected to a Wi-Fi network with a captive portal, iOS contacts a number of endpoints hosted by Apple — an example being <a href="https://www.apple.com/library/test/success.html" target="_blank" rel="noopener">https://www.apple.com/library/test/success.html</a>. Each endpoint hosts a small HTML page of the form:</p>
</blockquote>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ol>
<li><a href="https://github.com/tonymillion/Reachability" target="_blank" rel="noopener">Reachability</a></li>
<li><a href="https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFNetworkReachabilityManager.m" target="_blank" rel="noopener">AFNetworkReachabilityManager</a></li>
<li><a href="http://stackoverflow.com/questions/24535842/how-to-check-for-internet-connection-synchronously/25133851#25133851" target="_blank" rel="noopener">How to check for internet connection synchronously?</a></li>
<li><a href="http://dipinkrishna.com/blog/2012/04/ios-check-internet-connection/" target="_blank" rel="noopener">iOS: Check whether internet connection is available</a></li>
<li><a href="http://ios-blog.co.uk/tutorials/check-if-active-internet-connection-exists-on-ios-device/" target="_blank" rel="noopener">Check if Active Internet Connection Exists on iOS Device</a></li>
<li><a href="https://developer.apple.com/library/ios/qa/qa1693/_index.html" target="_blank" rel="noopener">Technical Q&amp;A QA1693 Synchronous Networking On The Main Thread</a></li>
<li><a href="http://stackoverflow.com/a/11314946/1418457" target="_blank" rel="noopener">How to check for network reachability on iOS in a non-blocking manner?</a></li>
<li><a href="http://stackoverflow.com/questions/16508685/understanding-inaddr-any-for-socket-programming-c" target="_blank" rel="noopener">understanding INADDR_ANY for socket programming - c</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-04-03T06:50:01.000Z" title="2019-04-03T06:50:01.000Z">2019-04-03</time><span class="level-item">a few seconds read (About 78 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-cancel-DispatchWorkItem-and-NSOperation/">How to cancel DispatchWorkItem and NSOperation</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/194" target="_blank" rel="noopener">#194</a></strong></p>
<h3 id="DispatchWorkItem"><a href="#DispatchWorkItem" class="headerlink" title="DispatchWorkItem"></a><code>DispatchWorkItem</code></h3><ul>
<li><a href="https://stackoverflow.com/questions/48844169/swift-ios-dispatchworkitem-is-still-running-even-though-its-getting-cancelled" target="_blank" rel="noopener">https://stackoverflow.com/questions/48844169/swift-ios-dispatchworkitem-is-still-running-even-though-its-getting-cancelled</a></li>
<li><a href="https://stackoverflow.com/questions/29492707/how-to-stop-cancel-suspend-resume-tasks-on-gcd-queue" target="_blank" rel="noopener">https://stackoverflow.com/questions/29492707/how-to-stop-cancel-suspend-resume-tasks-on-gcd-queue</a></li>
</ul>
<h3 id="NSOperation"><a href="#NSOperation" class="headerlink" title="NSOperation"></a><code>NSOperation</code></h3><ul>
<li><a href="https://developer.apple.com/documentation/foundation/nsoperation/1411672-cancel?language=objc" target="_blank" rel="noopener">https://developer.apple.com/documentation/foundation/nsoperation/1411672-cancel?language=objc</a></li>
</ul>
<h3 id="Grand-Central-Dispatch-vs-NSOperation"><a href="#Grand-Central-Dispatch-vs-NSOperation" class="headerlink" title="Grand Central Dispatch vs NSOperation"></a>Grand Central Dispatch vs NSOperation</h3><ul>
<li><a href="https://stackoverflow.com/questions/43226434/2017-swift-3-1-gcd-vs-nsoperation" target="_blank" rel="noopener">https://stackoverflow.com/questions/43226434/2017-swift-3-1-gcd-vs-nsoperation</a></li>
<li><a href="https://medium.com/@johnsundell/a-deep-dive-into-grand-central-dispatch-in-swift-dead7f6e1ca7" target="_blank" rel="noopener">https://medium.com/@johnsundell/a-deep-dive-into-grand-central-dispatch-in-swift-dead7f6e1ca7</a></li>
</ul>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/tags/iOS/page/3/">Previous</a></div><div class="pagination-next"><a href="/tags/iOS/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/tags/iOS/">1</a></li><li><a class="pagination-link" href="/tags/iOS/page/2/">2</a></li><li><a class="pagination-link" href="/tags/iOS/page/3/">3</a></li><li><a class="pagination-link is-current" href="/tags/iOS/page/4/">4</a></li><li><a class="pagination-link" href="/tags/iOS/page/5/">5</a></li><li><a class="pagination-link" href="/tags/iOS/page/6/">6</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">594</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">52</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-28T10:56:09.000Z">2020-04-28</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-webpack-to-bundle-html-css-js/">How to use webpack to bundle html css js</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-28T07:23:52.000Z">2020-04-28</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-assert-asynchronously-in-XCTest/">How to assert asynchronously in XCTest</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-27T20:01:47.000Z">2020-04-27</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-simple-filter-menu-in-css/">How to make simple filter menu in css</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-26T16:53:52.000Z">2020-04-26</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-simple-grid-gallery-in-css/">How to make simple grid gallery in css</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-26T02:57:51.000Z">2020-04-26</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-add-independent-page-in-hexo/">How to add independent page in hexo</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">42</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">48</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">35</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">158</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">40</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">97</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">268</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">49</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2020 Khoa Pham</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>