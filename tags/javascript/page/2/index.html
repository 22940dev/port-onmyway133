<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Tag: javascript - onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">javascript</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-03T09:53:16.000Z" title="2019-09-03T09:53:16.000Z">2019-09-03</time><span class="level-item">a minute read (About 131 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-safely-access-deeply-nested-object-in-Javascript/">How to safely access deeply nested object in Javascript</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/390">#390</a></strong></p>
<p>An object ‘s property can be null or undefined.</p>
<p>Accessing step by step is tedious</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">props.user &amp;&amp;</span><br><span class="line">props.user.posts &amp;&amp;</span><br><span class="line">props.user.posts[<span class="number">0</span>] &amp;&amp;</span><br><span class="line">props.user.posts[<span class="number">0</span>].comments</span><br></pre></td></tr></table></figure>

<p>Dynamic parsing path is too clever and involves string in the end, which is a no no</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">get</span> = (p, o) =&gt;</span><br><span class="line">  p.reduce((xs, x) =&gt; (xs &amp;&amp; xs[x]) ? xs[x] : null, o)</span><br><span class="line"></span><br><span class="line">const getUserComments = <span class="keyword">get</span>(['user', 'posts', 0, 'comments'])</span><br></pre></td></tr></table></figure>

<p>Instead let’s use function and catch errors explicitly, and defaults with a fallback</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">get</span>: (f, defaultValue) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      	<span class="keyword">const</span> value = f()</span><br><span class="line">      	<span class="keyword">if</span> (isNotNullOrUndefined(value)) &#123;</span><br><span class="line">        	<span class="keyword">return</span> value</span><br><span class="line">      	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> defaultValue</span><br><span class="line">      	&#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">     	<span class="keyword">return</span> defaultValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> comments = <span class="keyword">get</span>(() =&gt; &#123; .user.posts[<span class="number">0</span>].comments &#125;, [])</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://medium.com/javascript-inside/safely-accessing-deeply-nested-values-in-javascript-99bf72a0855a">https://medium.com/javascript-inside/safely-accessing-deeply-nested-values-in-javascript-99bf72a0855a</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-03T09:46:41.000Z" title="2019-09-03T09:46:41.000Z">2019-09-03</time><span class="level-item">a minute read (About 136 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-flow-type-in-Javascript/">How to use flow type in Javascript</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/389">#389</a></strong></p>
<p>Prefer <a href="https://flow.org/">flow</a> over TypeScript for simplicity</p>
<p>Javascript primitive types <code>number</code> and <code>string</code> are too general and do not express the domain objects. Because lack of type alias in Javascript, we can use flow</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> type Centimeter = number</span><br><span class="line"><span class="keyword">export</span> type Color = string</span><br><span class="line"><span class="keyword">export</span> type ImageSource = number</span><br><span class="line"><span class="keyword">export</span> type Kilogram = number</span><br><span class="line"><span class="keyword">export</span> type Kilocalorie = number <span class="comment">// 1 cal = 4.1840 J</span></span><br><span class="line"><span class="keyword">export</span> type Second = number</span><br><span class="line"><span class="keyword">export</span> type SecondsSince1970 = number</span><br><span class="line"><span class="keyword">export</span> type Minute = number</span><br><span class="line"><span class="keyword">export</span> type DateString = string <span class="comment">// 2018-11-20</span></span><br><span class="line"><span class="keyword">export</span> type DateTimeString = string <span class="comment">// 2018-11-20T00:00:00</span></span><br><span class="line"><span class="keyword">export</span> type YearWeekString = string <span class="comment">// 201838</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type FunctionWithVoid = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">void</span></span><br><span class="line"><span class="keyword">export</span> type FunctionWithString = <span class="function">(<span class="params">string</span>) =&gt;</span> <span class="keyword">void</span></span><br><span class="line"><span class="keyword">export</span> type FunctionWithBoolean = <span class="function">(<span class="params">boolean</span>) =&gt;</span> <span class="keyword">void</span></span><br><span class="line"><span class="keyword">export</span> type FunctionWithNumber = <span class="function">(<span class="params">number</span>) =&gt;</span> <span class="keyword">void</span></span><br><span class="line"><span class="keyword">export</span> type JSONObject = any</span><br><span class="line"><span class="keyword">export</span> type JSONString = string</span><br><span class="line"><span class="keyword">export</span> type StringToString = any</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type Degree = number</span><br><span class="line"><span class="keyword">export</span> type Radian = number</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type Animal = <span class="string">'cat'</span> | <span class="string">'dog'</span> | <span class="string">'cow'</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-08-12T04:44:36.000Z" title="2019-08-12T04:44:36.000Z">2019-08-12</time><span class="level-item">a minute read (About 122 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-React-JSX-with-Babel-in-Electron/">How to use React JSX with Babel in Electron</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/352">#352</a></strong></p>
<p>For a normal electron app created with <code>npm init</code>, we can use all features of ES6, but not the JSX syntax for React. We can use just Babel to transpile JSX, as used in <a href="https://github.com/onmyway133/IconGenerator/blob/master/.babelrc">IconGenerator</a></p>
<p><code>.babelrc</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"transform-react-jsx-source"</span>    </span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"react"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And in <code>package.json</code>, call babel to transpile <code>src</code> to <code>dist</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"main"</span>: <span class="string">"dist/main.js"</span>,</span><br><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"npm run babel &amp;&amp; electron ."</span>,</span><br><span class="line">    <span class="string">"babel"</span>: <span class="string">"babel ./src --out-dir ./dist --copy-files"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>Remember to use <code>dist/main.js</code> as our starting point, and in <a href="https://github.com/onmyway133/IconGenerator/blob/master/index.html">index.html</a>, specify <code>./dist/renderer.js</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">require</span>(<span class="string">'./dist/renderer.js'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-07-31T18:19:25.000Z" title="2019-07-31T18:19:25.000Z">2019-07-31</time><span class="level-item">3 minutes read (About 459 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-submit-electron-app-to-AppStore/">How to submit electron app to AppStore</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/342">#342</a></strong></p>
<h2 id="Before"><a href="#Before" class="headerlink" title="Before"></a>Before</h2><p>Install electron as dev <code>npm install electron --save-dev</code><br>Update electron-packager <code>npm install electron-packager@latest --save-dev</code><br>Use no space in app name</p>
<h2 id="Package-with-electron-packager"><a href="#Package-with-electron-packager" class="headerlink" title="Package with electron-packager"></a>Package with electron-packager</h2><p>Follow <a href="https://github.com/electron/electron-osx-sign/wiki/Packaging-and-Submitting-an-Electron-App-to-the-Mac-App-Store">https://github.com/electron/electron-osx-sign/wiki/Packaging-and-Submitting-an-Electron-App-to-the-Mac-App-Store</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx electron-packager . <span class="string">"MyApp"</span> --app-bundle-id=com.onmyway133.MyApp --helper-bundle-id=com.onmyway133.MyApp.helper --app-version=1.4.0 --build-version=1.0.100 --platform=mas --arch=x64 --icon=Icon/Icon.icns --overwrite</span><br><span class="line">npx electron-osx-sign <span class="string">"MyApp-mas-x64/MyApp.app"</span> --verbose</span><br><span class="line">npx electron-osx-flat <span class="string">"MyApp-mas-x64/MyApp.app"</span> --verbose</span><br></pre></td></tr></table></figure>

<h3 id="If-you-have-multiple-developer-identities-in-your-keychain"><a href="#If-you-have-multiple-developer-identities-in-your-keychain" class="headerlink" title="If you have multiple developer identities in your keychain:"></a>If you have multiple developer identities in your keychain:</h3><blockquote>
<p>electron-osx-sign searches your keychain for the first signing certificates that it can locate. If you have multiple certificates then it may not know which cert you want to use for signing and you need to explicitly provide the name:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">electron-osx-sign &quot;My App-mas-x64&#x2F;My App.app&quot; --identity&#x3D;&quot;3rd Party Mac Developer Application: My Company, Inc (ABCDEFG1234)&quot; --verbose</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><h5 id="Sign-with-electron-osx-sign"><a href="#Sign-with-electron-osx-sign" class="headerlink" title="Sign with electron-osx-sign"></a>Sign with electron-osx-sign</h5><p>Read README <a href="https://github.com/electron/electron-osx-sign">https://github.com/electron/electron-osx-sign</a></p>
<blockquote>
<p>For distribution in the Mac App Store: Have the provisioning profile for distribution placed in the current working directory and the signing identity installed in the default keychain.</p>
</blockquote>
<h3 id="Certificate"><a href="#Certificate" class="headerlink" title="Certificate"></a>Certificate</h3><p>On developer.apple.com, create Mac App Distribution certificate. Make sure when we download in Keychain Access, it has associated private key</p>
<h3 id="Manually-upload"><a href="#Manually-upload" class="headerlink" title="Manually upload"></a>Manually upload</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;Applications&#x2F;Xcode.app&#x2F;Contents&#x2F;Applications&#x2F;Application\ Loader.app&#x2F;Contents&#x2F;itms&#x2F;bin&#x2F;iTMSTransporter -m upload  -assetFile MyApp&#x2F;MyApp.pkg  -u onmyway133@gmail.com -p mypassword</span><br></pre></td></tr></table></figure>

<h3 id="Use-Application-Loader"><a href="#Use-Application-Loader" class="headerlink" title="Use Application Loader"></a>Use Application Loader</h3><p>Use <a href="https://support.apple.com/en-us/HT204397">Using app-specific passwords</a></p>
<h3 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h3><h4 id="electron-Bad-CFBundleExecutable-Cannot-find-executable-file"><a href="#electron-Bad-CFBundleExecutable-Cannot-find-executable-file" class="headerlink" title="electron Bad CFBundleExecutable. Cannot find executable file"></a>electron Bad CFBundleExecutable. Cannot find executable file</h4><blockquote>
<p>ERROR ITMS-90261: “Bad CFBundleExecutable. Cannot find executable file that matches the value of CFBundleExecutable in the nested bundle MyApp [com.onmyway133.MyApp.pkg/Payload/MyApp.app/Contents/Frameworks/MyApp (GPU).app] property list file.”</p>
</blockquote>
<p><a href="https://github.com/electron/electron-packager/issues?utf8=%E2%9C%93&amp;q=helper">https://github.com/electron/electron-packager/issues?utf8=%E2%9C%93&amp;q=helper</a></p>
<p>Try electron 5.0.0 <code>npm install electron@5.0.0 --save-dev</code></p>
<h4 id="Specifically-we-found-that-when-the-user-closes-the-main-application-window-there-is-no-menu-item-to-re-open-it"><a href="#Specifically-we-found-that-when-the-user-closes-the-main-application-window-there-is-no-menu-item-to-re-open-it" class="headerlink" title="Specifically, we found that when the user closes the main application window there is no menu item to re-open it."></a>Specifically, we found that when the user closes the main application window there is no menu item to re-open it.</h4><p><a href="https://stackoverflow.com/questions/35008347/electron-close-w-x-vs-right-click-dock-and-quit">https://stackoverflow.com/questions/35008347/electron-close-w-x-vs-right-click-dock-and-quit</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> application = &#123;</span><br><span class="line">    label: <span class="string">"MyApp"</span>,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123;</span><br><span class="line">        label: <span class="string">"New"</span>,</span><br><span class="line">        accelerator: <span class="string">"Command+N"</span>,</span><br><span class="line">        click: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (win === <span class="literal">null</span>) &#123;</span><br><span class="line">            createWindow()</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="‘electron-osx-flat-latest’-is-not-in-the-npm-registry"><a href="#‘electron-osx-flat-latest’-is-not-in-the-npm-registry" class="headerlink" title="‘electron-osx-flat@latest’ is not in the npm registry"></a>‘electron-osx-flat@latest’ is not in the npm registry</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g electron-osx-sign@latest</span><br></pre></td></tr></table></figure>

<h4 id="App-sandbox-not-enabled"><a href="#App-sandbox-not-enabled" class="headerlink" title="App sandbox not enabled"></a>App sandbox not enabled</h4><h4 id="electron-osx-sign-Command-failed-codesign"><a href="#electron-osx-sign-Command-failed-codesign" class="headerlink" title="electron-osx-sign Command failed: codesign"></a>electron-osx-sign Command failed: codesign</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ran xattr -cr *</span><br></pre></td></tr></table></figure>

<h4 id="Command-failed-codesign-bundle-format-is-ambiguous"><a href="#Command-failed-codesign-bundle-format-is-ambiguous" class="headerlink" title="Command failed: codesign bundle format is ambiguous"></a>Command failed: codesign bundle format is ambiguous</h4><blockquote>
<p>Perhaps you accidentally packaged the previous generated app bundle into your newly packaged app?</p>
</blockquote>
<p>Remove <code>dist</code> folder generated by electron-builder</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-25T09:01:49.000Z" title="2019-06-25T09:01:49.000Z">2019-06-25</time><span class="level-item">a minute read (About 127 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-organise-test-files/">How to organise test files</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/327">#327</a></strong></p>
<p>In terms of tests, we usually have files for unit test, UI test, integeration test and mock.</p>
<blockquote>
<p>Out of sight, out of mind.</p>
</blockquote>
<p>Unit tests are for checking specific functions and classes, it’s more convenient to browse them side by side with source file. For example in Javascript, Kotlin and Swift</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index.js</span><br><span class="line">index.test.js</span><br><span class="line">index.mock.js</span><br></pre></td></tr></table></figure>

<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LocationManager.kt</span><br><span class="line">LocationManager.mock.kt</span><br><span class="line">LocationManager.test.kt</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BasketHandler</span>.swift</span><br><span class="line"><span class="type">BasketHandler</span>.mock.swift</span><br><span class="line"><span class="type">BasketHandler</span>.test.swift</span><br></pre></td></tr></table></figure>

<p>Integration tests check features or sub features, and may cover many source files, it’s better to place them in <code>feature</code> folders</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- Features</span><br><span class="line">  - Cart</span><br><span class="line">    - Sources</span><br><span class="line">    - Tests</span><br><span class="line">      - Cart.test.swift</span><br><span class="line">      - Validator.test.swift</span><br><span class="line">  - Profile</span><br><span class="line">    - Sources</span><br><span class="line">    - Tests</span><br><span class="line">      - Updater.test.swift</span><br><span class="line">      - AvatarUploader.test.swift</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:25:54.000Z" title="2019-05-23T16:25:54.000Z">2019-05-23</time><span class="level-item">9 minutes read (About 1409 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/What-is-create-react-native-app/">What is create-react-native-app</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/279">#279</a></strong></p>
<p>Original post <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3</a></p>
<hr>
<p>As someone who comes to React Native from iOS and Android background, I like React and Javascript as much as I like Swift and Kotlin. React Native is a cool concept, but things that sound good in theory may not work well in practice.</p>
<h2 id="Another-layer-of-abstraction"><a href="#Another-layer-of-abstraction" class="headerlink" title="Another layer of abstraction"></a>Another layer of abstraction</h2><p>Up until now, I still don’t get why big companies choose React Native over native ones, as in the end what we do is to deliver good experience to the end user, not the easy development for developers. I have seen companies saying <a href="https://medium.com/airbnb-engineering/react-native-at-airbnb-f95aa460be1c">goodbye</a> to React Native and people saying that React Native is just React philosophy <a href="https://ashfurrow.com/blog/airbnb-and-react-native-expectations/">learn once, write anywhere</a>, that they choose React Native mainly for the React style, not for cross platform development. But the fact can’t be denied that people choose React Native mostly for cross platform development. Write once, deploy many places is so compelling. We still of course need to tweak a bit for each platform, but most of the code is reuse.</p>
<p>I have to confess that I myself spend less time developing than digging into compiling and bundling issues. Nothing comes for free. To be successful with React Native, not only we need strong understanding on both iOS and Android, but also ready to step into solving issues. We can’t just open issues, pray and wait and hope someone solves it. We can’t just use other dependencies blindly and call it a day. A trivial bug can be super hard to fix in React Native, and our projects can’t wait. Big companies have, of course, enough resource to solve issues, but for small teams, React Native is a trade off decision to consider.</p>
<h2 id="A-wrapper-for-a-wrapper"><a href="#A-wrapper-for-a-wrapper" class="headerlink" title="A wrapper for a wrapper"></a>A wrapper for a wrapper</h2><p>Enough about that. Let’s go to official React Native <a href="https://facebook.github.io/react-native/docs/getting-started.html">getting started guide</a>. It recommend <a href="https://github.com/react-community/create-react-native-app">create-react-native-app</a>. As someone who made electron.js apps and used <a href="https://github.com/facebook/create-react-app">create-react-app</a>, I choose <a href="https://github.com/react-community/create-react-native-app">create-react-native-app</a> right away, as I think it is the equivalent in terms of creating React Native apps. I know there is react-native init and though that it must have some problems, otherwise people don’t introduce <a href="https://github.com/react-community/create-react-native-app">create-react-native-app</a>.</p>
<p>After playing with <a href="https://github.com/react-community/create-react-native-app">create-react-native-app</a> and eject, and after that read carefully through its <a href="https://facebook.github.io/react-native/docs/getting-started.html#caveats">caveats</a>, I know it’s time to use just react-native init . In the end I just need a quick way to bootstrap React Native app with enough tooling (Babel, JSX, Hot reloading), however <a href="https://github.com/react-community/create-react-native-app">create-react-native-app</a> is just a limited experience in Expo with opinionated services like Expo push notification <a href="https://docs.expo.io/versions/latest/guides/push-notifications.html">docs.expo.io/versions/latest/guides/push-notifications.html</a> and connectivity to Google Cloud Platform and AWS. I know every thing has its use case, but in this case it’s not the tool for me. Dependencies are the root of all evils, and React Native already has a lot, I don’t want more unnecessary things.</p>
<p>The concept of Expo is actually nice, in that it allows newbie to step into React Native fast with recommended tooling already set up, and the ability to reject later. It also useful in sharing Snack to help reproduce issues. But the name of the repo create-react-native-app is a bit <a href="https://github.com/react-community/create-react-native-app/issues/742">misleading</a>.</p>
<p>Maybe it’s just me, or …</p>
<ul>
<li><p><a href="https://dev.to/kylessg/ive-released-over-100-apps-in-react-native-since-2015-ask-me-anything-1m9g">dev.to/kylessg/ive-released-over-100-apps-in-react-native-since-2015-ask-me-anything-1m9g</a></p>
<blockquote>
<p><em>No, I would never use Expo for a serious project. I imagine what ends up happening in most projects is they reach a point where they have to ultimately eject the app (e.g. needing a native module) which sounds very painful.</em></p>
</blockquote>
</li>
<li><p><a href="https://dev.to/gaserd/why-i-do-not-use-expo-for-react-native-dont-panic-1bp">dev.to/gaserd/why-i-do-not-use-expo-for-react-native-dont-panic-1bp</a></p>
<blockquote>
<p><em>If you use EXPO, you use wrapper-wrapper.</em></p>
</blockquote>
</li>
<li><p><a href="https://hackernoon.com/understanding-expo-for-react-native-7bf23054bbcd">hackernoon.com/understanding-expo-for-react-native-7bf23054bbcd</a></p>
<blockquote>
<p><em>Expo is a great tool for getting started quickly with React Native. However, it’s not always something that can get you to the finish line. From what I’ve seen, the Expo team is making a lot of great decisions with their product roadmap. But their rapid pace of development has often led to bugs in new features.</em></p>
</blockquote>
</li>
<li><p><a href="https://docs.expo.io/versions/latest/introduction/why-not-expo">docs.expo.io/versions/latest/introduction/why-not-expo</a></p>
<blockquote>
<p><em>JS and assets managed by Expo require connectivity to Google Cloud Platform and AWS</em></p>
</blockquote>
</li>
<li><p><a href="https://github.com/react-community/create-react-native-app/issues/516">#516</a></p>
</li>
<li><p><a href="http://www.albertgao.xyz/2018/05/30/24-tips-for-react-native-you-probably-want-to-know/">http://www.albertgao.xyz/2018/05/30/24-tips-for-react-native-you-probably-want-to-know</a></p>
<blockquote>
<p><em>If you are coming from web world, you need to know that create-react-native-app is not the create-react-app equivalent</em><br><em>But if you want more control over your project, something like tweaking your react native Android and iOS project, I highly suggest you use the official react-native-cli. Still, one simple command, react-native init ProjectName, and you are good to go.</em></p>
</blockquote>
</li>
<li><p><a href="https://medium.com/@paulsc/react-native-first-impressions-expo-vs-native-9565cce44c92">medium.com/@paulsc/react-native-first-impressions-expo-vs-native-9565cce44c92</a></p>
<blockquote>
<p><em>I wish I would have used “Native” from the get go, instead I wasted quite a bit of time with Expo</em><br><em>Maybe the biggest one for me is that the whole thing feels like adding another layer of indirection and complexity to an already complicated stack</em><br><em>I wish Expo would get removed from the react-native Getting Started guide to avoid confusing new arrivals</em></p>
</blockquote>
</li>
<li><p><a href="https://levelup.gitconnected.com/how-i-ditched-expo-for-pure-react-native-fc0375361307">levelup.gitconnected.com/how-i-ditched-expo-for-pure-react-native-fc0375361307</a></p>
<blockquote>
<p><em>The Expo dev team did a lot of good stuff there, and they are all doing it for free, so I definitely want to thank all of them for providing a smoother entrance to this world. If they ever manage to solve this issue of custom native code somehow, it may become my platform of choice again.</em></p>
</blockquote>
</li>
<li><p><a href="https://medium.com/@aswinmohanme/how-i-reduced-the-size-of-my-react-native-app-by-86-27be72bba640">https://medium.com/@aswinmohanme/how-i-reduced-the-size-of-my-react-native-app-by-86-27be72bba640</a></p>
<blockquote>
<p>I love everything about Expo except the size of the binaries. Each binary weighs around 25 MB regardless of your app.<br>So the first thing I did was to migrate my existing Expo app to React Native.</p>
</blockquote>
</li>
<li><p><a href="https://medium.com/react-native-training/best-practices-for-creating-react-native-apps-part-1-66311c746df3">https://medium.com/react-native-training/best-practices-for-creating-react-native-apps-part-1-66311c746df3</a></p>
<blockquote>
<p>If you are new to React Native and you think this is the “must” way to go. Check if it meets your needs first.<br>If you are planning to use third party RN packages that have custom native modules. Expo does not support this functionality and in that case, you will have to <a href="https://docs.expo.io/versions/v30.0.0/expokit/eject">eject Expo-Kit</a>. In my opinion, if you are going to eject any kit, don’t use it in the first place. It will probably make things harder than if you hadn’t used the kit at all.</p>
</blockquote>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:16:04.000Z" title="2019-05-23T16:16:04.000Z">2019-05-23</time><span class="level-item">9 minutes read (About 1347 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-tag-selection-view-in-React-Native/">How to make tag selection view in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/271">#271</a></strong></p>
<p>Original post <a href="https://hackernoon.com/how-to-make-tag-selection-view-in-react-native-b6f8b0adc891">https://hackernoon.com/how-to-make-tag-selection-view-in-react-native-b6f8b0adc891</a></p>
<hr>
<p>Besides React style programming, <a href="https://github.com/facebook/yoga">Yoga</a> is another cool feature of React Native. It is a cross-platform layout engine which implements Flexbox so we use the same layout code for both platforms.</p>
<p>As someone who uses Auto Layout in iOS and Constraint Layout in Android, I find Flexbox bit hard to use at first, but there are many tasks that Flexbox does very well, they are distribute elements in space and flow layout. In this post we will use Flexbox to build a tag selection view using just Javascript code. This is very easy to do so we don’t need to install extra dependencies.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*xLD0YbzaepgAuz7ED-lLGA.png" alt=""></p>
<p>Our tag view will support both multiple selection and exclusive selection. First, we need a custom Button .</p>
<h2 id="Button-with-Background"><a href="#Button-with-Background" class="headerlink" title="Button with Background"></a>Button with Background</h2><p><a href="https://facebook.github.io/react-native/docs/button">Button</a> is of the basic elements in React Native, but it is somewhat limited if we want to have custom content inside the button, for example texts, images and background</p>
<pre><code>import { Button } from &apos;react-native&apos;
...

&lt;Button
  onPress={onPressLearnMore}
  title=&quot;Learn More&quot;
  color=&quot;#841584&quot;
  accessibilityLabel=&quot;Learn more about this purple button&quot;
/&gt;</code></pre><h3 id="TouchableOpacity"><a href="#TouchableOpacity" class="headerlink" title="TouchableOpacity"></a><a href="https://facebook.github.io/react-native/docs/touchableopacity">TouchableOpacity</a></h3><p>Luckily we have <a href="https://facebook.github.io/react-native/docs/touchableopacity">TouchableOpacity</a>, which is a wrapper for making views respond properly to touches. On press down, the opacity of the wrapped view is decreased, dimming it.</p>
<p>To implement button in our tag view, we need to a button with background a check image. Create a file called BackgroundButton.js</p>
<pre><code>import React from &apos;react&apos;
import { TouchableOpacity, View, Text, StyleSheet, Image } from &apos;react-native&apos;
import R from &apos;res/R&apos;

export default class BackgroundButton extends React.Component {
  render() {
    const styles = this.makeStyles()
    return (
      &lt;TouchableOpacity style={styles.touchable} onPress={this.props.onPress}&gt;
        &lt;View style={styles.view}&gt;
          {this.makeImageIfAny(styles)}
          &lt;Text style={styles.text}&gt;{this.props.title}&lt;/Text&gt;
        &lt;/View&gt;
      &lt;/TouchableOpacity&gt;
    )
  }

makeImageIfAny(styles) {
    if (this.props.showImage) {
      return &lt;Image style={styles.image} source={R.images.check} /&gt;
    }
  }

makeStyles() {
    return StyleSheet.create({
      view: {
        flexDirection: &apos;row&apos;,
        borderRadius: 23,
        borderColor: this.props.borderColor,
        borderWidth: 2,
        backgroundColor: this.props.backgroundColor,
        height: 46,
        alignItems: &apos;center&apos;,
        justifyContent: &apos;center&apos;,
        paddingLeft: 16,
        paddingRight: 16
      },
      touchable: {
        marginLeft: 4,
        marginRight: 4,
        marginBottom: 8
      },
      image: {
        marginRight: 8
      },
      text: {
        fontSize: 18,
        textAlign: &apos;center&apos;,
        color: this.props.textColor,
        fontSize: 16
      }
    })
  }
}</code></pre><h3 id="Dynamic-styles"><a href="#Dynamic-styles" class="headerlink" title="Dynamic styles"></a>Dynamic styles</h3><p>Normally we use const styles = StyleSheet.create({}) but since we want our button to be configurable, we make styles into a function, so on every render we get a new styles with proper configurations. The properties we support are borderColor, textColor, backgroundColor and showImage</p>
<p>In the makeImageIfAny we only need to return Image if the view is selected. We don’t have the else case, so in if showImage is false, this returns undefined and React won’t render any element</p>
<pre><code>makeImageIfAny(styles) {
  if (this.props.showImage) {
    return &lt;Image style={styles.image} source={R.images.check} /&gt;
  }
}</code></pre><h3 id="padding-and-margin"><a href="#padding-and-margin" class="headerlink" title="padding and margin"></a>padding and margin</h3><p>To understand padding and margin, visit <a href="https://www.w3schools.com/css/css_boxmodel.asp">CSS Box Model</a>. Basically padding means clearing an area around the content and padding is transparent, while margin means clearing an area outside the border and the margin also is transparent.</p>
<p><img src="https://cdn-images-1.medium.com/max/4572/1*A98Em4msrGqOAWSRq3Njjw.png" alt=""></p>
<p>Pay attention to styles . We have margin for touchable so that each tag button have a little margin outside each other.</p>
<pre><code>touchable: {
  marginLeft: 4,
  marginRight: 4,
  marginBottom: 8
}</code></pre><p>In the view we need flexDirection as row because React Native has flexDirection as column by default. And a row means we have Image and Text side by side horizontally inside the button. We also use alignItems and justifyContent to align elements centeredly on both main and cross axises. The padding is used to have some spaces between the inner text and the view.</p>
<pre><code>view: {
  flexDirection: &apos;row&apos;,
  height: 46,
  alignItems: &apos;center&apos;,
  justifyContent: &apos;center&apos;,
  paddingLeft: 16,
  paddingRight: 16
}</code></pre><h2 id="Tag-View"><a href="#Tag-View" class="headerlink" title="Tag View"></a>Tag View</h2><p>Create a file called TagsView.js This is where we parse tags and show a bunch of BackgroundButton</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Button } from &apos;react-native&apos;
import R from &apos;res/R&apos;
import BackgroundButton from &apos;library/components/BackgroundButton&apos;
import addOrRemove from &apos;library/utils/addOrRemove&apos;

export default class TagsView extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      selected: props.selected
    }
  }

render() {
    return (
      &lt;View style={styles.container}&gt;
        {this.makeButtons()}
      &lt;/View&gt;
    )
  }

onPress = (tag) =&gt; {
    let selected
    if (this.props.isExclusive) {
      selected = [tag]
    } else {
      selected = addOrRemove(this.state.selected, tag)
    }

this.setState({
      selected
    })
  }

makeButtons() {
    return this.props.all.map((tag, i) =&gt; {
      const on = this.state.selected.includes(tag)
      const backgroundColor = on ? R.colors.on.backgroundColor : R.colors.off.backgroundColor
      const textColor = on ? R.colors.on.text : R.colors.off.text
      const borderColor = on ? R.colors.on.border : R.colors.off.border

return (
        &lt;BackgroundButton
          backgroundColor={backgroundColor}
          textColor={textColor}
          borderColor={borderColor}
          onPress={() =&gt; {
            this.onPress(tag)
          }}
          key={i}
          showImage={on}
          title={tag} /&gt;
      )
    })
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    flexDirection: &apos;row&apos;,
    flexWrap: &apos;wrap&apos;,
    padding: 20
  }
})</code></pre><p>We parse an array of tags to build BackgroundButton . We keep the selected array in state because this is mutated inside the TagsView component. If it is isExclusive then the new selected contains just the new selected tag. If it is multiple selection, then we add the new selected tag into the selected array.</p>
<p>The addOrRemove is a our homegrown utility function to add an item into an array if it does not exists, or remove if it exists, using the high orderfilter function.</p>
<pre><code>const addOrRemove = (array, item) =&gt; {
  const exists = array.includes(item)

if (exists) {
    return array.filter((c) =&gt; { return c !== item })
  } else {
    const result = array
    result.push(item)
    return result
  }
}</code></pre><h3 id="Flex-wrap"><a href="#Flex-wrap" class="headerlink" title="Flex wrap"></a>Flex wrap</h3><p>Pay attention to styles</p>
<pre><code>const styles = StyleSheet.create({
  container: {
    flex: 1,
    flexDirection: &apos;row&apos;,
    flexWrap: &apos;wrap&apos;,
    padding: 20
  }
})</code></pre><p>The hero here is flexWrap which specifies whether the flexible items should wrap or not. Take a look at <a href="https://www.w3schools.com/cssref/css3_pr_flex-wrap.asp">CSS flex-wrap</a> property for other options. Since we have main axis as row , element will be wrapped to the next row if there are not enough space. That’s how we can achieve a beautiful tag view.</p>
<h3 id="Using-TagsView"><a href="#Using-TagsView" class="headerlink" title="Using TagsView"></a>Using TagsView</h3><p>Then consuming TagsView is as easy as declare it inside render</p>
<pre><code>const selected = [&apos;Swift&apos;, Kotlin]
const tags = [&apos;Swift&apos;, &apos;Kotlin&apos;, &apos;C#&apos;, &apos;Haskell&apos;, &apos;Java&apos;]

return (
  &lt;TagsView
    all={tags}
    selected={selected}
    isExclusive={false}
  /&gt;
)</code></pre><h3 id="Learning-Flexbox"><a href="#Learning-Flexbox" class="headerlink" title="Learning Flexbox"></a>Learning Flexbox</h3><p>Learning Flebox is crucial in using React and React Native effectively. The best places to learn it are <a href="https://www.w3schools.com/css/css3_flexbox.asp">w3school CSS Flexbox</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">Basic concepts of flexbox</a> by Mozzila.<br><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox"><strong>Basic concepts of flexbox</strong><br><em>The Flexible Box Module, usually referred to as flexbox, was designed as a one-dimensional layout model, and as a…</em>developer.mozilla.org</a></p>
<p>There is a showcase of all possible Flexbox properties<br><a href="https://medium.com/@drorbiran/the-full-react-native-layout-cheat-sheet-a4147802405c"><strong>The Full React Native Layout Cheat Sheet</strong><br><em>A simple visual guide with live examples for all major React Native layout properties</em>medium.com</a></p>
<p>Yoga has its own YogaKit published on CocoaPods, you can learn it with native code in iOS<br><a href="https://www.raywenderlich.com/530-yoga-tutorial-using-a-cross-platform-layout-engine"><strong>Yoga Tutorial: Using a Cross-Platform Layout Engine</strong><br><em>Learn about Yoga, Facebook’s cross-platform layout engine that helps developers write more layout code in style akin to…</em>www.raywenderlich.com</a></p>
<p>And when we use flexbox, we should compose element instead of hardcoding values, for example we can use another View with justifyContent: flex-end to move a button down the screen. This follows flexbox style and prevent rigid code.<br><a href="https://medium.com/react-native-training/position-element-at-the-bottom-of-the-screen-using-flexbox-in-react-native-a00b3790ca42"><strong>Position element at the bottom of the screen using Flexbox in React Native</strong><br><em>React Native uses Yoga to achieve Flexbox style layout, which helps us set up layout in a declarative and easy way.</em>medium.com</a></p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>I hope you learn something useful in this post. For more information please consult the official guide <a href="https://facebook.github.io/react-native/docs/flexbox">Layout with Flexbox</a> and <a href="https://facebook.github.io/react-native/docs/layout-props">layout-props</a> for all the possible Flexbox properties.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:15:30.000Z" title="2019-05-23T16:15:30.000Z">2019-05-23</time><span class="level-item">10 minutes read (About 1528 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Getting-to-know-some-pragmatic-programming-language-features/">Getting to know some pragmatic programming language features</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/270">#270</a></strong></p>
<p>As you know, in the <a href="http://www.amazon.com/The-Pragmatic-Programmer-Journeyman-Master/dp/020161622X">Pragmatic Programmer</a>, section Your Knowledge Portfolio, it is said that</p>
<blockquote>
<p><em>Learn at least one new language every year. Different languages solve the same problems in different ways. By learning several different approaches, you can help broaden your thinking and avoid getting stuck in a rut. Additionally, learning many languages is far easier now, thanks to the wealth of freely available software on the Internet</em></p>
</blockquote>
<p>I see learning programming languages as a chance to open up my horizon and learn some new concepts. It also encourage good habit like immutability, composition, modulation, …</p>
<p>I’d like to review some of the features of all the languages I have played with. Some are useful, some just make me interested or say “wow”</p>
<h3 id="Curly-braces"><a href="#Curly-braces" class="headerlink" title="Curly braces"></a>Curly braces</h3><p>Each language can have its own style of grouping block of code, but I myself like the curly braces the most, which are cute :]</p>
<p>Some like C, Java, Swift, … use curly braces</p>
<p><strong>Swift</strong></p>
<pre><code>init(total: Double, taxPct: Double) {
  self.total = total
  self.taxPct = taxPct
  subtotal = total / (taxPct + 1)
}</code></pre><p>Some like Haskell, Python, … use indentation</p>
<p><strong>Haskell</strong></p>
<pre><code>bmiTell :: (RealFloat a) =&gt; a -&gt; String  
bmiTell bmi  
    | bmi &lt;= 18.5 = &quot;You&apos;re underweight, you emo, you!&quot;  
    | bmi &lt;= 25.0 = &quot;You&apos;re supposedly normal. Pffft, I bet you&apos;re ugly!&quot;  
    | bmi &lt;= 30.0 = &quot;You&apos;re fat! Lose some weight, fatty!&quot;  
    | otherwise   = &quot;You&apos;re a whale, congratulations!&quot;</code></pre><p>Some like Elixir use keyword list</p>
<p><strong>ELixir</strong></p>
<pre><code>if false, do: :this, else: :that</code></pre><h3 id="Named-parameter"><a href="#Named-parameter" class="headerlink" title="Named parameter"></a>Named parameter</h3><p>Language like Objective C, Swift offer named parameter, which make it easier to reason about a function call</p>
<pre><code>func sayHello(to person: String, and anotherPerson: String) -&gt; String {
    return &quot;Hello \(person) and \(anotherPerson)!&quot;
}</code></pre><h3 id="Explicit-type"><a href="#Explicit-type" class="headerlink" title="Explicit type"></a>Explicit type</h3><p>Language like C, Swift, Java, … have type information in parameter and in return, which make it easier to reason about a function call</p>
<p><strong>Swift</strong></p>
<pre><code>func sayHello(personName: String, alreadyGreeted: Bool) -&gt; String {
    if alreadyGreeted {
        return sayHelloAgain(personName)
    } else {
        return sayHello(personName)
    }
}</code></pre><h3 id="List-comprehension"><a href="#List-comprehension" class="headerlink" title="List comprehension"></a>List comprehension</h3><p>Languages like Haskell, Python, Elixir, support list comprehension</p>
<p><strong>Elixir</strong></p>
<pre><code>iex&gt; for n &lt;- [1, 2, 3, 4], do: n * n
[1, 4, 9, 16]</code></pre><h3 id="First-class-function"><a href="#First-class-function" class="headerlink" title="First class function"></a>First class function</h3><p>I enjoy functional programming, so first class function support in Javascript, Swift, Haskell, Elixir, … really make me happy</p>
<p><strong>Haskell</strong></p>
<pre><code>zipWith&apos; (*) (replicate 5 2) [1..]</code></pre><h3 id="Curry"><a href="#Curry" class="headerlink" title="Curry"></a>Curry</h3><blockquote>
<p><em>Currying is the technique of translating the evaluation of a function that takes multiple arguments (or a tuple of arguments) into evaluating a sequence of functions, each with a single argument (partial application)</em></p>
</blockquote>
<p>Language like Swift 2, Haskell, … have curry by default. Some like Javascript can use libraries (Lodash, …) to achieve this. In Haskell, every function officially only takes one parameter.</p>
<p>In Swift 3, curry was <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0002-remove-currying.md">removed</a> :(</p>
<p>Haskell</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">multThree</span> :: (<span class="type">Num</span> a) =&gt; a -&gt; a -&gt; a -&gt; a  </span><br><span class="line"><span class="title">multThree</span> x y z = x * y * z</span><br></pre></td></tr></table></figure>

<p>By calling functions with too few parameters, we’re creating new functions on the fly.</p>
<p><strong>Javascript</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> curry = <span class="built_in">require</span>(<span class="string">'lodash.curry'</span>);</span><br><span class="line"><span class="keyword">var</span> map = curry(<span class="function"><span class="keyword">function</span>(<span class="params">f, ary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ary.map(f);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> getChildren = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x.childNodes;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> allTheChildren = map(getChildren);</span><br></pre></td></tr></table></figure>

<h3 id="Pattern-matching"><a href="#Pattern-matching" class="headerlink" title="Pattern matching"></a>Pattern matching</h3><p>I find pattern matching as a better way around if else statement</p>
<p>Swift supports pattern matching in switch statement</p>
<p><strong>Swift</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Trades</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Buy</span>(stock: <span class="type">String</span>, amount: <span class="type">Int</span>, stockPrice: <span class="type">Float</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Sell</span>(stock: <span class="type">String</span>, amount: <span class="type">Int</span>, stockPrice: <span class="type">Float</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> aTrade = <span class="type">Trades</span>.<span class="type">Buy</span>(stock: <span class="string">"APPL"</span>, amount: <span class="number">200</span>, stockPrice: <span class="number">115.5</span>)</span><br><span class="line"><span class="keyword">switch</span> aTrade &#123;</span><br><span class="line"><span class="keyword">case</span> .<span class="type">Buy</span>(<span class="keyword">let</span> stock, <span class="keyword">let</span> amount, <span class="number">_</span>):</span><br><span class="line">    process(stock, amount)</span><br><span class="line"><span class="keyword">case</span> .<span class="type">Sell</span>(<span class="keyword">let</span> stock, <span class="keyword">let</span> amount, <span class="number">_</span>):</span><br><span class="line">    process(stock, amount * -<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Some like Haskell, Elixir, … also pattern matches on function name, which makes it work great for recursion</p>
<p><strong>Haskell</strong></p>
<pre><code>sayMe :: (Integral a) =&gt; a -&gt; String  
sayMe 1 = &quot;One!&quot;  
sayMe 2 = &quot;Two!&quot;  
sayMe 3 = &quot;Three!&quot;  
sayMe 4 = &quot;Four!&quot;  
sayMe 5 = &quot;Five!&quot;  
sayMe x = &quot;Not between 1 and 5&quot;  


map _ []     = []
map f (x:xs) = f x : map f xs</code></pre><p>In Elixir, the = operator is actually a match operator</p>
<p><strong>Elixir</strong></p>
<pre><code>iex&gt; x = 1
1
iex&gt; x
1
iex&gt; 1 = x
1
iex&gt; 2 = x
** (MatchError) no match of right hand side value: 1</code></pre><h3 id="Recursion"><a href="#Recursion" class="headerlink" title="Recursion"></a>Recursion</h3><p>Some language like Haskell, Elixir, … don’t use loop, they use recursion with performance in mind, no overflow.</p>
<p>Haskell</p>
<pre><code>length&apos; :: (Num b) =&gt; [a] -&gt; b  
length&apos; [] = 0  
length&apos; (_:xs) = 1 + length&apos; xs</code></pre><h3 id="Laziness"><a href="#Laziness" class="headerlink" title="Laziness"></a>Laziness</h3><p>Some languages support infinite collection, thanks to their laziness.</p>
<p>Haskell is lazy, if you map something over a list several times and filter it several times, it will only pass over the list once</p>
<p><strong>Haskell</strong></p>
<pre><code>largestDivisible :: (Integral a) =&gt; a  
largestDivisible = head (filter p [100000,99999..])  
    where p x = x `mod` 3829 == 0</code></pre><p>Elixir defines the concept of Eager with Enum and Lazy with Stream</p>
<p><strong>Elixir</strong></p>
<pre><code>1..100_000 |&gt; Enum.map(&amp;(&amp;1 * 3)) |&gt; Enum.filter(odd?) |&gt; Enum.sum</code></pre><h2 id="Custom-operator"><a href="#Custom-operator" class="headerlink" title="Custom operator"></a>Custom operator</h2><p>Elixir is famous for its pipe |&gt; operator</p>
<blockquote>
<p><em>The |&gt; symbol used in the snippet above is the pipe operator: it simply takes the output from the expression on its left side and passes it as the first argument to the function call on its right side</em></p>
</blockquote>
<p>Elixir</p>
<pre><code>1..100_000 |&gt; Enum.map(&amp;(&amp;1 * 3)) |&gt; Enum.filter(odd?) |&gt; Enum.sum</code></pre><p>Haskell often takes advantage of this custom -: operator Haskell</p>
<pre><code>x -: f = f x  

(0,0) -: landLeft 1 -: landRight 1 -: landLeft 2</code></pre><h3 id="Functor-Applicative-Functor-Monoid-Monad"><a href="#Functor-Applicative-Functor-Monoid-Monad" class="headerlink" title="Functor, Applicative Functor, Monoid, Monad"></a>Functor, Applicative Functor, Monoid, Monad</h3><p>I really like enjoy Haskell because of these typeclasses. It realizes common pattern (map, apply, join, bind, …) with comptutational context. It really enlightens me when I find that function is a Monad as well (you should read the Reader monad)</p>
<p><strong>Haskell</strong></p>
<pre><code>instance Monad Maybe where  
    return x = Just x  
    Nothing &gt;&gt;= f = Nothing  
    Just x &gt;&gt;= f  = f x  
    fail _ = Nothing  

landLeft :: Birds -&gt; Pole -&gt; Maybe Pole  
landLeft n (left,right)  
    | abs ((left + n) - right) &lt; 4 = Just (left + n, right)  
    | otherwise                    = Nothing  

landRight :: Birds -&gt; Pole -&gt; Maybe Pole  
landRight n (left,right)  
    | abs (left - (right + n)) &lt; 4 = Just (left, right + n)  
    | otherwise                    = Nothing

ghci&gt; return (0,0) &gt;&gt;= landLeft 1 &gt;&gt;= banana &gt;&gt;= landRight 1  
Nothing</code></pre><p>List comprehension in Haskell is just syntactic sugar for using lis as Monad <strong>Haskell</strong></p>
<pre><code>ghci&gt; [ (n,ch) | n &lt;- [1,2], ch &lt;- [&apos;a&apos;,&apos;b&apos;] ]  
[(1,&apos;a&apos;),(1,&apos;b&apos;),(2,&apos;a&apos;),(2,&apos;b&apos;)]</code></pre><p><strong>Swift</strong></p>
<pre><code>enum Result&lt;T&gt; {
    case Value(T)
    case Error(NSError)
}

extension Result {
    func map&lt;U&gt;(f: T -&gt; U) -&gt; Result&lt;U&gt; {
        switch self {
            case let .Value(value):
                return Result&lt;U&gt;.Value(f(value))
            case let .Error(error):
                return Result&lt;U&gt;.Error(error)
        }
    }
}

extension Result {
    static func flatten&lt;T&gt;(result: Result&lt;Result&lt;T&gt;&gt;) -&gt; Result&lt;T&gt; {
        switch result {
            case let .Value(innerResult):
                return innerResult
            case let .Error(error):
                return Result&lt;T&gt;.Error(error)
        }
    }
}

extension Result {
    func flatMap&lt;U&gt;(f: T -&gt; Result&lt;U&gt;) -&gt; Result&lt;U&gt; {
        return Result.flatten(map(f))
    }
}</code></pre><h3 id="Trait-and-mixin"><a href="#Trait-and-mixin" class="headerlink" title="Trait and mixin"></a>Trait and mixin</h3><p>Languages like Scala, … support trait</p>
<blockquote>
<p><em>Similar to interfaces in Java, traits are used to define object types by specifying the signature of the supported methods. Unlike Java, Scala allows traits to be partially implemented; i.e. it is possible to define default implementations for some methods</em></p>
</blockquote>
<p><strong>Scala</strong></p>
<pre><code>trait Similarity {
  def isSimilar(x: Any): Boolean
  def isNotSimilar(x: Any): Boolean = !isSimilar(x)
}

class Point(xc: Int, yc: Int) extends Similarity {
  var x: Int = xc
  var y: Int = yc
  def isSimilar(obj: Any) =
    obj.isInstanceOf[Point] &amp;&amp;
    obj.asInstanceOf[Point].x == x
}</code></pre><p>Swift can uses Protocol Extension to <a href="http://matthijshollemans.com/2015/07/22/mixins-and-traits-in-swift-2/">achieve trait</a></p>
<p><strong>Swift</strong></p>
<pre><code>protocol GunTrait {
    func shoot() -&gt; String {
        return &quot;Shoot&quot;
    }
}

protocol RenderTrait {
    func render() -&gt; String {
        return &quot;Render&quot;
    }
}

struct Player: GameObject, AITrait, GunTrait, RenderTrait, HealthTrait {

}</code></pre><p>Ruby supports Mixin via Module</p>
<p><strong>Ruby</strong></p>
<pre><code>module Greetings
  def hello
    puts &quot;Hello!&quot;
  end

  def bonjour
    puts &quot;Bonjour!&quot;
  end

  def hola
    puts &quot;Hola!&quot;
  end
end

class User
  include Greetings
end</code></pre><h3 id="Delegate-property"><a href="#Delegate-property" class="headerlink" title="Delegate property"></a>Delegate property</h3><p>There are certain common kinds of properties that would be very nice to implement once and for all like lazy, observable and storing. An example is in <strong>Kotlin</strong></p>
<pre><code>class Delegate {
    operator fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String {
        return &quot;$thisRef, thank you for delegating &apos;${property.name}&apos; to me!&quot;
    }

    operator fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String) {
        println(&quot;$value has been assigned to &apos;${property.name}&apos; in $thisRef.&quot;)
    }
}</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Hope you find something interesting. Each language has its own pros and is designed for specific purpose. So no list will be enough to cover them all.</p>
<p>To take a quick peek into other programming languages, I find <a href="https://www.youtube.com/playlist?list=PLGLfVvz_LVvSX7fVd4OUFp_ODd86H0ZIY">Learn in One Video</a> by Derek very helpful.</p>
<p>There are things that intrigue us every day like Swift initialization rule make it explicit when using initializer, Go goroutine and channel for concurrent code, Elixir process for easy concurrent and message communication. You’ll be amazed by how process encapsulates state, Haskell data type encourages immutability and thread safe code, Elixir macro for great extension of the language. The best way to to learn is to use and dive into the languages often.</p>
<p>May your code continue to compile.</p>
<p>While you are here, you may like my other posts</p>
<ul>
<li><a href="https://hackernoon.com/next-to-first-next-to-nothing-b7b7b2ba8a34">Next to first, next to nothing</a></li>
<li><a href="https://hackernoon.com/20-recommended-utility-apps-for-macos-in-2018-ea494b4db72b">20 recommended utility apps for macOS in 2018</a></li>
<li><a href="https://hackernoon.com/how-to-make-tag-selection-view-in-react-native-b6f8b0adc891">How to make tag selection view in React Native</a></li>
<li><a href="https://hackernoon.com/8-ways-to-communicate-between-fragment-and-activity-in-android-apps-235b60005d04">8 ways to communicate between Fragment and Activity in Android apps</a></li>
<li>Original post <a href="https://hackernoon.com/do-you-know-these-interesting-programming-languages-features-1fab3fcb2118">https://hackernoon.com/do-you-know-these-interesting-programming-languages-features-1fab3fcb2118</a></li>
</ul>
<hr>
<p><strong>Updated at</strong> 2020-12-05 05:44:54</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:09:18.000Z" title="2019-05-23T16:09:18.000Z">2019-05-23</time><span class="level-item">21 minutes read (About 3181 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-app-icons-and-splash-screens-to-a-React-Native-app-in-staging-and-production/">How to add app icons and splash screens to a React Native app in staging and production</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/268">#268</a></strong></p>
<p>React Native was designed to be “learn once, write anywhere,” and it is usually used to build cross platform apps for iOS and Android. And for each app that we build, there are times we need to reuse the same code, build and tweak it a bit to make it work for different environments. For example, we might need multiple skins, themes, a free and paid version, or more often different staging and production environments.</p>
<p>And the task that we can’t avoid is adding app icons and splash screens to our apps.</p>
<p>In fact, to add a staging and production environment, and to add app icons, requires us to use Xcode and Android Studio, and we do it the same way we do with native iOS or Android projects.</p>
<p>Let’s call our app MyApp and bootstrap it with react-native init MyApp . There will of course, be tons of <a href="https://github.com/thekevinbrown/react-native-schemes-manager">libraries</a> to help us with managing different environments.</p>
<p>In this post, we will do just like we did with native apps, so that we know the basic steps.</p>
<h2 id="Build-configuration-target-build-types-production-flavor-and-build-variant"><a href="#Build-configuration-target-build-types-production-flavor-and-build-variant" class="headerlink" title="Build configuration, target, build types, production flavor, and build variant"></a>Build configuration, target, build types, production flavor, and build variant</h2><p>There are some terminologies we needed to remember. In iOS, debug and releases are called <a href="https://developer.apple.com/library/archive/featuredarticles/XcodeConcepts/Concept-Build_Settings.html">build configurations</a>, and staging and production are called <a href="https://developer.apple.com/library/archive/featuredarticles/XcodeConcepts/Concept-Targets.html">targets</a>.</p>
<blockquote>
<h1 id="A-build-configuration-specifies-a-set-of-build-settings-used-to-build-a-target’s-product-in-a-particular-way-For-example-it-is-common-to-have-separate-build-configurations-for-debug-and-release-builds-of-a-product"><a href="#A-build-configuration-specifies-a-set-of-build-settings-used-to-build-a-target’s-product-in-a-particular-way-For-example-it-is-common-to-have-separate-build-configurations-for-debug-and-release-builds-of-a-product" class="headerlink" title="A build configuration specifies a set of build settings used to build a target’s product in a particular way. For example, it is common to have separate build configurations for debug and release builds of a product."></a>A build configuration specifies a set of build settings used to build a target’s product in a particular way. For example, it is common to have separate build configurations for debug and release builds of a product.</h1><h1 id="A-target-specifies-a-product-to-build-and-contains-the-instructions-for-building-the-product-from-a-set-of-files-in-a-project-or-work-space-A-target-defines-a-single-product-it-organizes-the-inputs-into-the-build-system-—-the-source-files-and-instructions-for-processing-those-source-files-—-required-to-build-that-product-Projects-can-contain-one-or-more-targets-each-of-which-produces-one-product"><a href="#A-target-specifies-a-product-to-build-and-contains-the-instructions-for-building-the-product-from-a-set-of-files-in-a-project-or-work-space-A-target-defines-a-single-product-it-organizes-the-inputs-into-the-build-system-—-the-source-files-and-instructions-for-processing-those-source-files-—-required-to-build-that-product-Projects-can-contain-one-or-more-targets-each-of-which-produces-one-product" class="headerlink" title="A target specifies a product to build and contains the instructions for building the product from a set of files in a project or work-space. A target defines a single product; it organizes the inputs into the build system — the source files and instructions for processing those source files — required to build that product. Projects can contain one or more targets, each of which produces one product"></a>A target specifies a product to build and contains the instructions for building the product from a set of files in a project or work-space. A target defines a single product; it organizes the inputs into the build system — the source files and instructions for processing those source files — required to build that product. Projects can contain one or more targets, each of which produces one product</h1></blockquote>
<p>In Android, debug and releases are called build types, and staging and production are called product flavors. Together they form <a href="https://developer.android.com/studio/build/build-variants">build variants</a>.</p>
<blockquote>
<h1 id="For-example-a-“demo”-product-flavor-can-specify-different-features-and-device-requirements-such-as-custom-source-code-resources-and-minimum-API-levels-while-the-“debug”-build-type-applies-different-build-and-packaging-settings-such-as-debug-options-and-signing-keys-The-resulting-build-variant-is-the-“demoDebug”-version-of-your-app-and-it-includes-a-combination-of-the-configurations-and-resources-included-in-the-“demo”-product-flavor-“debug”-build-type-and-main-source-set"><a href="#For-example-a-“demo”-product-flavor-can-specify-different-features-and-device-requirements-such-as-custom-source-code-resources-and-minimum-API-levels-while-the-“debug”-build-type-applies-different-build-and-packaging-settings-such-as-debug-options-and-signing-keys-The-resulting-build-variant-is-the-“demoDebug”-version-of-your-app-and-it-includes-a-combination-of-the-configurations-and-resources-included-in-the-“demo”-product-flavor-“debug”-build-type-and-main-source-set" class="headerlink" title="For example, a “demo” product flavor can specify different features and device requirements, such as custom source code, resources, and minimum API levels, while the “debug” build type applies different build and packaging settings, such as debug options and signing keys. The resulting build variant is the “demoDebug” version of your app, and it includes a combination of the configurations and resources included in the “demo” product flavor, “debug” build type, and main/ source set."></a>For example, a “demo” <em>product flavor</em> can specify different features and device requirements, such as custom source code, resources, and minimum API levels, while the “debug” <em>build type</em> applies different build and packaging settings, such as debug options and signing keys. The resulting build variant is the “demoDebug” version of your app, and it includes a combination of the configurations and resources included in the “demo” product flavor, “debug” build type, and main/ source set.</h1></blockquote>
<h2 id="Staging-and-production-targets-in-iOS"><a href="#Staging-and-production-targets-in-iOS" class="headerlink" title="Staging and production targets in iOS"></a>Staging and production targets in iOS</h2><p>Open MyApp.xcodeproj inside ios using Xcode. Here is what we get after bootstrapping:</p>
<p><img src="https://cdn-images-1.medium.com/max/2004/1*HMMS0zLAfLU_bvli-IESBg.png" alt=""></p>
<p>React Native creates iOS and tvOS apps, and two test targets. In Xcode, a project can contain many targets, and each target means a unique product with its own build settings — Info.plist and app icons.</p>
<h3 id="Duplicate-target"><a href="#Duplicate-target" class="headerlink" title="Duplicate target"></a>Duplicate target</h3><p>If we don’t need the tvOS app, we can delete the MyApp-tvOS and MyApp-tvOSTests . Let’s use MyApp target as our production environment, and right click -&gt; Duplicate to make another target. Let’s call it MyApp Staging.</p>
<p><img src="https://cdn-images-1.medium.com/max/2694/1*T2RDoSaQRJv8GRGkphUkGw.png" alt=""></p>
<p>Each target must have unique bundle id. Change the bundle id of MyApp to com.onmyway133.MyApp and MyApp Staging to com.onmyway133.MyApp.Staging.</p>
<p><img src="https://cdn-images-1.medium.com/max/3720/1*I3qdG0cgDrwc1bep76ckcA.png" alt=""></p>
<h3 id="Info-plist"><a href="#Info-plist" class="headerlink" title="Info.plist"></a>Info.plist</h3><p>When we duplicate MyApp target , Xcode also duplicates Info.plist into MyApp copy-Info.plist for the staging target. Change it to a more meaningful name Info-Staging.plist and drag it to the MyApp group in Xcode to stay organised. After dragging, MyApp Staging target can’t find the plist, so click Choose Info.plist File and point to the Info-Staging.plist.</p>
<p><img src="https://cdn-images-1.medium.com/max/4732/1*_FYFXy6NDHhSm5XwOPFDmQ.png" alt=""></p>
<h3 id="Scheme"><a href="#Scheme" class="headerlink" title="Scheme"></a>Scheme</h3><p>Xcode also duplicates the scheme when we duplicate the target, so we get MyApp copy:</p>
<p><img src="https://cdn-images-1.medium.com/max/5158/1*DW9wbUJWU1P4gXymv1LT8g.png" alt=""></p>
<p>Click Manage Schemes in the scheme drop-down to open Scheme manager:</p>
<p><img src="https://cdn-images-1.medium.com/max/3208/1*-bjXILHt-Y88etVJDlmyFQ.png" alt=""></p>
<p>I usually delete the generated MyApp copy scheme, then I create a new scheme again for the MyApp Staging target. You need to make sure that the scheme is marked as Shared so that it is tracked into git.</p>
<p><img src="https://cdn-images-1.medium.com/max/3208/1*VTXk1T-j9W-Yd24uU7Wmqg.png" alt=""></p>
<p>For some reason, the staging scheme does not have all the things set up like the production scheme. You can run into issues like ‘React/RCTBundleURLProvider.h’ file not found or <a href="https://github.com/onmyway133/notes/issues/380">RN: ‘React/RCTBridgeModule.h’ file not found</a> . It is because React target is not linked yet.</p>
<p>To solve it, we must disable Parallelise Build and add React target and move it above MyApp Staging.</p>
<p><img src="https://cdn-images-1.medium.com/max/3720/1*F7NF8BBg44H6AZHk_A7Jpg.png" alt=""></p>
<h3 id="Staging-and-production-product-flavors-in-Android"><a href="#Staging-and-production-product-flavors-in-Android" class="headerlink" title="Staging and production product flavors in Android"></a>Staging and production product flavors in Android</h3><p>Open the android folder in Android Studio. By default there are only debug and release build types:</p>
<p><img src="https://cdn-images-1.medium.com/max/3528/1*e362XxJHJpR0tn-ry86brA.png" alt=""></p>
<p>They are configured in the app module build.gradle:</p>
<pre><code>buildTypes {
    release {
        minifyEnabled enableProguardInReleaseBuilds
        proguardFiles getDefaultProguardFile(&quot;proguard-android.txt&quot;), &quot;proguard-rules.pro&quot;
    }
}</code></pre><p>First, let’s change application id to com.onmyway133.MyApp to match iOS. It is not required but I think it’s good to stay organised. Then create two product flavors for staging and production. For staging, let’s add .Staging to the application id.</p>
<p>From Android Studio 3, “all flavors must now belong to a named flavor dimension” — normally we just need default dimensions. Here is how it looks in build.gradle for our app module:</p>
<pre><code>android {
    compileSdkVersion rootProject.ext.compileSdkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion
    flavorDimensions &quot;default&quot;

defaultConfig {
        applicationId &quot;com.onmyway133.MyApp&quot;
        minSdkVersion rootProject.ext.minSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion
        versionCode 1
        versionName &quot;1.0&quot;
        ndk {
            abiFilters &quot;armeabi-v7a&quot;, &quot;x86&quot;
        }
    }
    splits {
        abi {
            reset()
            enable enableSeparateBuildPerCPUArchitecture
            universalApk false  // If true, also generate a universal APK
            include &quot;armeabi-v7a&quot;, &quot;x86&quot;
        }
    }
    buildTypes {
        release {
            minifyEnabled enableProguardInReleaseBuilds
            proguardFiles getDefaultProguardFile(&quot;proguard-android.txt&quot;), &quot;proguard-rules.pro&quot;
        }
    }

productFlavors {
        staging {
            applicationIdSuffix &quot;.Staging&quot;
        }

        production {

        }
    }
}</code></pre><p>Click Sync Now to let gradle do the syncing job. After that, we can see that we have four build variants:</p>
<p><img src="https://cdn-images-1.medium.com/max/5478/1*KxKqB-NdxtieuhFF-AUvwA.png" alt=""></p>
<h3 id="How-to-run-staging-and-production"><a href="#How-to-run-staging-and-production" class="headerlink" title="How to run staging and production"></a>How to run staging and production</h3><p>To run the Android app, we can specify a variant like react-native run-android — variant=productionDebug, but I prefer to go to Android Studio, select the variant, and run.</p>
<p>To run iOS app, we can specify the scheme like react-native run-ios — simulator=’iPhone X’ — scheme=”MyApp Staging” . As of react-native 0.57.0 this does not work. But it does not matter as I usually go to Xcode, select the scheme, and run.</p>
<h3 id="Add-app-icon-for-iOS"><a href="#Add-app-icon-for-iOS" class="headerlink" title="Add app icon for iOS"></a>Add app icon for iOS</h3><p>According to the <a href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/app-icon/">Human Interface Guideline</a>, we need app icons of different sizes for different iOS versions, device resolutions, and situations (notification, settings, Spring Board). I’ve crafted a tool called <a href="https://github.com/onmyway133/IconGenerator">IconGenerator</a>, which was previously mentioned in <a href="https://dev.to/sarthology/best-open-source-tools-for-developers--300f">Best Open Source Tools For Developers</a>. Drag the icon that you want — I prefer those with 1024x1024 pixels for high resolution app icons — to the Icon Generator MacOS app.</p>
<p><img src="https://cdn-images-1.medium.com/max/2848/1*4uBuihDMn3nq3Y1NwVhJsA.png" alt=""></p>
<p>Click Generate and we get AppIcon.appiconset . This contains app icons of the required sizes that are ready to be used in Asset Catalog. Drag this to Asset Catalog in Xcode. That is for production.</p>
<p>For staging, it’s good practice to add a “Staging” banner so that testers know which is staging, and which is production. We can easily do this in Sketch.</p>
<p><img src="https://cdn-images-1.medium.com/max/4536/1*6uxkwnsGkDp0K12LXh_yiw.png" alt=""></p>
<p>Remember to set a background, so we don’t get a transparent background. For an app icon with transparent background, iOS shows the background as black which looks horrible.</p>
<p>After exporting the image, drag the staging icon to the IconGenerator the same way we did earlier. But this time, rename the generated appiconset to AppIcon-Staging.appiconset. Then drag this to Asset Catalog in Xcode.</p>
<p>For the staging target to use staging app icons, open MyApp Staging target and choose AppIcon-Staging as App Icon Source.</p>
<p><img src="https://cdn-images-1.medium.com/max/4908/1*oIGuaxyftwCD0_72Rnv9-g.png" alt=""></p>
<h3 id="Add-app-icon-for-Android"><a href="#Add-app-icon-for-Android" class="headerlink" title="Add app icon for Android"></a>Add app icon for Android</h3><p><img src="https://cdn-images-1.medium.com/max/6720/1*CS_tKOts1zz05PVJ5XEc9A.png" alt=""></p>
<p>I like to switch to Project view, as it is easier to change app icons. Click res -&gt; New -&gt; Image Asset to open Asset Studio. We can use the same app icons that we used in iOS:</p>
<p><img src="https://cdn-images-1.medium.com/max/4528/1*bzJZh1exxXGnrXw_j4AMgQ.png" alt=""></p>
<p>Android 8.0 (API level 26) introduced <a href="https://developer.android.com/guide/practices/ui_guidelines/icon_design_adaptive">Adaptive Icons</a> so we need to tweak the Resize slider to make sure our app icons look as nice as possible.</p>
<blockquote>
<h1 id="Android-8-0-API-level-26-introduces-adaptive-launcher-icons-which-can-display-a-variety-of-shapes-across-different-device-models-For-example-an-adaptive-launcher-icon-can-display-a-circular-shape-on-one-OEM-device-and-display-a-squircle-on-another-device-Each-device-OEM-provides-a-mask-which-the-system-then-uses-to-render-all-adaptive-icons-with-the-same-shape-Adaptive-launcher-icons-are-also-used-in-shortcuts-the-Settings-app-sharing-dialogs-and-the-overview-screen-—-Android-developers"><a href="#Android-8-0-API-level-26-introduces-adaptive-launcher-icons-which-can-display-a-variety-of-shapes-across-different-device-models-For-example-an-adaptive-launcher-icon-can-display-a-circular-shape-on-one-OEM-device-and-display-a-squircle-on-another-device-Each-device-OEM-provides-a-mask-which-the-system-then-uses-to-render-all-adaptive-icons-with-the-same-shape-Adaptive-launcher-icons-are-also-used-in-shortcuts-the-Settings-app-sharing-dialogs-and-the-overview-screen-—-Android-developers" class="headerlink" title="Android 8.0 (API level 26) introduces adaptive launcher icons, which can display a variety of shapes across different device models. For example, an adaptive launcher icon can display a circular shape on one OEM device, and display a squircle on another device. Each device OEM provides a mask, which the system then uses to render all adaptive icons with the same shape. Adaptive launcher icons are also used in shortcuts, the Settings app, sharing dialogs, and the overview screen. — Android developers"></a>Android 8.0 (API level 26) introduces adaptive launcher icons, which can display a variety of shapes across different device models. For example, an adaptive launcher icon can display a circular shape on one OEM device, and display a squircle on another device. Each device OEM provides a mask, which the system then uses to render all adaptive icons with the same shape. Adaptive launcher icons are also used in shortcuts, the Settings app, sharing dialogs, and the overview screen. — <a href="https://developer.android.com/guide/practices/ui_guidelines/icon_design_adaptive">Android developers</a></h1></blockquote>
<p>We are doing for production first, which means the main Res Directory. This step will replace the existing placeholder app icons generated by Android Studio when we bootstrapped React Native projects.</p>
<p><img src="https://cdn-images-1.medium.com/max/4528/1*kIYEWBrWMG_qOkY-LsWnxw.png" alt=""></p>
<p>Now that we have production app icons, let’s make staging app icons. Android manages code and assets via convention. Click on src -&gt; New -&gt; Directory and create a staging folder. Inside staging, create a folder called res . Anything we place in staging will replace the ones in main — this is called source sets.</p>
<p><img src="https://cdn-images-1.medium.com/max/3652/1*dAkYONFc86mHNXKnbPf2fA.png" alt=""></p>
<p>You can read more here: <a href="https://developer.android.com/studio/build/build-variants">Build with source sets</a>.</p>
<blockquote>
<p>You can use source set directories to contain the code and resources you want packaged only with certain configurations. For example, if you are building the “demoDebug” build variant, which is the crossproduct of a “demo” product flavor and “debug” build type, Gradle looks at these directories, and gives them the following priority:<br>src/demoDebug/ <em>(build variant source set)</em><br>src/debug/ <em>(build type source set)</em><br>src/demo/ <em>(product flavor source set)</em><br>src/main/ <em>(main source set)</em></p>
</blockquote>
<p>Right click on staging/res -&gt; New -&gt; Image Asset to make app icons for staging. We also use the same staging app icons like in iOS, but this time we choose staging as Res Directory. This way Android Studio knows how to generate different ic_launcher and put them into staging.</p>
<p><img src="https://cdn-images-1.medium.com/max/4528/1*jKI8Erm57SGwZI2ylLaJ0w.png" alt=""></p>
<h3 id="Add-launch-screen-for-iOS"><a href="#Add-launch-screen-for-iOS" class="headerlink" title="Add launch screen for iOS"></a>Add launch screen for iOS</h3><p>The splash screen is called a [Launch Screen](<a href="http://Launch">http://Launch</a> Screen) in iOS, and it is important.</p>
<blockquote>
<h1 id="A-launch-screen-appears-instantly-when-your-app-starts-up-The-launch-screen-is-quickly-replaced-with-the-first-screen-of-your-app-giving-the-impression-that-your-app-is-fast-and-responsive"><a href="#A-launch-screen-appears-instantly-when-your-app-starts-up-The-launch-screen-is-quickly-replaced-with-the-first-screen-of-your-app-giving-the-impression-that-your-app-is-fast-and-responsive" class="headerlink" title="A launch screen appears instantly when your app starts up. The launch screen is quickly replaced with the first screen of your app, giving the impression that your app is fast and responsive"></a>A launch screen appears instantly when your app starts up. The launch screen is quickly replaced with the first screen of your app, giving the impression that your app is fast and responsive</h1></blockquote>
<p>In the old days, we needed to use static launch images with different sizes for each device and orientation.</p>
<p><img src="https://cdn-images-1.medium.com/max/2912/1*gncLBHGa4ntt1a9NCLL_1g.png" alt=""></p>
<h3 id="Launch-Screen-storyboard"><a href="#Launch-Screen-storyboard" class="headerlink" title="Launch Screen storyboard"></a>Launch Screen storyboard</h3><p>For now the recommended way is to use Launch Screen storyboard . The iOS project from React Native comes with LaunchScreen.xib but xib is a thing of the past. Let’s delete it and create a file called Launch Screen.storyboard .</p>
<p>Right click on MyApp folder -&gt; New and chose Launch Screen, add it to both targets as usually we show the same splash screen for both staging and production.</p>
<p><img src="https://cdn-images-1.medium.com/max/5140/1*kfGNEVm_gJevBIziQ3iXbw.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2984/1*v0ZGfvbSFgljeW34PQsw7g.png" alt=""></p>
<h3 id="Image-Set"><a href="#Image-Set" class="headerlink" title="Image Set"></a>Image Set</h3><p>Open asset catalog, right click and select New Image Set . We can name it anything. This will be used in the Launch Screen.storyboard.</p>
<p><img src="https://cdn-images-1.medium.com/max/4496/1*WOAJ9Vr7fSqRSxwBwRb3qg.png" alt=""></p>
<p>Open Launch Screen.storyboard and add an UIImageView . If you are using Xcode 10, click the Library button in the upper right corner and choose Show Objects Library.</p>
<p><img src="https://cdn-images-1.medium.com/max/6720/1*I6hTPAW_L4fUbo8cTakXlg.png" alt=""></p>
<p>Set image for Image View, and make sure Content Mode is set to Aspect Filled, as this ensures that the image always covers the full screen (although it may be cropped). Then connect ImageView using constraints to the View, not the Safe Area. You do this by Control+drag from the Image View (splash) to the View.</p>
<p><img src="https://cdn-images-1.medium.com/max/5700/1*qdEg7IejnxG3Y0Uo1bpiCA.png" alt=""></p>
<h3 id="Constrains-without-margin"><a href="#Constrains-without-margin" class="headerlink" title="Constrains without margin"></a>Constrains without margin</h3><p>Click into each constraint and uncheck Relative to Margin. This makes our ImageView pin to the very edges of the view and with no margin at all.</p>
<p><img src="https://cdn-images-1.medium.com/max/6720/1*5AIBO-ZLXfiLGsk9P32nFw.png" alt=""></p>
<p>Now go to both targets and select Launch Screen.storyboard as Launch Screen File:</p>
<p><img src="https://cdn-images-1.medium.com/max/7168/1*SrrFr1lk7oIwc4QvdoJVxg.png" alt=""></p>
<p>On iOS, the launch screen is often cached, so you probably won’t see the changes. One way to avoid that is to delete the app and run it again.</p>
<h3 id="Add-a-launcher-theme-for-Android"><a href="#Add-a-launcher-theme-for-Android" class="headerlink" title="Add a launcher theme for Android"></a>Add a launcher theme for Android</h3><p>There are <a href="https://android.jlelse.eu/the-complete-android-splash-screen-guide-c7db82bce565">several</a> <a href="https://android.jlelse.eu/right-way-to-create-splash-screen-on-android-e7f1709ba154">ways</a> to add splash screen for Android, from using launcher themes, Splash Activity, and a timer. For me, a reasonable splash screen for Android should be a very minimal image.</p>
<p>As there are many Android devices with different ratios and resolutions, if you want to show a full screen splash image, it will probably not scale correctly for each device. This is just about UX.</p>
<p>For the splash screen, let’s use the launcher theme with splash_background.xml .</p>
<h3 id="Learn-about-Device-Metric"><a href="#Learn-about-Device-Metric" class="headerlink" title="Learn about Device Metric"></a>Learn about Device Metric</h3><p>There is no single splash image that suits all Android devices. A more logical approach is to create multiple splash images for all common resolutions in portrait and landscape. Or we can design a minimal splash image that works. You can find more info here: <a href="https://material.io/tools/devices/">Device Metric</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*VY5n-nyMet5xlgQyr_fWWw.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/5940/1*491dzlEkHT3FvIuuLosGKg.png" alt=""></p>
<p>Here is how to add splash screen in 4 easy steps:</p>
<h3 id="Add-splash-image"><a href="#Add-splash-image" class="headerlink" title="Add splash image"></a>Add splash image</h3><p>We usually need a common splash screen for both staging and production. Drag an image into main/res/drawble . Android Studio seems to have a problem with recognising some jpg images for the splash screen, so it’s best to choose png images.</p>
<h3 id="Add-splash-background-xml"><a href="#Add-splash-background-xml" class="headerlink" title="Add splash_background.xml"></a>Add splash_background.xml</h3><p>Right click on drawable -&gt; New -&gt; Drawable resource file . Name it whatever you want — I choose splash_background.xml . Choose the root element as layer-list:</p>
<p><img src="https://cdn-images-1.medium.com/max/4170/1*rEa10WkfXx9VCBX_0sQK3A.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*FwCOuThRAGCZSWvdhVrfCw.png" alt=""></p>
<p>A [Layer List](<a href="http://Layer">http://Layer</a> List) means “a Drawable that manages an array of other Drawables. These are drawn in array order, so the element with the largest index is drawn on top”. Here is how splash_background.xml looks like:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;

&lt;!-- The android:opacity=”opaque” line — this is critical in preventing a flash of black as your theme transitions. --&gt;
&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:opacity=&quot;opaque&quot;&gt;

    &lt;!-- The background color, preferably the same as your normal theme --&gt;
    &lt;item android:drawable=&quot;@android:color/white&quot;/&gt;

    &lt;!-- Your splash image --&gt;
    &lt;item&gt;
        &lt;bitmap
            android:src=&quot;@drawable/iron_man&quot;
            android:gravity=&quot;center&quot;/&gt;

    &lt;/item&gt;

&lt;/layer-list&gt;</code></pre><p>Note that we point to our splash image we added earlier with android:src=”@drawable/iron_man”.</p>
<h3 id="Declare-style"><a href="#Declare-style" class="headerlink" title="Declare style"></a>Declare style</h3><p>Open styles.xml and add SplashTheme:</p>
<pre><code>&lt;style name=&quot;SplashTheme&quot; parent=&quot;Theme.AppCompat.NoActionBar&quot;&gt;
    &lt;item name=&quot;android:windowBackground&quot;&gt;@drawable/splash_background&lt;/item&gt;
&lt;/style&gt;</code></pre><h3 id="Use-SplashTheme"><a href="#Use-SplashTheme" class="headerlink" title="Use SplashTheme"></a>Use SplashTheme</h3><p>Go to Manifest.xml and change the theme of the the launcher activity, which has category android:name=”android.intent.category.LAUNCHER” . Change it to android:theme=”@style/SplashTheme” . For React Native, the launcher activity is usually MainActivity . Here is how Manifest.xml looks:</p>
<pre><code>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    package=&quot;com.myapp&quot;&gt;

    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;/&gt;

    &lt;application
      android:name=&quot;.MainApplication&quot;
      android:label=&quot;@string/app_name&quot;
      android:icon=&quot;@mipmap/ic_launcher&quot;
      android:allowBackup=&quot;false&quot;
      android:theme=&quot;@style/AppTheme&quot;&gt;
      &lt;activity
        android:name=&quot;.MainActivity&quot;
        android:label=&quot;@string/app_name&quot;
        android:configChanges=&quot;keyboard|keyboardHidden|orientation|screenSize&quot;
        android:theme=&quot;@style/SplashTheme&quot;
        android:windowSoftInputMode=&quot;adjustResize&quot;&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
            &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
        &lt;/intent-filter&gt;
      &lt;/activity&gt;
      &lt;activity android:name=&quot;com.facebook.react.devsupport.DevSettingsActivity&quot; /&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</code></pre><p>Run the app now and you should see the splash screen showing when the app starts.</p>
<h2 id="Managing-environment-configurations"><a href="#Managing-environment-configurations" class="headerlink" title="Managing environment configurations"></a>Managing environment configurations</h2><p>The differences between staging and production are just about app names, application ids, and app icons. We probably use different API keys, and backend URL for staging and production.</p>
<p>Right now the most popular library to handle these scenarios is <a href="https://github.com/luggit/react-native-config">react-native-config</a>, which is said to “bring some 12 factor love to your mobile apps”. It requires lots of steps to get started, and I hope there is a less verbose solution.</p>
<h3 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h3><p>In this post, we touched Xcode and Android Studio more than Visual Studio Code, but this was inevitable. I hope this post was useful to you. Here are some more links to read more about this topic:</p>
<ul>
<li><a href="https://medium.com/@scottianstewart/react-native-add-app-icons-and-launch-screens-onto-ios-and-android-apps-3bfbc20b7d4c">Add App Icons and Launch Screens to React Native Apps (iOS &amp; Android)</a></li>
<li><a href="https://medium.com/handlebar-labs/how-to-add-a-splash-screen-to-a-react-native-app-ios-and-android-30a3cec835ae">How to Add a Splash Screen to a React Native App (iOS and Android)</a></li>
<li><a href="https://medium.com/differential/managing-configuration-in-react-native-cd2dfb5e6f7b">Managing Configuration in React Native</a></li>
<li><a href="https://medium.com/@jacks205/adding-multiple-target-pipelines-for-react-native-apps-and-fastlane-circleci-deployment-pt-1-ae9590ae52f2">Adding multiple target pipelines for React Native Apps (and Fastlane CircleCI deployment) pt. 1</a></li>
<li><a href="https://android.jlelse.eu/the-complete-android-splash-screen-guide-c7db82bce565">The (Complete) Android Splash Screen Guide</a></li>
</ul>
<hr>
<h2 id="I-originally-published-on-Free-Code-Camp-https-medium-freecodecamp-org-how-to-add-app-icons-and-splash-screens-to-a-react-native-app-in-staging-and-production-d1dab615e7c6"><a href="#I-originally-published-on-Free-Code-Camp-https-medium-freecodecamp-org-how-to-add-app-icons-and-splash-screens-to-a-react-native-app-in-staging-and-production-d1dab615e7c6" class="headerlink" title="I originally published on Free Code Camp https://medium.freecodecamp.org/how-to-add-app-icons-and-splash-screens-to-a-react-native-app-in-staging-and-production-d1dab615e7c6"></a>I originally published on Free Code Camp <a href="https://medium.freecodecamp.org/how-to-add-app-icons-and-splash-screens-to-a-react-native-app-in-staging-and-production-d1dab615e7c6">https://medium.freecodecamp.org/how-to-add-app-icons-and-splash-screens-to-a-react-native-app-in-staging-and-production-d1dab615e7c6</a></h2><p><strong>Updated at</strong> 2021-01-13 09:14:18</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:06:58.000Z" title="2019-05-23T16:06:58.000Z">2019-05-23</time><span class="level-item">8 minutes read (About 1219 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Get-to-know-different-JavaScript-environments-in-React-Native/">Get to know different JavaScript environments in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/266">#266</a></strong></p>
<p>Original post <a href="https://medium.freecodecamp.org/get-to-know-different-javascript-environments-in-react-native-4951c15d61f5">https://medium.freecodecamp.org/get-to-know-different-javascript-environments-in-react-native-4951c15d61f5</a></p>
<hr>
<p>React Native can be very easy to <a href="https://facebook.github.io/react-native/docs/getting-started.html">get started</a> with, and then at some point problems occur and we need to dive deep into it.</p>
<p>The other day we had a strange bug that was only occurring in production build, and in iOS only. A long backtrace in the app revealed that it was due to Date constructor failure.</p>
<pre><code>const date = new Date(&quot;2019-01-18 12:00:00&quot;)</code></pre><p>This returns the correct Date object in debug mode, but yields Invalid Date in release. What’s special about Date constructor? Here I’m using react native 0.57.5 and no Date libraries.</p>
<h2 id="Date-constructor"><a href="#Date-constructor" class="headerlink" title="Date constructor"></a>Date constructor</h2><p>The best resource for learning Javascript is via Mozilla web docs, and entering <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a>:</p>
<blockquote>
<p>Creates a JavaScript <strong>Date</strong> instance that represents a single moment in time. Date objects use a <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">Unix Time Stamp</a>, an integer value that is the number of milliseconds since 1 January 1970 UTC.</p>
</blockquote>
<p>Pay attention to how Date can be constructed by dateString:</p>
<blockquote>
<p>dateStringString value representing a date. The string should be in a format recognized by the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse">Date.parse()</a> method (<a href="http://tools.ietf.org/html/rfc2822#page-14">IETF-compliant RFC 2822 timestamps</a> and also a <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15">version of ISO8601</a>).</p>
</blockquote>
<p>So Date constructor uses static method Date.parse under the hood. This has very specific requirement about the format of date string that it supports</p>
<blockquote>
<p>The standard string representation of a date time string is a simplification of the ISO 8601 calendar date extended format (see <a href="https://tc39.github.io/ecma262/#sec-date-time-string-format">Date Time String Format</a> section in the ECMAScript specification for more details). For example, “2011-10-10” (date-only form), “2011-10-10T14:48:00” (date-time form), or “2011-10-10T14:48:00.000+09:00” (date-time form with milliseconds and time zone) can be passed and will be parsed. When the time zone offset is absent, date-only forms are interpreted as a UTC time and date-time forms are interpreted as local time.<br>The ECMAScript specification states: If the String does not conform to the standard format the function may fall back to any implementation–specific heuristics or implementation–specific parsing algorithm. Unrecognizable strings or dates containing illegal element values in ISO formatted strings shall cause Date.parse() to return <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN">NaN</a>.</p>
</blockquote>
<p>The reason that we get Invalid Date in iOS must be because the code was run in two different JavaScript environments and they somehow have different implementation of the Date parsing function.</p>
<h2 id="JavaScript-Environment"><a href="#JavaScript-Environment" class="headerlink" title="JavaScript Environment"></a>JavaScript Environment</h2><p>React Native guide has a dedicated section about <a href="https://facebook.github.io/react-native/docs/javascript-environment">JavaScript environments</a>.</p>
<p>When using React Native, you’re going to be running your JavaScript code in two environments:</p>
<ul>
<li><p>In most cases, React Native will use <a href="http://trac.webkit.org/wiki/JavaScriptCore">JavaScriptCore</a>, the JavaScript engine that powers Safari. Note that on iOS, JavaScriptCore does not use JIT due to the absence of writable executable memory in iOS apps.</p>
</li>
<li><p>When using Chrome debugging, all JavaScript code runs within Chrome itself, communicating with native code via WebSockets. Chrome uses <a href="https://code.google.com/p/v8/">V8</a> as its JavaScript engine.</p>
</li>
</ul>
<p>While both environments are very similar, you may end up hitting some inconsistencies. We’re likely going to experiment with other JavaScript engines in the future, so it’s best to avoid relying on specifics of any runtime.</p>
<p>React Native also uses Babel and some polyfills to have some nice syntax transformers, so some of the code that we write may not be necessarily supported natively by JavascriptCore.</p>
<p>Now it is clear that while we debug our app via Chrome debugger, it works because V8 engine handles that. Now try turning off Remote JS Debugging: we can see that the above Date constructor fails, which means it is using JavascriptCore.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*zICMkdSSmUkcPTDNnkCA7Q.png" alt=""></p>
<p>To confirm this issue, let’s run our app in Xcode and go to the Safari app on MacOS to enter Development menu. Select the active Simulator and choose JSContext on the current iOS app. Remember to turn off Remote JS Debugging so that the app uses JavascriptCore:</p>
<p><img src="https://cdn-images-1.medium.com/max/6720/1*TPzyCz-z45fbzYSaJ3dQGA.png" alt=""></p>
<p>Now open the Console in Safari dev tools, and we should have access to JavascriptCore inside our app. Try running the above Date constructor to confirm that it fails:</p>
<p><img src="https://cdn-images-1.medium.com/max/4448/1*gqswNAR8vpqHrzBiZKeqcg.png" alt=""></p>
<h2 id="What-are-legit-date-string-formats"><a href="#What-are-legit-date-string-formats" class="headerlink" title="What are legit date string formats?"></a>What are legit date string formats?</h2><p>Since 2016, <a href="https://webkit.org/blog/6756/es6-feature-complete/">JavascriptCore</a> supports most ES6 features:</p>
<blockquote>
<p>As of <a href="https://trac.webkit.org/changeset/202125">r202125</a>, JavaScriptCore supports all of the new features in the <a href="https://tc39.github.io/ecma262/#sec-integerindexedelementget">ECMAScript 6 (ES6) language specification</a></p>
</blockquote>
<p>And it was fully confirmed a year later in <a href="https://webkit.org/blog/7536/jsc-loves-es6/">JSC 💕 ES6</a></p>
<blockquote>
<p><a href="http://www.ecma-international.org/ecma-262/6.0/">ES2015</a> (also known as ES6), the version of the JavaScript specification ratified in 2015, is a huge improvement to the language’s expressive power thanks to features like <a href="http://www.2ality.com/2015/02/es6-classes-final.html">classes</a>, <a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/">for-of</a>, <a href="http://www.2ality.com/2015/01/es6-destructuring.html">destructuring</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator">spread</a>, <a href="http://www.2ality.com/2015/06/tail-call-optimization.html">tail calls</a>, and <a href="http://kangax.github.io/compat-table/es6/">much more</a><br>WebKit’s JavaScript implementation, called JSC (JavaScriptCore), <a href="https://webkit.org/blog/6756/es6-feature-complete/">implements all of ES6</a></p>
</blockquote>
<p>For more details about JavaScript features supported by different JavaScript engines, visit this <a href="https://kangax.github.io/compat-table/es6/">ECMAScript comparison table</a>.</p>
<p>Now for the date string format, from <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse">Date.parse</a>, let’s visit ECMAScript 2015 specification to see what it says about <a href="https://www.ecma-international.org/ecma-262/6.0/#sec-date-time-string-format">date string format</a>:</p>
<p><img src="https://cdn-images-1.medium.com/max/4444/1*A8iKd3HZyq9ZmaH0ilm-AA.png" alt=""></p>
<p>ECMAScript defines a string interchange format for date-times based upon a simplification of the ISO 8601 Extended Format. The format is as follows: <strong>YYYY-MM-DDTHH:mm:ss.sss<em>Z</em></strong></p>
<p>Where the fields are as follows:</p>
<p><strong>“T”</strong> appears literally in the string, to indicate the beginning of the time element.</p>
<p>So JavascriptCore requires T specifier and V8 can work without it. The fix for now is to always include that T specifier. This way we always follow ECMAScript standards to make sure it works across different JavaScript environments.</p>
<pre><code>const date = new Date(&quot;2019-01-18 12:00:00&quot;.replace(&apos; &apos;, &apos;T&apos;))</code></pre><p>And now it returns correct Date object. There may be difference between JavascriptCore on iOS and macOS, and among different iOS versions. The lesson learned here is that we should always test our app thoroughly in production and on devices to make sure it works as expected.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T15:57:46.000Z" title="2019-05-23T15:57:46.000Z">2019-05-23</time><span class="level-item">18 minutes read (About 2656 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-Make-Linear-Gradient-View-with-Bridging-in-React-Native/">How to Make Linear Gradient View with Bridging in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/264">#264</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7">https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7</a></p>
<hr>
<p>React Native lets us build mobile apps using only Javascript. It works by providing a common interface that talks to native iOS and Android components. There are enough essentials components to get started, but the cooler thing is that it is easy to build our own, hence we are not limited by React Native. In this post we will implement a linear gradient view, which is not supported by default in React Native, using native UI component, particularly CAGradientLayer in iOS and GradientDrawable in Android.</p>
<p>In Javascript there are hundreds of libraries for a single problem and you should check if you really need it or not. A search on Google for linear gradient shows a bunch of libraries, like <a href="https://github.com/react-native-community/react-native-linear-gradient">react-native-linear-gradient</a>. The less <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">dependencies</a> the better. Linear gradient is in fact very easy to build and we probably don’t need to add extra dependencies. Also <a href="https://dev.to/acro5piano/struggle-to-install-react-native-linear-gradient--2omm">integrating</a> <a href="https://medium.com/react-native-training/fixing-react-native-issues-and-happy-deploy-to-bitrise-fabric-circleci-44da4ab1487b">and</a> <a href="https://medium.com/react-native-training/firebase-sdk-with-firestore-for-react-native-apps-in-2018-aa89a67d6934">following</a> <a href="https://medium.com/react-native-training/facebook-sdk-with-login-for-react-native-apps-in-2018-196601804f66">updates</a> with 3rd libraries are painful, I would avoid that as much as possible.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*SZnOwVTr15PY7uHYqaeaXw.png" alt=""></p>
<h2 id="Native-UI-component-vs-Native-module"><a href="#Native-UI-component-vs-Native-module" class="headerlink" title="Native UI component vs Native module"></a>Native UI component vs Native module</h2><p>In React Native, there are native UI component and native module. React Native moves pretty fast so most of the articles will be outdated, it’s best to consult official documentation for the latest React Native version. This post will try to give you overview of the whole picture because for now the official guide seems not completed.</p>
<ul>
<li><p><a href="https://facebook.github.io/react-native/docs/native-modules-ios">Native Modules in iOS</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-modules-android">Native Modules in Android</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-components-ios">Native UI Components in iOS</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-components-android">Native UI Components in Android</a></p>
</li>
</ul>
<p>In simple explanation, native UI component is about making UIView in iOS or View in Android available as React.Component and used in render function in Javascript.</p>
<blockquote>
<p>There are tons of native UI widgets out there ready to be used in the latest apps — some of them are part of the platform, others are available as third-party libraries, and still more might be in use in your very own portfolio. React Native has several of the most critical platform components already wrapped, like ScrollView and TextInput, but not all of them, and certainly not ones you might have written yourself for a previous app.</p>
</blockquote>
<p>Native module is more general in that we make any native class available in Javascript.</p>
<blockquote>
<p>Sometimes an app needs access to platform API, and React Native doesn’t have a corresponding module yet. Maybe you want to reuse some existing Objective-C, Swift or C++ code without having to reimplement it in JavaScript, or write some high performance, multi-threaded code such as for image processing, a database, or any number of advanced extensions.</p>
</blockquote>
<h2 id="View-Manager"><a href="#View-Manager" class="headerlink" title="View Manager"></a>View Manager</h2><p>To expose native UI views, we use the ViewManager as the bridge, it is RCTViewManager in iOS and SimpleViewManager in Android. Then inside this ViewManager we can just return our custom view. I see it’s good to use Objective C/Java for the ViewManager to match React Native classes, and the custom view we can use either Swift/Objective C in iOS and Kotlin/Java in Android.</p>
<p>I prefer to use Swift, but in this post to remove the overhead of introducing bridging header from Swift to Objective C, we use Objective C for simplicity. We also add the native source code directly into iOS and Android project, but in the future we can extract them easily to a React Native library.</p>
<p>For now let ‘s use the name RNGradientViewManager and RNGradientView to stay consistent between iOS and Android. The RN prefix is arbitrary, you can use any prefix you want, but here I use it to indicate that these classes are meant to be used in Javascript side in React Native.</p>
<h2 id="Implement-in-iOS"><a href="#Implement-in-iOS" class="headerlink" title="Implement in iOS"></a>Implement in iOS</h2><h3 id="Project-structure"><a href="#Project-structure" class="headerlink" title="Project structure"></a>Project structure</h3><p>Add these Objective-C classes to the projects, I usually place them inside NativeComponents folder</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*v9ecOYKhfHenOfFD_YyXjA.png" alt=""></p>
<blockquote>
<p>Native views are created and manipulated by subclasses of RCTViewManager. These subclasses are similar in function to view controllers, but are essentially singletons - only one instance of each is created by the bridge. They expose native views to the RCTUIManager, which delegates back to them to set and update the properties of the views as necessary. The RCTViewManagers are also typically the delegates for the views, sending events back to JavaScript via the bridge.</p>
</blockquote>
<h3 id="RNGradientViewManager"><a href="#RNGradientViewManager" class="headerlink" title="RNGradientViewManager"></a>RNGradientViewManager</h3><p>Create a RNGradientViewManager that inherits from RCTViewManager</p>
<p><strong>RNGradientViewManager.h</strong></p>
<pre><code>#import &lt;React/RCTViewManager.h&gt;
@interface RNGradientViewManager : RCTViewManager
@end</code></pre><p><strong>RNGradientViewManager.m</strong></p>
<pre><code>#import &quot;RNGradientViewManager.h&quot;
#import &quot;RNGradientView.h&quot;

[@implementation](http://twitter.com/implementation) RNGradientViewManager

RCT_EXPORT_MODULE()

- (UIView *)view {
  return [[RNGradientView alloc] init];
}

RCT_EXPORT_VIEW_PROPERTY(progress, NSNumber);
RCT_EXPORT_VIEW_PROPERTY(cornerRadius, NSNumber);
RCT_EXPORT_VIEW_PROPERTY(fromColor, UIColor);
RCT_EXPORT_VIEW_PROPERTY(toColor, UIColor);

[@end](http://twitter.com/end)</code></pre><p>In iOS we use macro RCT_EXPORT_MODULE() to automatically register the module with the bridge when it loads. The optional js_name argument will be used as the JS module name. If omitted, the JS module name will match the Objective-C class name.</p>
<pre><code>#define RCT_EXPORT_MODULE(js_name)</code></pre><p>The ViewManager, not the View, is the facade to the Javascript side, so we expose properties using RCT_EXPORT_VIEW_PROPERTY . Note that we do that inside @implementation RNGradientViewManager</p>
<p>Here we specify the types as NSNumber and UIColor , and later in Javascript we can just pass number and color hex string, and React Native can do the conversions for us. In older versions of React Native, we need processColor in Javascript or RCTConvert color in iOS side, but we don’t need to perform manual conversion now.</p>
<h3 id="RNGradientView"><a href="#RNGradientView" class="headerlink" title="RNGradientView"></a>RNGradientView</h3><p>In the Native UI component <a href="https://facebook.github.io/react-native/docs/native-components-ios">example</a> for iOS, they use WKWebView but here we make a RNGradientView which subclasses from <a href="https://github.com/facebook/react-native/blob/master/React/Views/RCTView.h">RCTView</a> to take advantage of many features of React Native views, and to avoid some problems we can get if using a normal UIView</p>
<p><strong>RNGradientView.h</strong></p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;
#import &lt;React/RCTView.h&gt;

[@interface](http://twitter.com/interface) RNGradientView : RCTView

[@end](http://twitter.com/end)</code></pre><p><strong>RNGradientView.m</strong></p>
<pre><code>#import &quot;RNGradientView.h&quot;
#import &lt;UIKit/UIKit.h&gt;

[@interface](http://twitter.com/interface) RNGradientView()
[@property](http://twitter.com/property) CAGradientLayer *gradientLayer;

[@property](http://twitter.com/property) UIColor *_fromColor;
[@property](http://twitter.com/property) UIColor *_toColor;
[@property](http://twitter.com/property) NSNumber *_progress;
[@property](http://twitter.com/property) NSNumber *_cornerRadius;
[@end](http://twitter.com/end)

[@implementation](http://twitter.com/implementation) RNGradientView

// MARK: - Init

- (instancetype)initWithFrame:(CGRect)frame
{
  self = [super initWithFrame:frame];
  if (self) {
    self.gradientLayer = [self makeGradientLayer];
    [self.layer addSublayer:self.gradientLayer];

self._fromColor = [UIColor blackColor];
    self._toColor = [UIColor whiteColor];
    self._progress = [@0](http://twitter.com/0).5;

[self update];
  }
  return self;
}

// MARK: - Life cycle

- (void)layoutSubviews {
  [super layoutSubviews];

self.gradientLayer.frame = CGRectMake(
    0, 0,
    self.bounds.size.width*self._progress.floatValue,
    self.bounds.size.height
  );
}

// MARK: - Properties

- (void)setFromColor:(UIColor *)color {
  self._fromColor = color;
  [self update];
}

- (void)setToColor:(UIColor *)color {
  self._toColor = color;
  [self update];
}

- (void)setProgress:(NSNumber *)progress {
  self._progress = progress;
  [self update];
}

- (void)setCornerRadius:(NSNumber *)cornerRadius {
  self._cornerRadius = cornerRadius;
  [self update];
}

// MARK: - Helper

- (void)update {
  self.gradientLayer.colors = @[
    (id)self._fromColor.CGColor,
    (id)self._toColor.CGColor
  ];

self.gradientLayer.cornerRadius = self._cornerRadius.floatValue;

[self setNeedsLayout];
}

- (CAGradientLayer *)makeGradientLayer {
  CAGradientLayer *gradientLayer = [CAGradientLayer layer];

gradientLayer.masksToBounds = true;

gradientLayer.startPoint = CGPointMake(0.0, 0.5);
  gradientLayer.endPoint = CGPointMake(1.0, 0.5);
  gradientLayer.anchorPoint = CGPointZero;

return gradientLayer;
}

[@end](http://twitter.com/end)</code></pre><p>We can implement anything we want in this native view, in this case we use CAGradientLayer to get nicely displayed linear gradient. Since RNGradientViewManager exposes some properties like progress, cornerRadius, fromColor, toColor we need to implement some setters as they will be called by React Native when we update values in Javascript side. In the setter we call setNeedsLayout to tell the view to invalidate the layout, hence layoutSubviews will be called again.</p>
<h3 id="requireNativeComponent"><a href="#requireNativeComponent" class="headerlink" title="requireNativeComponent"></a>requireNativeComponent</h3><p>Open project in Visual Studio Code, add GradientView.js to src/nativeComponents . The folder name is arbitrary, but it’s good to stay organised.</p>
<pre><code>import { requireNativeComponent } from &apos;react-native&apos;

module.exports = requireNativeComponent(&apos;RNGradientView&apos;, null)</code></pre><p>Here we use <a href="https://github.com/facebook/react-native/blob/master/Libraries/ReactNative/requireNativeComponent.js">requireNativeComponent</a> to load our RNGradientView . We only need this one Javascript file for interacting with both iOS and Android. You can name the module as RNGradientView but I think the practice in Javascript is that we don’t use prefix, so we name just GradientView .</p>
<pre><code>const requireNativeComponent = (uiViewClassName: string): string =&gt;
  createReactNativeComponentClass(uiViewClassName, () =&gt;
    getNativeComponentAttributes(uiViewClassName),
  );

module.exports = requireNativeComponent;</code></pre><p>Before I tried to use export default for the native component, but this way the view is not rendered at all, even if I wrap it inside React.Component . It seems we must use module.exports for the native component to be properly loaded.</p>
<p>Now using it is as easy as declare the GradientView with JSX syntax</p>
<pre><code>import GradientView from &apos;nativeComponents/GradientView&apos;

export default class Profile extends React.Component {
  render() {
    return (
      &lt;SafeAreaView style={styles.container}&gt;
        &lt;GradientView
          style={styles.progress}
          fromColor={R.colors.progress.from}
          toColor={R.colors.progress.to}
          cornerRadius={5.0}
          progress={0.8} /&gt;
    )
  }
}</code></pre><h2 id="Implement-in-Android"><a href="#Implement-in-Android" class="headerlink" title="Implement in Android"></a>Implement in Android</h2><h3 id="Project-structure-1"><a href="#Project-structure-1" class="headerlink" title="Project structure"></a>Project structure</h3><p>Add these Java classes to the projects, I usually place them inside nativeComponents folder</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*7v9qtfOAGPF2lqvWrrOysg.png" alt=""></p>
<h3 id="RNGradientManager"><a href="#RNGradientManager" class="headerlink" title="RNGradientManager"></a>RNGradientManager</h3><p>Create a RNGradientManager that extends SimpleViewManager<br><strong>RNGradientManager.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import android.support.annotation.Nullable;
import com.facebook.react.uimanager.SimpleViewManager;
import com.facebook.react.uimanager.ThemedReactContext;
import com.facebook.react.uimanager.annotations.ReactProp;

public class RNGradientViewManager extends SimpleViewManager&lt;RNGradientView&gt; {
    [@Override](http://twitter.com/Override)
    public String getName() {
        return &quot;RNGradientView&quot;;
    }

[@Override](http://twitter.com/Override)
    protected RNGradientView createViewInstance(ThemedReactContext reactContext) {
        return new RNGradientView(reactContext);
    }

// Properties

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;progress&quot;)
    public void setProgress(RNGradientView view, [@Nullable](http://twitter.com/Nullable) float progress) {
        view.setProgress(progress);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;cornerRadius&quot;)
    public void setCornerRadius(RNGradientView view, [@Nullable](http://twitter.com/Nullable) float cornerRadius) {
        view.setCornerRadius(cornerRadius);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;fromColor&quot;, customType = &quot;Color&quot;)
    public void setFromColor(RNGradientView view, [@Nullable](http://twitter.com/Nullable) int color) {
        view.setFromColor(color);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;toColor&quot;, customType = &quot;Color&quot;)
    public void setToColor(RNGradientView view, [@Nullable](http://twitter.com/Nullable) int color) {
        view.setToColor(color);
    }
}</code></pre><p>We usually use <a href="https://developer.android.com/reference/android/graphics/Color">Color</a> as android.graphics.Color , but for the GradientDrawable that we are going to use, it use color as ARGB integer. So it’s nifty that React Native deals with Color as int type. We also need to specify customType = “Color” as Color is something kinda custom.</p>
<h3 id="RNGradientView-1"><a href="#RNGradientView-1" class="headerlink" title="RNGradientView"></a>RNGradientView</h3><p>This is where we implement our view, we can do that in Kotlin if we like.</p>
<p><strong>RNGradientView.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import android.content.Context;
import android.graphics.drawable.GradientDrawable;
import android.graphics.drawable.ScaleDrawable;
import android.support.annotation.Nullable;
import android.util.AttributeSet;
import android.view.Gravity;
import android.view.View;

public class RNGradientView extends View {

    float progress;
    float cornerRadius;
    int fromColor;
    int toColor;

    public RNGradientView(Context context) {
        super(context);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs) {
        super(context, attrs);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }

    // update

    void update() {
        GradientDrawable gradient = new GradientDrawable();
        gradient.setColors(new int[] {
            this.fromColor,
            this.toColor
        });
         gradient.setOrientation(GradientDrawable.Orientation.*LEFT_RIGHT*);
        gradient.setGradientType(GradientDrawable.*LINEAR_GRADIENT*);
        gradient.setShape(GradientDrawable.*RECTANGLE*);
        gradient.setCornerRadius(this.cornerRadius * 4);

        ScaleDrawable scale = new ScaleDrawable(gradient, Gravity.*LEFT*, 1, -1);
        scale.setLevel((int)(this.progress * 10000));

        this.setBackground(scale);
    }

    // Getter &amp; setter

    public void setProgress(float progress) {
        this.progress = progress;
        this.update();
    }

    public void setCornerRadius(float cornerRadius) {
        this.cornerRadius = cornerRadius;
        this.update();
    }

    public void setFromColor(int fromColor) {
        this.fromColor = fromColor;
        this.update();
    }

    public void setToColor(int toColor) {
        this.toColor = toColor;
        this.update();
    }
}</code></pre><p>Pay attention to the <a href="https://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html#setColors(int[])">setColors</a> as it use an array of int</p>
<blockquote>
<p>Sets the colors used to draw the gradient.<br>Each color is specified as an ARGB integer and the array must contain at least 2 colors.</p>
</blockquote>
<p>If we call setBackground with the GradientDrawable it will be stretched to fill the view. In our case we want to support progress which determines how long the gradient should show. To fix that we use <a href="https://developer.android.com/reference/android/graphics/drawable/ScaleDrawable">ScaleDrawable</a> which is a Drawable that changes the size of another Drawable based on its current level value.</p>
<p>The same value for cornerRadius works in iOS, but for Android we need to use higher values, that’s why the multiplication in gradient.setCornerRadius(this.cornerRadius * 4)</p>
<h3 id="Shape-drawable"><a href="#Shape-drawable" class="headerlink" title="Shape drawable"></a>Shape drawable</h3><p>Another way to implement gradient is to use Shape Drawable with xml , it’s the equivalent of using xib in iOS. We can create something like gradient.xml and put that inside /res/drawable</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;shape xmlns:android=&quot;[http://schemas.android.com/apk/res/android](http://schemas.android.com/apk/res/android)&quot;
    android:shape=&quot;rectangle&quot;&gt;
    &lt;gradient
        android:startColor=&quot;#3B5998&quot;
        android:endColor=&quot;#00000000&quot;
        android:angle=&quot;45&quot;/&gt;    
&lt;/shape&gt;</code></pre><p>For more information, you can read<br><a href="https://android.jlelse.eu/android-shape-drawables-tutorial-17fbece6fef5"><strong>Android Shape Drawables Tutorial</strong><br><em>Have you ever wanted to reduce your Android application’s size or make it look more interesting? If yes, then you…</em>android.jlelse.eu</a></p>
<p>We can also use the class directly <a href="https://developer.android.com/reference/android/graphics/drawable/ShapeDrawable">ShapeDrawable</a> in code</p>
<blockquote>
<p>A Drawable object that draws primitive shapes. A ShapeDrawable takes a <a href="https://developer.android.com/reference/android/graphics/drawable/shapes/Shape.html">Shape</a> object and manages its presence on the screen. If no Shape is given, then the ShapeDrawable will default to a <a href="https://developer.android.com/reference/android/graphics/drawable/shapes/RectShape.html">RectShape</a>.<br>This object can be defined in an XML file with the <shape> element.</p>
</blockquote>
<h3 id="GradientManagerPackage"><a href="#GradientManagerPackage" class="headerlink" title="GradientManagerPackage"></a>GradientManagerPackage</h3><p>In iOS we use RCT_EXPORT_MODULE to register the component, but in Android, things are done explicitly using Package . A package can register both native module and native UI component. In this case we deal with just UI component, so let’s return RNGradientManager in createViewManagers</p>
<p><strong>GradientManagerPackage.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import com.facebook.react.ReactPackage;
import com.facebook.react.bridge.NativeModule;
import com.facebook.react.bridge.ReactApplicationContext;
import com.facebook.react.uimanager.ViewManager;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

public class RNGradientViewPackage implements ReactPackage {
    [@Override](http://twitter.com/Override)
    public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) {
        return Collections.emptyList();
    }

[@Override](http://twitter.com/Override)
    public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) {
        return Arrays.&lt;ViewManager&gt;asList(
            new RNGradientViewManager()
        );
    }
}</code></pre><p>Then head over to MainApplication.java to declare our package</p>
<pre><code>[@Override](http://twitter.com/Override)
protected List&lt;ReactPackage&gt; getPackages() {
  return Arrays.&lt;ReactPackage&gt;asList(
      new MainReactPackage(),
      new RNGradientViewPackage()
  );
}</code></pre><p>That’s it for Android. We already have the GradientView.js written earlier, when running the app in Android, it will look up and load our RNGradientView</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Hope you learn something about native UI component. In the post we only touch the surfaces on what native UI component can do, which is just passing configurations from Javascript to native. There are a lot more to discover, like event handling, thread, styles, custom types, please consult the official documentation for correct guidance.</p>
<ul>
<li><a href="https://facebook.github.io/react-native/docs/native-components-ios">Native UI Components for iOS</a></li>
<li><a href="https://facebook.github.io/react-native/docs/native-components-android">Native UI Components for Android</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T15:57:01.000Z" title="2019-05-23T15:57:01.000Z">2019-05-23</time><span class="level-item">11 minutes read (About 1723 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-dismiss-keyboard-with-react-navigation-in-React-Native-apps/">How to dismiss keyboard with react-navigation in React Native apps</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/263">#263</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/how-to-dismiss-keyboard-with-react-navigation-in-react-native-apps-4b987bbfdc48">https://medium.com/react-native-training/how-to-dismiss-keyboard-with-react-navigation-in-react-native-apps-4b987bbfdc48</a></p>
<hr>
<p>Showing and dismiss keyboard seems like a trivial thing to do in mobile apps, but it can be tricky in automatically dismissing it when it comes together with react-navigation and modal presentation. At least that’s according to my initial assumption. This article aims to detail what I have learned about keyboard handling and how to avoid extra tap when dealing with TextInput There will also be lots of code spelunking, thanks to the all the libraries being open source. The version of React Native I’m using at the time of writing is 0.57.5</p>
<h2 id="The-built-in-TextInput-component"><a href="#The-built-in-TextInput-component" class="headerlink" title="The built in TextInput component"></a>The built in TextInput component</h2><p>React Native comes with a bunch of basic components, one of them is the <a href="https://facebook.github.io/react-native/docs/textinput">TextInput</a> for inputting text into the app via a keyboard.</p>
<pre><code>import React, { Component } from &apos;react&apos;;
import { AppRegistry, TextInput } from &apos;react-native&apos;;

export default class UselessTextInput extends Component {
  constructor(props) {
    super(props);
    this.state = { text: &apos;Useless Placeholder&apos; };
  }

render() {
    return (
      &lt;TextInput
        style={{height: 40, borderColor: 'gray', borderWidth: 1}}
        onChangeText={(text) =&gt; this.setState({text})}
        value={this.state.text}
      /&gt;
    );
  }
}</code></pre><p>That’s it, whenever we click on the text input, keyboard appears allowing us to enter values. To dismiss the keyboard by pressing anywhere on the screen, the easy solution is to TouchableWithoutFeedback together with Keyboard . This is similar to having UITapGestureRecognizer in iOS UIView and calling view.endEditing</p>
<pre><code>import { Keyboard } from &apos;react-native&apos;

Keyboard.dismiss()</code></pre><h2 id="TextInput-inside-ScrollView"><a href="#TextInput-inside-ScrollView" class="headerlink" title="TextInput inside ScrollView"></a>TextInput inside ScrollView</h2><p>Normally we should have some text inputs inside a scrolling component, in React Native that is mostly ScrollView to be able to handle long list of content and avoid keyboard. If TextInput is inside ScrollView then the way keyboard gets dismissed behaves a bit differently, and depends on <a href="https://facebook.github.io/react-native/docs/scrollview#keyboardshouldpersisttaps">keyboardShouldPersistTaps</a></p>
<p>Determines when the keyboard should stay visible after a tap.</p>
<ul>
<li><p>‘never’ (the default), tapping outside of the focused text input when the keyboard is up dismisses the keyboard. When this happens, children won’t receive the tap.</p>
</li>
<li><p>‘always’, the keyboard will not dismiss automatically, and the scroll view will not catch taps, but children of the scroll view can catch taps.</p>
</li>
<li><p>‘handled’, the keyboard will not dismiss automatically when the tap was handled by a children, (or captured by an ancestor).</p>
</li>
</ul>
<p>The never mode should be the desired behaviour in most cases, clicking anywhere outside the focused text input should dismiss the keyboard.</p>
<p>In my app, there are some text inputs and an action button. The scenario is that users enter some infos and then press that button to register data. With the never mode, we have to press button twice, one for dismissing the keyboard, and two for the onPress of the Button . So the solution is to use always mode. This way the Button always gets the press event first.</p>
<pre><code>&lt;ScrollView keyboardShouldPersistTaps=&apos;always&apos; /&gt;</code></pre><h2 id="ScrollView-cares-about-keyboard"><a href="#ScrollView-cares-about-keyboard" class="headerlink" title="ScrollView cares about keyboard"></a>ScrollView cares about keyboard</h2><p>The native RCTScrollView class that power react native ScrollView has code to handle dismiss mode</p>
<pre><code>RCT_SET_AND_PRESERVE_OFFSET(setKeyboardDismissMode, keyboardDismissMode, UIScrollViewKeyboardDismissMode)</code></pre><p>The option that it chooses is UIScrollViewKeyboardDismissMode for <a href="https://developer.apple.com/documentation/uikit/uiscrollview/1619437-keyboarddismissmode">keyboardDismissMode</a> property</p>
<blockquote>
<p>The manner in which the keyboard is dismissed when a drag begins in the scroll view.</p>
</blockquote>
<p>As you can see, the possible modes are onDrag and interactive . And react native exposes customization point for this via keyboardShouldPersistTaps</p>
<p><a href="https://developer.apple.com/documentation/uikit/uiscrollview/keyboarddismissmode/none">case none</a> The keyboard does not get dismissed with a drag.</p>
<p><a href="https://developer.apple.com/documentation/uikit/uiscrollview/keyboarddismissmode/ondrag">case onDrag</a> The keyboard is dismissed when a drag begins.</p>
<p><a href="https://developer.apple.com/documentation/uikit/uiscrollview/keyboarddismissmode/interactive">case interactive</a> The keyboard follows the dragging touch offscreen, and can be pulled upward again to cancel the dismiss.</p>
<h2 id="ScrollView-inside-a-Modal"><a href="#ScrollView-inside-a-Modal" class="headerlink" title="ScrollView inside a Modal"></a>ScrollView inside a Modal</h2><p>But that does not work when ScrollView is inside <a href="https://facebook.github.io/react-native/docs/modal.html">Modal</a> . By Modal I meant the <a href="https://facebook.github.io/react-native/docs/modal.html">Modal</a> component in React Native. The only library that I use is react-navigation , and it supports <a href="https://reactnavigation.org/docs/en/modal.html">Opening a full-screen modal</a> too, but they way we declare modal in react-navigation looks like stack and it is confusing, so I would rather not use it. I use Modal in react-native and that works pretty well.</p>
<p>So if we have TextInput inside ScrollView inside Modal then keyboardShouldPersistTaps does not work. Modal seems to be aware of parent ScrollView so we have to declare keyboardShouldPersistTaps=’always’ on every parent ScrollView . In React Native FlatList and SectionList uses ScrollView under the hood, so we need to be aware of all those ScrollView components.</p>
<h2 id="Spelunking-react-navigation"><a href="#Spelunking-react-navigation" class="headerlink" title="Spelunking react-navigation"></a>Spelunking react-navigation</h2><p>Since my app relies heavily on react-navigation , it’s good to have a deep understanding about its components so we make sure where the problem lies. I’ve written a bit about react-navigation structure below.<br><a href="https://codeburst.io/using-react-navigation-3-0-in-react-native-apps-38cd5020fbbe"><strong>Using react-navigation 3.0 in React Native apps</strong><br><em>react-navigation is probably the only dependency I use in React Native apps. I’m happy with it so far, then version 3.0…</em>codeburst.io</a></p>
<p>Like every traditional mobile apps, my app consists of many stack navigators inside tab navigator. In iOS that means many UINavigationViewController inside UITabbarController . In react-navigation I use createMaterialTopTabNavigator inside createBottomTabNavigator</p>
<pre><code>import { createMaterialTopTabNavigator } from &apos;react-navigation&apos;
import { createBottomTabNavigator, BottomTabBar } from &apos;react-navigation-tabs&apos;</code></pre><p>The screen I have keyboard issue is a Modal presented from the 2nd screen in one of the stack navigators, so let’s examine every possible ScrollView up the hierarchy. This process involves lots of code reading and this’s how I love open source.</p>
<p>First let’s start with <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/navigators/createBottomTabNavigator.js">createBottomTabNavigator</a> which uses <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/utils/createTabNavigator.js">createTabNavigator</a> together with its own TabNavigationView</p>
<pre><code>class TabNavigationView extends React.PureComponent&lt;Props, State&gt;

export default createTabNavigator(TabNavigationView);</code></pre><p>Tab navigator has tab bar view below ScreenContainer , which is used to contain view. ScreenContainer is from <a href="https://github.com/kmagiera/react-native-screens">react-native-screens</a> “This project aims to expose native navigation container components to React Native”. Below is how tab navigator works.</p>
<pre><code>render() {
  const { navigation, renderScene, lazy } = this.props;
  const { routes } = navigation.state;
  const { loaded } = this.state
  return (
    &lt;View style={styles.container}&gt;
      &lt;ScreenContainer style={styles.pages}&gt;
        {routes.map((route, index) =&gt; {
          if (lazy &amp;&amp; !loaded.includes(index)) {
            // Don&apos;t render a screen if we&apos;ve never navigated to it
            return null;

          const isFocused = navigation.state.index === index
          return (
            &lt;ResourceSavingScene
              key={route.key}
              style={StyleSheet.absoluteFill}
              isVisible={isFocused}
            &gt;
              {renderScene({ route })}
            &lt;/ResourceSavingScene&gt;
          );
        })}
      &lt;/ScreenContainer&gt;
      {this._renderTabBar()}
    &lt;/View&gt;
  );
}</code></pre><p>Tab bar is rendered using <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/views/BottomTabBar.js">BottomTabBar</a> in _renderTabBar function. Looking at the code, the whole tab navigator has nothing to do with ScrollView .</p>
<p>So there is only <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/navigators/createMaterialTopTabNavigator.js">createMaterialTopTabNavigator</a> left on the suspecting list. I use it in the app with swipeEnabled: true . And by looking at the imports, top tab navigator has</p>
<pre><code>import MaterialTopTabBar, {  type TabBarOptions,} from &apos;../views/MaterialTopTabBar&apos;;</code></pre><p><a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/views/MaterialTopTabBar.js">MaterialTopTabBar</a> has import from <a href="https://github.com/react-native-community/react-native-tab-view/blob/master/src/TabBar.js">react-native-tab-view</a></p>
<pre><code>import { TabBar } from &apos;react-native-tab-view&apos;;</code></pre><p>which has ScrollView</p>
<pre><code>&lt;View style={styles.scroll}&gt;
  &lt;Animated.ScrollView
    horizontal
    keyboardShouldPersistTaps=&quot;handled&quot;</code></pre><p>The property keyboardShouldPersistTaps was initial set to always , then set back to <a href="https://github.com/react-native-community/react-native-tab-view/commit/e00bd021158a9ca6ad6f1ad0578303f0fdedb9e6#diff-9c1d42ef76323a8c67bd25bccfea6132">handled</a> to avoid the bug that we can’t press any button in tab bar while keyboard is open <a href="https://github.com/react-native-community/react-native-tab-view/issues/375">https://github.com/react-native-community/react-native-tab-view/issues/375</a></p>
<p>But this TabBar has nothing with our problem, because it’s just for containing tab bar buttons.</p>
<h2 id="Swiping-in-createMaterialTopTabNavigator"><a href="#Swiping-in-createMaterialTopTabNavigator" class="headerlink" title="Swiping in createMaterialTopTabNavigator"></a>Swiping in createMaterialTopTabNavigator</h2><p>Taking another look at <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/navigators/createMaterialTopTabNavigator.js">createMaterialTopTabNavigator</a> we see more imports from react-native-tab-view</p>
<pre><code>import { TabView, PagerPan } from &apos;react-native-tab-view&apos;;</code></pre><p>TabView has swipeEnabled passed in</p>
<pre><code>return (
  &lt;TabView
    {...rest}
    navigationState={navigation.state}
    animationEnabled={animationEnabled}
    swipeEnabled={swipeEnabled}
    onAnimationEnd={this._handleAnimationEnd}
    onIndexChange={this._handleIndexChange}
    onSwipeStart={this._handleSwipeStart}
    renderPager={renderPager}
    renderTabBar={this._renderTabBar}
    renderScene={
      /* $FlowFixMe */
      this._renderScene
    }
  /&gt;
);</code></pre><p>and it renders <a href="https://github.com/react-native-community/react-native-tab-view/blob/8b463fc31d/src/PagerDefault.js">PagerDefault</a>, which in turn uses PagerScroll for iOS</p>
<pre><code>import { Platform } from &apos;react-native&apos;;

let Pager;

switch (Platform.OS) {
  case &apos;android&apos;:
    Pager = require(&apos;./PagerAndroid&apos;).default;
    break;
  case &apos;ios&apos;:
    Pager = require(&apos;./PagerScroll&apos;).default;
    break;
  default:
    Pager = require(&apos;./PagerPan&apos;).default;
    break;
}

export default Pager;</code></pre><p>So <a href="https://github.com/react-native-community/react-native-tab-view/blob/8b463fc31d/src/PagerScroll.js">PagerScroll</a> uses ScrollView to handle scrolling to match material style that user can scroll between pages, and it has keyboardShouldPersistTaps=”always” which should be correct.</p>
<pre><code>return (
  &lt;ScrollView
    horizontal
    pagingEnabled
    directionalLockEnabled
    keyboardDismissMode=&quot;on-drag&quot;
    keyboardShouldPersistTaps=&quot;always&quot;</code></pre><p>So nothing looks suspicious in react-navigation , which urges me to look at code from my project.</p>
<h2 id="Debugging-FlatList-SectionList-and-ScrollView"><a href="#Debugging-FlatList-SectionList-and-ScrollView" class="headerlink" title="Debugging FlatList, SectionList and ScrollView"></a>Debugging FlatList, SectionList and ScrollView</h2><p>Like I stated in the beginning of this article, the root problem is that we need to declare keyboardShouldPersistTaps for all parent ScrollView in the hierarchy. That means to look out for any FlatList, SectionList and ScrollView</p>
<p>Luckily, there is react-devtools that shows tree of all rendered components in react app, and that is also guided in <a href="https://facebook.github.io/react-native/docs/debugging.html">Debugging</a> section of react native.</p>
<p>You can use <a href="https://github.com/facebook/react-devtools/tree/master/packages/react-devtools">the standalone version of React Developer Tools</a> to debug the React component hierarchy. To use it, install the react-devtools package globally:</p>
<pre><code>npm install -g react-devtools</code></pre><p>So after searching I found out that there is a SectionList up the hierarchy that should have keyboardShouldPersistTaps=’always’ while it didn’t.</p>
<p><img src="https://cdn-images-1.medium.com/max/7168/1*RDNnY3yKYpgxdaXi4bGUTg.png" alt=""></p>
<p>Taking a thorough look at the code, I found out that the Modal is trigged from a SectionList item. We already know that triggering Modal in react native means that to embed that Modal inside the view hierarchy and control its visibility via a state. So in terms of view and component, that Modal is inside a SectionList . And for your interest, if you dive deep into react native code, SectionList in my case is just VirtualizedSectionList , which is VirtualizedList, which uses ScrollView</p>
<p>So after I declare keyboardShouldPersistTaps=’always’ in that SectionList , the problem is solved. User can now just enters some values in the text inputs, then press once on the submit button to submit data. The button now captures touch events first instead of scrollview.</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>The solution for this is fortunately simple as it involves fixing our code without having to alter react-navigation code. But it’s good to look at the library code to know what it does, and to trace where the problem originates. Thanks for following such long exploring and hope you learn something.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T05:48:09.000Z" title="2019-05-23T05:48:09.000Z">2019-05-23</time><span class="level-item">21 minutes read (About 3191 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-structure-your-project-and-manage-static-resources-in-React-Native/">How to structure your project and manage static resources in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/256">#256</a></strong></p>
<p>Original post <a href="https://medium.freecodecamp.org/how-to-structure-your-project-and-manage-static-resources-in-react-native-6f4cfc947d92">https://medium.freecodecamp.org/how-to-structure-your-project-and-manage-static-resources-in-react-native-6f4cfc947d92</a></p>
<hr>
<p>React and React Native are just frameworks, and they do not dictate how we should structure our projects. It all depends on your personal taste and the project you’re working on.</p>
<p>In this post, we will go through how to structure a project and how to manage local assets. This of course is not written in stone, and you are free to apply only the pieces that suit you. Hope you learn something.</p>
<p>For a project bootstrapped with <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">react-native init</a> , we get only the <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">basic structure</a>.</p>
<p>There is the ios folder for Xcode projects, the android folder for Android projects, and an index.js and an App.js file for the React Native starting point.</p>
<pre><code>ios/
android/
index.js
App.js</code></pre><p>As someone who has worked with native on both Windows Phone, iOS and Android, I find that structuring a project all comes down to separating files by <strong>type</strong> or <strong>feature</strong></p>
<h2 id="type-vs-feature"><a href="#type-vs-feature" class="headerlink" title="type vs feature"></a>type vs feature</h2><p>Separating by type means that we organise files by their type. If it is a component, there are container and presentational files. If it is Redux, there are action, reducer, and store files. If it is view, there are JavaScript, HTML, and CSS files.</p>
<h3 id="Group-by-type"><a href="#Group-by-type" class="headerlink" title="Group by type"></a>Group by type</h3><pre><code>redux
  actions
  store
  reducers
components
  container
  presentational
view
  javascript
  html
  css</code></pre><p>This way, we can see the type of each file, and easily run a script toward a certain file type. This is general for all projects, but it does not answer the question “what is this project about?” Is it news application? Is it a loyalty app? Is it about nutrition tracking?</p>
<p>Organising files by type is for a machine, not for a human. Many times we work on a feature, and finding files to fix in multiple directories is a hassle. It’s also a pain if we plan to make a framework out of our project, as files are spread across many places.</p>
<h3 id="Group-by-feature"><a href="#Group-by-feature" class="headerlink" title="Group by feature"></a>Group by feature</h3><p>A more reasonable solution is to organise files by feature. Files related to a feature should be placed together. And <a href="https://medium.com/@JeffLombardJr/organizing-tests-in-jest-17fc431ff850">test files</a> should stay close to the source files. Check out <a href="https://medium.com/@JeffLombardJr/organizing-tests-in-jest-17fc431ff850">this article</a> to learn more.</p>
<p>A feature can be related to login, sign up, onboarding, or a user’s profile. A feature can contain sub-features as long as they belong to the same flow. If we wanted to move the sub feature around, it would be easy, as all related files are already grouped together.</p>
<p>My typical project structure based on features looks like this:</p>
<pre><code>index.js
App.js
ios/
android/
src
  screens
    login
      LoginScreen.js
      LoginNavigator.js
    onboarding
      OnboardingNavigator    
      welcome 
        WelcomeScreen.js
      term
        TermScreen.js
      notification
        NotificationScreen.js
    main
      MainNavigator.js
      news
        NewsScreen.js
      profile
        ProfileScreen.js
      search
        SearchScreen.js
  library
    package.json
    components
      ImageButton.js
      RoundImage.js
    utils
      moveToBottom.js
      safeArea.js
    networking
      API.js
      Auth.js
  res
    package.json
    strings.js
    colors.js
    palette.js
    fonts.js
    images.js
    images
      logo@2x.png
      logo@3x.png
      button@2x.png
      button@3x.png
scripts
  images.js
  clear.js</code></pre><p>Besides the traditional files App.js and index.js and the ios1 and android folders, I put all the source files inside the src folder. Inside src I have res for resources, library for common files used across features, and screens for a screen of content.</p>
<h3 id="As-few-dependencies-as-possible"><a href="#As-few-dependencies-as-possible" class="headerlink" title="As few dependencies as possible"></a>As few dependencies as possible</h3><p>Since React Native is heavily dependent on tons of dependencies, I try to be pretty aware when adding more. In my project I use just react-navigation for navigation. And I’m not a fan of redux as it adds unneeded complexity. Only add a dependency when you really need it, otherwise you are just setting yourself up for more trouble than value.</p>
<p>The thing I like about React is the components. A component is where we define view, style and behavior. React has inline style — it’s like using JavaScript to define script, HTML and CSS. This fits the feature approach we are aiming for. That’s why I don’t use <a href="https://github.com/styled-components/styled-components">styled-components</a>. Since styles are just JavaScript objects, we can just share comment styles in library .</p>
<h2 id="src"><a href="#src" class="headerlink" title="src"></a>src</h2><p>I like Android a lot, so I name src and res to match its folder conventions.</p>
<p>react-native init sets up babel for us. But for a typical JavaScript project, it’s good to organise files in the src folder. In my electron.js application <a href="https://github.com/onmyway133/IconGenerator/tree/master/src">IconGenerator</a>, I put the source files inside the src folder. This not only helps in terms of organising, but also helps babel transpile the entire folder at once. Just a command and I have the files in src transpiled to dist in a blink.</p>
<pre><code>babel ./src --out-dir ./dist --copy-files</code></pre><h2 id="Screen"><a href="#Screen" class="headerlink" title="Screen"></a>Screen</h2><p>React is based around components. Yup. There are <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">container and presentational components</a>, but we can compose components to build more complex components. They usually end in showing in the full screen. It is called Page in Windows Phone, ViewController in iOS and Activity in Android. The React Native guide mentions <a href="https://facebook.github.io/react-native/docs/navigation">screen</a> very often as something that covers the entire space:</p>
<blockquote>
<h1 id="Mobile-apps-are-rarely-made-up-of-a-single-screen-Managing-the-presentation-of-and-transition-between-multiple-screens-is-typically-handled-by-what-is-known-as-a-navigator"><a href="#Mobile-apps-are-rarely-made-up-of-a-single-screen-Managing-the-presentation-of-and-transition-between-multiple-screens-is-typically-handled-by-what-is-known-as-a-navigator" class="headerlink" title="Mobile apps are rarely made up of a single screen. Managing the presentation of, and transition between, multiple screens is typically handled by what is known as a navigator."></a>Mobile apps are rarely made up of a single screen. Managing the presentation of, and transition between, multiple screens is typically handled by what is known as a navigator.</h1></blockquote>
<h3 id="index-js-or-not"><a href="#index-js-or-not" class="headerlink" title="index.js or not?"></a>index.js or not?</h3><p>Each screen is considered the entry point for each feature. You can rename the LoginScreen.js to index.js by leveraging the Node <a href="https://medium.freecodecamp.org/requiring-modules-in-node-js-everything-you-need-to-know-e7fbd119be8">module</a> feature:</p>
<blockquote>
<p>Modules don’t have to be files. We can also create a find-me folder under node_modules and place an index.js file in there. The same require(‘find-me’) line will use that folder’s index.js file</p>
</blockquote>
<p>So instead of import LoginScreen from ‘./screens/LoginScreen’ , we can just do import LoginScreen from ‘./screens’.</p>
<p>Using index.js results in encapsulation and provides a public interface for the feature. This is all personal taste. I myself prefer explicit naming for a file, hence the name LoginScreen.js.</p>
<h2 id="Navigator"><a href="#Navigator" class="headerlink" title="Navigator"></a>Navigator</h2><p><a href="https://github.com/react-navigation/react-navigation">react-navigation</a> seems to be the most popular choice for handling navigation in a React Native app. For a feature like onboarding, there are probably many screens managed by a stack navigation, so there is OnboardingNavigator .</p>
<p>You can think of Navigator as something that groups sub screens or features. Since we group by feature, it’s reasonable to place Navigator inside the feature folder. It basically looks like this:</p>
<pre><code>import { createStackNavigator } from &apos;react-navigation&apos;
import Welcome from &apos;./Welcome&apos;
import Term from &apos;./Term&apos;

const routeConfig = {
  Welcome: {
    screen: Welcome
  },
  Term: {
    screen: Term
  }
}

const navigatorConfig = {
  navigationOptions: {
    header: null
  }
}

export default OnboardingNavigator = createStackNavigator(routeConfig, navigatorConfig)</code></pre><h2 id="library"><a href="#library" class="headerlink" title="library"></a>library</h2><p>This is the most controversial part of structuring a project. If you don’t like the name library, you can name it utilities, common, citadel , whatever…</p>
<p>This is not meant for homeless files, but it is where we place common utilities and components that are used by many features. Things like atomic components, wrappers, quick fixes function, networking stuff, and login info are used a lot, and it’s hard to move them to a specific feature folder. Sometimes we just need to be practical and get the work done.</p>
<p>In React Native, we often need to implement a button with an image background in many screens. Here is a simple one that stays inside library/components/ImageButton.js . The components folder is for reusable components, sometimes called <a href="https://medium.com/joeydinardo/a-brief-look-at-atomic-components-39cbe71d38b5">atomic components</a>. According to React naming conventions, the first letter should be uppercase.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; TouchableOpacity, View, Image, Text, StyleSheet &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> images <span class="keyword">from</span> <span class="string">'res/images'</span></span><br><span class="line"><span class="keyword">import</span> colors <span class="keyword">from</span> <span class="string">'res/colors'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;TouchableOpacity style=&#123;styles.touchable&#125; onPress=&#123;<span class="keyword">this</span>.props.onPress&#125;&gt;</span><br><span class="line">                &lt;View style=&#123;styles.view&#125;&gt;</span><br><span class="line">                    &lt;Text style=&#123;styles.text&#125;&gt;&#123;<span class="keyword">this</span>.props.title&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>View&gt;</span><br><span class="line">                &lt;Image</span><br><span class="line">                    source=&#123;images.button&#125;</span><br><span class="line">                    style=&#123;styles.image&#125; /&gt;</span><br><span class="line">            &lt;<span class="regexp">/TouchableOpacity&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    view: &#123;</span></span><br><span class="line"><span class="regexp">        position: 'absolute',</span></span><br><span class="line"><span class="regexp">        backgroundColor: 'transparent'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    image: &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    touchable: &#123;</span></span><br><span class="line"><span class="regexp">        alignItems: 'center',</span></span><br><span class="line"><span class="regexp">        justifyContent: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    text: &#123;</span></span><br><span class="line"><span class="regexp">        color: colors.button,</span></span><br><span class="line"><span class="regexp">        fontSize: 18,</span></span><br><span class="line"><span class="regexp">        textAlign: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<p>And if we want to place the button at the bottom, we use a utility function to prevent code duplication. Here is library/utils/moveToBottom.js:</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet } from &apos;react-native&apos;

function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})

export default moveToBottom</code></pre><h3 id="Use-package-json-to-avoid-relative-path"><a href="#Use-package-json-to-avoid-relative-path" class="headerlink" title="Use package.json to avoid relative path"></a>Use package.json to avoid relative path</h3><p>Then somewhere in the src/screens/onboarding/term/Term.js , we can import by using relative paths:</p>
<pre><code>import moveToBottom from &apos;../../../../library/utils/move&apos;
import ImageButton from &apos;../../../../library/components/ImageButton&apos;</code></pre><p>This is a big red flag in my eyes. It’s error prone, as we need to calculate how many .. we need to perform. And if we move feature around, all of the paths need to be recalculated.</p>
<p>Since library is meant to be used many places, it’s good to reference it as an absolute path. In JavaScript there are usually 1000 libraries to a single problem. A quick search on Google reveals tons of libraries to tackle this issue. But we don’t need another dependency as this is extremely easy to fix.</p>
<p>The solution is to turn library into a module so node can find it. Adding package.json to any folder makes it into a Node module . Add package.json inside the library folder with this simple content:</p>
<pre><code>{
  &quot;name&quot;: &quot;library&quot;,
  &quot;version&quot;: &quot;0.0.1&quot;
}</code></pre><p>Now in Term.js we can easily import things from library because it is now a module:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, StyleSheet, Image, Text, Button &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> strings <span class="keyword">from</span> <span class="string">'res/strings'</span></span><br><span class="line"><span class="keyword">import</span> palette <span class="keyword">from</span> <span class="string">'res/palette'</span></span><br><span class="line"><span class="keyword">import</span> images <span class="keyword">from</span> <span class="string">'res/images'</span></span><br><span class="line"><span class="keyword">import</span> ImageButton <span class="keyword">from</span> <span class="string">'library/components/ImageButton'</span></span><br><span class="line"><span class="keyword">import</span> moveToBottom <span class="keyword">from</span> <span class="string">'library/utils/moveToBottom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Term</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">                &lt;Text style=&#123;styles.heading&#125;&gt;&#123;strings.onboarding.term.heading.toUpperCase()&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">                &#123;</span></span><br><span class="line"><span class="regexp">                    moveToBottom(</span></span><br><span class="line"><span class="regexp">                        &lt;ImageButton style=&#123;styles.button&#125; title=&#123;strings.onboarding.term.button.toUpperCase()&#125; /</span>&gt;</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    container: &#123;</span></span><br><span class="line"><span class="regexp">        flex: 1,</span></span><br><span class="line"><span class="regexp">        alignItems: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    heading: &#123;</span></span><br><span class="line"><span class="regexp">        ...palette.heading, ...&#123;</span></span><br><span class="line"><span class="regexp">            marginTop: 72</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="res"><a href="#res" class="headerlink" title="res"></a>res</h2><p>You may wonder what res/colors, res/strings , res/images and res/fonts are in the above examples. Well, for front end projects, we usually have components and style them using fonts, localised strings, colors, images and styles. JavaScript is a very dynamic language, and it’s easy to use stringly types everywhere. We could have a bunch of #00B75D color across many files, or Fira as a fontFamily in many Text components. This is error-prone and hard to refactor.</p>
<p>Let’s encapsulate resource usage inside the res folder with safer objects. They look like the examples below:</p>
<p><strong>res/colors</strong></p>
<pre><code>const colors = {
  title: &apos;#00B75D&apos;,
  text: &apos;#0C222B&apos;,
  button: &apos;#036675&apos;
}

export default colors</code></pre><p><strong>res/strings</strong></p>
<pre><code>const strings = {
  onboarding: {
    welcome: {
      heading: &apos;Welcome&apos;,
      text1: &quot;What you don&apos;t know is what you haven&apos;t learn&quot;,
      text2: &apos;Visit my GitHub at [https://github.com/onmyway133&apos;](https://github.com/onmyway133&apos;),
      button: &apos;Log in&apos;
    },
    term: {
      heading: &apos;Terms and conditions&apos;,
      button: &apos;Read&apos;
    }
  }
}

export default strings</code></pre><p><strong>res/fonts</strong></p>
<pre><code>const fonts = {
  title: &apos;Arial&apos;,
  text: &apos;SanFrancisco&apos;,
  code: &apos;Fira&apos;
}

export default fonts</code></pre><p><strong>res/images</strong></p>
<pre><code>const images = {
  button: require(&apos;./images/button.png&apos;),
  logo: require(&apos;./images/logo.png&apos;),
  placeholder: require(&apos;./images/placeholder.png&apos;)
}

export default images</code></pre><p>Like library , res files can be access from anywhere, so let’s make it a module . Add package.json to the res folder:</p>
<pre><code>{
  &quot;name&quot;: &quot;res&quot;,
  &quot;version&quot;: &quot;0.0.1&quot;
}</code></pre><p>so we can access resource files like normal modules:</p>
<pre><code>import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;</code></pre><h3 id="Group-colors-images-fonts-with-palette"><a href="#Group-colors-images-fonts-with-palette" class="headerlink" title="Group colors, images, fonts with palette"></a>Group colors, images, fonts with palette</h3><p>The design of the app should be consistent. Certain elements should have the same look and feel so they don’t confuse the user. For example, the heading Text should use one color, font, and font size. The Image component should use the same placeholder image. In React Native, we already use the name styles with const styles = StyleSheet.create({}) so let’s use the name palette.</p>
<p>Below is my simple palette. It defines common styles for heading and Text:</p>
<h3 id="res-palette"><a href="#res-palette" class="headerlink" title="res/palette"></a>res/palette</h3><pre><code>import colors from &apos;./colors&apos;

const palette = {
  heading: {
    color: colors.title,
    fontSize: 20,
    textAlign: &apos;center&apos;
  },
  text: {
    color: colors.text,
    fontSize: 17,
    textAlign: &apos;center&apos;
  }
}

export default palette</code></pre><p>And then we can use them in our screen:</p>
<pre><code>const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  heading: {...palette.heading, ...{
    marginTop: 72
  }}
})</code></pre><p>Here we use the <a href="https://github.com/tc39/proposal-object-rest-spread">object spread operator</a> to merge palette.heading and our custom style object. This means that we use the styles from palette.heading but also specify more properties.</p>
<p>If we were to reskin the app for multiple brands, we could have multiple palettes. This is a really powerful pattern.</p>
<h3 id="Generate-images"><a href="#Generate-images" class="headerlink" title="Generate images"></a>Generate images</h3><p>You can see that in /src/res/images.js we have properties for each image in the src/res/images folder:</p>
<pre><code>const images = {
  button: require(&apos;./images/button.png&apos;),
  logo: require(&apos;./images/logo.png&apos;),
  placeholder: require(&apos;./images/placeholder.png&apos;)
}

export default images</code></pre><p>This is tedious to do manually, and we have to update if there’s changes in image naming convention. Instead, we can add a script to generate the images.js based on the images we have. Add a file at the root of the project /scripts/images.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imageFileNames = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> array = fs</span><br><span class="line">        .readdirSync(<span class="string">'src/res/images'</span>)</span><br><span class="line">        .filter(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.endsWith(<span class="string">'.png'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.replace(<span class="string">'[@2x](http://twitter.com/2x).png'</span>, <span class="string">''</span>).replace(<span class="string">'[@3x](http://twitter.com/3x).png'</span>, <span class="string">''</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> properties = imageFileNames()</span><br><span class="line">        .map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;name&#125;</span>: require('./images/<span class="subst">$&#123;name&#125;</span>.png')`</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">',\n  '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> string = <span class="string">`const images = &#123;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;properties&#125;</span></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default images</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(<span class="string">'src/res/images.js'</span>, string, <span class="string">'utf8'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generate()</span><br></pre></td></tr></table></figure>

<p>The cool thing about Node is that we have access to the fs module, which is really good at file processing. Here we simply traverse through images, and update /src/res/images.js accordingly.</p>
<p>Whenever we add or change images, we can run:</p>
<pre><code>node scripts/images.js</code></pre><p>And we can also declare the script inside our main package.json :</p>
<pre><code>&quot;scripts&quot;: {
  &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;,
  &quot;test&quot;: &quot;jest&quot;,
  &quot;lint&quot;: &quot;eslint *.js **/*.js&quot;,
  &quot;images&quot;: &quot;node scripts/images.js&quot;
}</code></pre><p>Now we can just run npm run images and we get an up-to-date images.js resource file.</p>
<h3 id="How-about-custom-fonts"><a href="#How-about-custom-fonts" class="headerlink" title="How about custom fonts"></a>How about custom fonts</h3><p>React Native has some <a href="https://medium.com/react-native-training/list-of-available-react-native-fonts-ed78b48bd45e">custom fonts</a> that may be good enough for your projects. You can also use custom fonts.</p>
<p>One thing to note is that Android uses the name of the font file, but iOS uses the full name. You can see the full name in Font Book app, or by inspecting in running app</p>
<pre><code>for (NSString* family in [UIFont familyNames]) {
  NSLog(@&quot;%@&quot;, family);

for (NSString* name in [UIFont fontNamesForFamilyName: family]) {
    NSLog(@&quot;Family name:  %@&quot;, name);
  }
}</code></pre><p>For custom fonts to be registered in iOS, we need to declare UIAppFonts in Info.plist using the file name of the fonts, and for Android, the fonts need to be placed at app/src/main/assets/fonts .</p>
<p>It is good practice to name the font file the same as full name. React Native is said to dynamically load custom fonts, but in case you get “Unrecognized font family”, then simply add those fonts to target within Xcode.</p>
<p>Doing this by hand takes time, luckily we have <a href="https://github.com/rnpm/rnpm">rnpm</a> that can help. First add all the fonts inside res/fonts folder. Then simply declare rnpm in package.json and run react-native link . This should declare UIAppFonts in iOS and move all the fonts into app/src/main/assets/fonts for Android.</p>
<pre><code>&quot;rnpm&quot;: {
  &quot;assets&quot;: [
    &quot;./src/res/fonts/&quot;
  ]
}</code></pre><p>Accessing fonts by name is error prone, we can create a script similar to what we have done with images to generate a safer accession. Add fonts.js to our scripts folder</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fontFileNames = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> array = fs</span><br><span class="line">        .readdirSync(<span class="string">'src/res/fonts'</span>)</span><br><span class="line">        .map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.replace(<span class="string">'.ttf'</span>, <span class="string">''</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> properties = fontFileNames()</span><br><span class="line">        .map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> key = name.replace(<span class="regexp">/\s/g</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;key&#125;</span>: '<span class="subst">$&#123;name&#125;</span>'`</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">',\n  '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> string = <span class="string">`const fonts = &#123;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;properties&#125;</span></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default fonts</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(<span class="string">'src/res/fonts.js'</span>, string, <span class="string">'utf8'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generate()</span><br></pre></td></tr></table></figure>

<p>Now you can use custom font via R namespace.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> R <span class="keyword">from</span> <span class="string">'res/R'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">    text: &#123;</span><br><span class="line">        fontFamily: R.fonts.FireCodeNormal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="The-R-namespace"><a href="#The-R-namespace" class="headerlink" title="The R namespace"></a>The R namespace</h2><p>This step depends on personal taste, but I find it more organised if we introduce the R namespace, just like how Android does for assets with the generated <a href="https://stackoverflow.com/questions/9408544/what-is-r-class-in-android/9408589">R class</a>.</p>
<blockquote>
<p>Once you externalize your app resources, you can access them using resource IDs that are generated in your project’s Rclass. This document shows you how to group your resources in your Android project and provide alternative resources for specific device configurations, and then access them from your app code or other XML files.</p>
</blockquote>
<p>This way, let’s make a file called R.js in src/res:</p>
<pre><code>import strings from &apos;./strings&apos;
import images from &apos;./images&apos;
import colors from &apos;./colors&apos;
import palette from &apos;./palette&apos;

const R = {
  strings,
  images,
  colors,
  palette
}

export default R</code></pre><p>And access it in the screen:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> R <span class="keyword">from</span> <span class="string">'res/R'</span></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;SafeAreaView style=&#123;styles.container&#125;&gt;</span><br><span class="line">      &lt;Image</span><br><span class="line">        style=&#123;styles.logo&#125;</span><br><span class="line">        source=&#123;R.images.logo&#125; /&gt;</span><br><span class="line">      &lt;Image</span><br><span class="line">        style=&#123;styles.image&#125;</span><br><span class="line">        source=&#123;R.images.placeholder&#125; /&gt;</span><br><span class="line">      &lt;Text style=&#123;styles.title&#125;&gt;&#123;R.strings.onboarding.welcome.title.toUpperCase()&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Replace strings with R.strings, colors with R.colors, and images with R.images. With the R annotation, it is clear that we are accessing static assets from the app bundle.</p>
<p>This also matches the Airbnb <a href="https://github.com/airbnb/javascript#naming--PascalCase-singleton">convention</a> for singleton, as our R is now like a global constant.</p>
<blockquote>
<p><a href="https://github.com/airbnb/javascript#naming--PascalCase-singleton">23.8</a> Use PascalCase when you export a constructor / class / singleton / function library / bare object.</p>
</blockquote>
<pre><code>const AirbnbStyleGuide = {
  es6: {
  },
}

export default AirbnbStyleGuide</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>In this post, I’ve shown you how I think you should structure folders and files in a React Native project. We’ve also learned how to manage resources and access them in a safer manner. I hope you’ve found it useful. Here are some more resources to explore further:</p>
<ul>
<li><a href="https://medium.com/the-react-native-log/organizing-a-react-native-project-9514dfadaa0">Organizing a React Native Project</a></li>
<li><a href="https://hackernoon.com/structuring-projects-and-naming-components-in-react-1261b6e18d76">Structuring projects and naming components in React</a></li>
<li><a href="https://alligator.io/react/index-js-public-interfaces/">Using index.js for Fun and Public Interfaces</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-22T17:14:43.000Z" title="2019-05-22T17:14:43.000Z">2019-05-22</time><span class="level-item">a few seconds read (About 102 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-overlay-view-on-another-view-in-React-Native/">How to overlay view on another view in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/254">#254</a></strong></p>
<p>Original post <a href="https://stackoverflow.com/a/54108708/1418457">https://stackoverflow.com/a/54108708/1418457</a></p>
<hr>
<p>Make our own convenient OverlayContainer. The trick is to use <code>absolute</code> with <code>100%</code> size</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @flow</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, StyleSheet &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">  behind: React.Component,</span><br><span class="line">  front: React.Component,</span><br><span class="line">  under: React.Component</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Show something on top of other</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">OverlayContainer</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">Props</span>&gt; </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; behind, front, under &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;View style=&#123;styles.center&#125;&gt;</span><br><span class="line">          &lt;View style=&#123;styles.behind&#125;&gt;</span><br><span class="line">            &#123;behind&#125;</span><br><span class="line">          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">          &#123;front&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>View&gt;</span><br><span class="line">        &#123;under&#125;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">  container: &#123;</span></span><br><span class="line"><span class="regexp">    flex: 1,</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    height: 100,</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  center: &#123;</span></span><br><span class="line"><span class="regexp">    width: '100%',</span></span><br><span class="line"><span class="regexp">    height: '100%',</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  behind: &#123;</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">    position: 'absolute',</span></span><br><span class="line"><span class="regexp">    left: 0,</span></span><br><span class="line"><span class="regexp">    top: 0,</span></span><br><span class="line"><span class="regexp">    width: '100%',</span></span><br><span class="line"><span class="regexp">    height: '100%'</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T09:11:44.000Z" title="2019-05-21T09:11:44.000Z">2019-05-21</time><span class="level-item">6 minutes read (About 895 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-remove-Cartography-in-iOS/">How to remove Cartography in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/252">#252</a></strong></p>
<p>Read more <a href="https://medium.com/flawless-app-stories/how-to-make-auto-layout-more-convenient-in-ios-df3b42fed37f">https://medium.com/flawless-app-stories/how-to-make-auto-layout-more-convenient-in-ios-df3b42fed37f</a></p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>This is a script to remove Cartography, and use plain NSLayoutAnchor syntax.<br>Use Constraint.on() from Sugar.<br>It will change all .swift files recursively under provided folder.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Constraint</span>.on(</span><br><span class="line">    logoImageView.widthAnchor.constraint(equalToConstant: <span class="number">74</span>),</span><br><span class="line">    view1.leftAnchor.constraint(equalTo: view2.leftAnchor, constant: <span class="number">20</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><ul>
<li>Parse recursively</li>
<li>Parse a single file</li>
<li>Parse each constrain block separately</li>
<li>Handle ==, &gt;=, &lt;=</li>
<li>Handle center, edges</li>
<li>Infer indentation</li>
<li>Handle relation with other item</li>
<li>Handle relation with constant</li>
<li>Handle multiplier</li>
<li>Auto import Sugar</li>
<li>Infer superView</li>
</ul>
<h2 id="Prepare"><a href="#Prepare" class="headerlink" title="Prepare"></a>Prepare</h2><p>Install tool if needed</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install yarn</span><br></pre></td></tr></table></figure>

<p>How to use</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br><span class="line">yarn start &#x2F;Users&#x2F;khoa&#x2F;path&#x2F;to&#x2F;project</span><br></pre></td></tr></table></figure>

<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> Glob = <span class="built_in">require</span>(<span class="string">'glob'</span>)</span><br><span class="line"><span class="keyword">const</span> Fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> projectPath = getProjectPath()</span><br><span class="line">  <span class="keyword">const</span> files = getAllFiles(projectPath)</span><br><span class="line"></span><br><span class="line">  files.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">    handleFile(file)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// The 1st argument is node, 2nd is index.js, 3rd is path</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProjectPath</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> process.argv[<span class="number">2</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Only select `swift` file</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAllFiles</span>(<span class="params">projectPath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (projectPath.endsWith(<span class="string">'.swift'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> [projectPath]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> files = Glob.sync(<span class="string">`<span class="subst">$&#123;projectPath&#125;</span>/**/*.swift`</span>)</span><br><span class="line">    <span class="keyword">return</span> files</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Read file, replace by matches, and write again</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleFile</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(file)</span><br><span class="line"></span><br><span class="line">  Fs.readFile(file, <span class="string">'utf8'</span>, (error, data) =&gt; &#123;</span><br><span class="line">    <span class="comment">// non greedy `*?`</span></span><br><span class="line">    <span class="keyword">const</span> pattern = <span class="string">'(.)*constrain\\(.+\\) &#123;\\s(\\s|.)*?\\n(\\s)*&#125;'</span></span><br><span class="line">    <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> matches = data.match(regex)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RegEx only return the 1st match per execution, let's do a recursion</span></span><br><span class="line">    <span class="keyword">while</span> (matches != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> match = matches[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> indentationLength = findIndentationLength(match)</span><br><span class="line">      <span class="keyword">const</span> rawTransforms = handleMatch(match)</span><br><span class="line">      <span class="keyword">const</span> transforms = handleSuperview(rawTransforms, match)</span><br><span class="line">      <span class="keyword">const</span> statements = handleTransforms(transforms, indentationLength)</span><br><span class="line">      <span class="keyword">const</span> string = handleStatements(statements, indentationLength)</span><br><span class="line">      data = data.replace(match, string)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Examine again</span></span><br><span class="line">      matches = data.match(regex)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle import</span></span><br><span class="line">    data = handleImport(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Fs.writeFile(file, data, <span class="string">'utf8'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Replace or remove import</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleImport</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (data.includes(<span class="string">'import Sugar'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">'import Cartography'</span>, <span class="string">''</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">'import Cartography'</span>, <span class="string">'import Sugar'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Format transform to have `,` and linebreaks</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleTransforms</span>(<span class="params">transforms, indentationLength</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> string = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Expect the first is always line break</span></span><br><span class="line">  <span class="keyword">if</span> (transforms[<span class="number">0</span>] != <span class="string">'\n'</span>) &#123;</span><br><span class="line">    transforms.unshift(<span class="string">'\n'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> indentation = makeIndentation(indentationLength + <span class="number">2</span>)</span><br><span class="line">  </span><br><span class="line">  transforms.forEach(<span class="function">(<span class="params">line, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (line.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">      string = string.concat(indentation + line)</span><br><span class="line">      <span class="keyword">if</span> (index &lt; transforms.length - <span class="number">1</span>) &#123;</span><br><span class="line">        string = string.concat(<span class="string">',\n'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      string = string.concat(<span class="string">'\n'</span>)</span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Replace superView</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleSuperview</span>(<span class="params">transforms, match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> superView = findSuperview(match)</span><br><span class="line">  <span class="keyword">if</span> (superView == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> transforms</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> superViewPattern = <span class="string">' superView.'</span></span><br><span class="line">  transforms = transforms.map(<span class="function">(<span class="params">transform</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (transform.includes(superViewPattern)) &#123;</span><br><span class="line">      <span class="keyword">return</span> transform.replace(superViewPattern, <span class="string">` <span class="subst">$&#123;superView&#125;</span>.`</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> transform</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> transforms</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Embed the statements inside `Constraint.on`</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleStatements</span>(<span class="params">statements, indentationLength</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> indentation = makeIndentation(indentationLength)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;indentation&#125;</span>Constraint.on(<span class="subst">$&#123;statements&#125;</span>\n<span class="subst">$&#123;indentation&#125;</span>)`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Turn every line into flatten transformed line</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleMatch</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> lines = match.split(<span class="string">'\n'</span>)</span><br><span class="line">  lines = lines.map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> handleLine(line.trim())</span><br><span class="line">  &#125;).filter(<span class="function">(<span class="params">transforms</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> transforms != <span class="literal">null</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> flatten = [].concat.apply([], lines)</span><br><span class="line">  <span class="keyword">return</span> flatten</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Check to handle lines, turn them into `LayoutAnchor` statements</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleLine</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> itemPattern = <span class="string">'\\w*\\.\\w* (=|&lt;|&gt;)= \\w*\\.*\\..*'</span></span><br><span class="line">  <span class="keyword">const</span> sizePattern = <span class="string">'\w*\.\w* (=|&lt;|&gt;)= (\s|.)*'</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'edges == '</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleEdges(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'center == '</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleCenter(line) </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPattern(line, itemPattern) &amp;&amp; !hasSizeKeywords(line)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleItem(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPattern(line, sizePattern)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleSize(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&gt;='</span>) || line.includes(<span class="string">'&gt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'.'</span>)) &#123;</span><br><span class="line">    <span class="comment">// return the line itself to let the human fix</span></span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'\n'</span>]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: listView.bottom == listView.superview!.bottom - 43</span></span><br><span class="line"><span class="comment">/// listView.bottom == listView.superview!.bottom - Metrics.BackButtonWidth</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleItem</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> equalSign = getEqualSign(line)</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">` <span class="subst">$&#123;equalSign&#125;</span> `</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> rightParts = parts[<span class="number">1</span>].trim()</span><br><span class="line">  <span class="keyword">let</span> right = rightParts.split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">let</span> number = rightParts.replace(right, <span class="string">''</span>).replace(<span class="string">'- '</span>, <span class="string">'-'</span>).trim()</span><br><span class="line">  <span class="keyword">if</span> (number.startsWith(<span class="string">'+ '</span>)) &#123;</span><br><span class="line">    number = number.slice(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> equal = getEqual(line)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (number == <span class="literal">null</span> || number.length == <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>: <span class="subst">$&#123;right&#125;</span>Anchor)`</span></span><br><span class="line">    ]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>: <span class="subst">$&#123;right&#125;</span>Anchor, constant: <span class="subst">$&#123;number&#125;</span>)`</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: segmentedControl.height == 24</span></span><br><span class="line"><span class="comment">/// backButton.width == Metrics.BackButtonWidth</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleSize</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> equalSign = getEqualSign(line)</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">` <span class="subst">$&#123;equalSign&#125;</span> `</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = parts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> equal = getEqual(line)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>Constant: <span class="subst">$&#123;right&#125;</span>)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: mapView.edges == listView.edges</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleEdges</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">' == '</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = removeLastPart(parts[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.topAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.topAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.bottomAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.bottomAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.leftAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.leftAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.rightAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.rightAnchor)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: mapView.center == listView.center</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleCenter</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">' == '</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = removeLastPart(parts[<span class="number">1</span>])</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.centerXAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.centerXAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.centerYAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.centerYAnchor)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPattern</span>(<span class="params">string, pattern</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">  <span class="keyword">let</span> matches = string.match(regex)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (matches == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  matches = matches.filter(<span class="function">(<span class="params">match</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> match !== <span class="literal">undefined</span> &amp;&amp; match.length &gt; <span class="number">1</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> matches.length &gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeLastPart</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = string.split(<span class="string">'.'</span>)</span><br><span class="line">  parts.pop()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> parts.join(<span class="string">'.'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEqual</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'=='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'equalTo'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&lt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'lessThanOrEqualTo'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'greaterThanOrEqualTo'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEqualSign</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'=='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'=='</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&gt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&gt;='</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&lt;='</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findIndentationLength</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> match.split(<span class="string">'constrain'</span>)[<span class="number">0</span>].length + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeIndentation</span>(<span class="params">length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>(length).join(<span class="string">' '</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// For ex: constrain(tableView, headerView, view) &#123; tableView, headerView, superView in</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findSuperview</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> line = match.split(<span class="string">'\n'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">if</span> (!line.includes(<span class="string">' superView in'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pattern = <span class="string">', \\w*\\)'</span></span><br><span class="line">  <span class="keyword">const</span> regex = <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">  <span class="keyword">const</span> string =  line.match(regex)[<span class="number">0</span>] <span class="comment">// `, view)</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string.replace(<span class="string">', '</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check special size keywords</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasSizeKeywords</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> keywords = [<span class="string">'Metrics'</span>, <span class="string">'Dimensions'</span>, <span class="string">'UIScreen'</span>]</span><br><span class="line">  <span class="keyword">return</span> keywords.filter(<span class="function">(<span class="params">keyword</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> line.includes(keyword)</span><br><span class="line">  &#125;).length != <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T09:08:50.000Z" title="2019-05-21T09:08:50.000Z">2019-05-21</time><span class="level-item">a few seconds read (About 108 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-sort-strings-with-number-in-Javascript/">How to sort strings with number in Javascript</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/251">#251</a></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> string = </span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string">- Favorite WWDC 2017 sessions https://github.com/onmyway133/blog/issues/56</span></span><br><span class="line"><span class="string">- Favorite WWDC 2018 sessions https://github.com/onmyway133/blog/issues/245</span></span><br><span class="line"><span class="string">- How to do clustering with Google Maps in iOS https://github.com/onmyway133/blog/issues/191</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> lines = string</span><br><span class="line">        .split(<span class="string">'\n'</span>)</span><br><span class="line">        .filter(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123; <span class="keyword">return</span> line.length &gt; <span class="number">0</span> &#125;)</span><br><span class="line">        .map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> parts = line.trimEnd().split(<span class="string">' '</span>)</span><br><span class="line">            <span class="keyword">let</span> lastPart = parts[parts.length<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">let</span> number = lastPart.replace(<span class="string">'https://github.com/onmyway133/blog/issues/'</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                line,</span><br><span class="line">                number: <span class="built_in">parseInt</span>(number)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    lines.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (a.number &lt; b.number) ? <span class="number">-1</span> : <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> sortedString = lines</span><br><span class="line">        .map(<span class="function">(<span class="params">tuple</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> tuple.line</span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(sortedString)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then <code>node index.js</code></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-28T12:34:07.000Z" title="2019-03-28T12:34:07.000Z">2019-03-28</time><span class="level-item">a minute read (About 202 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-catch-error-in-ApolloClient/">How to catch error in ApolloClient</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/192">#192</a></strong></p>
<p>Read <a href="https://www.apollographql.com/docs/react/features/error-handling">https://www.apollographql.com/docs/react/features/error-handling</a><br>How to catch actual error <a href="https://github.com/apollographql/apollo-client/issues/4016">https://github.com/apollographql/apollo-client/issues/4016</a> 🤔 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">'apollo-link'</span></span><br><span class="line"><span class="keyword">import</span> ApolloClient <span class="keyword">from</span> <span class="string">'apollo-boost'</span></span><br><span class="line"><span class="keyword">import</span> Token <span class="keyword">from</span> <span class="string">'library/models/Token'</span></span><br><span class="line"><span class="keyword">import</span> TokenService <span class="keyword">from</span> <span class="string">'./TokenService'</span></span><br><span class="line"><span class="keyword">import</span> &#123; TokenRefreshException &#125; <span class="keyword">from</span> <span class="string">'library/utils/Exception'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> client = <span class="keyword">new</span> ApolloClient(&#123;</span><br><span class="line">  uri: <span class="string">'https://www.myapp.no/api/'</span>,</span><br><span class="line">  request: <span class="keyword">async</span> (operation) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="keyword">await</span> TokenService.loadToken()</span><br><span class="line">    updateOperation(operation, token)</span><br><span class="line">  &#125;,</span><br><span class="line">  onError: <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ApolloClient error'</span>, error)</span><br><span class="line">    <span class="keyword">if</span> (isAuthError(error)) &#123;</span><br><span class="line">      <span class="keyword">return</span> handleAuthError(error)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> error.forward(error.operation)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  fetchOptions: &#123;</span><br><span class="line">    mode: <span class="string">'no-cors'</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isValidErrorCode = <span class="function">(<span class="params">statusCode</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> (statusCode) === <span class="string">'undefined'</span> || statusCode === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isAuthError = <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'client error'</span>, error)</span><br><span class="line">  <span class="keyword">if</span> (error.networkError) &#123;</span><br><span class="line">    <span class="keyword">return</span> error.networkError.statusCode === <span class="number">401</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handleAuthError = <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">    TokenService.refreshToken()</span><br><span class="line">      .then(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;</span><br><span class="line">        updateOperation(error.operation, token)</span><br><span class="line">      &#125;)</span><br><span class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> subscriber = &#123;</span><br><span class="line">          next: observer.next.bind(observer),</span><br><span class="line">          error: observer.error.bind(observer),</span><br><span class="line">          complete: observer.complete.bind(observer)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error.forward(error.operation).subscribe(subscriber)</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        observer.error(e)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateOperation = <span class="function">(<span class="params">operation, token: Token</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> tokenHeader = <span class="string">`<span class="subst">$&#123;token.token_type&#125;</span> <span class="subst">$&#123;token.access_token&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">  operation.setContext(<span class="function">(<span class="params">context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      headers: &#123;</span><br><span class="line">        authorization: tokenHeader,</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-24T20:08:27.000Z" title="2019-03-24T20:08:27.000Z">2019-03-24</time><span class="level-item">8 minutes read (About 1130 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Curry-in-Swift-and-Javascript/">Curry in Swift and Javascript</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/185">#185</a></strong></p>
<p>You may encounter curry in everyday code without knowing it. Here is a bit of my reflections on curry and how to apply it in Javascript and Swift.</p>
<h2 id="Taking-one-parameter-in-Haskell"><a href="#Taking-one-parameter-in-Haskell" class="headerlink" title="Taking one parameter in Haskell"></a>Taking one parameter in Haskell</h2><p>In Haskell, all function officially takes only 1 parameter. Function with many parameters are just curried, which means they will be partially applied. Calling sum 1 just returns a function with 1 parameter, then 2is passed into this function. The following 2 function calls are the same.</p>
<pre><code>ghci&gt; sum 1 2
3 
ghci&gt; (max 1) 2
3</code></pre><p>I tend to think of curried function or partially applied function as something that carry dependencies at each application step. Each curried function can be assigned to variable or pass around, or as returned value.</p>
<h2 id="Curry-in-Swift-for-predicate"><a href="#Curry-in-Swift-for-predicate" class="headerlink" title="Curry in Swift for predicate"></a>Curry in Swift for predicate</h2><p>When I was trying to make my own <a href="https://github.com/onmyway133/archives/tree/master/Signal">Signal</a> library, I have</p>
<iframe src="https://medium.com/media/f61aae80ae0b6410d6844dbfd961d01e" frameborder=0></iframe>

<p>and Event</p>
<iframe src="https://medium.com/media/4a05bf4ba2a71d096c2ef87a3cd57ec8" frameborder=0></iframe>

<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>Then there should be a filter for Signal. The idea of filter is that we should update signal if the Event is Next with right filtered value</p>
<pre><code>public func filter(f: T -&gt; Bool) -&gt; Signal&lt;T&gt;{
    let signal = Signal&lt;T&gt;()
    subscribe { result in
        switch(result) {
        case let .Success(value):
            if f(value) {
                signal.update(result)
            }
        case let .Error(error): signal.update(.Error(error))
        }
    }
    return signal
}</code></pre><h3 id="2-parameters"><a href="#2-parameters" class="headerlink" title="2 parameters"></a>2 parameters</h3><p>But having Event as another monad, I think it should be more encapsulated if that switching logic gets moved into the Event. Here the filter takes 2 params</p>
<p>Event.swift</p>
<pre><code>func filter(f: T -&gt; Bool, callback: (Event&lt;T&gt; -&gt; Void)) {
        switch self {
        case let .Next(value) where f(value):
            callback(self)
        case .Failed:
            callback(self)
        default:
            break
    }
}</code></pre><p>Signal.swift</p>
<pre><code>public func filter(f: T -&gt; Bool) -&gt; Signal&lt;T&gt; {
    let signal = Signal&lt;T&gt;()

    subscribe { event in
        event.filter(f, callback: signal.update)
    }

    return signal
}</code></pre><h3 id="Currying"><a href="#Currying" class="headerlink" title="Currying"></a>Currying</h3><p>With currying, we can make filter a more abstract function, and defer the decision to pass the callback param. It is a little carried away but I find it helpful this way</p>
<p>Now filter accepts 1 param, and it returns a function that takes callback as its param</p>
<p>Event.swift</p>
<pre><code>func filter(f: T -&gt; Bool) -&gt; ((Event&lt;T&gt; -&gt; Void) -&gt; Void) {
        return { g in
            switch self {
            case let .Next(value) where f(value):
                g(self)
            case .Failed:
                g(self)
            default:
                break
            }
        }
    }</code></pre><p>Signal.swift</p>
<pre><code>public func filter(f: T -&gt; Bool) -&gt; Signal&lt;T&gt; {
        let signal = Signal&lt;T&gt;()

        subscribe { event in
            event.filter(f)(signal.update)
        }

        return signal
    }</code></pre><h3 id="Curry-syntax-in-Swift-2-and-above"><a href="#Curry-syntax-in-Swift-2-and-above" class="headerlink" title="Curry syntax in Swift 2 and above"></a>Curry syntax in Swift 2 and above</h3><p>Swift 2 supports curry syntax function</p>
<pre><code>func sum(a: Int)(b: Int) -&gt; Int {
    return a + b
}

let sumWith5 = sum(5)
let result = sumWith5(b: 10)</code></pre><p>Unfortunately, the syntactic sugar for declaring curry has been dropped since Swift 3. You may want to find out in <a href="http://ericasadun.com/2015/12/18/bidding-farewell-to-currying/">Bidding farewell to currying</a>. But it’s not a big deal as we can easily create curry function. It is just a function that returns another function.</p>
<h2 id="Using-curry-for-partial-application-in-UIKit"><a href="#Using-curry-for-partial-application-in-UIKit" class="headerlink" title="Using curry for partial application in UIKit"></a>Using curry for partial application in UIKit</h2><p>I used this curry technique in my Xkcd app. See <a href="https://github.com/onmyway133/Xkcd/blob/master/Source/Feature/Main/MainController.swift">MainController.swift</a>. MainController is vanilla UITabBarController with ComicsController and FavoriteController , all embedded in UINavigationViewController .</p>
<p>The feature is that when a comic is selected, a comic detail screen should be pushed on top of the navigation stack. For example in <a href="https://github.com/onmyway133/Xkcd/blob/master/Source/Feature/Comics/ComicsContoller.swift#L20">ComicsController</a></p>
<pre><code>/// Called when a comic is selected  
var selectComic: ((Comic) -&gt; Void)?</code></pre><p>All ComicsController needs to know is to call that selectComic closure with the chosen Comic, and someone should know how to handle that selection. Back to the <a href="https://github.com/onmyway133/Xkcd/blob/master/Source/Feature/Main/MainController.swift">handleFlow</a> function inside MainController.</p>
<pre><code>private func handleFlow() {
  typealias Function = (UINavigationController) -&gt; (Comic) -&gt; Void
  let selectComic: Function = { [weak self] navigationController in
    return { (comic: Comic) in
      guard let self = self else {
        return
      }

  let detailController = self.makeDetail(comic: comic)
      navigationController.pushViewController(detailController, animated: true)
    }
  }

  comicsController.selectComic = selectComic(comicNavigationController)
  favoriteController.selectComic = selectComic(favoriteNavigationController)
}</code></pre><p>I declared Function as typealias to explicitly state the curry function that we are going to build</p>
<pre><code>typealias Function = (UINavigationController) -&gt; (Comic) -&gt; Void</code></pre><p>We build selectComic as curried function, that takes UINavigationViewController and returns a function that takes Comic and returns Void . This way when we partially apply selectComic with the a navigationController , we get another function that has navigationController as dependency, and ready to be assigned to selectComic property in comicsController .</p>
<h2 id="Curry-promised-function-in-Javascript"><a href="#Curry-promised-function-in-Javascript" class="headerlink" title="Curry promised function in Javascript"></a>Curry promised function in Javascript</h2><p>I like to work with Promise and async/await in Javascript. It allows chainable style and easy to reason about. So when working with callbacks in Javascript, for example callback from native modules in React Native, I tend to convert them into Promise.</p>
<p>For example when working with HealthKit, we need to expose a native modules around it</p>
<pre><code>// [@flow](http://twitter.com/flow)

import { NativeModules } from &apos;react-native&apos;

type HealthManagerType = {
  checkAuthorisation: ((string) =&gt; void)) =&gt; void,
  authorise: ((boolean) =&gt; void)) =&gt; void,
  readWorkout: (Date, Date, () =&gt; void)) =&gt; void,
  readDailySummary: (Date, Date, () =&gt; void)) =&gt; void,
  readMeasurement: (Date, Date, () =&gt; void)) =&gt; void
}

const HealthManager: HealthManagerType = NativeModules.HealthManager
export default HealthManager</code></pre><p>We can build a toPromise function that can convert a function with callback into Promise</p>
<pre><code>// [@flow](http://twitter.com/flow)

const toPromise = (f: (any) =&gt; void) =&gt; {
  return new Promise&lt;any&gt;((resolve, reject) =&gt; {
    try {
      f((result) =&gt; {
        resolve(result)
      })
    } catch (e) {
      reject(e)
    }
  })
}

export default toPromise</code></pre><p>However, as you can see in the signature, it only works with a callback of type (any) =&gt; void In other words, this callback must have exactly 1 parameter, because a Promise can either returns a value or throws an error.</p>
<p>To remedy this, we can build a curry function that can turns function with either 1, 2, 3 parameters into curried function. Thanks to the dynamic nature of Javascript, we have</p>
<pre><code>// [@flow](http://twitter.com/flow)

function curry0(f: () =&gt; void) {
  return f()
}

function curry1(f: (any) =&gt; void) {
  return (p1: any) =&gt; {
    return f(p1)
  }
}

function curry2(f: (any, any) =&gt; void) {
  return (p1: any) =&gt; {
    return (p2: any) =&gt; {
      return f(p1, p2)
    }
  }
}

function curry3(f: (any, any, any) =&gt; void) {
  return (p1: any) =&gt; {
    return (p2: any) =&gt; {
      return (p3: any) =&gt; {
        return f(p1, p2, p3)
      }
    }
  }
}

export default {
  curry0,
  curry1,
  curry2,
  curry3
}</code></pre><p>So with a function that have 3 parameters, we can use curry3 to partially apply the first 2 parameters. Then we have a function that accepts just a callback, and this is turned into Promise via toPromise</p>
<pre><code>const readWorkout = curry.curry3(HealthManager.readWorkout)(DateUtils.startDate))(DateUtils.endDate))

const workouts = await toPromise(readWorkout)</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Here are some of my favorite posts to read more about curry</p>
<ul>
<li><p><a href="http://learnyouahaskell.com/higher-order-functions">Higher order functions</a></p>
</li>
<li><p><a href="https://robots.thoughtbot.com/introduction-to-function-currying-in-swift">Introduction to Function Currying in Swift</a></p>
</li>
<li><p><a href="http://www.russbishop.net/swift-function-currying">Swift Function Currying</a></p>
</li>
<li><p><a href="https://medium.com/@kevincennis/currying-in-javascript-c66080543528">Currying in JavaScript</a>: I like how he uses memory and slice to gradually build more generic curry function</p>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T10:55:25.000Z" title="2019-03-19T10:55:25.000Z">2019-03-19</time><span class="level-item">a few seconds read (About 15 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-properties-of-JSValue-in-JavascriptCore/">How to get properties of JSValue in JavascriptCore</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/179">#179</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> rough = context.objectForKeyedSubscript(<span class="string">"myObject"</span>)</span><br><span class="line">myObject.toDictionary()</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2017-08-04T09:03:55.000Z" title="2017-08-04T09:03:55.000Z">2017-08-04</time><span class="level-item">a few seconds read (About 94 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Learning-flexbox/">Learning flexbox</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/62">#62</a></strong></p>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><ul>
<li>body height <a href="https://www.kirupa.com/html5/make_body_take_up_full_browser_height.htm">https://www.kirupa.com/html5/make_body_take_up_full_browser_height.htm</a></li>
</ul>
<h2 id="Flexbox"><a href="#Flexbox" class="headerlink" title="Flexbox"></a>Flexbox</h2><ul>
<li>Properties of flex <a href="https://codepen.io/enxaneta/full/adLPwv">https://codepen.io/enxaneta/full/adLPwv</a></li>
<li>Visual guide to flexbox <a href="https://scotch.io/tutorials/a-visual-guide-to-css3-flexbox-properties">https://scotch.io/tutorials/a-visual-guide-to-css3-flexbox-properties</a></li>
<li>align-items vs align-content <a href="https://stackoverflow.com/questions/27539262/whats-the-difference-between-align-content-and-align-items">https://stackoverflow.com/questions/27539262/whats-the-difference-between-align-content-and-align-items</a></li>
<li>align-items vs justify-content <a href="https://stackoverflow.com/questions/35049262/difference-between-justify-content-vs-align-items">https://stackoverflow.com/questions/35049262/difference-between-justify-content-vs-align-items</a></li>
<li>multiple line <a href="https://stackoverflow.com/questions/41789278/first-child-full-width-in-flexbox">https://stackoverflow.com/questions/41789278/first-child-full-width-in-flexbox</a></li>
</ul>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/tags/javascript/">Previous</a></div><div class="pagination-next is-invisible is-hidden-mobile"><a href="/tags/javascript/page/3/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/tags/javascript/">1</a></li><li><a class="pagination-link is-current" href="/tags/javascript/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">696</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">54</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://wwdctogether.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">WWDC Together</span></span><span class="level-right"><span class="level-item tag">wwdctogether.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-01-14T05:01:47.000Z">2021-01-14</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-add-alternative-app-icons-for-iOS/">How to add alternative app icons for iOS</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-01-13T04:56:03.000Z">2021-01-13</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-popup-button-in-SwiftUI-for-macOS/">How to make popup button in SwiftUI for macOS</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-01-08T19:17:59.000Z">2021-01-08</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-UITextView-in-SwiftUI/">How to use UITextView in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-01-07T08:25:52.000Z">2021-01-07</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-check-app-going-to-background-in-SwiftUI/">How to check app going to background in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-01-06T20:04:59.000Z">2021-01-06</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-selection-in-List-in-SwiftUI/">How to use selection in List in SwiftUI</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featured/"><span class="tag">featured</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">171</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">50</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">121</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">335</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">86</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tweet/"><span class="tag">tweet</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2021 Khoa Pham</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>