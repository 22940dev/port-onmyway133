<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Issue #329 Firstly, to make UIStackView scrollable, embed it inside UIScrollView. Read How to embed UIStackView inside UIScrollView in iOS It’s best to listen to keyboardWillChangeFrameNotification as">
<meta name="keywords" content="swift,iOS">
<meta property="og:type" content="article">
<meta property="og:title" content="How to handle keyboard for UITextField in scrolling UIStackView in iOS">
<meta property="og:url" content="https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="Issue #329 Firstly, to make UIStackView scrollable, embed it inside UIScrollView. Read How to embed UIStackView inside UIScrollView in iOS It’s best to listen to keyboardWillChangeFrameNotification as">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-08-19T05:58:49.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to handle keyboard for UITextField in scrolling UIStackView in iOS">
<meta name="twitter:description" content="Issue #329 Firstly, to make UIStackView scrollable, embed it inside UIScrollView. Read How to embed UIStackView inside UIScrollView in iOS It’s best to listen to keyboardWillChangeFrameNotification as">
    
    
        
          
              <link rel="shortcut icon" href="/images/icons96.jpeg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/icons96.jpeg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/icons96.jpeg">
          
        
    
    <!-- title -->
    <title>How to handle keyboard for UITextField in scrolling UIStackView in iOS</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/speaking/">Speaking</a></li>
         
          <li><a href="/opensource/">Open Source</a></li>
         
          <li><a href="/gumroad/">Gumroad</a></li>
         
          <li><a href="/jobs/">Jobs</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/How-to-make-scrollable-NSTextView-in-AppKit/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/How-to-make-simple-form-validator-in-Swift/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&text=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&is_video=false&description=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How to handle keyboard for UITextField in scrolling UIStackView in iOS&body=Check out this article: https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&name=How to handle keyboard for UITextField in scrolling UIStackView in iOS&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Move-up-the-entire-view"><span class="toc-number">1.</span> <span class="toc-text">Move up the entire view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Prefer-willShow-and-willHide"><span class="toc-number">2.</span> <span class="toc-text">Prefer willShow and willHide</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Read-more"><span class="toc-number"></span> <span class="toc-text">Read more</span></a>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        How to handle keyboard for UITextField in scrolling UIStackView in iOS
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">onmyway133</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-06-26T08:36:04.000Z" itemprop="datePublished">2019-06-26</time>
        
        (Updated: <time datetime="2019-08-19T05:58:49.000Z" itemprop="dateModified">2019-08-19</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/iOS/">iOS</a>, <a class="tag-link" href="/tags/swift/">swift</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/329" target="_blank" rel="noopener">#329</a></strong></p>
<p>Firstly, to make UIStackView scrollable, embed it inside UIScrollView. Read <a href="https://github.com/onmyway133/blog/issues/324" target="_blank" rel="noopener">How to embed UIStackView inside UIScrollView in iOS</a></p>
<p>It’s best to listen to <code>keyboardWillChangeFrameNotification</code> as it contains frame changes for Keyboard in different situation like custom keyboard, languages.</p>
<blockquote>
<p>Posted immediately prior to a change in the keyboard’s frame.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeyboardHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> scrollView: <span class="type">UIScrollView</span></span><br><span class="line">    <span class="keyword">let</span> stackView: <span class="type">UIStackView</span></span><br><span class="line">    <span class="keyword">var</span> observer: <span class="type">AnyObject?</span></span><br><span class="line">    <span class="keyword">var</span> keyboardHeightConstraint: <span class="type">NSLayoutConstraint!</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Info</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> frame: <span class="type">CGRect</span></span><br><span class="line">        <span class="keyword">let</span> duration: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(scrollView: <span class="type">UIScrollView</span>, stackView: <span class="type">UIStackView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.scrollView = scrollView</span><br><span class="line">        <span class="keyword">self</span>.stackView = stackView</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To make scrollView scroll beyond its <code>contentSize</code>, we can change its <code>contentInset.bottom</code>. Another way is to add a dummy view with certain height to <code>UIStackView</code> and alter its <code>NSLayoutConstraint</code> <code>constant</code></p>
<p>We can’t access <code>self</code> inside init, so it’s best to have setup function</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> space = <span class="type">UIView</span>()</span><br><span class="line">    keyboardHeightConstraint = space.heightAnchor.constraint(equalToConstant: <span class="number">0</span>)</span><br><span class="line">    <span class="type">NSLayoutConstraint</span>.on([keyboardHeightConstraint])</span><br><span class="line">    stackView.addArrangedSubview(spa</span><br><span class="line">    observer = <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">        forName: <span class="type">UIResponder</span>.keyboardWillChangeFrameNotification,</span><br><span class="line">        object: <span class="literal">nil</span>,</span><br><span class="line">        queue: .main,</span><br><span class="line">        using: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] notification <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>?.handle(notification)</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Convert <code>Notification</code> to a convenient <code>Info</code> struct</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">convert</span><span class="params">(notification: Notification)</span></span> -&gt; <span class="type">Info?</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span></span><br><span class="line">        <span class="keyword">let</span> frameValue = notification.userInfo?[<span class="type">UIResponder</span>.keyboardFrameEndUserInfoKey] <span class="type">NSValue</span>,</span><br><span class="line">        <span class="keyword">let</span> durationotification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationDurationUserInfoKey] <span class="keyword">as</span>? <span class="type">NSNumber</span>,</span><br><span class="line">        <span class="keyword">let</span> raw = notification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationCurveUserInfoKey] <span class="type">NSNumber</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="type">Info</span>(</span><br><span class="line">        frame: frameValue.cgRectValue,</span><br><span class="line">        duration: duration.doubleValue,</span><br><span class="line">        animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span>(rawValue: raw.uintValue)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then we can compare with UIScreen to check if Keyboard is showing or hiding</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> notification: Notification)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> info = convert(notification: notification) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">let</span> isHiding = info.frame.origin.y == <span class="type">UIScreen</span>.main.bounds.height</span><br><span class="line">    keyboardHeightConstraint.constant = isHiding ? <span class="number">0</span> : info.frame.hei</span><br><span class="line">    <span class="type">UIView</span>.animate(</span><br><span class="line">        withDuration: info.duration,</span><br><span class="line">        delay: <span class="number">0</span>,</span><br><span class="line">        options: info.animationOptions,</span><br><span class="line">        animations: &#123;</span><br><span class="line">            <span class="keyword">self</span>.scrollView.layoutIfNeeded()</span><br><span class="line">            <span class="keyword">self</span>.moveTextFieldIfNeeded(info: info)</span><br><span class="line">    &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To move <code>UITextField</code> we can use <a href="https://developer.apple.com/documentation/uikit/uiscrollview/1619439-scrollrecttovisible" target="_blank" rel="noopener"><code>scrollRectToVisible(_:animated:)</code></a> but we have little control over how much we want to scroll</p>
<blockquote>
<p>This method scrolls the content view so that the area defined by rect is just visible inside the scroll view. If the area is already visible, the method does nothing.</p>
</blockquote>
<p>Another way is to check if keyboard overlaps <code>UITextField</code>. To do that we use <a href="https://developer.apple.com/documentation/uikit/uiview/1622504-convertrect" target="_blank" rel="noopener"><code>convertRect:toView:</code></a> with <code>nil</code> target so it uses window coordinates. Since keyboard frame is always relative to window, we have frames in same coordinate space.</p>
<blockquote>
<p>Converts a rectangle from the receiver’s coordinate system to that of another view.</p>
</blockquote>
<blockquote>
<p>rect: A rectangle specified in the local coordinate system (bounds) of the receiver.<br>view: The view that is the target of the conversion operation. If view is nil, this method instead converts to window base coordinates. Otherwise, both view and the receiver must belong to the same UIWindow object.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">moveTextFieldIfNeeded</span><span class="params">(info: Info)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> input = stackView.arrangedSubviews</span><br><span class="line">        .compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UITextField</span> &#125;)</span><br><span class="line">        .first(<span class="keyword">where</span>: &#123; $<span class="number">0</span>.isFirstResponder &#125;)</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">let</span> inputFrame = input.convert(input.bounds, to: <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">if</span> inputFrame.intersects(info.frame) &#123;</span><br><span class="line">        scrollView.setContentOffset(<span class="type">CGPoint</span>(x: <span class="number">0</span>, y: inputFrame.height), animated: <span class="literal">true</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        scrollView.setContentOffset(.zero, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Move-up-the-entire-view"><a href="#Move-up-the-entire-view" class="headerlink" title="Move up the entire view"></a>Move up the entire view</h3><p>For simplicity, we can move up the entire view</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">move</span><span class="params">(info: Info)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> isHiding = info.frame.origin.y == <span class="type">UIScreen</span>.main.bounds.height</span><br><span class="line">    <span class="keyword">let</span> moveUp = <span class="type">CGAffineTransform</span>(translationX: <span class="number">0</span>, y: -info.frame.height)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (view.transform, isHiding) &#123;</span><br><span class="line">    <span class="keyword">case</span> (.identity, <span class="literal">false</span>):</span><br><span class="line">        view.transform = moveUp</span><br><span class="line">    <span class="keyword">case</span> (moveUp, <span class="literal">true</span>):</span><br><span class="line">        view.transform = .identity</span><br><span class="line">     <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Prefer-willShow-and-willHide"><a href="#Prefer-willShow-and-willHide" class="headerlink" title="Prefer willShow and willHide"></a>Prefer willShow and willHide</h3><p>There ‘s an edge case with the above switch on <code>view.transform</code> and <code>isHiding</code> with one time verification sms code, which make it into the correct <code>case</code> handling. It’s safe to just set view.transform depending on <code>show</code> with <code>willHide</code> and <code>willShow</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeyboardHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> view: <span class="type">UIView</span></span><br><span class="line">    <span class="keyword">var</span> observerForWillShow: <span class="type">AnyObject?</span></span><br><span class="line">    <span class="keyword">var</span> observerForWillHide: <span class="type">AnyObject?</span></span><br><span class="line">    <span class="keyword">var</span> keyboardHeightConstraint: <span class="type">NSLayoutConstraint!</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Info</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> frame: <span class="type">CGRect</span></span><br><span class="line">        <span class="keyword">let</span> duration: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">init</span>(view: <span class="type">UIView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.view = view</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        observerForWillShow = <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">            forName: <span class="type">UIResponder</span>.keyboardWillShowNotification,</span><br><span class="line">            object: <span class="literal">nil</span>,</span><br><span class="line">            queue: .main,</span><br><span class="line">            using: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] notification <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>?.handle(notification, show: <span class="literal">true</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        observerForWillHide = <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">            forName: <span class="type">UIResponder</span>.keyboardWillHideNotification,</span><br><span class="line">            object: <span class="literal">nil</span>,</span><br><span class="line">            queue: .main,</span><br><span class="line">            using: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] notification <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>?.handle(notification, show: <span class="literal">false</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> notification: Notification, show: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> info = convert(notification: notification) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">UIView</span>.animate(</span><br><span class="line">            withDuration: info.duration,</span><br><span class="line">            delay: <span class="number">0</span>,</span><br><span class="line">            options: info.animationOptions,</span><br><span class="line">            animations: &#123;</span><br><span class="line">				<span class="keyword">self</span>.move(info: info, show: show)</span><br><span class="line">        &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">move</span><span class="params">(info: Info, show: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> moveUp = <span class="type">CGAffineTransform</span>(translationX: <span class="number">0</span>, y: -info.frame.height)</span><br><span class="line">        <span class="keyword">if</span> show &#123;</span><br><span class="line">            view.transform = moveUp</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            view.transform = .identity</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">convert</span><span class="params">(notification: Notification)</span></span> -&gt; <span class="type">Info?</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> frameValue = notification.userInfo?[<span class="type">UIResponder</span>.keyboardFrameEndUserInfoKey] <span class="keyword">as</span>? <span class="type">NSValue</span>,</span><br><span class="line">            <span class="keyword">let</span> duration = notification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationDurationUserInfoKey] <span class="keyword">as</span>? <span class="type">NSNumber</span>,</span><br><span class="line">            <span class="keyword">let</span> raw = notification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationCurveUserInfoKey] <span class="keyword">as</span>? <span class="type">NSNumber</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">Info</span>(</span><br><span class="line">            frame: frameValue.cgRectValue,</span><br><span class="line">            duration: duration.doubleValue,</span><br><span class="line">            animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span>(rawValue: raw.uintValue)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://developer.apple.com/library/archive/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html#//apple_ref/doc/uid/TP40009542-CH5-SW16" target="_blank" rel="noopener">Managing the Keyboard</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/speaking/">Speaking</a></li>
         
          <li><a href="/opensource/">Open Source</a></li>
         
          <li><a href="/gumroad/">Gumroad</a></li>
         
          <li><a href="/jobs/">Jobs</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Move-up-the-entire-view"><span class="toc-number">1.</span> <span class="toc-text">Move up the entire view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Prefer-willShow-and-willHide"><span class="toc-number">2.</span> <span class="toc-text">Prefer willShow and willHide</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Read-more"><span class="toc-number"></span> <span class="toc-text">Read more</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&text=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&is_video=false&description=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How to handle keyboard for UITextField in scrolling UIStackView in iOS&body=Check out this article: https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&title=How to handle keyboard for UITextField in scrolling UIStackView in iOS"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://onmyway133.github.io/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/&name=How to handle keyboard for UITextField in scrolling UIStackView in iOS&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Khoa Pham
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/speaking/">Speaking</a></li>
         
          <li><a href="/opensource/">Open Source</a></li>
         
          <li><a href="/gumroad/">Gumroad</a></li>
         
          <li><a href="/jobs/">Jobs</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-40119591-5', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
