<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-16T21:29:38.000Z" title="2019-11-16T21:29:38.000Z">2019-11-16</time><span class="level-item">a few seconds read (About 48 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-group-array-by-property-in-Swift/">How to  group array by property in  Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/510">#510</a></strong></p>
<p>Use <code>Dictionary(grouping:by:)</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">groups</span><span class="params">(countries: [Country])</span></span> -&gt; [<span class="type">Group</span>] &#123;</span><br><span class="line">    <span class="keyword">let</span> dictionary = <span class="type">Dictionary</span>(grouping: countries, by: &#123; <span class="type">String</span>($<span class="number">0</span>.name.<span class="keyword">prefix</span>(<span class="number">1</span>)) &#125;)</span><br><span class="line">    <span class="keyword">let</span> groups = dictionary</span><br><span class="line">        .<span class="built_in">map</span>(&#123; (key: <span class="type">String</span>, value: [<span class="type">Country</span>]) -&gt; <span class="type">Group</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">Group</span>(initial: key, countries: value)</span><br><span class="line">        &#125;)</span><br><span class="line">        .sorted(by: &#123; $<span class="number">0</span>.initial &lt; $<span class="number">1</span>.initial &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> groups</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-14T13:44:23.000Z" title="2019-11-14T13:44:23.000Z">2019-11-14</time><span class="level-item">a few seconds read (About 102 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-full-width-list-row-in-SwiftUI/">How to make full width list row in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/508">#508</a></strong></p>
<p>We need to use <code>frame(minWidth: 0, maxWidth: .infinity, alignment: .leading)</code>. Note that order is important, and <code>padding</code> should be first, and <code>background</code> after <code>frame</code> to apply color to the entire <code>frame</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BooksScreen</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">BooksViewModel</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">ForEach</span>(viewModel.books) &#123; book <span class="keyword">in</span></span><br><span class="line">                <span class="type">RowView</span>(vault: book)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .listStyle(<span class="type">GroupedListStyle</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">struct</span> <span class="title">RowView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> book: <span class="type">Book</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(book.name)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">                .font(.headline)</span><br><span class="line">            <span class="type">Text</span>(book.text)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">                .font(.subheadline)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">        .frame(minWidth: <span class="number">0</span>, maxWidth: .infinity, alignment: .leading)</span><br><span class="line">        .background(<span class="type">Color</span>(hex: book.color))</span><br><span class="line">        .cornerRadius(<span class="number">8</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-14T11:27:24.000Z" title="2019-11-14T11:27:24.000Z">2019-11-14</time><span class="level-item">a minute read (About 115 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-full-screen-TabView-in-SwiftUI/">How to make full screen TabView in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/507">#507</a></strong></p>
<p><code>View</code> extends to the bottom, but not to the notch. We need to add <code>.edgesIgnoringSafeArea(.top)</code> to our <code>TabView</code> to tell <code>TabView</code> to extend all the way to the top.</p>
<p>Note that if we use <code>edgesIgnoringSafeArea(.all)</code> then <code>TabView</code> ‘s bar will be  dragged very down and broken.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainScreen</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="type">UITabBar</span>.appearance().backgroundColor = <span class="type">R</span>.color.barBackground</span><br><span class="line">        <span class="type">UITableView</span>.appearance().backgroundColor = .clear</span><br><span class="line">        <span class="type">UITableViewCell</span>.appearance().backgroundColor = .clear</span><br><span class="line">        <span class="type">UITableView</span>.appearance().tableFooterView = <span class="type">UIView</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="type">R</span>.color.background</span><br><span class="line">                .edgesIgnoringSafeArea(.all)</span><br><span class="line"></span><br><span class="line">            <span class="type">TabView</span> &#123;</span><br><span class="line">                <span class="type">PersonalScreen</span>()</span><br><span class="line">                    .tabItem(&#123;</span><br><span class="line">                        <span class="type">Image</span>(sfSymbol: .bagFill)</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">"Personal"</span>)</span><br><span class="line">                            .styleTabBarItem()</span><br><span class="line">                    &#125;)</span><br><span class="line">                <span class="type">CloudScreen</span>()</span><br><span class="line">                    .tabItem(&#123;</span><br><span class="line">                        <span class="type">Image</span>(sfSymbol: .cloudFill)</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">"Cloud"</span>)</span><br><span class="line">                            .styleTabBarItem()</span><br><span class="line">                    &#125;)</span><br><span class="line">                <span class="type">SettingsScreen</span>()</span><br><span class="line">                    .tabItem(&#123;</span><br><span class="line">                        <span class="type">Image</span>(sfSymbol: .gear)</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">"Settings"</span>)</span><br><span class="line">                            .styleTabBarItem()</span><br><span class="line">                    &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            .edgesIgnoringSafeArea(.top)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-14T09:23:12.000Z" title="2019-11-14T09:23:12.000Z">2019-11-14</time><span class="level-item">a few seconds read (About 108 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-map-error-in-Combine/">How to map error in Combine</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/506">#506</a></strong></p>
<p>When a function expects <code>AnyPublisher&lt;[Book], Error&gt;</code> but in mock, we have <code>Just</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getBooks</span><span class="params">()</span></span> -&gt; <span class="type">AnyPublisher</span>&lt;[<span class="type">Book</span>], <span class="type">Error</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Just</span>([</span><br><span class="line">        <span class="type">Book</span>(id: <span class="string">"1"</span>, name: <span class="string">"Book 1"</span>),</span><br><span class="line">        <span class="type">Book</span>(id: <span class="string">"2"</span>, name: <span class="string">"Book 2"</span>),</span><br><span class="line">    ])</span><br><span class="line">    .eraseToAnyPublisher()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>There will be a mismatch, hence compile error</p>
<blockquote>
<p>Cannot convert return expression of type ‘AnyPublisher&lt;[Book], Just<Output>.Failure&gt;’ (aka ‘AnyPublisher&lt;Array<Book>, Never&gt;’) to return type ‘AnyPublisher&lt;[Book], Error&gt;’</p>
</blockquote>
<p>The reason is because Just produces <code>Never</code>, not <code>Error</code>. The workaround is to introduce <code>Error</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AppError</span>: <span class="title">Error</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> impossible</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getBooks</span><span class="params">()</span></span> -&gt; <span class="type">AnyPublisher</span>&lt;[<span class="type">Book</span>], <span class="type">Error</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Just</span>([</span><br><span class="line">        <span class="type">Book</span>(id: <span class="string">"1"</span>, name: <span class="string">"Book 1"</span>),</span><br><span class="line">        <span class="type">Book</span>(id: <span class="string">"2"</span>, name: <span class="string">"Book 2"</span>),</span><br><span class="line">    ])</span><br><span class="line">    .mapError(&#123; <span class="number">_</span> <span class="keyword">in</span>  <span class="type">AppError</span>.impossible &#125;)</span><br><span class="line">    .eraseToAnyPublisher()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2020-11-07 20:30:01</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-13T19:48:58.000Z" title="2019-11-13T19:48:58.000Z">2019-11-13</time><span class="level-item">a few seconds read (About 28 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-unable-to-infer-complex-closure-return-type-in-SwiftUI/">How to fix unable to infer complex closure return type in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/505">#505</a></strong></p>
<p>Make sure all <code>String</code> are passed into <code>Text</code>, not <code>Optional&lt;String&gt;</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(data.title)</span><br><span class="line">    <span class="type">Text</span>(data.description!)</span><br><span class="line">    <span class="type">Text</span>(data.text!)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-13T11:23:55.000Z" title="2019-11-13T11:23:55.000Z">2019-11-13</time><span class="level-item">a minute read (About 156 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-Swift-Package-Manager-package-for-multiple-platforms/">How to make Swift Package Manager package for multiple platforms</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/504">#504</a></strong></p>
<p><a href="https://twitter.com/NeoNacho/status/1181245484867801088?s=20">https://twitter.com/NeoNacho/status/1181245484867801088?s=20</a></p>
<blockquote>
<p>There’s no way to have platform specific sources or targets today, so you’ll have to take a different approach. I would recommend wrapping all OS specific files in #if os and just having one target. For tests, you could do something similar, one test target, but conditional tests</p>
</blockquote>
<p>Every files are in <code>Sources</code> folder, so we can use platform and version checks. For example <a href="https://github.com/onmyway133/Omnia">Omnia</a> is a Swift Package Manager that supports iOS, tvOS, watchOS, macOS and Catalyst.</p>
<p>For macOS only code, need to check for AppKit and Catalyst</p>
<p><code>https://github.com/onmyway133/Omnia/blob/master/Sources/macOS/ClickedCollectionView.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> canImport(<span class="type">AppKit</span>) &amp;&amp; !targetEnvironment(macCatalyst)</span><br></pre></td></tr></table></figure>

<p>For SwiftUI feature, need to check for iOS 13 and macOS 10.15</p>
<p><code>https://github.com/onmyway133/Omnia/blob/master/Sources/SwiftUI/Utils/ImageLoader.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@available</span>(iOS <span class="number">13.0</span>, <span class="type">OSX</span> <span class="number">10.15</span>, tvOS <span class="number">13.0</span>, watchOS <span class="number">6.0</span>, *)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-13T10:10:29.000Z" title="2019-11-13T10:10:29.000Z">2019-11-13</time><span class="level-item">2 minutes read (About 307 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-simple-Redux-for-SwiftUI/">How to make simple Redux for SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/502">#502</a></strong></p>
<p><code>Mutation</code> is used to mutate state synchronously. <code>Action</code> is like intent, either from app or from user action. <code>Action</code> maps to <code>Mutation</code> in form of <code>Publisher</code> to work  with  async action, similar to <a href="https://github.com/redux-observable/redux-observable">redux-observable</a></p>
<p><code>AnyReducer</code> is a type erasure that takes the <code>reduce</code> function</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Reducer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">State</span></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Mutation</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">reduce</span><span class="params">(state: State, mutation: Mutation)</span></span> -&gt; <span class="type">State</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">AnyReducer</span>&lt;<span class="title">State</span>, <span class="title">Mutation</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">let</span> <span class="built_in">reduce</span>: (<span class="type">State</span>, <span class="type">Mutation</span>) -&gt; <span class="type">State</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>&lt;<span class="type">R</span>: <span class="type">Reducer</span>&gt;(reducer: <span class="type">R</span>) <span class="keyword">where</span> <span class="type">R</span>.<span class="type">State</span> == <span class="type">State</span>, <span class="type">R</span>.<span class="type">Mutation</span> == <span class="type">Mutation</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="built_in">reduce</span> = reducer.<span class="built_in">reduce</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Mutation</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toMutation</span><span class="params">()</span></span> -&gt; <span class="type">AnyPublisher</span>&lt;<span class="type">Mutation</span>, <span class="type">Never</span>&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Store</span>&lt;<span class="title">State</span>, <span class="title">Mutation</span>&gt;: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">public</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> state: <span class="type">State</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">let</span> reducer: <span class="type">AnyReducer</span>&lt;<span class="type">State</span>, <span class="type">Mutation</span>&gt;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> cancellables = <span class="type">Set</span>&lt;<span class="type">AnyCancellable</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(initialState: <span class="type">State</span>, reducer: <span class="type">AnyReducer</span>&lt;<span class="type">State</span>, <span class="type">Mutation</span>&gt;) &#123;</span><br><span class="line">        <span class="keyword">self</span>.state = initialState</span><br><span class="line">        <span class="keyword">self</span>.reducer = reducer</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">send</span>&lt;A: Action&gt;<span class="params">(action: A)</span></span> <span class="keyword">where</span> <span class="type">A</span>.<span class="type">Mutation</span> == <span class="type">Mutation</span> &#123;</span><br><span class="line">        action</span><br><span class="line">            .toMutation()</span><br><span class="line">            .receive(on: <span class="type">DispatchQueue</span>.main)</span><br><span class="line">            .sink(receiveValue: update(mutation:))</span><br><span class="line">            .store(<span class="keyword">in</span>: &amp;cancellables)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">(mutation: Mutation)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.state = reducer.<span class="built_in">reduce</span>(state, mutation)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To use, conform to all the protocols. Also make typelias <code>AppStore</code> in order to easy specify type in <code>SwiftUI View</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">AppStore</span> = <span class="type">Store</span>&lt;<span class="type">AppState</span>, <span class="type">AppMutation</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> appStore: <span class="type">AppStore</span> = <span class="type">AppStore</span>(</span><br><span class="line">    initialState: <span class="type">AppState</span>(),</span><br><span class="line">    reducer: appReducer</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AppState</span>: <span class="title">Codable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> hasShownOnboaring = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AppReducer</span>: <span class="title">Reducer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">reduce</span><span class="params">(state: AppState, mutation: AppMutation)</span></span> -&gt; <span class="type">AppState</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> state = state</span><br><span class="line">        <span class="keyword">switch</span> mutation &#123;</span><br><span class="line">        <span class="keyword">case</span> .finishOnboarding:</span><br><span class="line">            state.hasShownOnboaring = <span class="literal">true</span></span><br><span class="line">        @unknown <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AppMutation</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> finishOnboarding</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Use in  SwiftUI</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RootScreen</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> store: <span class="type">AppStore</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> store.state.hasShownOnboaring &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(<span class="string">"Welcome"</span>)</span><br><span class="line">                .eraseToAnyView()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">OnboardingScreen</span>()</span><br><span class="line">                .eraseToAnyView()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OnboardingScreen</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> store: <span class="type">AppStore</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">done</span><span class="params">()</span></span> &#123;</span><br><span class="line">        store.send(action: <span class="type">AppAction</span>.finishOnboarding)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://swiftwithmajid.com/2019/09/18/redux-like-state-container-in-swiftui/">https://swiftwithmajid.com/2019/09/18/redux-like-state-container-in-swiftui/</a></li>
<li><a href="https://github.com/mecid/swiftui-recipes-app">https://github.com/mecid/swiftui-recipes-app</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-12T12:54:20.000Z" title="2019-11-12T12:54:20.000Z">2019-11-12</time><span class="level-item">a few seconds read (About 104 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Firebase-in-macOS/">How to use Firebase in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/501">#501</a></strong></p>
<ul>
<li>Use Catalyst</li>
<li>Add to CocoaPods</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">platform <span class="symbol">:ios</span>, <span class="string">'13.0'</span></span><br><span class="line"></span><br><span class="line">target <span class="string">'MyApp'</span> <span class="keyword">do</span></span><br><span class="line">  use_frameworks!</span><br><span class="line"></span><br><span class="line">  pod <span class="string">'FirebaseCore'</span></span><br><span class="line">  pod <span class="string">'Firebase/Firestore'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Select-a-team-for-gRPC-C-gRPCCertificates-Cpp"><a href="#Select-a-team-for-gRPC-C-gRPCCertificates-Cpp" class="headerlink" title="Select a team for gRPC-C++-gRPCCertificates-Cpp"></a>Select a team for <code>gRPC-C++-gRPCCertificates-Cpp</code></h3><img width="957" alt="Screenshot 2019-11-12 at 14 53 03" src="https://user-images.githubusercontent.com/2284279/68677350-3f93c380-055c-11ea-9782-00f124cffc89.png">

<h3 id="FIRAnalyticsConnector-building-for-Mac-Catalyst-but-linking-in-object-file-built-for-iOS-Simulator"><a href="#FIRAnalyticsConnector-building-for-Mac-Catalyst-but-linking-in-object-file-built-for-iOS-Simulator" class="headerlink" title="FIRAnalyticsConnector: building for Mac Catalyst, but linking in object file built for iOS Simulator"></a>FIRAnalyticsConnector: building for Mac Catalyst, but linking in object file built for iOS Simulator</h3><p><a href="https://stackoverflow.com/questions/57666155/firanalyticsconnector-building-for-mac-catalyst-but-linking-in-object-file-bui">https://stackoverflow.com/questions/57666155/firanalyticsconnector-building-for-mac-catalyst-but-linking-in-object-file-bui</a></p>
<blockquote>
<p>The problem was related to the difference between Firebase/Core and FirebaseCore. The first is a subspec of the Firebase pod that depends on FirebaseAnalytics. The second is only the FirebaseCore pod. Only the latter should be used for macOS.</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-12T07:33:50.000Z" title="2019-11-12T07:33:50.000Z">2019-11-12</time><span class="level-item">2 minutes read (About 278 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Links-for-Xcode/">Links for Xcode</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/499">#499</a></strong></p>
<h2 id="Build-setting"><a href="#Build-setting" class="headerlink" title="Build setting"></a>Build setting</h2><h3 id="Build-Library-For-Distribution"><a href="#Build-Library-For-Distribution" class="headerlink" title="Build Library For Distribution"></a>Build Library For Distribution</h3><ul>
<li><a href="https://developer.apple.com/videos/play/wwdc2019/416/?time=596">Binary Frameworks in Swift</a></li>
</ul>
<blockquote>
<p>It turns on all the features that are necessary to build your library in such a way that it can be distributed</p>
</blockquote>
<blockquote>
<p>What does this error actually mean? Well, when the Swift compiler goes to import a module, it looks for a file called the Compiled Module for that library. If it finds one of these files, it reads off the manifest of public APIs that you can call into, and lets you use them. Now, this Compiled Module Format is a binary format that basically contains internal compiler data structures.</p>
</blockquote>
<blockquote>
<p> And since they’re just internal data structures, they’re subject to change with every version of the Swift Compiler. So what this means is that if one person tries to import a module using one version of Swift, and that module was created by another version of Swift, their compiler can’t understand it, and they won’t be able to use it.</p>
</blockquote>
<blockquote>
<p>Well, in order to solve this version lock, Xcode 11 introduces a new format for Swift Modules, called Swift Module Interfaces. And just like the Compiled Module Format, they list out all the public APIs of a module, but in a textual form that behaves more like source code. And since they behave like source code, then future versions of the Swift Compiler will be able to import module interfaces created with older versions. And when you enable Build Libraries for Distribution, you’re telling the compiler to generate one of these stable interfaces whenever it builds your framework</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-12T07:33:50.000Z" title="2019-11-12T07:33:50.000Z">2019-11-12</time><span class="level-item">2 minutes read (About 278 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Xcode/">How to use Xcode</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/499">#499</a></strong></p>
<h2 id="Build-setting"><a href="#Build-setting" class="headerlink" title="Build setting"></a>Build setting</h2><h3 id="Build-Library-For-Distribution"><a href="#Build-Library-For-Distribution" class="headerlink" title="Build Library For Distribution"></a>Build Library For Distribution</h3><ul>
<li><a href="https://developer.apple.com/videos/play/wwdc2019/416/?time=596">Binary Frameworks in Swift</a></li>
</ul>
<blockquote>
<p>It turns on all the features that are necessary to build your library in such a way that it can be distributed</p>
</blockquote>
<blockquote>
<p>What does this error actually mean? Well, when the Swift compiler goes to import a module, it looks for a file called the Compiled Module for that library. If it finds one of these files, it reads off the manifest of public APIs that you can call into, and lets you use them. Now, this Compiled Module Format is a binary format that basically contains internal compiler data structures.</p>
</blockquote>
<blockquote>
<p> And since they’re just internal data structures, they’re subject to change with every version of the Swift Compiler. So what this means is that if one person tries to import a module using one version of Swift, and that module was created by another version of Swift, their compiler can’t understand it, and they won’t be able to use it.</p>
</blockquote>
<blockquote>
<p>Well, in order to solve this version lock, Xcode 11 introduces a new format for Swift Modules, called Swift Module Interfaces. And just like the Compiled Module Format, they list out all the public APIs of a module, but in a textual form that behaves more like source code. And since they behave like source code, then future versions of the Swift Compiler will be able to import module interfaces created with older versions. And when you enable Build Libraries for Distribution, you’re telling the compiler to generate one of these stable interfaces whenever it builds your framework</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-10T21:21:06.000Z" title="2019-11-10T21:21:06.000Z">2019-11-10</time><span class="level-item">2 minutes read (About 225 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-access-view-in-fragment-in-Kotlin/">How to access view in fragment in Kotlin</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/497">#497</a></strong></p>
<p>Synthetic properties generated by <a href="https://kotlinlang.org/docs/tutorials/android-plugin.html">Kotlin Android Extensions plugin</a> needs a <code>view</code> for <code>Fragment/Activity</code> to be set before hand.</p>
<p>In your case, for <code>Fragment</code>, you need to use <code>view.btn_K</code> in <code>onViewCreated</code></p>
<pre><code>override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
    super.onCreateView(inflater, container, savedInstanceState)
    val view = inflater.inflate(R.layout.fragment_card_selector, container, false)
    view.btn_K.setOnClickListener{} // access with `view`
    return view
}</code></pre><p>Or better, you should only access synthetic properties in <code>onViewCreated</code></p>
<pre><code>override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
    super.onCreateView(inflater, container, savedInstanceState)
    return inflater.inflate(R.layout.fragment_card_selector, container, false)
}

override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
    super.onViewCreated(view, savedInstanceState)
    btn_K.setOnClickListener{} // access without `view`
}</code></pre><p>Please notice that <code>savedInstanceState</code> parameter should be nullable <code>Bundle?</code>, and also check <a href="https://kotlinlang.org/docs/tutorials/android-plugin.html">Importing synthetic properties</a></p>
<blockquote>
<p>It is convenient to import all widget properties for a specific layout<br>in one go:</p>
<p><code>import kotlinx.android.synthetic.main.&lt;layout&gt;.*</code></p>
<p>Thus if the layout filename is activity_main.xml, we’d import<br><code>kotlinx.android.synthetic.main.activity_main.*.</code></p>
<p>If we want to call the synthetic properties on View, we should also<br>import <code>kotlinx.android.synthetic.main.activity_main.view.*.</code></p>
</blockquote>
<hr>
<p>Original answer <a href="https://stackoverflow.com/questions/34541650/nullpointerexception-when-trying-to-access-views-in-a-kotlin-fragment/51674381#51674381">https://stackoverflow.com/questions/34541650/nullpointerexception-when-trying-to-access-views-in-a-kotlin-fragment/51674381#51674381</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-10T21:19:39.000Z" title="2019-11-10T21:19:39.000Z">2019-11-10</time><span class="level-item">3 minutes read (About 407 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-refresh-receipt-and-restore-in-app-purchase-in-iOS/">How to refresh receipt and restore in app purchase in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/496">#496</a></strong></p>
<p>Read this <a href="https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/Restoring.html#//apple_ref/doc/uid/TP40008267-CH8-SW9">Restoring Purchased Products</a> to understand the purposes between the 2.</p>
<p>From iOS 7, every app downloaded from the store has a receipt (for downloading/buying the app) at <code>appStoreReceiptURL</code>. When users purchases something via In App Purchase, the content at <code>appStoreReceiptURL</code> is updated with purchases information. Most of the cases, you just need to refresh the receipt (at <code>appStoreReceiptURL</code>) so that you know which transactions users have made.</p>
<blockquote>
<p>Users restore transactions to maintain access to content they’ve already purchased. For example, when they upgrade to a new phone, they don’t lose all of the items they purchased on the old phone. Include some mechanism in your app to let the user restore their purchases, such as a Restore Purchases button. Restoring purchases <strong>prompts for the user’s App Store credentials</strong>, which interrupts the flow of your app: because of this, don’t automatically restore purchases, especially not every time your app is launched.</p>
</blockquote>
<blockquote>
<p><strong>In most cases, all your app needs to do is refresh its receipt</strong> and deliver the products in its receipt. The refreshed receipt contains a record of the user’s purchases in this app, on this device or any other device. However, some apps need to take an alternate approach for one of the following reasons:</p>
</blockquote>
<blockquote>
<p>If you use <strong>Apple-hosted content</strong>, restoring completed transactions gives your app the transaction objects it uses to download the content.<br>If you need to support versions of iOS earlier than iOS 7, where the app receipt isn’t available, restore completed transactions instead.</p>
</blockquote>
<blockquote>
<p>Refreshing the receipt asks the App Store for the latest copy of the receipt. <strong>Refreshing a receipt does not create any new transactions.</strong></p>
</blockquote>
<blockquote>
<p>Restoring completed transactions creates a new transaction for every completed transaction the user made, essentially replaying history for your transaction queue observer.</p>
</blockquote>
<p>More about receipt, from WWDC 2017, What’s new in StoreKit session <a href="https://developer.apple.com/videos/play/wwdc2017/303/">https://developer.apple.com/videos/play/wwdc2017/303/</a></p>
<p><a href="https://i.stack.imgur.com/XoZOv.png"><img src="https://i.stack.imgur.com/XoZOv.png" alt="enter image description here"></a></p>
<p>You can also watch WWDC 2017, session Advanced StoreKit for more detail <a href="https://developer.apple.com/videos/play/wwdc2017/305/">https://developer.apple.com/videos/play/wwdc2017/305/</a></p>
<p><a href="https://i.stack.imgur.com/h2cg9.png"><img src="https://i.stack.imgur.com/h2cg9.png" alt="enter image description here"></a></p>
<hr>
<p>Original answer <a href="https://stackoverflow.com/questions/45615106/when-to-refresh-a-receipt-vs-restore-purchases-in-ios/52162283#52162283">https://stackoverflow.com/questions/45615106/when-to-refresh-a-receipt-vs-restore-purchases-in-ios/52162283#52162283</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-06T09:16:32.000Z" title="2019-11-06T09:16:32.000Z">2019-11-06</time><span class="level-item">a minute read (About 151 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-edit-hexo-theme-hiero/">How to edit hexo theme hiero</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/494">#494</a></strong></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><ul>
<li><a href="https://github.com/iTimeTraveler/hexo-theme-hiero">https://github.com/iTimeTraveler/hexo-theme-hiero</a></li>
</ul>
<p>Remove <code>max-width</code> from <code>source/css/style.styl</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span></span><br><span class="line">  <span class="selector-tag">clearfix</span>()</span><br><span class="line">  // max-width: (column-width + gutter-width) * columns + gutter-width</span><br><span class="line">  <span class="selector-tag">margin</span>: 40<span class="selector-tag">px</span> <span class="selector-tag">auto</span></span><br><span class="line">  <span class="selector-tag">padding</span>: 0 <span class="selector-tag">gutter-width</span></span><br></pre></td></tr></table></figure>

<p>Change <code>font-size</code> of code block from <code>source/css/_partial/highlight.styl</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$code-block</span><br><span class="line">  background: $highlight-background</span><br><span class="line">  <span class="selector-tag">margin</span>: <span class="selector-tag">article-padding</span> <span class="selector-tag">article-padding</span> * 0</span><br><span class="line">  <span class="selector-tag">padding</span>: 15<span class="selector-tag">px</span> <span class="selector-tag">article-padding</span></span><br><span class="line">  <span class="selector-tag">border-style</span>: <span class="selector-tag">solid</span></span><br><span class="line">  <span class="selector-tag">border-color</span>: <span class="selector-tag">color-border</span></span><br><span class="line">  <span class="selector-tag">border-width</span>: 1<span class="selector-tag">px</span> 0</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">auto</span></span><br><span class="line">  color: $highlight-foreground</span><br><span class="line">  <span class="selector-tag">font-size</span>: 1<span class="selector-class">.0em</span>;</span><br><span class="line">  <span class="selector-tag">line-height</span>: 1<span class="selector-tag">em</span></span><br></pre></td></tr></table></figure>

<p>Change <code>font-size</code> of <code>article-header</code> from <code>source/css/_partial/article.styl</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.article-header</span></span><br><span class="line">  <span class="selector-tag">h1</span></span><br><span class="line">    <span class="selector-tag">margin</span>: 0 0 3<span class="selector-tag">px</span> 0;</span><br><span class="line">    <span class="selector-tag">font-size</span>: 26<span class="selector-tag">px</span>;</span><br><span class="line">    <span class="selector-tag">line-height</span>: 1<span class="selector-class">.2</span>;</span><br><span class="line">    <span class="selector-tag">a</span></span><br><span class="line">      <span class="selector-tag">color</span>: <span class="selector-id">#404040</span>;</span><br><span class="line">      <span class="selector-tag">text-decoration</span>: <span class="selector-tag">none</span>;</span><br></pre></td></tr></table></figure>

<p>Change <code>font-size</code> of text from <code>source/css/_partial/article.styl</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.article-entry</span></span><br><span class="line">  @<span class="keyword">extend</span> $base-style</span><br><span class="line">  clearfix()</span><br><span class="line">  color: color-default</span><br><span class="line">  padding: <span class="number">0</span></span><br><span class="line">  p, table</span><br><span class="line">    line-height: line-height</span><br><span class="line">    margin: line-height <span class="number">0</span></span><br><span class="line">    font-size: <span class="number">1.1em</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-05T12:13:25.000Z" title="2019-11-05T12:13:25.000Z">2019-11-05</time><span class="level-item">a minute read (About 148 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Firebase-RemoteConfig/">How to use Firebase RemoteConfig</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/493">#493</a></strong></p>
<p>Declare in Podfile</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pod <span class="string">'Firebase/Core'</span></span><br><span class="line">pod <span class="string">'Firebase/RemoteConfig'</span></span><br></pre></td></tr></table></figure>

<p>Use <code>RemoteConfigHandler</code> to encapsulate logic. We introduce <code>Key</code> with <code>CaseIterable</code> and <code>defaultValue</code> of type <code>NSNumber</code> to manage default values.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Firebase</span><br><span class="line"><span class="keyword">import</span> FirebaseRemoteConfig</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteConfigHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> remoteConfig: <span class="type">RemoteConfig</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Key</span>: <span class="title">String</span>, <span class="title">CaseIterable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> interval = <span class="string">"fetch_interval"</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> defaultValue: <span class="type">NSNumber</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .periodicGetSalons: <span class="keyword">return</span> <span class="type">NSNumber</span>(value: <span class="number">300</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.remoteConfig = <span class="type">RemoteConfig</span>.remoteConfig()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> settings = <span class="type">RemoteConfigSettings</span>()</span><br><span class="line">        settings.minimumFetchInterval = <span class="number">0</span></span><br><span class="line">        <span class="keyword">self</span>.remoteConfig.configSettings = settings</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="built_in">map</span> = <span class="type">Key</span>.allCases.<span class="built_in">reduce</span>([<span class="type">String</span>: <span class="type">NSObject</span>](), &#123; <span class="built_in">map</span>, key <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">var</span> <span class="built_in">map</span> = <span class="built_in">map</span></span><br><span class="line">            <span class="built_in">map</span>[key.rawValue] = key.defaultValue</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">map</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.remoteConfig.setDefaults(<span class="built_in">map</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">()</span></span>  &#123;</span><br><span class="line">        <span class="keyword">self</span>.remoteConfig.fetchAndActivate(completionHandler: &#123; status, error <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(status, error <span class="keyword">as</span> <span class="type">Any</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> fetchInterval: <span class="type">TimeInterval</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getValue(key: .interval, transform: &#123; $<span class="number">0</span>.doubleValue &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">getValue</span>&lt;T&gt;<span class="params">(key: Key, transform: <span class="params">(NSNumber)</span></span></span> -&gt; <span class="type">T</span>) -&gt; <span class="type">T</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> number = remoteConfig.configValue(forKey: key.rawValue).numberValue ?? key.defaultValue</span><br><span class="line">        <span class="keyword">return</span> transform(number)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-05T08:35:11.000Z" title="2019-11-05T08:35:11.000Z">2019-11-05</time><span class="level-item">2 minutes read (About 225 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-apply-translations-to-Localizable.strings/">How to apply translations to Localizable.strings</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/492">#492</a></strong></p>
<p>Suppose we have a base Localizable.strings</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;open&quot; &#x3D; &quot;Open&quot;;</span><br><span class="line">&quot;closed&quot; &#x3D; &quot;Closed&quot;;</span><br></pre></td></tr></table></figure>

<p>After sending that file for translations, we get translated versions.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;open&quot; &#x3D; &quot;Åpen&quot;;</span><br><span class="line">&quot;closed&quot; &#x3D; &quot;Stengt&quot;;</span><br></pre></td></tr></table></figure>

<p>Searching and copy pasting these to our Localizable.strings is tedious and time consuming. We can write a script to apply that.</p>
<p>Remember that we need to be aware of smart and dump quotes</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.replace(<span class="regexp">/\"/g</span>, <span class="string">''</span>)</span><br><span class="line">.replace(<span class="regexp">/\"/g</span>, <span class="string">''</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> originalFile = <span class="string">'MyApp/Resources/nb.lproj/Localizable.strings'</span></span><br><span class="line"><span class="keyword">const</span> translationString = <span class="string">`</span></span><br><span class="line"><span class="string">"open" = "Åpen";</span></span><br><span class="line"><span class="string">"closed" = "Stengt";</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Translation</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(key, value) &#123;</span><br><span class="line">        <span class="keyword">this</span>.key = key</span><br><span class="line">        <span class="keyword">this</span>.value = value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Translation.make = <span class="function"><span class="keyword">function</span> <span class="title">make</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!line.endsWith(<span class="string">';'</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Translation(<span class="string">''</span>, <span class="string">''</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> parts = line</span><br><span class="line">        .replace(<span class="string">';'</span>)</span><br><span class="line">        .split(<span class="string">" = "</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> key = parts[<span class="number">0</span>]</span><br><span class="line">        .replace(<span class="regexp">/\"/g</span>, <span class="string">''</span>)</span><br><span class="line">        .replace(<span class="regexp">/\”/g</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">const</span> value = parts[<span class="number">1</span>]</span><br><span class="line">        .replace(<span class="regexp">/\"/g</span>, <span class="string">''</span>)</span><br><span class="line">        .replace(<span class="regexp">/\”/g</span>, <span class="string">''</span>)</span><br><span class="line">        .replace(<span class="string">'undefined'</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Translation(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> translations = translationString</span><br><span class="line">        .split(<span class="regexp">/\r?\n/</span>)</span><br><span class="line">        .map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123; <span class="keyword">return</span> Translation.make(line) &#125;)</span><br><span class="line"></span><br><span class="line">    apply(translations, originalFile)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">apply</span>(<span class="params">translations, originalFile</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> originalData = fs.readFileSync(originalFile, <span class="string">'utf8'</span>)</span><br><span class="line">        <span class="keyword">const</span> originalLines = originalData.split(<span class="regexp">/\r?\n/</span>)</span><br><span class="line">        <span class="keyword">const</span> parsedLine = originalLines.map(<span class="function">(<span class="params">originalLine</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> originalTranslation = Translation.make(originalLine)</span><br><span class="line">            <span class="keyword">const</span> find = translations.find(<span class="function">(<span class="params">translation</span>) =&gt;</span> &#123; <span class="keyword">return</span> translation.key === originalTranslation.key &#125;)</span><br><span class="line">            <span class="keyword">if</span> (originalLine !== <span class="string">""</span> &amp;&amp; find !== <span class="literal">undefined</span> &amp;&amp;  find.key !== <span class="string">""</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`"<span class="subst">$&#123;find.key&#125;</span>" = "<span class="subst">$&#123;find.value&#125;</span>";`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> originalLine</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> parsedData = parsedLine.join(<span class="string">'\n'</span>)</span><br><span class="line">        fs.writeFileSync(originalFile, parsedData, &#123; <span class="attr">overwrite</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-04T12:14:50.000Z" title="2019-11-04T12:14:50.000Z">2019-11-04</time><span class="level-item">a few seconds read (About 83 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-CreateML-to-classify-images/">How to use CreateML to classify images</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/491">#491</a></strong></p>
<img width="832" alt="createml" src="https://user-images.githubusercontent.com/2284279/68123467-4774b780-ff0d-11e9-9ac1-5ab2b21b5dc4.png">
<img width="1403" alt="createml data" src="https://user-images.githubusercontent.com/2284279/68123468-480d4e00-ff0d-11e9-80e5-6c3e8f8d92b3.png">
<img width="1403" alt="createml train" src="https://user-images.githubusercontent.com/2284279/68127306-e7364380-ff15-11e9-88e2-5f6d880df186.png">

<h2 id="CreateMLUI-Playground"><a href="#CreateMLUI-Playground" class="headerlink" title="CreateMLUI Playground"></a>CreateMLUI Playground</h2><img width="1680" alt="create ml ui" src="https://user-images.githubusercontent.com/2284279/68127301-e1d8f900-ff15-11e9-9b1e-3c8c3aeeb28b.png">

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://developer.apple.com/documentation/createml/creating_an_image_classifier_model">https://developer.apple.com/documentation/createml/creating_an_image_classifier_model</a></li>
<li><a href="https://captechconsulting.com/blogs/hands-on-with-the-all-new-create-ml-app-machine-learning-for-the-masses">https://captechconsulting.com/blogs/hands-on-with-the-all-new-create-ml-app-machine-learning-for-the-masses</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2019/425/">Training Sound Classification Models in Create ML - WWDC 2019</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2019/426/">Building Activity Classification Models in Create ML - WWDC 2019</a></li>
<li><a href="https://www.youtube.com/watch?v=a905KIBw1hs">Create ML for Everyone</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-04T11:41:41.000Z" title="2019-11-04T11:41:41.000Z">2019-11-04</time><span class="level-item">a few seconds read (About 56 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Firebase-AutoML-Vision-Edge-to-classify-images/">How to use Firebase AutoML Vision Edge to classify images</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/490">#490</a></strong></p>
<h2 id="Create-project-on-Firebase-and-choose-Vision-Edge"><a href="#Create-project-on-Firebase-and-choose-Vision-Edge" class="headerlink" title="Create project on Firebase and choose Vision Edge"></a>Create project on Firebase and choose Vision Edge</h2><p>Vision Edge is part of MLKit, but for custom images training</p>
<p><a href="https://console.firebase.google.com/u/0/project/avengers-ad2ce/ml/">https://console.firebase.google.com/u/0/project/avengers-ad2ce/ml/</a></p>
<img width="1527" alt="firebase vision edge" src="https://user-images.githubusercontent.com/2284279/68121743-cb787080-ff08-11e9-8fbf-bc3734e833e3.png">

<img width="1527" alt="firebase dataset" src="https://user-images.githubusercontent.com/2284279/68121742-cb787080-ff08-11e9-83a6-345d79126542.png">

<blockquote>
<p>Model Avengers_dataset_2019114133437 is training and may take several hours. You will receive an email once training is complete.</p>
</blockquote>
<img width="1403" alt="firebase evaluation" src="https://user-images.githubusercontent.com/2284279/68123651-e0a3ce00-ff0d-11e9-9264-33bb1a475e53.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-04T11:40:28.000Z" title="2019-11-04T11:40:28.000Z">2019-11-04</time><span class="level-item">a few seconds read (About 34 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Google-AutoML-to-classify-images/">How to use Google AutoML to classify images</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/489">#489</a></strong></p>
<h2 id="Create-bucket-on-Google-Cloud-Storage"><a href="#Create-bucket-on-Google-Cloud-Storage" class="headerlink" title="Create bucket on Google Cloud Storage"></a>Create bucket on Google Cloud Storage</h2><p><a href="https://console.cloud.google.com/storage">https://console.cloud.google.com/storage</a></p>
<img width="1674" alt="cloud storage" src="https://user-images.githubusercontent.com/2284279/68121645-8d7b4c80-ff08-11e9-93f6-56c6b3f46f41.png">

<h2 id="Create-dataset-by-uploading-images-to-Google-AutoML-Vision"><a href="#Create-dataset-by-uploading-images-to-Google-AutoML-Vision" class="headerlink" title="Create dataset by uploading images to Google AutoML Vision"></a>Create dataset by uploading images to Google AutoML Vision</h2><p><a href="https://console.cloud.google.com/vision">https://console.cloud.google.com/vision</a></p>
<img width="1239" alt="automl dataset" src="https://user-images.githubusercontent.com/2284279/68121669-9ff58600-ff08-11e9-95e0-20c6fa8e9cfa.png">

<img width="1675" alt="automl images" src="https://user-images.githubusercontent.com/2284279/68121894-404baa80-ff09-11e9-97ff-a2cd61167d38.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-02T22:46:18.000Z" title="2019-11-02T22:46:18.000Z">2019-11-02</time><span class="level-item">3 minutes read (About 442 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-Binding-via-dollar-prefix-in-SwiftUI/">How to get Binding via dollar prefix in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/488">#488</a></strong></p>
<p>The dollar is not a prefix, it seems to be a generated code for property wrapper, and each kind of property wrapper can determine which value it return via this dollar sign</p>
<p><code>State</code> and <code>ObservedObject</code> are popular property wrappers in SwiftUI</p>
<h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><p>Read <a href="https://developer.apple.com/documentation/swiftui/state">State</a></p>
<blockquote>
<p>A persistent value of a given type, through which a view reads and monitors the value.</p>
</blockquote>
<p>If we have a simple State, we can access its 3 forms</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> image: <span class="type">UIImage</span></span><br></pre></td></tr></table></figure>

<p>and here is what </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">image <span class="comment">// UIImage</span></span><br><span class="line">_image <span class="comment">// State&lt;UIImage&gt;</span></span><br><span class="line">$image <span class="comment">// Binding&lt;UIImage&gt;</span></span><br></pre></td></tr></table></figure>

<p>Also, with State, we can access <code>Binding</code> via <code>projectedValue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_image.projectedValue &#x2F;&#x2F; Binding&lt;UIImage&gt;</span><br></pre></td></tr></table></figure>

<h2 id="ObservableObject"><a href="#ObservableObject" class="headerlink" title="ObservableObject"></a>ObservableObject</h2><p>Read <a href="https://developer.apple.com/documentation/swiftui/observedobject">ObservedObject</a></p>
<p>For a simple <code>ObservableObject</code>, we can see its 3 forms</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewModel</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> objectWillChange = <span class="type">ObservableObjectPublisher</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">UIImage?</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            objectWillChange.send()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span> = <span class="type">ViewModel</span>()</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">viewModel <span class="comment">// ViewModel</span></span><br><span class="line">_viewModel <span class="comment">// ObservedObject&lt;ViewModel&gt;</span></span><br><span class="line">$viewModel <span class="comment">// ObservedObject&lt;ViewModel&gt;.Wrapper</span></span><br></pre></td></tr></table></figure>

<p>If we view the source code of <code>ObservableObject</code>, we can see its <code>Wrapper</code> which uses <code>dynamicMemberLookup</code> to provide <code>Binding</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@propertyWrapper <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">ObservedObject</span>&lt;<span class="title">ObjectType</span>&gt; : <span class="title">DynamicProperty</span> <span class="title">where</span> <span class="title">ObjectType</span> : <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// A wrapper of the underlying `ObservableObject` that can create</span></span><br><span class="line">    <span class="comment">/// `Binding`s to its properties using dynamic member lookup.</span></span><br><span class="line">    @dynamicMemberLookup <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">Wrapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// Creates a `Binding` to a value semantic property of a</span></span><br><span class="line">        <span class="comment">/// reference type.</span></span><br><span class="line">        <span class="comment">///</span></span><br><span class="line">        <span class="comment">/// If `Value` is not value semantic, the updating behavior for</span></span><br><span class="line">        <span class="comment">/// any views that make use of the resulting `Binding` is</span></span><br><span class="line">        <span class="comment">/// unspecified.</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">subscript</span>&lt;<span class="type">Subject</span>&gt;(dynamicMember keyPath: <span class="type">ReferenceWritableKeyPath</span>&lt;<span class="type">ObjectType</span>, <span class="type">Subject</span>&gt;) -&gt; <span class="type">Binding</span>&lt;<span class="type">Subject</span>&gt; &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(initialValue: <span class="type">ObjectType</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(wrappedValue: <span class="type">ObjectType</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> wrappedValue: <span class="type">ObjectType</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> projectedValue: <span class="type">ObservedObject</span>&lt;<span class="type">ObjectType</span>&gt;.<span class="type">Wrapper</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Derived-State"><a href="#Derived-State" class="headerlink" title="Derived State"></a>Derived State</h2><p>If we have a struct with <code>@State</code> in a SwiftUI view, we can access its property as Binding. This derived state mechanism is done via Dynamic keypath member lookup  feature of Swift 5.1</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ViewModel</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span> = <span class="type">ViewModel</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Take a look at the interface of <code>Binding</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// A value and a means to mutate it.</span></span><br><span class="line"><span class="meta">@available</span>(iOS <span class="number">13.0</span>, <span class="type">OSX</span> <span class="number">10.15</span>, tvOS <span class="number">13.0</span>, watchOS <span class="number">6.0</span>, *)</span><br><span class="line">@propertyWrapper @dynamicMemberLookup <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">Binding</span>&lt;<span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/// Creates a new `Binding` focused on `Subject` using a key path.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">subscript</span>&lt;<span class="type">Subject</span>&gt;(dynamicMember keyPath: <span class="type">WritableKeyPath</span>&lt;<span class="type">Value</span>, <span class="type">Subject</span>&gt;) -&gt; <span class="type">Binding</span>&lt;<span class="type">Subject</span>&gt; &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So if use <code>$viewModel.image</code> we can access its property as Binding</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">viewModel.image <span class="comment">// UIImage?</span></span><br><span class="line">$viewModel.image <span class="comment">// Binding&lt;UIImage?&gt;</span></span><br><span class="line">$viewModel.$image <span class="comment">// Value of type 'ViewModel' has no member '$image'</span></span><br></pre></td></tr></table></figure>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>So now we know how to get <code>Binding</code> from <code>State</code> and <code>ObservableObject</code>, and the mysterious dollar sign. These are both convenient but confusing at first, but if we use it more, it will make more sense and hopefully we can learn to do the same for our own property wrappers</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-02T22:09:43.000Z" title="2019-11-02T22:09:43.000Z">2019-11-02</time><span class="level-item">8 minutes read (About 1193 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-modify-state-from-state-in-SwiftUI/">How to modify state from state in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/487">#487</a></strong></p>
<p>In case we have to modify state when another state is known, we can encapsulate all those states in <code>ObservableObject</code> and use <code>onReceive</code> to check the state we want to act on.</p>
<p>See code <a href="https://github.com/onmyway133/Avengers/blob/master/Avengers/Features/MainView.swift">Avengers</a></p>
<p>If we were to modify state from within <code>body</code> function call, we will get warnings</p>
<blockquote>
<p>Modifying state during view update, this will cause undefined behavior.</p>
</blockquote>
<p>This is similar to the warning when we change state inside <code>render</code> in React</p>
<p>For example, when we get an image, we want to do some logic based on that image and modify result state. Here we use <code>var objectWillChange = ObservableObjectPublisher()</code> to notify state change, and because <code>onReceive</code> requires <code>Publisher</code>, we use <code>let imagePublisher = PassthroughSubject&lt;UIImage, Never&gt;()</code></p>
<p>Note that we use <code>$</code> prefix from a variable to form <code>Binding</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewModel</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> objectWillChange = <span class="type">ObservableObjectPublisher</span>()</span><br><span class="line">    <span class="keyword">let</span> imagePublisher = <span class="type">PassthroughSubject</span>&lt;<span class="type">UIImage</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">UIImage?</span> &#123;</span><br><span class="line">        <span class="keyword">willSet</span> &#123;</span><br><span class="line">            objectWillChange.send()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> image = image &#123;</span><br><span class="line">                imagePublisher.send(image)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> isDetecting: <span class="type">Bool</span> = <span class="literal">false</span> &#123;</span><br><span class="line">        <span class="keyword">willSet</span> &#123;</span><br><span class="line">            objectWillChange.send()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">String?</span> &#123;</span><br><span class="line">        <span class="keyword">willSet</span> &#123;</span><br><span class="line">            objectWillChange.send()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> showImagePicker: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    @<span class="type">ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span> = <span class="type">ViewModel</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> detector = <span class="type">Detector</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            makeImage()</span><br><span class="line">                .styleFit()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> viewModel.isDetecting &#123;</span><br><span class="line">                <span class="type">ActivityIndicator</span>(</span><br><span class="line">                    isAnimating: $viewModel.isDetecting,</span><br><span class="line">                    style: .large</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            makeResult()</span><br><span class="line"></span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                <span class="keyword">self</span>.showImagePicker.toggle()</span><br><span class="line">            &#125;, label: &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">"Choose image"</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">            .sheet(isPresented: $showImagePicker, content: &#123;</span><br><span class="line">                <span class="type">ImagePicker</span>(image: <span class="keyword">self</span>.$viewModel.image, isPresented: <span class="keyword">self</span>.$showImagePicker)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        .onReceive(viewModel.imagePublisher, perform: &#123; image <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.detect(image: image)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">makeImage</span><span class="params">()</span></span> -&gt; <span class="type">Image</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> image = <span class="keyword">self</span>.viewModel.image &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Image</span>(uiImage: image)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Image</span>(<span class="string">"placeholder"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">makeResult</span><span class="params">()</span></span> -&gt; <span class="type">Text</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> result = viewModel.result &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(result)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(<span class="string">""</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">detect</span><span class="params">(image: UIImage)</span></span> &#123;</span><br><span class="line">        viewModel.isDetecting = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">try</span>? detector.detect(image: image, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success(<span class="keyword">let</span> string):</span><br><span class="line">                <span class="keyword">self</span>.viewModel.result = string</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">self</span>.viewModel.result = <span class="string">""</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">self</span>.viewModel.isDetecting = <span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Use-Published"><a href="#Use-Published" class="headerlink" title="Use Published"></a>Use Published</h2><p>See <a href="https://developer.apple.com/documentation/combine/observableobject">ObservableObject</a> </p>
<blockquote>
<p>By default an ObservableObject synthesizes an objectWillChange publisher that emits the changed value before any of its @Published properties changes.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Contact</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> age: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>, age: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">self</span>.age = age</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">haveBirthday</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        age += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> john = <span class="type">Contact</span>(name: <span class="string">"John Appleseed"</span>, age: <span class="number">24</span>)</span><br><span class="line">john.objectWillChange.sink &#123; <span class="number">_</span> <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">"\(john.age) will change"</span>) &#125;</span><br><span class="line"><span class="built_in">print</span>(john.haveBirthday())</span><br><span class="line"><span class="comment">// Prints "24 will change"</span></span><br><span class="line"><span class="comment">// Prints "25"</span></span><br></pre></td></tr></table></figure>

<p>We should use <code>@Published</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewModel</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> objectWillChange = <span class="type">ObservableObjectPublisher</span>()</span><br><span class="line"></span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> isDetecting: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> result: <span class="type">String?</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Note that we should not use <code>objectWillChange</code> as</p>
<blockquote>
<p>By default an ObservableObject synthesizes an objectWillChange publisher that emits the changed value before any of its @Published properties changes.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.onReceive(viewModel.$image, perform: &#123; image <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> image = image &#123;</span><br><span class="line">        <span class="keyword">self</span>.detect(image: image)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>We need to manually notify using <code>objectWillChange</code> !! Maybe this is a SwiftUI bug</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">detect</span><span class="params">(image: UIImage)</span></span> &#123;</span><br><span class="line">    viewModel.isDetecting = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">try</span>? detector.detect(image: image, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">switch</span> result &#123;</span><br><span class="line">        <span class="keyword">case</span> .success(<span class="keyword">let</span> string):</span><br><span class="line">            <span class="keyword">self</span>.viewModel.result = string</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">self</span>.viewModel.result = <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.viewModel.isDetecting = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">self</span>.viewModel.objectWillChange.send()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If we remove the declaration of <code>var objectWillChange = ObservableObjectPublisher()</code>, then it works automatically</p>
<h2 id="objectWillChange"><a href="#objectWillChange" class="headerlink" title="objectWillChange"></a>objectWillChange</h2><p>Learn more about the history of <code>objectWillChange</code></p>
<p><a href="https://twitter.com/luka_bernardi/status/1155944329363349504?lang=no">https://twitter.com/luka_bernardi/status/1155944329363349504?lang=no</a></p>
<blockquote>
<p>In Beta 5 ObjectBinding is now defined in Combine as ObservableObject (the property wrapper is now @ObservedObject). There is also a new property wrapper @Published where we automatically synthesize the objectWillChange publisher and call it on willSet.</p>
</blockquote>
<blockquote>
<p>It’ll objectWillChange.send() in the property willSet it’s defined on.<br>It just removes the boilerplate that you had to write before but otherwise behaves the same.</p>
</blockquote>
<h2 id="State-vs-ObservedObject"><a href="#State-vs-ObservedObject" class="headerlink" title="State vs ObservedObject"></a>State vs ObservedObject</h2><p>If we were to use <code>@State</code> instead of <code>@ObservedObject</code>, it still compiles, but after we pick an image, which should change the <code>image</code> property of our <code>viewModel</code>, the view is not reloaded.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> showImagePicker: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span> = <span class="type">ViewModel</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Note that we can’t use <code>@Published</code> inside <code>struct</code></p>
<blockquote>
<p>‘wrappedValue’ is unavailable: @Published is only available on properties of classes</p>
</blockquote>
<p><code>@State</code> is for internal usage within a view, and should use struct and primitive  data structure. SwiftUI keeps <code>@State</code> property in a separate memory place to preserve it during many reload cycles.</p>
<p><code>@Observabled</code> is meant for sharing reference objects across views</p>
<p>To to use <code>@State</code> we should use struct, and to use <code>onReceive</code> we should introduce another <code>Publisher</code> like <code>imagePublisher</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ViewModel</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> imagePublisher = <span class="type">PassthroughSubject</span>&lt;<span class="type">UIImage?</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">UIImage?</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            imagePublisher.send(image)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> isDetecting: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">String?</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> showImagePicker: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span> = <span class="type">ViewModel</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> detector = <span class="type">Detector</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            makeImage()</span><br><span class="line">                .styleFit()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> viewModel.isDetecting &#123;</span><br><span class="line">                <span class="type">ActivityIndicator</span>(</span><br><span class="line">                    isAnimating: $viewModel.isDetecting,</span><br><span class="line">                    style: .large</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            makeResult()</span><br><span class="line"></span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                <span class="keyword">self</span>.showImagePicker.toggle()</span><br><span class="line">            &#125;, label: &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">"Choose image"</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">            .sheet(isPresented: $showImagePicker, content: &#123;</span><br><span class="line">                <span class="type">ImagePicker</span>(image: <span class="keyword">self</span>.$viewModel.image, isPresented: <span class="keyword">self</span>.$showImagePicker)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        .onReceive(viewModel.imagePublisher, perform: &#123; image <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> image = image &#123;</span><br><span class="line">                <span class="keyword">self</span>.detect(image: image)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The dollar sign for <code>State</code> to access nested properties, like <code>$viewModel.image</code> is called derived Binding, and is achieved via Keypath member lookup feature of Swift 5.1.</p>
<p>Take a look at <code>projectedValue: Binding&lt;Value&gt;</code> from <code>State</code> and <code>subscript&lt;Subject&gt;(dynamicMember keyPath</code> from <code>Binding</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@available</span>(iOS <span class="number">13.0</span>, <span class="type">OSX</span> <span class="number">10.15</span>, tvOS <span class="number">13.0</span>, watchOS <span class="number">6.0</span>, *)</span><br><span class="line">@propertyWrapper <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">State</span>&lt;<span class="title">Value</span>&gt; : <span class="title">DynamicProperty</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Initialize with the provided initial value.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(wrappedValue value: <span class="type">Value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Initialize with the provided initial value.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(initialValue value: <span class="type">Value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The current state value.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> wrappedValue: <span class="type">Value</span> &#123; <span class="keyword">get</span> <span class="keyword">nonmutating</span> <span class="keyword">set</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Produces the binding referencing this state value</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> projectedValue: <span class="type">Binding</span>&lt;<span class="type">Value</span>&gt; &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// A value and a means to mutate it.</span></span><br><span class="line"><span class="meta">@available</span>(iOS <span class="number">13.0</span>, <span class="type">OSX</span> <span class="number">10.15</span>, tvOS <span class="number">13.0</span>, watchOS <span class="number">6.0</span>, *)</span><br><span class="line">@propertyWrapper @dynamicMemberLookup <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">Binding</span>&lt;<span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The transaction used for any changes to the binding's value.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> transaction: <span class="type">Transaction</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Initializes from functions to read and write the value.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">get</span>: @escaping () -&gt; <span class="type">Value</span>, <span class="keyword">set</span>: @escaping (<span class="type">Value</span>) -&gt; <span class="type">Void</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Initializes from functions to read and write the value.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">get</span>: @escaping () -&gt; <span class="type">Value</span>, <span class="keyword">set</span>: @escaping (<span class="type">Value</span>, <span class="type">Transaction</span>) -&gt; <span class="type">Void</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Creates a binding with an immutable `value`.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">constant</span><span class="params">(<span class="number">_</span> value: Value)</span></span> -&gt; <span class="type">Binding</span>&lt;<span class="type">Value</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The value referenced by the binding. Assignments to the value</span></span><br><span class="line">    <span class="comment">/// will be immediately visible on reading (assuming the binding</span></span><br><span class="line">    <span class="comment">/// represents a mutable location), but the view changes they cause</span></span><br><span class="line">    <span class="comment">/// may be processed asynchronously to the assignment.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> wrappedValue: <span class="type">Value</span> &#123; <span class="keyword">get</span> <span class="keyword">nonmutating</span> <span class="keyword">set</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The binding value, as "unwrapped" by accessing `$foo` on a `@Binding` property.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> projectedValue: <span class="type">Binding</span>&lt;<span class="type">Value</span>&gt; &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Creates a new `Binding` focused on `Subject` using a key path.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">subscript</span>&lt;<span class="type">Subject</span>&gt;(dynamicMember keyPath: <span class="type">WritableKeyPath</span>&lt;<span class="type">Value</span>, <span class="type">Subject</span>&gt;) -&gt; <span class="type">Binding</span>&lt;<span class="type">Subject</span>&gt; &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://www.freecodecamp.org/news/get-pro-with-react-setstate-in-10-minutes-d38251d1c781/">https://www.freecodecamp.org/news/get-pro-with-react-setstate-in-10-minutes-d38251d1c781/</a></li>
<li><a href="https://stackoverflow.com/questions/56551131/what-does-the-dollar-sign-do-in-this-example">https://stackoverflow.com/questions/56551131/what-does-the-dollar-sign-do-in-this-example</a></li>
<li><a href="https://stackoverflow.com/questions/44037611/how-to-avoid-setstate-inside-render-when-state-depends-on-render?rq=1">https://stackoverflow.com/questions/44037611/how-to-avoid-setstate-inside-render-when-state-depends-on-render?rq=1</a></li>
<li><a href="https://stackoverflow.com/questions/57459727/why-an-observedobject-array-is-not-updated-in-my-swiftui-application">https://stackoverflow.com/questions/57459727/why-an-observedobject-array-is-not-updated-in-my-swiftui-application</a></li>
<li><a href="https://www.pointfree.co/blog/posts/30-swiftui-and-state-management-corrections">https://www.pointfree.co/blog/posts/30-swiftui-and-state-management-corrections</a></li>
<li><a href="https://www.hackingwithswift.com/quick-start/swiftui/whats-the-difference-between-observedobject-state-and-environmentobject">https://www.hackingwithswift.com/quick-start/swiftui/whats-the-difference-between-observedobject-state-and-environmentobject</a></li>
<li><a href="https://swiftui-lab.com/state-changes/">Safely Updating The View State</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-02T21:02:33.000Z" title="2019-11-02T21:02:33.000Z">2019-11-02</time><span class="level-item">a few seconds read (About 56 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-loading-indicator-in-SwiftUI/">How to show loading indicator in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/486">#486</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ActivityIndicator</span>: <span class="title">UIViewRepresentable</span> </span>&#123;</span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> isAnimating: <span class="type">Bool</span></span><br><span class="line">    <span class="keyword">let</span> style: <span class="type">UIActivityIndicatorView</span>.<span class="type">Style</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makeUIView</span><span class="params">(context: UIViewRepresentableContext&lt;ActivityIndicator&gt;)</span></span> -&gt; <span class="type">UIActivityIndicatorView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIActivityIndicatorView</span>(style: style)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">updateUIView</span><span class="params">(<span class="number">_</span> uiView: UIActivityIndicatorView, context: UIViewRepresentableContext&lt;ActivityIndicator&gt;)</span></span> &#123;</span><br><span class="line">        isAnimating ? uiView.startAnimating() : uiView.stopAnimating()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ActivityIndicator_Previews</span>: <span class="title">PreviewProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ActivityIndicator</span>(isAnimating: .constant(<span class="literal">true</span>), style: .large)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-02T20:41:52.000Z" title="2019-11-02T20:41:52.000Z">2019-11-02</time><span class="level-item">4 minutes read (About 664 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-image-picker-in-SwiftUI/">How to show image picker in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/485">#485</a></strong></p>
<p>The easiest way to show image picker in iOS is to use <code>UIImagePickerController</code>, and we can bridge that to SwiftUI via <code>UIViewControllerRepresentable</code></p>
<h2 id="First-attempt-use-Environment"><a href="#First-attempt-use-Environment" class="headerlink" title="First attempt, use Environment"></a>First attempt, use Environment</h2><p>We conform to <code>UIViewControllerRepresentable</code> and make a Coordinator, which is the recommended way to manage the bridging with <code>UIViewController</code>.</p>
<p>There’s some built in environment property we can use, one of those is <code>presentationMode</code> where we can call <code>dismiss</code> to dismiss the modal.</p>
<p>My first attempt looks like below</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">ImagePicker</span>: <span class="title">UIViewControllerRepresentable</span> </span>&#123;</span><br><span class="line">    @<span class="type">Environment</span>(\.presentationMode) <span class="keyword">private</span> <span class="keyword">var</span> presentationMode</span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">makeCoordinator</span><span class="params">()</span></span> -&gt; <span class="type">ImagePicker</span>.<span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">ImagePicker</span>.<span class="type">Coordinator</span>(</span><br><span class="line">            presentationMode: presentationMode,</span><br><span class="line">            image: $image</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">makeUIViewController</span><span class="params">(context: UIViewControllerRepresentableContext&lt;ImagePicker&gt;)</span></span> -&gt; <span class="type">UIImagePickerController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> controller = <span class="type">UIImagePickerController</span>()</span><br><span class="line">        controller.delegate = context.coordinator</span><br><span class="line">        <span class="keyword">return</span> controller</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">updateUIViewController</span><span class="params">(<span class="number">_</span> uiViewController: UIImagePickerController, context: UIViewControllerRepresentableContext&lt;ImagePicker&gt;)</span></span> &#123;</span><br><span class="line">        <span class="comment">// No op</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">extension</span> <span class="title">ImagePicker</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Coordinator</span>: <span class="title">NSObject</span>, <span class="title">UINavigationControllerDelegate</span> </span>&#123;</span><br><span class="line">        @<span class="type">Binding</span> <span class="keyword">var</span> presentationMode: <span class="type">PresentationMode</span></span><br><span class="line">        @<span class="type">Binding</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">init</span>(presentationMode: <span class="type">Binding</span>&lt;<span class="type">PresentationMode</span>&gt;, image: <span class="type">Binding</span>&lt;<span class="type">UIImage?</span>&gt;) &#123;</span><br><span class="line">            <span class="keyword">self</span>._presentationMode = presentationMode</span><br><span class="line">            <span class="keyword">self</span>._image = image</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ImagePicker</span>.<span class="title">Coordinator</span>: <span class="title">UIImagePickerControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">imagePickerController</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> picker: UIImagePickerController,</span></span></span><br><span class="line"><span class="function"><span class="params">        didFinishPickingMediaWithInfo info: [UIImagePickerController.InfoKey: <span class="keyword">Any</span>])</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.image = info[<span class="type">UIImagePickerController</span>.<span class="type">InfoKey</span>.originalImage] <span class="keyword">as</span>? <span class="type">UIImage</span></span><br><span class="line">        presentationMode.dismiss()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">imagePickerControllerDidCancel</span><span class="params">(<span class="number">_</span> picker: UIImagePickerController)</span></span> &#123;</span><br><span class="line">        presentationMode.dismiss()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Signatures"><a href="#Signatures" class="headerlink" title="Signatures"></a>Signatures</h3><p>We need to be aware of the types of these property wrappers</p>
<p>Where we declare environment, <code>presentationMode</code> is of type <code>Binding&lt;PresentationMode&gt;</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">Environment</span>(\.presentationMode) <span class="keyword">private</span> <span class="keyword">var</span> presentationMode</span><br></pre></td></tr></table></figure>

<p>Given a Binding declaration, for example <code>@Binding var image: UIImage?</code>, <code>image</code> is of type <code>UIImage?</code> but <code>$image</code> is <code>Binding&lt;UIImage?&gt;</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">makeCoordinator</span><span class="params">()</span></span> -&gt; <span class="type">ImagePicker</span>.<span class="type">Coordinator</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">ImagePicker</span>.<span class="type">Coordinator</span>(</span><br><span class="line">        image: $image,</span><br><span class="line">        isPresented: $isPresented</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When we want to assign to variables in <code>init</code>, we use <code>_image</code> to use mutable <code>Binding&lt;UIImage?&gt;</code> because <code>self.$image</code> gives us immutable <code>Binding&lt;UIImage?&gt;</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coordinator</span>: <span class="title">NSObject</span>, <span class="title">UINavigationControllerDelegate</span> </span>&#123;</span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> presentationMode: <span class="type">PresentationMode</span></span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(presentationMode: <span class="type">Binding</span>&lt;<span class="type">PresentationMode</span>&gt;, image: <span class="type">Binding</span>&lt;<span class="type">UIImage?</span>&gt;) &#123;</span><br><span class="line">        <span class="keyword">self</span>._presentationMode = presentationMode</span><br><span class="line">        <span class="keyword">self</span>._image = image</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-use"><a href="#How-to-use" class="headerlink" title="How to use"></a>How to use</h3><p>To show modal, we use <code>sheet</code> and use a state <code>@State var showImagePicker: Bool = false</code> to control its  presentation</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="keyword">self</span>.showImagePicker.toggle()</span><br><span class="line">&#125;, label: &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Choose image"</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.sheet(isPresented: $showImagePicker, content: &#123;</span><br><span class="line">    <span class="type">ImagePicker</span>(image: <span class="keyword">self</span>.$image)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Environment-outside-body"><a href="#Environment-outside-body" class="headerlink" title="Environment outside body"></a>Environment outside body</h3><p>If we run the above code, it will crash because of we access environment value <code>presentationMode</code> in <code>makeCoordinator</code> and this is outside <code>body</code></p>
<blockquote>
<p>Fatal error: Reading Environment&lt;Binding<PresentationMode>&gt; outside View.body</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">makeCoordinator</span><span class="params">()</span></span> -&gt; <span class="type">ImagePicker</span>.<span class="type">Coordinator</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">ImagePicker</span>.<span class="type">Coordinator</span>(</span><br><span class="line">        presentationMode: presentationMode,</span><br><span class="line">        image: $image</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Second-attempt-pass-closure"><a href="#Second-attempt-pass-closure" class="headerlink" title="Second attempt, pass closure"></a>Second attempt, pass closure</h2><p>So instead of passing environment <code>presentationMode</code>, we can pass closure, just like in React where we pass functions to child component.</p>
<p>So <code>ImagePicker</code> can just accept a closure called <code>onDone</code>, and the component that uses it can do the dismissal.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="keyword">self</span>.showImagePicker.toggle()</span><br><span class="line">&#125;, label: &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Choose image"</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.sheet(isPresented: $showImagePicker, content: &#123;</span><br><span class="line">    <span class="type">ImagePicker</span>(image: <span class="keyword">self</span>.$image, onDone: &#123;</span><br><span class="line">        <span class="keyword">self</span>.presentationMode.wrappedValue.dismiss()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Unfortunately, although the <code>onDone</code> gets called, the modal is not dismissed.</p>
<h2 id="Use-Binding-instead-of-Environment"><a href="#Use-Binding-instead-of-Environment" class="headerlink" title="Use Binding instead of Environment"></a>Use Binding instead of Environment</h2><p>Maybe there are betters way, but we can use Binding to replace usage of Environment.</p>
<p>We can do that by accepting <code>Binding</code> and change the <code>isPresented</code> state</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">ImagePicker</span>: <span class="title">UIViewControllerRepresentable</span> </span>&#123;</span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> isPresented: <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">makeCoordinator</span><span class="params">()</span></span> -&gt; <span class="type">ImagePicker</span>.<span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">ImagePicker</span>.<span class="type">Coordinator</span>(</span><br><span class="line">            image: $image,</span><br><span class="line">            isPresented: $isPresented</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">makeUIViewController</span><span class="params">(context: UIViewControllerRepresentableContext&lt;ImagePicker&gt;)</span></span> -&gt; <span class="type">UIImagePickerController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> controller = <span class="type">UIImagePickerController</span>()</span><br><span class="line">        controller.delegate = context.coordinator</span><br><span class="line">        <span class="keyword">return</span> controller</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">updateUIViewController</span><span class="params">(<span class="number">_</span> uiViewController: UIImagePickerController, context: UIViewControllerRepresentableContext&lt;ImagePicker&gt;)</span></span> &#123;</span><br><span class="line">        <span class="comment">// No op</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">extension</span> <span class="title">ImagePicker</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Coordinator</span>: <span class="title">NSObject</span>, <span class="title">UINavigationControllerDelegate</span> </span>&#123;</span><br><span class="line">        @<span class="type">Binding</span> <span class="keyword">var</span> isPresented: <span class="type">Bool</span></span><br><span class="line">        @<span class="type">Binding</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">init</span>(image: <span class="type">Binding</span>&lt;<span class="type">UIImage?</span>&gt;, isPresented: <span class="type">Binding</span>&lt;<span class="type">Bool</span>&gt;) &#123;</span><br><span class="line">            <span class="keyword">self</span>._image = image</span><br><span class="line">            <span class="keyword">self</span>._isPresented = isPresented</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ImagePicker</span>.<span class="title">Coordinator</span>: <span class="title">UIImagePickerControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">imagePickerController</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> picker: UIImagePickerController,</span></span></span><br><span class="line"><span class="function"><span class="params">        didFinishPickingMediaWithInfo info: [UIImagePickerController.InfoKey: <span class="keyword">Any</span>])</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.image = info[<span class="type">UIImagePickerController</span>.<span class="type">InfoKey</span>.originalImage] <span class="keyword">as</span>? <span class="type">UIImage</span></span><br><span class="line">        isPresented = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">imagePickerControllerDidCancel</span><span class="params">(<span class="number">_</span> picker: UIImagePickerController)</span></span> &#123;</span><br><span class="line">        isPresented = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>How to use it</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="keyword">self</span>.showImagePicker.toggle()</span><br><span class="line">&#125;, label: &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Choose image"</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.sheet(isPresented: $showImagePicker, content: &#123;</span><br><span class="line">    <span class="type">ImagePicker</span>(image: <span class="keyword">self</span>.$image, isPresented: <span class="keyword">self</span>.$showImagePicker)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Pass-ImagePicker-to-Coordinator"><a href="#Pass-ImagePicker-to-Coordinator" class="headerlink" title="Pass ImagePicker to Coordinator"></a>Pass ImagePicker to Coordinator</h2><ul>
<li><a href="https://www.youtube.com/watch?v=Ek_r-7aRp3A">Using coordinators to manage SwiftUI view controllers</a></li>
</ul>
<p>So that we can call <code>parent.presentationMode.wrappedValue.dismiss()</code></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-01T08:48:43.000Z" title="2019-11-01T08:48:43.000Z">2019-11-01</time><span class="level-item">a minute read (About 165 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-monkey-test-to-iOS-apps/">How to add monkey test to iOS apps</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/484">#484</a></strong></p>
<p>Use <a href="https://github.com/zalando/SwiftMonkey">SwiftMonkey</a> which adds random UITests gestures</p>
<p>Add to UITests target</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">target <span class="string">'MyAppUITests'</span> <span class="keyword">do</span></span><br><span class="line">  pod <span class="string">'R.swift'</span>, <span class="string">'~&gt; 5.0'</span></span><br><span class="line">  pod <span class="string">'SwiftMonkey'</span>, <span class="string">'~&gt; 2.1.0'</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Failed-to-determine-hittability-of-Button"><a href="#Failed-to-determine-hittability-of-Button" class="headerlink" title="Failed to determine hittability of Button"></a>Failed to determine hittability of Button</h3><blockquote>
<p>Failed to determine hittability of Button: Unable to fetch parameterized attribute XC_kAXXCParameterizedAttributeConvertHostedViewPositionFromContext, remote interface does not have this capability.</p>
</blockquote>
<p>This happens when using SwiftMonkey and somewhere in our code uses <code>isHittable</code>, so best to avoid that by having isolated monkey test only</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> XCTest</span><br><span class="line"><span class="keyword">import</span> SwiftMonkey</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MonkeyTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> app: <span class="type">XCUIApplication!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">setUp</span><span class="params">()</span></span> &#123;</span><br><span class="line">        continueAfterFailure = <span class="literal">false</span></span><br><span class="line">        app = <span class="type">XCUIApplication</span>()</span><br><span class="line">        app.launch()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testMonkey</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> monkey = <span class="type">Monkey</span>(frame: app.frame)</span><br><span class="line">        monkey.addDefaultUIAutomationActions()</span><br><span class="line">        monkey.addXCTestTapAlertAction(interval: <span class="number">100</span>, application: app)</span><br><span class="line">        monkey.monkeyAround()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Another workaround is possibly use <code>addDefaultXCTestPublicActions</code> other than <code>addDefaultUIAutomationActions</code></p>
<h3 id="UI-Test-Activity"><a href="#UI-Test-Activity" class="headerlink" title="UI Test Activity:"></a>UI Test Activity:</h3><blockquote>
<p>Assertion Failure: MonkeyXCTest.swift:33: Failed to get matching snapshots: Timed out while evaluating UI query.</p>
</blockquote>
<p>This seems related to SwiftMonkey trying to snapshot. Workaround is to remove</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">monkey.addXCTestTapAlertAction(interval: <span class="number">100</span>, application: app)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-31T11:15:42.000Z" title="2019-10-31T11:15:42.000Z">2019-10-31</time><span class="level-item">a few seconds read (About 58 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-array-of-strings-in-ForEach-in-SwiftUI/">How to use array of strings in ForEach in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/483">#483</a></strong></p>
<p>Every item in list must be uniquely identifiable</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span> &#123;</span><br><span class="line">    <span class="type">ForEach</span>(books, id: \.bookId) &#123; book <span class="keyword">in</span></span><br><span class="line">        <span class="type">NavigationLink</span>(destination:</span><br><span class="line">            <span class="type">BookView</span>(book: book)</span><br><span class="line">                .navigationBarTitle(book.name)</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(book.name)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In case of primitive, we can just provide <code>id</code> to conform to <code>Identifiable</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span>: <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> id: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-31T10:24:54.000Z" title="2019-10-31T10:24:54.000Z">2019-10-31</time><span class="level-item">a few seconds read (About 66 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-multiline-Text-in-SwiftUI-in-watchOS/">How to make multiline Text in SwiftUI in watchOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/482">#482</a></strong></p>
<p><code>lineLimit</code> does not seem to work, use <a href="https://developer.apple.com/documentation/swiftui/group/3284808-fixedsize">fixedSize</a> instead</p>
<blockquote>
<p>Fixes this view at its ideal size.</p>
</blockquote>
<blockquote>
<p>A view that fixes this view at its ideal size in the dimensions given in fixedDimensions.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Text</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">styleText</span><span class="params">()</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span></span><br><span class="line">            .font(.footnote)</span><br><span class="line">            .foregroundColor(.gray)</span><br><span class="line">            .lineLimit(<span class="number">10</span>)</span><br><span class="line">            .fixedSize(horizontal: <span class="literal">false</span>, vertical: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-31T08:51:02.000Z" title="2019-10-31T08:51:02.000Z">2019-10-31</time><span class="level-item">a few seconds read (About 35 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-documentations-for-GitHub-projects/">How to show documentations for GitHub projects</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/481">#481</a></strong></p>
<ul>
<li>Use <a href="https://github.com/realm/jazzy">jazzy</a> to generate documentation which the generated artifacts in <code>docs</code> folder</li>
<li>GitHub has a nifty feature to use docs as GitHub pages</li>
</ul>
<img width="796" alt="Screenshot 2019-10-31 at 10 49 35" src="https://user-images.githubusercontent.com/2284279/67936575-51747e80-fbcc-11e9-9cca-bd52298ced3c.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-29T13:08:00.000Z" title="2019-10-29T13:08:00.000Z">2019-10-29</time><span class="level-item">2 minutes read (About 344 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-CommonCrypto-in-iOS/">How to use CommonCrypto in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/480">#480</a></strong></p>
<h2 id="Use-modulemap"><a href="#Use-modulemap" class="headerlink" title="Use modulemap"></a>Use modulemap</h2><h3 id="modulemap-approach"><a href="#modulemap-approach" class="headerlink" title="modulemap approach"></a>modulemap approach</h3><p>I use <code>modulemap</code> in my wrapper around CommonCrypto <a href="https://github.com/onmyway133/arcane">https://github.com/onmyway133/arcane</a>, <a href="https://github.com/onmyway133/Reindeer">https://github.com/onmyway133/Reindeer</a></p>
<p>For those getting <code>header not found</code>, please take a look <a href="https://github.com/onmyway133/Arcane/issues/4">https://github.com/onmyway133/Arcane/issues/4</a> or run <code>xcode-select --install</code></p>
<ul>
<li>Make a folder <code>CCommonCrypto</code> containing <code>module.modulemap</code></li>
</ul>
<pre><code>module CCommonCrypto {
  header &quot;/usr/include/CommonCrypto/CommonCrypto.h&quot;
  export *
}</code></pre><ul>
<li>Go to Built Settings -&gt; Import Paths</li>
</ul>
<pre><code>${SRCROOT}/Sources/CCommonCrypto</code></pre><h3 id="Cocoapods-with-modulemap-approach"><a href="#Cocoapods-with-modulemap-approach" class="headerlink" title="Cocoapods with modulemap approach"></a>Cocoapods with modulemap approach</h3><ul>
<li><p>Here is the podspec <a href="https://github.com/onmyway133/Arcane/blob/master/Arcane.podspec">https://github.com/onmyway133/Arcane/blob/master/Arcane.podspec</a></p>
<pre><code>s.source_files = &apos;Sources/**/*.swift&apos;
s.xcconfig = { &apos;SWIFT_INCLUDE_PATHS&apos; =&gt;
&apos;$(PODS_ROOT)/CommonCryptoSwift/Sources/CCommonCrypto&apos; }
s.preserve_paths = &apos;Sources/CCommonCrypto/module.modulemap&apos;</code></pre></li>
<li><p>Using <code>module_map</code> does not work, see <a href="https://github.com/CocoaPods/CocoaPods/issues/5271">https://github.com/CocoaPods/CocoaPods/issues/5271</a></p>
</li>
<li><p>Using Local Development Pod with <code>path</code> does not work, see <a href="https://github.com/CocoaPods/CocoaPods/issues/809">https://github.com/CocoaPods/CocoaPods/issues/809</a></p>
</li>
<li><p>That’s why you see that my Example Podfile <a href="https://github.com/onmyway133/CommonCrypto.swift/blob/master/Example/CommonCryptoSwiftDemo/Podfile">https://github.com/onmyway133/CommonCrypto.swift/blob/master/Example/CommonCryptoSwiftDemo/Podfile</a> points to the git repo</p>
<pre><code>target &apos;CommonCryptoSwiftDemo&apos; do
  pod &apos;CommonCryptoSwift&apos;, :git =&gt; &apos;https://github.com/onmyway133/CommonCrypto.swift&apos;
end</code></pre></li>
</ul>
<h3 id="public-header-approach"><a href="#public-header-approach" class="headerlink" title="public header approach"></a>public header approach</h3><ul>
<li><p><a href="https://github.com/honghaoz/Ji">Ji</a> is a wrapper around libxml2, and it uses public header approach</p>
</li>
<li><p>It has a header file <a href="https://github.com/honghaoz/Ji/blob/master/Source/Ji.h">https://github.com/honghaoz/Ji/blob/master/Source/Ji.h</a> with <code>Target Membership</code> set to <code>Public</code></p>
</li>
<li><p>It has a list of header files for libxml2 <a href="https://github.com/honghaoz/Ji/tree/master/Source/Ji-libxml">https://github.com/honghaoz/Ji/tree/master/Source/Ji-libxml</a></p>
</li>
<li><p>It has Build Settings -&gt; Header Search Paths</p>
<pre><code>$(SDKROOT)/usr/include/libxml2</code></pre></li>
<li><p>It has Build Settings -&gt; Other Linker Flags</p>
<pre><code>-lxml2</code></pre></li>
</ul>
<h3 id="Cocoapods-with-public-header-approach"><a href="#Cocoapods-with-public-header-approach" class="headerlink" title="Cocoapods with public header approach"></a>Cocoapods with public header approach</h3><ul>
<li>Take a look at the podspec <a href="https://github.com/honghaoz/Ji/blob/master/Ji.podspec">https://github.com/honghaoz/Ji/blob/master/Ji.podspec</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.libraries        &#x3D; &quot;xml2&quot;</span><br><span class="line">s.xcconfig         &#x3D; &#123; &#39;HEADER_SEARCH_PATHS&#39; &#x3D;&gt;           &#39;$(SDKROOT)&#x2F;usr&#x2F;include&#x2F;libxml2&#39;, &#39;OTHER_LDFLAGS&#39; &#x3D;&gt; &#39;-lxml2&#39; &#125;</span><br></pre></td></tr></table></figure>

<p><strong>🐝 Interesting related posts</strong></p>
<ul>
<li><a href="https://stackoverflow.com/questions/24004732/how-to-call-c-from-swift">https://stackoverflow.com/questions/24004732/how-to-call-c-from-swift</a></li>
<li><a href="https://spin.atomicobject.com/2015/02/23/c-libraries-swift/">https://spin.atomicobject.com/2015/02/23/c-libraries-swift/</a></li>
</ul>
<h2 id="CommonCrypto-from-Xcode-10"><a href="#CommonCrypto-from-Xcode-10" class="headerlink" title="CommonCrypto from Xcode 10"></a>CommonCrypto from Xcode 10</h2><p>From Xcode 10, we can just</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> CommonCrypto</span><br></pre></td></tr></table></figure>

<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><ul>
<li><a href="https://github.com/onmyway133/Arcane">https://github.com/onmyway133/Arcane</a></li>
<li><a href="https://stackoverflow.com/questions/25248598/importing-commoncrypto-in-a-swift-framework/37125785#37125785">https://stackoverflow.com/questions/25248598/importing-commoncrypto-in-a-swift-framework/37125785#37125785</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-29T13:01:10.000Z" title="2019-10-29T13:01:10.000Z">2019-10-29</time><span class="level-item">3 minutes read (About 511 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-ISO-8601-date-in-Swift/">How to make ISO 8601 date in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/479">#479</a></strong></p>
<p>From <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8601 spec</a>, the problems are the representation and time zone</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ISO 8601 &#x3D; year-month-day time timezone</span><br><span class="line">For date and time, there are basic (YYYYMMDD, hhmmss, ...) and extended format (YYYY-MM-DD, hh:mm:ss, ...)</span><br><span class="line">Time zone can be Zulu, offset or GMT</span><br><span class="line">Separator for date and time can be space, or T</span><br><span class="line">There are week format for date, but it is rarely used</span><br><span class="line">Timezone can be a lot of spaces after</span><br><span class="line">Second is optional</span><br></pre></td></tr></table></figure>

<p>Here are some valid strings</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2016-04-08T10:25:30Z</span><br><span class="line">2016-04-08 11:25:30+0100</span><br><span class="line">2016-04-08 202530GMT+1000</span><br><span class="line">20160408 08:25:30-02:00</span><br><span class="line">2016-04-08 11:25:30     +0100</span><br></pre></td></tr></table></figure>

<h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><p>Use <code>NSDateFormatter</code> and normalize the date string.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> stringToDateFormatter: <span class="type">DateFormatter</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> formatter = <span class="type">Foundation</span>.<span class="type">DateFormatter</span>()</span><br><span class="line">    formatter.locale = <span class="type">Locale</span>(identifier: <span class="string">"en_US_POSIX"</span>)</span><br><span class="line">    formatter.dateFormat = <span class="string">"yyyyMMdd HHmmssZ"</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> formatter</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">date</span><span class="params">(string: String)</span></span> -&gt; <span class="type">Date?</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> basicString = string</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> regex = <span class="keyword">try</span>? <span class="type">NSRegularExpression</span>(pattern: <span class="string">"[0-9]&#123;4&#125;-[0-9]&#123;2&#125;-[0-9]&#123;2&#125;"</span>, options: []),</span><br><span class="line">        <span class="keyword">let</span> result = regex.firstMatch(<span class="keyword">in</span>: string, options: .anchored, range: <span class="type">NSMakeRange</span>(<span class="number">0</span>, string.characters.<span class="built_in">count</span>)) &#123;</span><br><span class="line">        basicString = (basicString <span class="keyword">as</span> <span class="type">NSString</span>).replacingOccurrences(of: <span class="string">"-"</span>, with: <span class="string">""</span>, options: [], range: result.range)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    basicString = basicString</span><br><span class="line">        .replacingOccurrences(of: <span class="string">":"</span>, with: <span class="string">""</span>)</span><br><span class="line">        .replacingOccurrences(of: <span class="string">"GMT"</span>, with: <span class="string">""</span>)</span><br><span class="line">        .replacingOccurrences(of: <span class="string">"T"</span>, with: <span class="string">" "</span>)</span><br><span class="line">        .replacingOccurrences(of: <span class="string">","</span>, with: <span class="string">"."</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> stringToDateFormatter.date(from: basicString)</span><br><span class="line">        ?? stringToDateMillisecondsFormatter.date(from: basicString)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So here is the format that I’m using in my ISO8601</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> formatter = <span class="type">NSDateFormatter</span>()</span><br><span class="line">formatter.locale = <span class="type">NSLocale</span>(localeIdentifier: <span class="string">"en_US_POSIX"</span>)</span><br><span class="line">formatter.dateFormat = <span class="string">"yyyyMMdd HHmmssZ"</span></span><br></pre></td></tr></table></figure>

<h3 id="About-the-Z-identifier-Date-Field-Symbol-Table"><a href="#About-the-Z-identifier-Date-Field-Symbol-Table" class="headerlink" title="About the Z identifier Date Field Symbol Table"></a>About the Z identifier Date Field Symbol Table</h3><blockquote>
<p>Z: The ISO8601 basic format with hours, minutes and optional seconds fields. The format is equivalent to RFC 822 zone format (when optional seconds field is absent)</p>
</blockquote>
<h3 id="About-locale-Formatting-Data-Using-the-Locale-Settings"><a href="#About-locale-Formatting-Data-Using-the-Locale-Settings" class="headerlink" title="About locale Formatting Data Using the Locale Settings"></a>About locale Formatting Data Using the Locale Settings</h3><blockquote>
<p>Locales represent the formatting choices for a particular user, not the user’s preferred language. These are often the same but can be different. For example, a native English speaker who lives in Germany might select English as the language and Germany as the region</p>
</blockquote>
<h3 id="About-en-US-POSIX-Technical-Q-amp-A-QA1480-NSDateFormatter-and-Internet-Dates"><a href="#About-en-US-POSIX-Technical-Q-amp-A-QA1480-NSDateFormatter-and-Internet-Dates" class="headerlink" title="About en_US_POSIX Technical Q&amp;A QA1480 NSDateFormatter and Internet Dates"></a>About en_US_POSIX Technical Q&amp;A QA1480 NSDateFormatter and Internet Dates</h3><blockquote>
<p>On the other hand, if you’re working with fixed-format dates, you should first set the locale of the date formatter to something appropriate for your fixed format. In most cases the best locale to choose is “en_US_POSIX”, a locale that’s specifically designed to yield US English results regardless of both user and system preferences. </p>
</blockquote>
<blockquote>
<p>“en_US_POSIX” is also invariant in time (if the US, at some point in the future, changes the way it formats dates, “en_US” will change to reflect the new behaviour, but “en_US_POSIX” will not), and between machines (“en_US_POSIX” works the same on iOS as it does on OS X, and as it it does on other platforms).</p>
</blockquote>
<h2 id="NSISO8601DateFormatter-from-iOS-10"><a href="#NSISO8601DateFormatter-from-iOS-10" class="headerlink" title="NSISO8601DateFormatter from iOS 10"></a>NSISO8601DateFormatter from iOS 10</h2><p>From iOS 10, we can use <a href="https://developer.apple.com/documentation/foundation/nsiso8601dateformatter">NSISO8601DateFormatter</a></p>
<blockquote>
<p>The NSISO8601DateFormatter class generates and parses string representations of dates following the ISO 8601 standard. Use this class to create ISO 8601 representations of dates and create dates from text strings in ISO 8601 format.</p>
</blockquote>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><ul>
<li><a href="https://github.com/onmyway133/ISO8601">https://github.com/onmyway133/ISO8601</a></li>
<li><a href="https://stackoverflow.com/questions/16254575/how-do-i-get-an-iso-8601-date-on-ios/37082414#37082414">https://stackoverflow.com/questions/16254575/how-do-i-get-an-iso-8601-date-on-ios/37082414#37082414</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-29T12:57:33.000Z" title="2019-10-29T12:57:33.000Z">2019-10-29</time><span class="level-item">3 minutes read (About 522 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-configure-test-target-in-Xcode/">How to configure test target in Xcode</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/478">#478</a></strong></p>
<h4 id="This-applies-to"><a href="#This-applies-to" class="headerlink" title="This applies to"></a>This applies to</h4><ul>
<li>Main targets<ul>
<li>App</li>
<li>Framework</li>
</ul>
</li>
<li>Test targets<ul>
<li>Unit tests</li>
<li>UI tests</li>
</ul>
</li>
</ul>
<h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><p>Dependencies used</p>
<ul>
<li>Main target: <a href="http://github.com/hyperoslo/Sugar">Sugar</a></li>
<li>Test target: <a href="https://github.com/Quick/Nimble">Nimble</a>, <a href="https://github.com/Quick/Quick">Quick</a></li>
</ul>
<p>Examples</p>
<ul>
<li>Cocoapods</li>
<li>Carthage</li>
</ul>
<h4 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h4><ul>
<li>Make sure test target can link to all the frameworks it needs. This includes frameworks that Test targets use, and possibly frameworks that Main target uses !</li>
<li>Remember to “Clean Build Folder” and “Clear Derived Data” so that you’re sure it works. Sometimes Xcode caches.</li>
</ul>
<h3 id="Errors"><a href="#Errors" class="headerlink" title="Errors"></a>Errors</h3><p>Errors occur mostly due to linker error</p>
<ul>
<li>Test target X encountered an error (Early unexpected exit, operation never finished bootstrapping - no restart will be attempted</li>
<li>Framework not found</li>
</ul>
<h2 id="Cocoapods"><a href="#Cocoapods" class="headerlink" title="Cocoapods"></a>Cocoapods</h2><h4 id="1-Pod"><a href="#1-Pod" class="headerlink" title="1. Pod"></a>1. Pod</h4><p>Test targets need to include pods that Main target uses !</p>
<p>or we’ll get “Framework not found”</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">app_pods</span></span></span><br><span class="line">	pod <span class="string">'Sugar'</span>, <span class="string">'~&gt; 1.0'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_pods</span></span></span><br><span class="line">	pod <span class="string">'Nimble'</span>, <span class="string">'~&gt; 3.2'</span></span><br><span class="line">	pod <span class="string">'Quick'</span>, <span class="string">'~&gt; 0.9'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">target <span class="string">'TeaApp'</span> <span class="keyword">do</span></span><br><span class="line">	app_pods</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">target <span class="string">'TeaAppTests'</span> <span class="keyword">do</span></span><br><span class="line">	app_pods</span><br><span class="line">	test_pods</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">target <span class="string">'TeaAppUITests'</span> <span class="keyword">do</span></span><br><span class="line">	app_pods</span><br><span class="line">	test_pods</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Link-Binaries-with-Library"><a href="#2-Link-Binaries-with-Library" class="headerlink" title="2. Link Binaries with Library"></a>2. Link Binaries with Library</h4><p>Cocoapods builds a framework that contains all the frameworks the Test targets need, and configure it for us</p>
<p><img src="Screenshots/cocoapods_link_binaries.png" alt=""></p>
<h4 id="3-Runpath-Search-Paths"><a href="#3-Runpath-Search-Paths" class="headerlink" title="3. Runpath Search Paths"></a>3. Runpath Search Paths</h4><ul>
<li>Go to Test target Build Settings</li>
<li>Add <code>$(FRAMEWORK_SEARCH_PATHS)</code></li>
</ul>
<p><img src="Screenshots/cocoapods_runpath_search_paths.png" alt=""></p>
<h2 id="Carthage"><a href="#Carthage" class="headerlink" title="Carthage"></a>Carthage</h2><h4 id="1-Cartfile"><a href="#1-Cartfile" class="headerlink" title="1. Cartfile"></a>1. Cartfile</h4><p>We usually have</p>
<ul>
<li>Cartfile for Main target</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">github <span class="string">"hyperoslo/Sugar"</span> ~&gt; <span class="number">1.0</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Cartfile.private for Test target</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">github <span class="string">"Quick/Nimble"</span></span><br><span class="line">github <span class="string">"Quick/Quick"</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Link-Binaries-with-Libraries"><a href="#2-Link-Binaries-with-Libraries" class="headerlink" title="2. Link Binaries with Libraries"></a>2. Link Binaries with Libraries</h4><ul>
<li>Go to Test target build phase</li>
<li>Drag built frameworks from <code>Carthage/Build</code></li>
<li>In rare case, we need to drag frameworks that the Main target uses</li>
<li>In rare case, we need to drag the Main target framework</li>
</ul>
<p><img src="Screenshots/carthage_link_binaries.png" alt=""></p>
<h4 id="3-Framework-Search-Paths"><a href="#3-Framework-Search-Paths" class="headerlink" title="3. Framework Search Paths"></a>3. Framework Search Paths</h4><p>Configure correct path</p>
<ul>
<li>Go to Test target Built Settings</li>
<li>Configure Framework Search Paths</li>
</ul>
<p><img src="Screenshots/carthage_framework_search_paths.png" alt=""></p>
<h4 id="4-Runpath-Search-Paths"><a href="#4-Runpath-Search-Paths" class="headerlink" title="4. Runpath Search Paths"></a>4. Runpath Search Paths</h4><ul>
<li>Go to Test target Build Settings</li>
<li>Add <code>$(FRAMEWORK_SEARCH_PATHS)</code></li>
</ul>
<p><img src="Screenshots/cocoapods_runpath_search_paths.png" alt=""></p>
<h4 id="5-Copy-Files-maybe"><a href="#5-Copy-Files-maybe" class="headerlink" title="5. Copy Files (maybe)"></a>5. Copy Files (maybe)</h4><p>From <a href="https://github.com/Carthage/Carthage/blob/0.11/README.md#adding-frameworks-to-unit-tests-or-a-framework">Adding frameworks to unit tests or a framework</a></p>
<blockquote>
<p>In rare cases, you may want to also copy each dependency into the build product (e.g., to embed dependencies within the outer framework, or make sure dependencies are present in a test bundle). To do this, create a new “Copy Files” build phase with the “Frameworks” destination, then add the framework reference there as well.</p>
</blockquote>
<p><img src="Screenshots/carthage_copy_files.png" alt=""></p>
<h2 id="Runpath-Search-Paths-and-Install-name"><a href="#Runpath-Search-Paths-and-Install-name" class="headerlink" title="Runpath Search Paths and Install name"></a>Runpath Search Paths and Install name</h2><p>Question</p>
<ul>
<li>Why preconfigured run path “@executable_path/Frameworks” and “@loader_path/Frameworks” not work?</li>
<li>Why configuring runpath to “$(FRAMEWORK_SEARCH_PATHS)” works ?</li>
<li>Why framework has install name “@rpath/Sugar.framework/Sugar” ?</li>
</ul>
<p>Reference</p>
<ul>
<li><a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/RunpathDependentLibraries.html">Run-Path Dependent Libraries</a></li>
<li><a href="https://www.mikeash.com/pyblog/friday-qa-2009-11-06-linking-and-install-names.html">Linking and Install Names</a></li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><ul>
<li><a href="https://github.com/onmyway133/TestTarget">https://github.com/onmyway133/TestTarget</a></li>
<li><a href="https://stackoverflow.com/questions/34990175/test-target-x-encountered-an-error-early-unexpected-exit-operation-never-finis/36343395#36343395">https://stackoverflow.com/questions/34990175/test-target-x-encountered-an-error-early-unexpected-exit-operation-never-finis/36343395#36343395</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-29T11:23:07.000Z" title="2019-10-29T11:23:07.000Z">2019-10-29</time><span class="level-item">a few seconds read (About 88 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-check-platform-versions-in-Swift/">How to check platform versions in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/477">#477</a></strong></p>
<h2 id="Mark-APIs-availability"><a href="#Mark-APIs-availability" class="headerlink" title="Mark APIs availability"></a>Mark APIs availability</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@available</span>(iOS <span class="number">13.0</span>, <span class="type">OSX</span> <span class="number">10.15</span>, tvOS <span class="number">13.0</span>, watchOS <span class="number">6.0</span>, *)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">extension</span> <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Check-platform"><a href="#Check-platform" class="headerlink" title="Check platform"></a>Check platform</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> canImport(<span class="type">UIKit</span>)</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line">#elseif canImport(<span class="type">OSX</span>)</span><br><span class="line"><span class="keyword">import</span> AppKit</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>

<p>In watchOS app, it still can import <code>UIKit</code>, so for only iOS usage, we need to use <code>os</code> check</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> canImport(<span class="type">UIKit</span>) &amp;&amp; os(iOS)</span><br></pre></td></tr></table></figure>

<h2 id="Check-environment"><a href="#Check-environment" class="headerlink" title="Check environment"></a>Check environment</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> targetEnvironment(macCatalyst)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"UIKit running on macOS"</span>)</span><br><span class="line">#<span class="keyword">else</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Your regular code"</span>)</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> targetEnvironment(simulator)</span><br><span class="line">  <span class="comment">// your simulator code</span></span><br><span class="line">#<span class="keyword">else</span></span><br><span class="line">  <span class="comment">// your real device code</span></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/9/">Previous</a></div><div class="pagination-next"><a href="/page/11/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/9/">9</a></li><li><a class="pagination-link is-current" href="/page/10/">10</a></li><li><a class="pagination-link" href="/page/11/">11</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/25/">25</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">727</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">54</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://wwdctogether.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">WWDC Together</span></span><span class="level-right"><span class="level-item tag">wwdctogether.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-24T08:12:22.000Z">2021-02-24</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-tune-performance-with-ButtonBehavior-in-SwiftUI/">How to tune performance with ButtonBehavior in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-23T20:27:59.000Z">2021-02-23</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-GroupBox-in-SwiftUI/">How to use GroupBox in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-18T09:11:04.000Z">2021-02-18</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-suppress-selector-warning-in-Swift/">How to suppress selector warning in Swift</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-17T19:25:20.000Z">2021-02-17</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-simple-search-bar-in-SwiftUI/">How to make simple search bar in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-17T18:30:50.000Z">2021-02-17</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-fix-share-and-action-extension-not-showing-up-in-iOS-14/">How to fix share and action extension not showing up in iOS 14</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">31</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featured/"><span class="tag">featured</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">173</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">51</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">136</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">24</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">359</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">99</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tweet/"><span class="tag">tweet</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2021 Khoa Pham</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>