<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>onmyway133</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta name="description" content="What you don&apos;t know is what you haven&apos;t learned">
<meta name="keywords" content="ios, android,javascript, react">
<meta property="og:type" content="website">
<meta property="og:title" content="onmyway133">
<meta property="og:url" content="https://onmyway133.github.io/page/6/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="What you don&apos;t know is what you haven&apos;t learned">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onmyway133">
<meta name="twitter:description" content="What you don&apos;t know is what you haven&apos;t learned">
  
    <link rel="alternate" href="/atom.xml" title="onmyway133" type="application/atom+xml">
  
  <link rel="icon" href="/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/about/"] = "About"; 

  themeMenus["/writing/"] = "writing"; 

  themeMenus["/archives"] = "Archives"; 

  themeMenus["/speaking/"] = "speaking"; 

  themeMenus["/opensource/"] = "open source"; 

  themeMenus["/projects/"] = "projects"; 

  themeMenus["/news/"] = "news"; 

  themeMenus["/gumroad/"] = "gumroad"; 

  themeMenus["/atom.xml"] = "rss"; 

</script>


  <body>


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="onmyway133" rel="home"> onmyway133 </a>
            
          </h1>

          
            <div class="site-description">What you don&#39;t know is what you haven&#39;t learned</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about/">About</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/writing/">writing</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/speaking/">speaking</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/opensource/">open source</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/projects/">projects</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/news/">news</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/gumroad/">gumroad</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/atom.xml">rss</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "https://avatars1.githubusercontent.com/u/2284279?s=460&v=4".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-How-to-use-coroutine-LiveData-in-Android"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-coroutine-LiveData-in-Android/">How to use coroutine LiveData in Android</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-coroutine-LiveData-in-Android/" class="article-date">
	  <time datetime="2019-08-15T18:48:58.000Z" itemprop="datePublished">August 15, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/358" target="_blank" rel="noopener">#358</a></strong></p>
<p><code>app/build.gradle</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">"androidx.lifecycle:lifecycle-livedata-ktx:2.2.0-alpha01"</span></span><br></pre></td></tr></table></figure>

<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.liveData</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.Dispatchers</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> repository: TodoRepository = TodoRepository()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> firstTodo = liveData(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">val</span> retrivedTodo = repository.getTodo(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        emit(retrivedTodo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Use-coroutines-with-LiveData"><a href="#Use-coroutines-with-LiveData" class="headerlink" title="Use coroutines with LiveData"></a>Use coroutines with LiveData</h2><p><a href="https://developer.android.com/topic/libraries/architecture/coroutines" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/coroutines</a></p>
<blockquote>
<p>The liveData building block serves as a structured concurrency primitive between coroutines and LiveData. The code block starts executing when LiveData becomes active and is automatically canceled after a configurable timeout when the LiveData becomes inactive.</p>
</blockquote>
<h2 id="Source-code"><a href="#Source-code" class="headerlink" title="Source code"></a>Source code</h2><p><a href="https://android.googlesource.com/platform/frameworks/support/+/androidx-master-dev/lifecycle/lifecycle-livedata-ktx/src/main/java/androidx/lifecycle/CoroutineLiveData.kt" target="_blank" rel="noopener">https://android.googlesource.com/platform/frameworks/support/+/androidx-master-dev/lifecycle/lifecycle-livedata-ktx/src/main/java/androidx/lifecycle/CoroutineLiveData.kt</a><br><a href="https://android.googlesource.com/platform/frameworks/support/+/androidx-master-dev/lifecycle/lifecycle-livedata-ktx/src/main/java/androidx/lifecycle/FlowLiveData.kt" target="_blank" rel="noopener">https://android.googlesource.com/platform/frameworks/support/+/androidx-master-dev/lifecycle/lifecycle-livedata-ktx/src/main/java/androidx/lifecycle/FlowLiveData.kt</a></p>
<p><code>CoroutineLiveData.kt</code></p>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@UseExperimental(ExperimentalTypeInference::class)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">liveData</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    context: <span class="type">CoroutineContext</span> = EmptyCoroutineContext,</span></span></span><br><span class="line"><span class="function"><span class="params">    timeoutInMs: <span class="type">Long</span> = DEFAULT_TIMEOUT,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="meta">@BuilderInference</span> block: <span class="type">suspend</span> <span class="type">LiveDataScope</span>&lt;<span class="type">T</span>&gt;.() -&gt; <span class="type">Unit</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>: LiveData&lt;T&gt; = CoroutineLiveData(context, timeoutInMs, block)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>a LiveData that tries to load the <code>User</code> from local cache first and then tries from the server and also yields the updated value</p>
</blockquote>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> user = liveData &#123;</span><br><span class="line"> 	<span class="comment">// dispatch loading first</span></span><br><span class="line"> 	emit(LOADING(id))</span><br><span class="line"> 	<span class="comment">// check local storage</span></span><br><span class="line"> 	<span class="keyword">val</span> cached = cache.loadUser(id)</span><br><span class="line"></span><br><span class="line"> 	<span class="keyword">if</span> (cached != <span class="literal">null</span>) &#123;</span><br><span class="line">    	emit(cached)</span><br><span class="line"> 	&#125;</span><br><span class="line"></span><br><span class="line"> 	<span class="keyword">if</span> (cached == <span class="literal">null</span> || cached.isStale()) &#123;</span><br><span class="line">    	<span class="keyword">val</span> fresh = api.fetch(id) <span class="comment">// errors are ignored for brevity</span></span><br><span class="line">     	cache.save(fresh)</span><br><span class="line">     	emit(fresh)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://proandroiddev.com/suspend-what-youre-doing-retrofit-has-now-coroutines-support-c65bd09ba067" target="_blank" rel="noopener">Suspend what you’re doing: Retrofit has now Coroutines support!</a></li>
<li><a href="https://medium.com/corouteam/exploring-kotlin-coroutines-and-lifecycle-architectural-components-integration-on-android-c63bb8a9156f" target="_blank" rel="noopener">Exploring new Coroutines and Lifecycle Architectural Components integration on Android</a></li>
<li><a href="https://android.jlelse.eu/coroutine-in-android-working-with-lifecycle-fc9c1a31e5f3" target="_blank" rel="noopener">Coroutine in Android: Working with Lifecycle</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-declare-generic-RecyclerView-adapter-in-Android"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-declare-generic-RecyclerView-adapter-in-Android/">How to declare generic RecyclerView adapter in Android</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-declare-generic-RecyclerView-adapter-in-Android/" class="article-date">
	  <time datetime="2019-08-14T18:53:28.000Z" itemprop="datePublished">August 14, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/357" target="_blank" rel="noopener">#357</a></strong></p>
<p><code>generic/Adapter.kt</code></p>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.onmyway133.generic</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.RecyclerView</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Adapter</span>&lt;<span class="type">T</span>&gt;</span>(<span class="keyword">var</span> items: ArrayList&lt;T&gt;): RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() &#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">configure</span><span class="params">(item: <span class="type">T</span>, holder: <span class="type">ViewHolder</span>)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">update</span><span class="params">(items: <span class="type">ArrayList</span>&lt;<span class="type">T</span>&gt;)</span></span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.items = items</span><br><span class="line">        notifyDataSetChanged()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span>: <span class="built_in">Int</span> = items.count()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: RecyclerView.ViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater</span><br><span class="line">            .from(parent.context)</span><br><span class="line">            .inflate(viewType, parent, <span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">return</span> ViewHolder(view)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">RecyclerView</span>.<span class="type">ViewHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        configure(items[position], holder <span class="keyword">as</span> ViewHolder)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>(view: View): RecyclerView.ViewHolder(view) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>hero/HeroAdapter.kt</code></p>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.onmyway133.hero</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.hero_item_view.view.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adapter</span></span>(items: ArrayList&lt;Hero&gt;): com.onmyway133.generic.Adapter&lt;Hero&gt;(items) &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">configure</span><span class="params">(item: <span class="type">Hero</span>, holder: <span class="type">ViewHolder</span>)</span></span> &#123;</span><br><span class="line">        holder.itemView.titleLabel.text = item.name</span><br><span class="line">        holder.itemView.descriptionLabel.text = item.description</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemViewType</span><span class="params">(position: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> R.layout.hero_item_view</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>May run into <a href="https://stackoverflow.com/questions/49512629/default-interface-methods-are-only-supported-starting-with-android-n" target="_blank" rel="noopener">https://stackoverflow.com/questions/49512629/default-interface-methods-are-only-supported-starting-with-android-n</a></p>
<p><code>app/build.gradle</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-Payment-Intent-and-Setup-Intents-with-Stripe-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-Payment-Intent-and-Setup-Intents-with-Stripe-in-iOS/">How to use Payment Intent and Setup Intents with Stripe in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-Payment-Intent-and-Setup-Intents-with-Stripe-in-iOS/" class="article-date">
	  <time datetime="2019-08-14T09:05:23.000Z" itemprop="datePublished">August 14, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/356" target="_blank" rel="noopener">#356</a></strong></p>
<p><code>StripeHandler.swift</code></p>
<p>From Stripe 16.0.0 <a href="https://github.com/stripe/stripe-ios/blob/master/CHANGELOG.md#1600-2019-07-18" target="_blank" rel="noopener">https://github.com/stripe/stripe-ios/blob/master/CHANGELOG.md#1600-2019-07-18</a></p>
<blockquote>
<p>Migrates STPPaymentCardTextField.cardParams property type from STPCardParams to STPPaymentMethodCardParams</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StripeHandler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">createPaymentMethod</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        textField: STPPaymentCardTextField,</span></span></span><br><span class="line"><span class="function"><span class="params">        completion: @escaping <span class="params">(Result&lt;STPPaymentMethod, Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> paymentMethodParams = <span class="type">STPPaymentMethodParams</span>(</span><br><span class="line">            card: textField.cardParams,</span><br><span class="line">            billingDetails: <span class="literal">nil</span>,</span><br><span class="line">            metadata: <span class="literal">nil</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="type">STPAPIClient</span>.shared().createPaymentMethod(</span><br><span class="line">            with: paymentMethodParams,</span><br><span class="line">            completion: &#123; paymentMethod, error <span class="keyword">in</span></span><br><span class="line">                <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> paymentMethod = paymentMethod &#123;</span><br><span class="line">                        completion(.success(paymentMethod))</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        completion(.failure(error ?? <span class="type">AppError</span>.request))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="type">STPAPIClient</span>.shared().createPaymentMethod(</span><br><span class="line">            with: paymentMethodParams,</span><br><span class="line">            completion: &#123; paymentMethod, error <span class="keyword">in</span></span><br><span class="line">                <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> paymentMethod = paymentMethod &#123;</span><br><span class="line">                        completion(.success(paymentMethod))</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        completion(.failure(error ?? <span class="type">AppError</span>.request))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">confirmSetupIntents</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        clientSecret: String,</span></span></span><br><span class="line"><span class="function"><span class="params">        paymentMethodId: String,</span></span></span><br><span class="line"><span class="function"><span class="params">        context: STPAuthenticationContext?,</span></span></span><br><span class="line"><span class="function"><span class="params">        completion: @escaping <span class="params">(Result&lt;STPSetupIntent, Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> context = context <span class="keyword">else</span> &#123;</span><br><span class="line">            completion(.failure(<span class="type">AppError</span>.invalid))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> setupIntentParams = <span class="type">STPSetupIntentConfirmParams</span>(clientSecret: clientSecret)</span><br><span class="line">        setupIntentParams.paymentMethodID = paymentMethodId</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> paymentHandler = <span class="type">STPPaymentHandler</span>.shared()</span><br><span class="line">        paymentHandler.confirmSetupIntent(</span><br><span class="line">            setupIntentParams,</span><br><span class="line">            with: context,</span><br><span class="line">            completion: &#123; status, intent, error <span class="keyword">in</span></span><br><span class="line">                <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">case</span> .succeeded = status, <span class="keyword">let</span> intent = intent &#123;</span><br><span class="line">                        completion(.success(intent))</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        completion(.failure(error ?? <span class="type">AppError</span>.invalid))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">func</span> <span class="title">confirmPaymentIntents</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        clientSecret: String,</span></span></span><br><span class="line"><span class="function"><span class="params">        context: STPAuthenticationContext?,</span></span></span><br><span class="line"><span class="function"><span class="params">        completion: @escaping <span class="params">(Result&lt;STPPaymentIntent, Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> context = context <span class="keyword">else</span> &#123;</span><br><span class="line">            completion(.failure(<span class="type">AppError</span>.invalid))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">STPPaymentHandler</span>.shared().handleNextAction(</span><br><span class="line">            forPayment: clientSecret,</span><br><span class="line">            with: context,</span><br><span class="line">            returnURL: <span class="literal">nil</span>,</span><br><span class="line">            completion: &#123; status, paymentIntent, error <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">case</span> .succeeded = status, <span class="keyword">let</span> paymentIntent = paymentIntent &#123;</span><br><span class="line">                    completion(.success(paymentIntent))</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    completion(.failure(error ?? <span class="type">AppError</span>.invalid))</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toCard</span><span class="params">(paymentMethod: STPPaymentMethod)</span></span> -&gt; <span class="type">MyCard?</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> card = paymentMethod.card,</span><br><span class="line">            <span class="keyword">let</span> last4 = card.last4</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> withValue(<span class="type">MyCard</span>()) &#123;</span><br><span class="line">            $<span class="number">0</span>.expiryYear = <span class="type">UInt32</span>(card.expYear)</span><br><span class="line">            $<span class="number">0</span>.expiryMonth = <span class="type">UInt32</span>(card.expMonth)</span><br><span class="line">            $<span class="number">0</span>.lastFourDigits = last4</span><br><span class="line">            $<span class="number">0</span>.brand = <span class="type">STPCard</span>.string(from: card.brand)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Payment-intents"><a href="#Payment-intents" class="headerlink" title="Payment intents"></a>Payment intents</h2><p><a href="https://stripe.com/docs/payments/payment-intents/creating-payment-intents" target="_blank" rel="noopener">https://stripe.com/docs/payments/payment-intents/creating-payment-intents</a></p>
<blockquote>
<p>When using automatic confirmation, create the PaymentIntent at the beginning of the checkout process. When using manual confirmation, create the PaymentIntent after collecting payment information from the customer using Elements or our iOS and Android SDKs. For a detailed comparison on the automatic and manual confirmation flows, see accepting one-time payments.</p>
</blockquote>
<h4 id="Step-3-Authenticate-the-payment-if-necessary"><a href="#Step-3-Authenticate-the-payment-if-necessary" class="headerlink" title="Step 3: Authenticate the payment if necessary"></a>Step 3: Authenticate the payment if necessary</h4><blockquote>
<p>Pass the confirmed Payment Intent client secret from the previous step to STPPaymentHandler handleNextActionForPayment. If the customer must perform 3D Secure authentication to complete the payment, STPPaymentHandler presents view controllers using the STPAuthenticationContext passed in and walks them through that process. See Supporting 3D Secure Authentication on iOS to learn more.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MyAPIClient</span>.createAndConfirmPaymentIntent(paymentMethodId: paymentMethodId) &#123; result <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">case</span> .success(<span class="keyword">let</span> paymentIntentClientSecret) = result <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">STPPaymentHandler</span>.shared().handleNextAction(forPayment: paymentIntentClientSecret, with: <span class="keyword">self</span>, returnURL: <span class="literal">nil</span>) &#123; (status, paymentIntent, error) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">      <span class="keyword">case</span> .succeeded:</span><br><span class="line">        <span class="comment">// ...Continued in Step 4</span></span><br><span class="line">      <span class="keyword">case</span> .canceled:</span><br><span class="line">        <span class="comment">// Handle cancel</span></span><br><span class="line">      <span class="keyword">case</span> .failed:</span><br><span class="line">        <span class="comment">// Handle error</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Setup-intents"><a href="#Setup-intents" class="headerlink" title="Setup intents"></a>Setup intents</h2><p>There is Setup intents <a href="https://stripe.com/docs/payments/cards/reusing-cards#saving-cards-without-payment" target="_blank" rel="noopener">https://stripe.com/docs/payments/cards/reusing-cards#saving-cards-without-payment</a> for saving cards</p>
<blockquote>
<p>Use the Setup Intents API to authenticate a customer’s card without making an initial payment. This flow works best for businesses that want to onboard customers without charging them right away:</p>
</blockquote>
<h4 id="Step-4-Submit-the-card-details-to-Stripe-from-the-client"><a href="#Step-4-Submit-the-card-details-to-Stripe-from-the-client" class="headerlink" title="Step 4: Submit the card details to Stripe from the client"></a>Step 4: Submit the card details to Stripe from the client</h4><blockquote>
<p>Pass the STPSetupIntentParams object to the confirmSetupIntent method on a STPPaymentHandler sharedManager. If the customer must perform additional steps to complete the payment, such as authentication, STPPaymentHandler presents view controllers using the STPAuthenticationContext passed in and walks them through that process. See Supporting 3D Secure Authentication on iOS to learn more.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> setupIntentParams = <span class="type">STPSetupIntentParams</span>(clientSecret: clientSecret)</span><br><span class="line">setupIntentParams.paymentMethodId = paymentMethodId</span><br><span class="line"><span class="keyword">let</span> paymentManager = <span class="type">STPPaymentHandler</span>.shared()</span><br><span class="line">paymentManager.confirmSetupIntent(setupIntentParams, authenticationContext: <span class="keyword">self</span>, completion &#123; (status, setupIntent, error) <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">    <span class="keyword">case</span> .succeeded:</span><br><span class="line">      <span class="comment">// Setup succeeded</span></span><br><span class="line">    <span class="keyword">case</span> .canceled:</span><br><span class="line">      <span class="comment">// Handle cancel</span></span><br><span class="line">    <span class="keyword">case</span> .failed:</span><br><span class="line">      <span class="comment">// Handle error</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Authentication-context"><a href="#Authentication-context" class="headerlink" title="Authentication context"></a>Authentication context</h2><p>In <code>STPPaymentHandler.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)_canPresentWithAuthenticationContext:(<span class="keyword">id</span>&lt;STPAuthenticationContext&gt;)authenticationContext &#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *presentingViewController = authenticationContext.authenticationPresentingViewController;</span><br><span class="line">    <span class="comment">// Is presentingViewController non-nil and in the window?</span></span><br><span class="line">    <span class="keyword">if</span> (presentingViewController == <span class="literal">nil</span> || presentingViewController.view.window == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Is it the Apple Pay VC?</span></span><br><span class="line">    <span class="keyword">if</span> ([presentingViewController isKindOfClass:[PKPaymentAuthorizationViewController <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        <span class="comment">// We can't present over Apple Pay, user must implement prepareAuthenticationContextForPresentation: to dismiss it.</span></span><br><span class="line">        <span class="keyword">return</span> [authenticationContext respondsToSelector:<span class="keyword">@selector</span>(prepareAuthenticationContextForPresentation:)];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Is it already presenting something?</span></span><br><span class="line">    <span class="keyword">if</span> (presentingViewController.presentedViewController == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Hopefully the user implemented prepareAuthenticationContextForPresentation: to dismiss it.</span></span><br><span class="line">        <span class="keyword">return</span> [authenticationContext respondsToSelector:<span class="keyword">@selector</span>(prepareAuthenticationContextForPresentation:)];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Use-stripe-SDK"><a href="#Use-stripe-SDK" class="headerlink" title="Use stripe SDK"></a>Use stripe SDK</h2><p><code>STPSetupIntentConfirmParams.useStripeSDK</code></p>
<blockquote>
<p> A boolean number to indicate whether you intend to use the Stripe SDK’s functionality to handle any SetupIntent next actions.<br>If set to false, STPSetupIntent.nextAction will only ever contain a redirect url that can be opened in a webview or mobile browser.<br>When set to true, the nextAction may contain information that the Stripe SDK can use to perform native authentication within your app.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> setupIntentParams = <span class="type">STPSetupIntentConfirmParams</span>(clientSecret: clientSecret)</span><br><span class="line">setupIntentParams.useStripeSDK = <span class="type">NSNumber</span>(booleanLiteral: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://stripe.com/docs/payments/payment-intents/ios#create-and-confirm-payment-intent-manual" target="_blank" rel="noopener">Using Payment Intents on iOS</a></li>
<li><a href="https://stripe.com/docs/payments/payment-intents" target="_blank" rel="noopener">One-time Payments with the Payment Intents API</a></li>
<li><a href="https://stripe.com/docs/mobile/ios/authentication#return-url" target="_blank" rel="noopener">Supporting 3D Secure Authentication on iOS</a></li>
<li><a href="https://stripe.dev/stripe-ios/docs/Classes/STPSetupIntentConfirmParams.html" target="_blank" rel="noopener">STPSetupIntentConfirmParams</a></li>
<li><a href="https://stripe.com/docs/testing" target="_blank" rel="noopener">Testing</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-format-currency-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-format-currency-in-Swift/">How to format currency in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-format-currency-in-Swift/" class="article-date">
	  <time datetime="2019-08-13T11:09:29.000Z" itemprop="datePublished">August 13, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/355" target="_blank" rel="noopener">#355</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CurrencyFormatter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">format</span><span class="params">(amount: UInt64, decimalCount: Int)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter = <span class="type">NumberFormatter</span>()</span><br><span class="line">        formatter.minimumFractionDigits = <span class="number">0</span></span><br><span class="line">        formatter.maximumFractionDigits = decimalCount</span><br><span class="line">        formatter.numberStyle = .decimal</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> value = <span class="type">Double</span>(amount) / pow(<span class="type">Double</span>(<span class="number">10</span>), <span class="type">Double</span>(decimalCount))</span><br><span class="line">        <span class="keyword">let</span> fallback = <span class="type">String</span>(format: <span class="string">"%.0f"</span>, value)</span><br><span class="line">        <span class="keyword">return</span> formatter.string(from: <span class="type">NSNumber</span>(value: value)) ?? fallback</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CurrencyFormatterTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testFormat</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter = <span class="type">CurrencyFormatter</span>()</span><br><span class="line">        <span class="comment">// 120 USD</span></span><br><span class="line">        <span class="type">XCTAssertEqual</span>(formatter.format(amount: <span class="number">120</span>, decimalCount: <span class="number">0</span>), <span class="string">"120"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 12000 cents</span></span><br><span class="line">        <span class="type">XCTAssertEqual</span>(formatter.format(amount: <span class="number">12000</span>, decimalCount: <span class="number">2</span>), <span class="string">"120"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 12520 cents</span></span><br><span class="line">        <span class="type">XCTAssertEqual</span>(formatter.format(amount: <span class="number">12520</span>, decimalCount: <span class="number">2</span>), <span class="string">"125.2"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-simplify-struct-mutating-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-simplify-struct-mutating-in-Swift/">How to simplify struct mutating in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-simplify-struct-mutating-in-Swift/" class="article-date">
	  <time datetime="2019-08-13T09:55:52.000Z" itemprop="datePublished">August 13, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/354" target="_blank" rel="noopener">#354</a></strong></p>
<p>In <a href="https://github.com/onmyway133/Construction/blob/master/Sources/Construction.swift#L37" target="_blank" rel="noopener">Construction</a>, we have a <code>build</code> method to apply closure to <code>inout</code> struct.</p>
<p>We can explicitly define that with <code>withValue</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withValue</span>&lt;T&gt;<span class="params">(<span class="number">_</span> value: T, closure: <span class="params">(<span class="keyword">inout</span> T)</span></span></span> -&gt; <span class="type">Void</span>) -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> mutableValue = value</span><br><span class="line">    closure(&amp;mutableValue)</span><br><span class="line">    <span class="keyword">return</span> mutableValue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So we can modify Protobuf structs easily</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">user.book = withValue(<span class="type">Book</span>()) &#123;</span><br><span class="line">    $<span class="number">0</span>.price = <span class="number">300</span></span><br><span class="line">    $<span class="number">0</span>.author = withValue(<span class="type">Author</span>()) &#123;</span><br><span class="line">        $<span class="number">0</span>.name = <span class="string">"Thor"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-not-resign-first-responder-for-UITextField-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-not-resign-first-responder-for-UITextField-in-iOS/">How to not resign first responder for UITextField in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-not-resign-first-responder-for-UITextField-in-iOS/" class="article-date">
	  <time datetime="2019-08-13T06:37:55.000Z" itemprop="datePublished">August 13, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/353" target="_blank" rel="noopener">#353</a></strong></p>
<p>When using <code>STPPaymentCardTextField</code> from <a href="https://github.com/stripe/stripe-ios" target="_blank" rel="noopener">stripe-ios</a>, the default behavior is when we touch outside to dismiss keyboard, it checks and focus on number text field is it is invalid</p>
<p><code>STPPaymentCardTextField.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (STPFormTextField *)currentFirstResponderField &#123;</span><br><span class="line">    <span class="keyword">for</span> (STPFormTextField *textField <span class="keyword">in</span> [<span class="keyword">self</span> allFields]) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([textField isFirstResponder]) &#123;</span><br><span class="line">            <span class="keyword">return</span> textField;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)canResignFirstResponder &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>.currentFirstResponderField canResignFirstResponder];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)resignFirstResponder &#123;</span><br><span class="line">    [<span class="keyword">super</span> resignFirstResponder];</span><br><span class="line">    <span class="built_in">BOOL</span> success = [<span class="keyword">self</span>.currentFirstResponderField resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span> layoutViewsToFocusField:<span class="literal">nil</span></span><br><span class="line">                         animated:<span class="literal">YES</span></span><br><span class="line">                       completion:<span class="literal">nil</span>];</span><br><span class="line">    [<span class="keyword">self</span> updateImageForFieldType:STPCardFieldTypeNumber];</span><br><span class="line">    <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then it calls <code>[self.numberField becomeFirstResponder];</code> is validation on number fails</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (^STPLayoutAnimationCompletionBlock)(<span class="built_in">BOOL</span> completed);</span><br><span class="line">- (<span class="keyword">void</span>)layoutViewsToFocusField:(<span class="built_in">NSNumber</span> *)focusedField</span><br><span class="line">                       animated:(<span class="built_in">BOOL</span>)animated</span><br><span class="line">                     completion:(STPLayoutAnimationCompletionBlock)completion &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSNumber</span> *fieldtoFocus = focusedField;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fieldtoFocus == <span class="literal">nil</span></span><br><span class="line">        &amp;&amp; ![<span class="keyword">self</span>.focusedTextFieldForLayout isEqualToNumber:@(STPCardFieldTypeNumber)]</span><br><span class="line">        &amp;&amp; ([<span class="keyword">self</span>.viewModel validationStateForField:STPCardFieldTypeNumber] != STPCardValidationStateValid)) &#123;</span><br><span class="line">        fieldtoFocus = @(STPCardFieldTypeNumber);</span><br><span class="line">        [<span class="keyword">self</span>.numberField becomeFirstResponder];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="isUserInteractionEnabled"><a href="#isUserInteractionEnabled" class="headerlink" title="isUserInteractionEnabled"></a>isUserInteractionEnabled</h3><p>Be aware to use <code>isUserInteractionEnabled</code> on <code>STPPaymentCardTextField</code> as that can resign first responder when set to <code>true</code> and become first responder when set to <code>false</code></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-React-JSX-with-Babel-in-Electron"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-React-JSX-with-Babel-in-Electron/">How to use React JSX with Babel in Electron</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-React-JSX-with-Babel-in-Electron/" class="article-date">
	  <time datetime="2019-08-12T04:44:36.000Z" itemprop="datePublished">August 12, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/352" target="_blank" rel="noopener">#352</a></strong></p>
<p>For a normal electron app created with <code>npm init</code>, we can use all features of ES6, but not the JSX syntax for React. We can use just Babel to transpile JSX, as used in <a href="https://github.com/onmyway133/IconGenerator/blob/master/.babelrc" target="_blank" rel="noopener">IconGenerator</a></p>
<p><code>.babelrc</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"transform-react-jsx-source"</span>    </span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"react"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And in <code>package.json</code>, call babel to transpile <code>src</code> to <code>dist</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"main"</span>: <span class="string">"dist/main.js"</span>,</span><br><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"npm run babel &amp;&amp; electron ."</span>,</span><br><span class="line">    <span class="string">"babel"</span>: <span class="string">"babel ./src --out-dir ./dist --copy-files"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>Remember to use <code>dist/main.js</code> as our starting point, and in <a href="https://github.com/onmyway133/IconGenerator/blob/master/index.html" target="_blank" rel="noopener">index.html</a>, specify <code>./dist/renderer.js</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">require</span>(<span class="string">'./dist/renderer.js'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/electron/">electron</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/">react</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-define-version-property-in-gradle"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-define-version-property-in-gradle/">How to define version property in gradle</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-define-version-property-in-gradle/" class="article-date">
	  <time datetime="2019-08-10T18:49:00.000Z" itemprop="datePublished">August 10, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/351" target="_blank" rel="noopener">#351</a></strong></p>
<p>From <a href="https://developer.android.com/studio/build/gradle-tips" target="_blank" rel="noopener">Gradle tips and recipes</a>, Configure project-wide properties</p>
<blockquote>
<p>For projects that include multiple modules, it might be useful to define properties at the project level and share them across all modules. You can do this by adding extra properties to the ext block in the top-level build.gradle file.</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ext &#123;</span><br><span class="line">    navigationVersion = <span class="string">"2.0.0"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rootProject.ext.navigationVersion</span><br></pre></td></tr></table></figure>

<p>Versions are used mostly in <code>dependencies</code> block so having them defined in global <code>ext</code> is not quite right.  We can use <code>def</code> to define variables</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> navigationVersion = <span class="string">"2.0.0"</span></span><br><span class="line">    implementation <span class="string">"androidx.navigation:navigation-fragment-ktx:$navigationVersion"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For better namespacing, we can use a class</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Version</span> &#123;</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">def</span> navigation = <span class="string">"2.0.0"</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">def</span> drawerLayout = <span class="string">"1.0.0"</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">def</span> koin = <span class="string">"2.0.1"</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">def</span> moshi = <span class="string">"1.8.0"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation <span class="string">"androidx.navigation:navigation-fragment-ktx:$Version.navigation"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-Firebase-PhoneAuth-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-Firebase-PhoneAuth-in-iOS/">How to use Firebase PhoneAuth in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-Firebase-PhoneAuth-in-iOS/" class="article-date">
	  <time datetime="2019-08-07T11:57:14.000Z" itemprop="datePublished">August 7, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/350" target="_blank" rel="noopener">#350</a></strong></p>
<p>Read <a href="https://firebase.google.com/docs/auth/ios/phone-auth" target="_blank" rel="noopener">Authenticate with Firebase on iOS using a Phone Number</a></p>
<h3 id="Disable-swizzling"><a href="#Disable-swizzling" class="headerlink" title="Disable swizzling"></a>Disable swizzling</h3><p><code>Info.plist</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>FirebaseAppDelegateProxyEnabled<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>NO<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Enable-remote-notification"><a href="#Enable-remote-notification" class="headerlink" title="Enable remote notification"></a>Enable remote notification</h3><p>Enable Capability -&gt; Background mode -&gt; Remote notification</p>
<p><code>AppDelegate.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Firebase</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> FirebaseAuth</span><br><span class="line"></span><br><span class="line"><span class="meta">@UIApplicationMain</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">UIResponder</span>, <span class="title">UIApplicationDelegate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> appFlowController = <span class="type">AppFlowController</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(<span class="number">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: <span class="keyword">Any</span>]?)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">UIApplication</span>.shared.registerForRemoteNotifications()</span><br><span class="line">		<span class="type">FirebaseApp</span>.configure()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MARK: - Remote Notification</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(<span class="number">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class="line">        <span class="type">Auth</span>.auth().setAPNSToken(deviceToken, type: .unknown)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(<span class="number">_</span> application: UIApplication, didFailToRegisterForRemoteNotificationsWithError error: Error)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(error)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> application: UIApplication,</span></span></span><br><span class="line"><span class="function"><span class="params">        didReceiveRemoteNotification userInfo: [AnyHashable: <span class="keyword">Any</span>],</span></span></span><br><span class="line"><span class="function"><span class="params">        fetchCompletionHandler completionHandler: @escaping <span class="params">(UIBackgroundFetchResult)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        completionHandler(.noData)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(<span class="number">_</span> app: UIApplication, <span class="keyword">open</span> url: URL, options: [UIApplication.OpenURLOptionsKey: <span class="keyword">Any</span>] = [:])</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">Auth</span>.auth().canHandle(url) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Firebase push message looks like</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">▿ 1 element</span><br><span class="line">  ▿ 0 : 2 elements</span><br><span class="line">    ▿ key : AnyHashable(&quot;com.google.firebase.auth&quot;)</span><br><span class="line">      - value : &quot;com.google.firebase.auth&quot;</span><br><span class="line">    ▿ value : 1 element</span><br><span class="line">      ▿ 0 : 2 elements</span><br><span class="line">        - key : warning</span><br><span class="line">        - value : This fake notification should be forwarded to Firebase Auth.</span><br></pre></td></tr></table></figure>

<h2 id="Captcha"><a href="#Captcha" class="headerlink" title="Captcha"></a>Captcha</h2><p>To disable captcha during testing</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Auth</span>.auth().settings?.isAppVerificationDisabledForTesting = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-Navigation-component-with-DrawerLayout-in-Android"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-Navigation-component-with-DrawerLayout-in-Android/">How to use Navigation component with DrawerLayout in Android</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-Navigation-component-with-DrawerLayout-in-Android/" class="article-date">
	  <time datetime="2019-08-07T07:36:15.000Z" itemprop="datePublished">August 7, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/349" target="_blank" rel="noopener">#349</a></strong></p>
<p><img src="https://user-images.githubusercontent.com/2284279/62612124-24833900-b907-11e9-9a7d-57fbcffa72aa.png" alt="Screenshot_1565169686"></p>
<p><code>build.gradle</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    classpath <span class="string">'android.arch.navigation:navigation-safe-args-gradle-plugin:1.0.0-alpha05'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>app/build.gradle</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'androidx.navigation.safeargs'</span></span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> navigationVersion = <span class="string">"2.0.0"</span></span><br><span class="line">    <span class="keyword">def</span> drawerLayoutVersion = <span class="string">"1.0.0"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"androidx.drawerlayout:drawerlayout:$drawerLayoutVersion"</span></span><br><span class="line">    implementation <span class="string">"androidx.navigation:navigation-fragment-ktx:$navigationVersion"</span></span><br><span class="line">    implementation <span class="string">"androidx.navigation:navigation-ui-ktx:$navigationVersion"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>main_activity.xml</code></p>
<ul>
<li>Use <code>CoordinatorLayout</code> and <code>ToolBar</code></li>
<li>Define <code>layout_gravity</code> for <code>NavigationView</code></li>
</ul>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;androidx.drawerlayout.widget.DrawerLayout</span><br><span class="line">    android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">    android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">    xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    xmlns:app=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span><br><span class="line">    xmlns:tools=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">    android:id=<span class="string">"@+id/drawerLayout"</span></span><br><span class="line">    tools:context=<span class="string">".MainActivity"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;androidx.coordinatorlayout.widget.CoordinatorLayout</span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"match_parent"</span>&gt;</span><br><span class="line">        &lt;com.google.android.material.appbar.AppBarLayout</span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"wrap_content"</span>&gt;</span><br><span class="line">            &lt;androidx.appcompat.widget.Toolbar</span><br><span class="line">                android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">                android:layout_height=<span class="string">"?attr/actionBarSize"</span></span><br><span class="line">                android:id=<span class="string">"@+id/toolbar"</span>/&gt;</span><br><span class="line">        &lt;/com.google.android.material.appbar.AppBarLayout&gt;</span><br><span class="line">        &lt;fragment</span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">            android:id=<span class="string">"@+id/hostFragment"</span></span><br><span class="line">            android:name=<span class="string">"androidx.navigation.fragment.NavHostFragment"</span></span><br><span class="line">            app:defaultNavHost=<span class="string">"true"</span></span><br><span class="line">            app:navGraph=<span class="string">"@navigation/navigation_graph"</span>/&gt;</span><br><span class="line">    &lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&gt;</span><br><span class="line">    &lt;com.google.android.material.navigation.NavigationView</span><br><span class="line">        android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">        android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">        android:id=<span class="string">"@+id/navigationView"</span></span><br><span class="line">        android:fitsSystemWindows=<span class="string">"true"</span></span><br><span class="line">        android:layout_gravity=<span class="string">"start"</span></span><br><span class="line">        app:menu=<span class="string">"@menu/drawer_menu"</span>/&gt;</span><br><span class="line">&lt;/androidx.drawerlayout.widget.DrawerLayout&gt;</span><br></pre></td></tr></table></figure>

<p><code>navigation/navigation_graph.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">navigation</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/navigationGraph"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:startDestination</span>=<span class="string">"@id/aboutFragment"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/aboutFragment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.onmyway133.whatsupintech.AboutFragment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/menu_about"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:layout</span>=<span class="string">"@layout/about_fragment"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/feedFragment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.onmyway133.whatsupintech.FeedFragment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/menu_git_hub"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:layout</span>=<span class="string">"@layout/feed_fragment"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/webFragment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.onmyway133.whatsupintech.WebFragment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:layout</span>=<span class="string">"@layout/web_fragment"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">navigation</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>menu/drawer_menu.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span> <span class="attr">android:checkableBehavior</span>=<span class="string">"single"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/about"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"@string/menu_about"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/hackerNews"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"@string/menu_hacker_news"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/reddit"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"@string/menu_reddit"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/dev"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"@string/menu_dev"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/gitHub"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"@string/menu_git_hub"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>MainActivity.kotlin</code></p>
<ul>
<li>Use <code>AppBarConfiguration</code> to define multiple top level destinations</li>
<li>Convert Toolbar to ActionBar</li>
</ul>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.onmyway133.whatsupintech</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.GravityCompat</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.findNavController</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.AppBarConfiguration</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.navigateUp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.setupActionBarWithNavController</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.setupWithNavController</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.main_activity.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> appBarConfig: AppBarConfiguration</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.main_activity)</span><br><span class="line">        setupNavigationController()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setupNavigationController</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> navigationController = findNavController(R.id.hostFragment)</span><br><span class="line"></span><br><span class="line">        setSupportActionBar(toolbar)</span><br><span class="line"></span><br><span class="line">        appBarConfig = AppBarConfiguration(setOf(R.id.aboutFragment, R.id.feedFragment), drawerLayout)</span><br><span class="line">        setupActionBarWithNavController(navigationController, appBarConfig)</span><br><span class="line">        navigationView.setupWithNavController(navigationController)</span><br><span class="line">        navigationView.setNavigationItemSelectedListener &#123; menuItem -&gt;</span><br><span class="line">            drawerLayout.closeDrawers()</span><br><span class="line">            menuItem.isChecked = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">when</span> (menuItem.itemId) &#123;</span><br><span class="line">                R.id.about -&gt; navigationController.navigate(R.id.aboutFragment)</span><br><span class="line">                R.id.gitHub, R.id.reddit, R.id.hackerNews, R.id.dev -&gt; navigationController.navigate(R.id.feedFragment)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onSupportNavigateUp</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> navigationController = findNavController(R.id.hostFragment)</span><br><span class="line">        <span class="keyword">return</span> navigationController.navigateUp(appBarConfig) || <span class="keyword">super</span>.onSupportNavigateUp()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBackPressed</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (drawerLayout.isDrawerOpen(GravityCompat.START)) &#123;</span><br><span class="line">            drawerLayout.closeDrawer(GravityCompat.START)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.onBackPressed()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Update-UI-components-with-NavigationUI"><a href="#Update-UI-components-with-NavigationUI" class="headerlink" title="Update UI components with NavigationUI"></a><a href="https://developer.android.com/guide/navigation/navigation-ui" target="_blank" rel="noopener">Update UI components with NavigationUI</a></h2><h3 id="Tie-destinations-to-menu-items"><a href="#Tie-destinations-to-menu-items" class="headerlink" title="Tie destinations to menu items"></a>Tie destinations to menu items</h3><blockquote>
<p>NavigationUI also provides helpers for tying destinations to menu-driven UI components. NavigationUI contains a helper method, onNavDestinationSelected(), which takes a MenuItem along with the NavController that hosts the associated destination. If the id of the MenuItem matches the id of the destination, the NavController can then navigate to that destination.</p>
</blockquote>
<h3 id="Add-a-navigation-drawer"><a href="#Add-a-navigation-drawer" class="headerlink" title="Add a navigation drawer"></a>Add a navigation drawer</h3><blockquote>
<p>The drawer icon is displayed on all top-level destinations that use a DrawerLayout. Top-level destinations are the root-level destinations of your app. They do not display an Up button in the app bar.</p>
</blockquote>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://mvnrepository.com/artifact/android.arch.navigation/navigation-safe-args-gradle-plugin/1.0.0-alpha01" target="_blank" rel="noopener">Android Navigation TypeSafe Arguments Gradle Plugin</a></li>
<li><a href="https://developer.android.com/guide/navigation/navigation-getting-started" target="_blank" rel="noopener">Get started with the Navigation component</a></li>
<li><a href="https://developer.android.com/guide/navigation/navigation-conditional" target="_blank" rel="noopener">Conditional navigation</a></li>
<li><a href="https://github.com/umangburman/Navigation-Drawer-With-Navigation-Component" target="_blank" rel="noopener">Navigation Drawer with New JetPacks Navigation Component</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Links-for-Android"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Links-for-Android/">Links for Android</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Links-for-Android/" class="article-date">
	  <time datetime="2019-08-06T18:24:43.000Z" itemprop="datePublished">August 6, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/348" target="_blank" rel="noopener">#348</a></strong></p>
<ul>
<li>Google Maven Repository <a href="https://dl.google.com/dl/android/maven2/index.html" target="_blank" rel="noopener">https://dl.google.com/dl/android/maven2/index.html</a></li>
</ul>
<h3 id="Posts"><a href="#Posts" class="headerlink" title="Posts"></a>Posts</h3><ul>
<li><a href="https://medium.com/androiddevelopers/viewmodels-a-simple-example-ed5ac416317e" target="_blank" rel="noopener">https://medium.com/androiddevelopers/viewmodels-a-simple-example-ed5ac416317e</a></li>
<li><a href="https://proandroiddev.com/5-common-mistakes-when-using-architecture-components-403e9899f4cb" target="_blank" rel="noopener">https://proandroiddev.com/5-common-mistakes-when-using-architecture-components-403e9899f4cb</a></li>
<li><a href="https://tech.instacart.com/introducing-coil-kotlin-first-image-loading-on-android-f0fdc7a2a99e" target="_blank" rel="noopener">https://tech.instacart.com/introducing-coil-kotlin-first-image-loading-on-android-f0fdc7a2a99e</a></li>
</ul>
<h3 id="Coroutine"><a href="#Coroutine" class="headerlink" title="Coroutine"></a>Coroutine</h3><ul>
<li>Index <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html" target="_blank" rel="noopener">https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html</a></li>
<li><a href="https://proandroiddev.com/suspend-what-youre-doing-retrofit-has-now-coroutines-support-c65bd09ba067" target="_blank" rel="noopener">https://proandroiddev.com/suspend-what-youre-doing-retrofit-has-now-coroutines-support-c65bd09ba067</a></li>
<li><a href="https://blog.mindorks.com/mastering-kotlin-coroutines-in-android-step-by-step-guide" target="_blank" rel="noopener">https://blog.mindorks.com/mastering-kotlin-coroutines-in-android-step-by-step-guide</a></li>
<li><a href="https://jivimberg.io/blog/2018/05/04/parallel-map-in-kotlin/" target="_blank" rel="noopener">https://jivimberg.io/blog/2018/05/04/parallel-map-in-kotlin/</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/coroutines" target="_blank" rel="noopener">Use Kotlin coroutines with Architecture components</a></li>
<li><a href="https://proandroiddev.com/async-operations-with-kotlin-coroutines-part-1-c51cc581ad33" target="_blank" rel="noopener">https://proandroiddev.com/async-operations-with-kotlin-coroutines-part-1-c51cc581ad33</a></li>
<li><a href="https://medium.com/@elizarov/coroutine-context-and-scope-c8b255d59055" target="_blank" rel="noopener">https://medium.com/@elizarov/coroutine-context-and-scope-c8b255d59055</a></li>
<li><a href="https://medium.com/@elizarov/structured-concurrency-722d765aa952" target="_blank" rel="noopener">https://medium.com/@elizarov/structured-concurrency-722d765aa952</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/links/">links</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-digit-passcode-input-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-digit-passcode-input-in-Swift/">How to make digit passcode input in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-digit-passcode-input-in-Swift/" class="article-date">
	  <time datetime="2019-08-06T11:14:49.000Z" itemprop="datePublished">August 6, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/347" target="_blank" rel="noopener">#347</a></strong></p>
<p>Add a hidden <code>UITextField</code> to view hierarchy, and add <code>UITapGestureRecognizer</code> to activate that textField.</p>
<p>Use padding string with limit to the number of labels, and prefix to get exactly n characters.</p>
<img width="596" alt="code" src="https://user-images.githubusercontent.com/2284279/62542858-f34e2e80-b85c-11e9-91df-c9c46a00eefe.png">


<p><code>DigitView.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">DigitView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> stackView: <span class="type">UIStackView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIStackView</span>()</span><br><span class="line">        view.axis = .horizontal</span><br><span class="line">        view.distribution = .equalSpacing</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> boxes: [<span class="type">UIView</span>] = []</span><br><span class="line">    <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> labels: [<span class="type">UILabel</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> hiddenTextField: <span class="type">UITextField</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> textField = <span class="type">UITextField</span>()</span><br><span class="line">        textField.alpha = <span class="number">0</span></span><br><span class="line">        textField.keyboardType = .numbersAndPunctuation</span><br><span class="line">        <span class="keyword">return</span> textField</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> tapGR = <span class="type">UITapGestureRecognizer</span>(target: <span class="keyword">self</span>, action: #selector(handle(<span class="number">_</span>:)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line"></span><br><span class="line">        addGestureRecognizer(tapGR)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.layoutSubviews()</span><br><span class="line"></span><br><span class="line">        boxes.forEach &#123;</span><br><span class="line">            $<span class="number">0</span>.layer.borderWidth = <span class="number">1</span></span><br><span class="line">            $<span class="number">0</span>.layer.borderColor = <span class="type">R</span>.color.primary.cgColor</span><br><span class="line">            $<span class="number">0</span>.layoutIfNeeded()</span><br><span class="line">            $<span class="number">0</span>.layer.cornerRadius = $<span class="number">0</span>.bounds.height / <span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> tapGR: UITapGestureRecognizer)</span></span> &#123;</span><br><span class="line">        hiddenTextField.becomeFirstResponder()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([hiddenTextField, stackView])</span><br><span class="line">        boxes = <span class="type">Array</span>(<span class="number">0</span>..&lt;<span class="number">6</span>).<span class="built_in">map</span> &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">UIView</span>()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        labels = boxes.<span class="built_in">map</span> &#123; box <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">            label.font = <span class="type">R</span>.customFont.semibold(<span class="number">16</span>)</span><br><span class="line">            label.textAlignment = .center</span><br><span class="line">            label.textColor = <span class="type">R</span>.color.primary</span><br><span class="line">            box.addSubview(label)</span><br><span class="line"></span><br><span class="line">            <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">                label.centerXAnchor.constraint(equalTo: box.centerXAnchor),</span><br><span class="line">                label.centerYAnchor.constraint(equalTo: box.centerYAnchor)</span><br><span class="line">            ])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> label</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        boxes.forEach &#123;</span><br><span class="line">            stackView.addArrangedSubview($<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">                $<span class="number">0</span>.heightAnchor.constraint(equalTo: stackView.heightAnchor, multiplier: <span class="number">0.9</span>),</span><br><span class="line">                $<span class="number">0</span>.widthAnchor.constraint(equalTo: $<span class="number">0</span>.heightAnchor, multiplier: <span class="number">1.0</span>)</span><br><span class="line">            ])</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            stackView.pinEdges(view: <span class="keyword">self</span>, inset: <span class="type">UIEdgeInsets</span>(top: <span class="number">0</span>, <span class="keyword">left</span>: <span class="number">16</span>, bottom: <span class="number">0</span>, <span class="keyword">right</span>: -<span class="number">16</span>))</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>DigitHandler.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">DigitHandler</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> digitView: <span class="type">DigitView</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(digitView: <span class="type">DigitView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.digitView = digitView</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line"></span><br><span class="line">        digitView.hiddenTextField.delegate = <span class="keyword">self</span></span><br><span class="line">        digitView.hiddenTextField.addTarget(<span class="keyword">self</span>, action: #selector(handle(<span class="number">_</span>:)), <span class="keyword">for</span>: .editingChanged)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> textField: UITextField)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> text = textField.text <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="built_in">count</span> = digitView.labels.<span class="built_in">count</span></span><br><span class="line">        <span class="keyword">let</span> paddedText = <span class="type">String</span>(text.padding(toLength: <span class="built_in">count</span>, withPad: <span class="string">"-"</span>, startingAt: <span class="number">0</span>).<span class="keyword">prefix</span>(<span class="built_in">count</span>))</span><br><span class="line">        <span class="built_in">zip</span>(digitView.labels, paddedText).forEach &#123; tuple <span class="keyword">in</span></span><br><span class="line">            tuple.<span class="number">0</span>.text = <span class="type">String</span>(tuple.<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">DigitHandler</span>: <span class="title">UITextFieldDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">textFieldShouldReturn</span><span class="params">(<span class="number">_</span> textField: UITextField)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        textField.resignFirstResponder()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">textField</span><span class="params">(<span class="number">_</span> textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> text = textField.text ?? <span class="string">""</span></span><br><span class="line">        <span class="keyword">return</span> text.<span class="built_in">count</span> &lt; digitView.labels.<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-credit-card-input-UI-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-credit-card-input-UI-in-Swift/">How to make credit card input UI in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-credit-card-input-UI-in-Swift/" class="article-date">
	  <time datetime="2019-08-05T12:16:48.000Z" itemprop="datePublished">August 5, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/346" target="_blank" rel="noopener">#346</a></strong></p>
<p>We have FrontCard that contains number and expiration date, BackCard that contains CVC. CardView is used to contain front and back sides for flipping transition.</p>
<p>We leverage <code>STPPaymentCardTextField</code> from Stripe for working input fields, then <code>CardHandler</code> is used to parse <code>STPPaymentCardTextField</code> content and update our UI.</p>
<p>For masked credit card numbers, we pad string to fit 16 characters with <code>●</code> symbol, then chunk into 4 parts and zip with labels to update.</p>
<p>For flipping animation, we use <code>UIView.transition</code> with <code>showHideTransitionViews</code></p>
<img width="370" alt="a1" src="https://user-images.githubusercontent.com/2284279/62470585-0dbfd380-b79b-11e9-9c31-13ea6cd17550.png">
<img width="362" alt="a2" src="https://user-images.githubusercontent.com/2284279/62470586-0dbfd380-b79b-11e9-9473-4c534b263b74.png">



<p><code>BackCard.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">BackCard</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> rectangle: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> cvcLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.font = <span class="type">R</span>.customFont.medium(<span class="number">14</span>)</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        label.textAlignment = .center</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> cvcBox: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">R</span>.color.lightText</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([rectangle, cvcBox, cvcLabel])</span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            rectangle.leftAnchor.constraint(equalTo: leftAnchor),</span><br><span class="line">            rectangle.rightAnchor.constraint(equalTo: rightAnchor),</span><br><span class="line">            rectangle.heightAnchor.constraint(equalToConstant: <span class="number">52</span>),</span><br><span class="line">            rectangle.topAnchor.constraint(equalTo: topAnchor, constant: <span class="number">30</span>),</span><br><span class="line"></span><br><span class="line">            cvcBox.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">16</span>),</span><br><span class="line">            cvcBox.topAnchor.constraint(equalTo: rectangle.bottomAnchor, constant: <span class="number">16</span>),</span><br><span class="line">            cvcBox.widthAnchor.constraint(equalToConstant: <span class="number">66</span>),</span><br><span class="line">            cvcBox.heightAnchor.constraint(equalToConstant: <span class="number">30</span>),</span><br><span class="line"></span><br><span class="line">            cvcLabel.centerXAnchor.constraint(equalTo: cvcBox.centerXAnchor),</span><br><span class="line">            cvcLabel.centerYAnchor.constraint(equalTo: cvcBox.centerYAnchor)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>FrontCard.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">FrontCard</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> stackView: <span class="type">UIStackView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> stackView = <span class="type">UIStackView</span>()</span><br><span class="line">        stackView.axis = .horizontal</span><br><span class="line">        stackView.distribution = .equalSpacing</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stackView</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> numberLabels: [<span class="type">UILabel</span>] = <span class="type">Array</span>(<span class="number">0</span>..&lt;<span class="number">4</span>).<span class="built_in">map</span>(&#123; <span class="number">_</span> <span class="keyword">in</span> <span class="keyword">return</span> <span class="type">UILabel</span>() &#125;)</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> expirationStaticLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.font = <span class="type">R</span>.customFont.regular(<span class="number">10</span>)</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> expirationLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.font = <span class="type">R</span>.customFont.medium(<span class="number">14</span>)</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubview(stackView)</span><br><span class="line">        numberLabels.forEach &#123;</span><br><span class="line">            stackView.addArrangedSubview($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        addSubviews([expirationStaticLabel, expirationLabel])</span><br><span class="line"></span><br><span class="line">        numberLabels.forEach &#123;</span><br><span class="line">            $<span class="number">0</span>.font = <span class="type">R</span>.customFont.medium(<span class="number">16</span>)</span><br><span class="line">            $<span class="number">0</span>.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">            $<span class="number">0</span>.textAlignment = .center</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            stackView.heightAnchor.constraint(equalToConstant: <span class="number">50</span>),</span><br><span class="line">            stackView.leftAnchor.constraint(equalTo: leftAnchor, constant: <span class="number">24</span>),</span><br><span class="line">            stackView.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">24</span>),</span><br><span class="line">            stackView.topAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line"></span><br><span class="line">            expirationStaticLabel.topAnchor.constraint(equalTo: stackView.bottomAnchor),</span><br><span class="line">            expirationStaticLabel.leftAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">70</span>),</span><br><span class="line"></span><br><span class="line">            expirationLabel.leftAnchor.constraint(equalTo: expirationStaticLabel.leftAnchor),</span><br><span class="line">            expirationLabel.topAnchor.constraint(equalTo: expirationStaticLabel.bottomAnchor)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>CardView.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CardView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> backCard = <span class="type">BackCard</span>()</span><br><span class="line">    <span class="keyword">let</span> frontCard = <span class="type">FrontCard</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubview(backCard)</span><br><span class="line">        addSubview(frontCard)</span><br><span class="line"></span><br><span class="line">        [backCard, frontCard].forEach &#123;</span><br><span class="line">            <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">                $<span class="number">0</span>.pinEdges(view: <span class="keyword">self</span>)</span><br><span class="line">            ])</span><br><span class="line"></span><br><span class="line">            $<span class="number">0</span>.clipsToBounds = <span class="literal">true</span></span><br><span class="line">            $<span class="number">0</span>.layer.cornerRadius = <span class="number">10</span></span><br><span class="line">            $<span class="number">0</span>.backgroundColor = <span class="type">R</span>.color.card.background</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>CardHandler.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Stripe</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CardHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> cardView: <span class="type">CardView</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(cardView: <span class="type">CardView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.cardView = cardView</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">reset</span><span class="params">()</span></span> &#123;</span><br><span class="line">        cardView.frontCard.expirationStaticLabel.text = <span class="type">R</span>.string.localizable.cardExpiration()</span><br><span class="line">        cardView.frontCard.expirationLabel.text = <span class="type">R</span>.string.localizable.cardExpirationPlaceholder()</span><br><span class="line">        cardView.backCard.cvcLabel.text = <span class="type">R</span>.string.localizable.cardCvcPlaceholder()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showFront</span><span class="params">()</span></span> &#123;</span><br><span class="line">        flip(</span><br><span class="line">            from: cardView.backCard,</span><br><span class="line">            to: cardView.frontCard,</span><br><span class="line">            options: .transitionFlipFromLeft</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showBack</span><span class="params">()</span></span> &#123;</span><br><span class="line">        flip(</span><br><span class="line">            from: cardView.frontCard,</span><br><span class="line">            to: cardView.backCard,</span><br><span class="line">            options: .transitionFlipFromRight</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> textField: STPPaymentCardTextField)</span></span> &#123;</span><br><span class="line">        handle(number: textField.cardNumber ?? <span class="string">""</span>)</span><br><span class="line">        handle(month: textField.formattedExpirationMonth, year: textField.formattedExpirationYear)</span><br><span class="line">        handle(cvc: textField.cvc)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(number: String)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> paddedNumber = number.padding(</span><br><span class="line">            toLength: <span class="number">16</span>,</span><br><span class="line">            withPad: <span class="type">R</span>.string.localizable.cardNumberPlaceholder(),</span><br><span class="line">            startingAt: <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> chunkedNumbers = paddedNumber.chunk(by: <span class="number">4</span>)</span><br><span class="line">        <span class="built_in">zip</span>(cardView.frontCard.numberLabels, chunkedNumbers).forEach &#123; tuple <span class="keyword">in</span></span><br><span class="line">            tuple.<span class="number">0</span>.text = tuple.<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(cvc: String?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> cvc = cvc, !cvc.isEmpty &#123;</span><br><span class="line">            cardView.backCard.cvcLabel.text = cvc</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cardView.backCard.cvcLabel.text = <span class="type">R</span>.string.localizable.cardCvcPlaceholder()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(month: String?, year: String?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> month = month, <span class="keyword">let</span> year = year,</span><br><span class="line">            !month.isEmpty</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cardView.frontCard.expirationLabel.text = <span class="type">R</span>.string.localizable.cardExpirationPlaceholder()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> formattedYear = year.ifEmpty(replaceWith: <span class="string">"00"</span>)</span><br><span class="line">        cardView.frontCard.expirationLabel.text = <span class="string">"\(month)/\(formattedYear)"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">flip</span><span class="params">(from: UIView, to: UIView, options: UIView.AnimationOptions)</span></span> &#123;</span><br><span class="line">        <span class="type">UIView</span>.transition(</span><br><span class="line">            from: from,</span><br><span class="line">            to: to,</span><br><span class="line">            duration: <span class="number">0.25</span>,</span><br><span class="line">            options: [options, .showHideTransitionViews],</span><br><span class="line">            completion: <span class="literal">nil</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>String+Extension.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ifEmpty</span><span class="params">(replaceWith: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isEmpty ? replaceWith : <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">chunk</span><span class="params">(by length: Int)</span></span> -&gt; [<span class="type">String</span>] &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: <span class="built_in">count</span>, by: length).<span class="built_in">map</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> start = index(startIndex, offsetBy: $<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">let</span> end = index(start, offsetBy: length, limitedBy: endIndex) ?? endIndex</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(<span class="keyword">self</span>[start..&lt;end])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-stop-implicit-animation-when-title-change-on-UIButton"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-stop-implicit-animation-when-title-change-on-UIButton/">How to stop implicit animation when title change on UIButton</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-stop-implicit-animation-when-title-change-on-UIButton/" class="article-date">
	  <time datetime="2019-08-02T05:21:47.000Z" itemprop="datePublished">August 2, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/345" target="_blank" rel="noopener">#345</a></strong></p>
<p><code>UIButton</code> with system type has implicit animation for <a href="https://developer.apple.com/documentation/uikit/uibutton/1624018-settitle" target="_blank" rel="noopener">setTitle(_:for:)</a></p>
<blockquote>
<p>Use this method to set the title for the button. The title you specify derives its formatting from the button’s associated label object. If you set both a title and an attributed title for the button, the button prefers the use of the attributed title over this one.</p>
</blockquote>
<blockquote>
<p>At a minimum, you should set the value for the normal state. If a title is not specified for a state, the default behavior is to use the title associated with the normal state. If the value for normal is not set, then the property defaults to a system value.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIView</span>.performWithoutAnimation &#123;</span><br><span class="line">    button.setTitle(title, <span class="keyword">for</span>: .normal)</span><br><span class="line">    button.layoutIfNeeded()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-addSubview-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-addSubview-in-iOS/">How to use addSubview in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-addSubview-in-iOS/" class="article-date">
	  <time datetime="2019-08-01T12:06:27.000Z" itemprop="datePublished">August 1, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/344" target="_blank" rel="noopener">#344</a></strong></p>
<p><a href="https://developer.apple.com/documentation/uikit/uiview/1622616-addsubview" target="_blank" rel="noopener">addSubview</a> can trigger <a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/1621398-viewdidlayoutsubviews" target="_blank" rel="noopener">viewDidLayoutSubviews</a>, so be careful to just do layout stuff in <code>viewDidLayoutSubviews</code></p>
<blockquote>
<p>This method establishes a strong reference to view and sets its next responder to the receiver, which is its new superview.</p>
</blockquote>
<blockquote>
<p>Views can have only one superview. If view already has a superview and that view is not the receiver, this method removes the previous superview before making the receiver its new superview.</p>
</blockquote>
<blockquote>
<p>When the bounds change for a view controller’s view, the view adjusts the positions of its subviews and then the system calls this method. However, this method being called does not indicate that the individual layouts of the view’s subviews have been adjusted. Each subview is responsible for adjusting its own layout.</p>
</blockquote>
<blockquote>
<p>Your view controller can override this method to make changes after the view lays out its subviews. The default implementation of this method does nothing.</p>
</blockquote>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-run-app-on-beta-iOS-devices"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-run-app-on-beta-iOS-devices/">How to run app on beta iOS devices</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-run-app-on-beta-iOS-devices/" class="article-date">
	  <time datetime="2019-08-01T04:59:03.000Z" itemprop="datePublished">August 1, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/343" target="_blank" rel="noopener">#343</a></strong></p>
<p>Xcode 10.3 with iOS 13</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /Applications/Xcode-beta.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/13.0 /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport</span><br></pre></td></tr></table></figure>

<p>Xcode 10.3 with iOS 13.1 beta 2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /Applications/Xcode-beta.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/13.0/ /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/13.1</span><br></pre></td></tr></table></figure>

<h2 id="Use-DeviceSupport"><a href="#Use-DeviceSupport" class="headerlink" title="Use DeviceSupport"></a>Use DeviceSupport</h2><ul>
<li>Download and unzip Device support <a href="https://github.com/iGhibli/iOS-DeviceSupport" target="_blank" rel="noopener">https://github.com/iGhibli/iOS-DeviceSupport</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Applications/Xcode/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xcode/">xcode</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-submit-electron-app-to-AppStore"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-submit-electron-app-to-AppStore/">How to submit electron app to AppStore</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-submit-electron-app-to-AppStore/" class="article-date">
	  <time datetime="2019-07-31T18:19:25.000Z" itemprop="datePublished">July 31, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/342" target="_blank" rel="noopener">#342</a></strong></p>
<h2 id="Before"><a href="#Before" class="headerlink" title="Before"></a>Before</h2><p>Install electron as dev <code>npm install electron --save-dev</code><br>Update electron-packager <code>npm install electron-packager@latest --save-dev</code><br>Use no space in app name</p>
<h2 id="Package-with-electron-packager"><a href="#Package-with-electron-packager" class="headerlink" title="Package with electron-packager"></a>Package with electron-packager</h2><p>Follow <a href="https://github.com/electron/electron-osx-sign/wiki/Packaging-and-Submitting-an-Electron-App-to-the-Mac-App-Store" target="_blank" rel="noopener">https://github.com/electron/electron-osx-sign/wiki/Packaging-and-Submitting-an-Electron-App-to-the-Mac-App-Store</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx electron-packager . <span class="string">"MyApp"</span> --app-bundle-id=com.onmyway133.MyApp --helper-bundle-id=com.onmyway133.MyApp.helper --app-version=1.4.0 --build-version=1.0.100 --platform=mas --arch=x64 --icon=Icon/Icon.icns --overwrite</span><br><span class="line">npx electron-osx-sign <span class="string">"MyApp-mas-x64/MyApp.app"</span> --verbose</span><br><span class="line">npx electron-osx-flat <span class="string">"MyApp-mas-x64/MyApp.app"</span> --verbose</span><br></pre></td></tr></table></figure>

<h3 id="If-you-have-multiple-developer-identities-in-your-keychain"><a href="#If-you-have-multiple-developer-identities-in-your-keychain" class="headerlink" title="If you have multiple developer identities in your keychain:"></a>If you have multiple developer identities in your keychain:</h3><blockquote>
<p>electron-osx-sign searches your keychain for the first signing certificates that it can locate. If you have multiple certificates then it may not know which cert you want to use for signing and you need to explicitly provide the name:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">electron-osx-sign &quot;My App-mas-x64/My App.app&quot; --identity=&quot;3rd Party Mac Developer Application: My Company, Inc (ABCDEFG1234)&quot; --verbose</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><h5 id="Sign-with-electron-osx-sign"><a href="#Sign-with-electron-osx-sign" class="headerlink" title="Sign with electron-osx-sign"></a>Sign with electron-osx-sign</h5><p>Read README <a href="https://github.com/electron/electron-osx-sign" target="_blank" rel="noopener">https://github.com/electron/electron-osx-sign</a></p>
<blockquote>
<p>For distribution in the Mac App Store: Have the provisioning profile for distribution placed in the current working directory and the signing identity installed in the default keychain.</p>
</blockquote>
<h3 id="Certificate"><a href="#Certificate" class="headerlink" title="Certificate"></a>Certificate</h3><p>On developer.apple.com, create Mac App Distribution certificate. Make sure when we download in Keychain Access, it has associated private key</p>
<h3 id="Manually-upload"><a href="#Manually-upload" class="headerlink" title="Manually upload"></a>Manually upload</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Applications/Xcode.app/Contents/Applications/Application\ Loader.app/Contents/itms/bin/iTMSTransporter -m upload  -assetFile MyApp/MyApp.pkg  -u onmyway133@gmail.com -p mypassword</span><br></pre></td></tr></table></figure>

<h3 id="Use-Application-Loader"><a href="#Use-Application-Loader" class="headerlink" title="Use Application Loader"></a>Use Application Loader</h3><p>Use <a href="https://support.apple.com/en-us/HT204397" target="_blank" rel="noopener">Using app-specific passwords</a></p>
<h3 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h3><h4 id="electron-Bad-CFBundleExecutable-Cannot-find-executable-file"><a href="#electron-Bad-CFBundleExecutable-Cannot-find-executable-file" class="headerlink" title="electron Bad CFBundleExecutable. Cannot find executable file"></a>electron Bad CFBundleExecutable. Cannot find executable file</h4><blockquote>
<p>ERROR ITMS-90261: “Bad CFBundleExecutable. Cannot find executable file that matches the value of CFBundleExecutable in the nested bundle MyApp [com.onmyway133.MyApp.pkg/Payload/MyApp.app/Contents/Frameworks/MyApp (GPU).app] property list file.”</p>
</blockquote>
<p><a href="https://github.com/electron/electron-packager/issues?utf8=%E2%9C%93&amp;q=helper" target="_blank" rel="noopener">https://github.com/electron/electron-packager/issues?utf8=%E2%9C%93&amp;q=helper</a></p>
<p>Try electron 5.0.0 <code>npm install electron@5.0.0 --save-dev</code></p>
<h4 id="Specifically-we-found-that-when-the-user-closes-the-main-application-window-there-is-no-menu-item-to-re-open-it"><a href="#Specifically-we-found-that-when-the-user-closes-the-main-application-window-there-is-no-menu-item-to-re-open-it" class="headerlink" title="Specifically, we found that when the user closes the main application window there is no menu item to re-open it."></a>Specifically, we found that when the user closes the main application window there is no menu item to re-open it.</h4><p><a href="https://stackoverflow.com/questions/35008347/electron-close-w-x-vs-right-click-dock-and-quit" target="_blank" rel="noopener">https://stackoverflow.com/questions/35008347/electron-close-w-x-vs-right-click-dock-and-quit</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> application = &#123;</span><br><span class="line">    label: <span class="string">"MyApp"</span>,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123;</span><br><span class="line">        label: <span class="string">"New"</span>,</span><br><span class="line">        accelerator: <span class="string">"Command+N"</span>,</span><br><span class="line">        click: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (win === <span class="literal">null</span>) &#123;</span><br><span class="line">            createWindow()</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="‘electron-osx-flat-latest’-is-not-in-the-npm-registry"><a href="#‘electron-osx-flat-latest’-is-not-in-the-npm-registry" class="headerlink" title="‘electron-osx-flat@latest’ is not in the npm registry"></a>‘electron-osx-flat@latest’ is not in the npm registry</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g electron-osx-sign@latest</span><br></pre></td></tr></table></figure>

<h4 id="App-sandbox-not-enabled"><a href="#App-sandbox-not-enabled" class="headerlink" title="App sandbox not enabled"></a>App sandbox not enabled</h4><h4 id="electron-osx-sign-Command-failed-codesign"><a href="#electron-osx-sign-Command-failed-codesign" class="headerlink" title="electron-osx-sign Command failed: codesign"></a>electron-osx-sign Command failed: codesign</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ran xattr -cr *</span><br></pre></td></tr></table></figure>

<h4 id="Command-failed-codesign-bundle-format-is-ambiguous"><a href="#Command-failed-codesign-bundle-format-is-ambiguous" class="headerlink" title="Command failed: codesign bundle format is ambiguous"></a>Command failed: codesign bundle format is ambiguous</h4><blockquote>
<p>Perhaps you accidentally packaged the previous generated app bundle into your newly packaged app?</p>
</blockquote>
<p>Remove <code>dist</code> folder generated by electron-builder</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/electron/">electron</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-format-hour-minute-from-time-interval-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-format-hour-minute-from-time-interval-in-Swift/">How to format hour minute from time interval in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-format-hour-minute-from-time-interval-in-Swift/" class="article-date">
	  <time datetime="2019-07-31T07:35:44.000Z" itemprop="datePublished">July 31, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/340" target="_blank" rel="noopener">#340</a></strong></p>
<h2 id="Use-DateComponentsFormatter"><a href="#Use-DateComponentsFormatter" class="headerlink" title="Use DateComponentsFormatter"></a>Use DateComponentsFormatter</h2><p><a href="https://nshipster.com/formatter/#datecomponentsformatter" target="_blank" rel="noopener">https://nshipster.com/formatter/#datecomponentsformatter</a></p>
<p>Results in no padding 0</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">format</span><span class="params">(second: TimeInterval)</span></span> -&gt; <span class="type">String?</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> formatter = <span class="type">DateComponentsFormatter</span>()</span><br><span class="line">    formatter.unitsStyle = .positional</span><br><span class="line">    formatter.allowedUnits = [.hour, .minute]</span><br><span class="line">    formatter.zeroFormattingBehavior = .pad</span><br><span class="line">    <span class="keyword">return</span> formatter.string(from: second)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">XCTAssertEqual</span>(format(second: <span class="number">5400</span> ), <span class="string">"1:30"</span>)</span><br><span class="line"><span class="type">XCTAssertEqual</span>(format(second: <span class="number">7200</span>), <span class="string">"2:00"</span>)</span><br><span class="line"><span class="type">XCTAssertEqual</span>(format(second: <span class="number">39600</span> ), <span class="string">"11:00"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Use-mod"><a href="#Use-mod" class="headerlink" title="Use mod"></a>Use mod</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">format</span><span class="params">(minute: Int)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> h = minute / <span class="number">60</span></span><br><span class="line">    <span class="keyword">let</span> m = minute % <span class="number">60</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"\(h.padZero()):\(m.padZero())"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">extension</span> <span class="title">Int</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">padZero</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">"%02d"</span>, <span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">XCTAssertEqual</span>(format(minute: <span class="number">90</span> ), <span class="string">"01:30"</span>)</span><br><span class="line"><span class="type">XCTAssertEqual</span>(format(minute: <span class="number">120</span>), <span class="string">"02:00"</span>)</span><br><span class="line"><span class="type">XCTAssertEqual</span>(format(minute: <span class="number">660</span> ), <span class="string">"11:00"</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-cache-URLSession-response"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-cache-URLSession-response/">How to cache URLSession response</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-cache-URLSession-response/" class="article-date">
	  <time datetime="2019-07-03T11:49:07.000Z" itemprop="datePublished">July 3, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/339" target="_blank" rel="noopener">#339</a></strong></p>
<p>For simple cases, we don’t need to. Let’s use <a href="https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410148-urlcache" target="_blank" rel="noopener">urlCache</a></p>
<blockquote>
<p>The URL cache for providing cached responses to requests within the session.</p>
</blockquote>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/accessing_cached_data" target="_blank" rel="noopener">Accessing Cached Data</a></p>
<blockquote>
<p>The URL Loading System caches responses both in memory and on disk, improving performance and reducing network traffic.</p>
</blockquote>
<blockquote>
<p>The URLCache class is used for caching responses from network resources. Your app can directly access the shared cache instance by using the shared property of URLCache. Or, you can create your own caches for different purposes, setting distinct caches on your URLSessionConfiguration objects.</p>
</blockquote>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://nshipster.com/nsurlcache/" target="_blank" rel="noopener">URLCache</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-ext-in-gradle-in-Android"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-ext-in-gradle-in-Android/">How to use ext in gradle in Android</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-ext-in-gradle-in-Android/" class="article-date">
	  <time datetime="2019-07-02T12:15:02.000Z" itemprop="datePublished">July 2, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/338" target="_blank" rel="noopener">#338</a></strong></p>
<p>Gradle uses Groovy and it has <code>ext</code>, also known as <a href="https://docs.gradle.org/current/dsl/org.gradle.api.plugins.ExtraPropertiesExtension.html" target="_blank" rel="noopener">ExtraPropertiesExtension</a></p>
<blockquote>
<p>Additional, ad-hoc, properties for Gradle domain objects.</p>
</blockquote>
<blockquote>
<p>Extra properties extensions allow new properties to be added to existing domain objects. They act like maps, allowing the storage of arbitrary key/value pairs. All ExtensionAware Gradle domain objects intrinsically have an extension named “ext” of this type.</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">project.ext &#123;</span><br><span class="line">  myprop = <span class="string">"a"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">assert</span> project.myprop == <span class="string">"a"</span></span><br><span class="line"><span class="keyword">assert</span> project.ext.myprop == <span class="string">"a"</span></span><br><span class="line"></span><br><span class="line">project.myprop = <span class="string">"b"</span></span><br><span class="line"><span class="keyword">assert</span> project.myprop == <span class="string">"b"</span></span><br><span class="line"><span class="keyword">assert</span> project.ext.myprop == <span class="string">"b"</span></span><br></pre></td></tr></table></figure>

<p>In root <code>build.gradle</code>, <code>ext</code> adds extra property to <code>rootProject</code> object. There we can access <code>rootProject.ext</code> or just <code>ext</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ext &#123;</span><br><span class="line">  myLibraryVersion = <span class="string">'1.0.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In module <code>app/build.gradle</code>, <code>ext</code> adds extra property to <code>project</code> object. There we can access <code>project.ext</code> or just <code>ext</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ext &#123;</span><br><span class="line">  myLibraryVersion = <span class="string">'1.0.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-do-custom-presentation-with-UIViewPropertyAnimator-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-do-custom-presentation-with-UIViewPropertyAnimator-in-iOS/">How to do custom presentation with UIViewPropertyAnimator in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-do-custom-presentation-with-UIViewPropertyAnimator-in-iOS/" class="article-date">
	  <time datetime="2019-07-02T08:14:34.000Z" itemprop="datePublished">July 2, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/337" target="_blank" rel="noopener">#337</a></strong></p>
<p>Normally we just present from any <code>UIViewController</code> in any <code>UINavigationController</code> in <code>UITabBarController</code> and it will present over tabbar</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">present(detailViewController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>If we have animation with <code>UIViewPropertyAnimator</code>, then we can implement <a href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" target="_blank" rel="noopener">UIViewControllerAnimatedTransitioning</a> and <a href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning/1829434-interruptibleanimator" target="_blank" rel="noopener">interruptibleAnimator(using:)</a></p>
<blockquote>
<p>The methods in this protocol let you define an animator object, which creates the animations for transitioning a view controller on or off screen in a fixed amount of time. The animations you create using this protocol must not be interactive. To create interactive transitions, you must combine your animator object with another object that controls the timing of your animations.</p>
</blockquote>
<blockquote>
<p>Implement this method when you want to perform your transitions using an interruptible animator object, such as a UIViewPropertyAnimator object. You must return the same animator object for the duration of the transition.</p>
</blockquote>
<p>For more fine-grained control, we can have <a href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" target="_blank" rel="noopener">UIPresentationController</a></p>
<blockquote>
<p>From the time a view controller is presented until the time it is dismissed, UIKit uses a presentation controller to manage various aspects of the presentation process for that view controller. The presentation controller can add its own animations on top of those provided by animator objects, it can respond to size changes, and it can manage other aspects of how the view controller is presented onscreen.</p>
</blockquote>
<p>A lazy approach is to present without animation and do animation after</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">present(detailViewController, animated: <span class="literal">false</span>, completion: &#123;</span><br><span class="line">	<span class="keyword">let</span> animator = <span class="type">UIViewPropertyAnimator</span>()</span><br><span class="line">    animator.startAnimation()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>If we don’t want to involve <code>UIViewController</code> then we can work on <code>UIView</code> level. This way we can animate hiding tab bar. Any <code>UIViewController</code> within <code>UITabBarController</code> has <code>tabBarController</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animator = <span class="type">UIViewPropertyAnimator</span>()</span><br><span class="line">animator.addAnimations &#123;</span><br><span class="line">  <span class="keyword">self</span>.tabBarController?.tabBar.transform = <span class="type">CGAffineTransform</span>(translationX: <span class="number">0</span>, y: tabbar.frame.height)</span><br><span class="line">&#125;</span><br><span class="line">animator.startAnimation()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-show-dropdown-in-AppKit"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-show-dropdown-in-AppKit/">How to show dropdown in AppKit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-show-dropdown-in-AppKit/" class="article-date">
	  <time datetime="2019-06-29T17:37:25.000Z" itemprop="datePublished">June 29, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/336" target="_blank" rel="noopener">#336</a></strong></p>
<p>Use <a href="https://developer.apple.com/documentation/appkit/nspopupbutton" target="_blank" rel="noopener">NSPopUpButton</a></p>
<p><code>var pullsDown: Bool</code></p>
<blockquote>
<p>A Boolean value indicating whether the button displays a pull-down or pop-up menu.</p>
</blockquote>
<p><code>func addItem(withTitle: String)</code><br>Adds an item with the specified title to the end of the menu.</p>
<p>Should disable <code>pullsDown</code> if we want to set title automatically and not scale button for title</p>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/MenuList/Articles/ManagingPopUpItems.html" target="_blank" rel="noopener">Managing Pop-Up Buttons and Pull-Down Lists</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-scan-up-to-character-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-scan-up-to-character-in-Swift/">How to scan up to character in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-scan-up-to-character-in-Swift/" class="article-date">
	  <time datetime="2019-06-29T17:29:25.000Z" itemprop="datePublished">June 29, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/335" target="_blank" rel="noopener">#335</a></strong></p>
<p>This is useful when we want to get the first meaningful line in a big paragraph</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scanner = <span class="type">Scanner</span>(string: text)</span><br><span class="line"><span class="keyword">var</span> result: <span class="type">NSString?</span> = <span class="string">""</span></span><br><span class="line">scanner.scanUpTo(<span class="string">"\n"</span>, into: &amp;result)</span><br><span class="line"><span class="keyword">return</span> result <span class="keyword">as</span> <span class="type">String?</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-NSSecureCoding-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-NSSecureCoding-in-Swift/">How to use NSSecureCoding in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-NSSecureCoding-in-Swift/" class="article-date">
	  <time datetime="2019-06-29T17:19:34.000Z" itemprop="datePublished">June 29, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/334" target="_blank" rel="noopener">#334</a></strong></p>
<p><a href="https://developer.apple.com/documentation/foundation/nssecurecoding" target="_blank" rel="noopener">NSSecureCoding</a> has been around since iOS 6 and has had some API changes in iOS 12</p>
<blockquote>
<p>A protocol that enables encoding and decoding in a manner that is robust against object substitution attacks.</p>
</blockquote>
<p>The class must subclass from <code>NSObject</code> and conform to <code>NSSecureCoding</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Note</span>: <span class="title">NSObject</span>, <span class="title">NSSecureCoding</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> supportsSecureCoding: <span class="type">Bool</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">encode</span><span class="params">(with aCoder: NSCoder)</span></span> &#123;</span><br><span class="line">        aCoder.encode(id, forKey: <span class="string">"id"</span>)</span><br><span class="line">        aCoder.encode(text, forKey: <span class="string">"text"</span>)</span><br><span class="line">        aCoder.encode(date, forKey: <span class="string">"date"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> id = aDecoder.decodeObject(forKey: <span class="string">"id"</span>) <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">            <span class="keyword">let</span> text = aDecoder.decodeObject(forKey: <span class="string">"text"</span>) <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">            <span class="keyword">let</span> date = aDecoder.decodeObject(forKey: <span class="string">"date"</span>) <span class="keyword">as</span>? <span class="type">Date</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.id = id</span><br><span class="line">        <span class="keyword">self</span>.text = text</span><br><span class="line">        <span class="keyword">self</span>.date = date</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> text = <span class="string">"untitled"</span></span><br><span class="line">    <span class="keyword">var</span> date: <span class="type">Date</span> = <span class="type">Date</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        id = <span class="type">UUID</span>().uuidString</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>First, we need to serialize to Data, then use <a href="https://github.com/onmyway133/EasyStash" target="_blank" rel="noopener">EasyStash</a> for easy persistency</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">try</span> <span class="type">NSKeyedArchiver</span>.archivedData(</span><br><span class="line">        withRootObject: <span class="keyword">self</span>.notes,</span><br><span class="line">        requiringSecureCoding: <span class="literal">true</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">try</span> <span class="keyword">self</span>.storage.save(object: data, forKey: <span class="keyword">self</span>.key)</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then we can use <code>unarchiveTopLevelObjectWithData</code> to unarchive array</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> data: <span class="type">Data</span> = <span class="keyword">try</span> <span class="keyword">self</span>.storage.load(forKey: <span class="keyword">self</span>.key)</span><br><span class="line">    <span class="keyword">let</span> notes = <span class="keyword">try</span> <span class="type">NSKeyedUnarchiver</span>.unarchiveTopLevelObjectWithData(data) <span class="keyword">as</span>? [<span class="type">Note</span>]</span><br><span class="line">    <span class="comment">// notes is of type [Note]?</span></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-simplify-pager-interaction-with-Rx"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-simplify-pager-interaction-with-Rx/">How to simplify pager interaction with Rx</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-simplify-pager-interaction-with-Rx/" class="article-date">
	  <time datetime="2019-06-27T11:30:34.000Z" itemprop="datePublished">June 27, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/333" target="_blank" rel="noopener">#333</a></strong></p>
<p>In a traditional pager with many pages of content, and a bottom navigation with previous and next button. Each page may have different content, and depending on each state, may block the next button.</p>
<p>The state of next button should state in real time depending on state in each page content, and when user moves back and forth between pages, the state of next button should be reflected as well.</p>
<p>We might have</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">BottomNavigationDelegate</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">bottomNavigationCanGoNext</span><span class="params">(currentIndex: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">bottomNavigationDidMoveTo</span><span class="params">(index: Int)</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">PreferencePageDelegate</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">preferencePageDidSelect</span><span class="params">(itemCount: Int)</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">FormPageDelegate</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">formPageDidCheck</span><span class="params">(valid: Bool)</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">ConsentPageDelegate</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">consentPageDidAccept</span><span class="params">(agree: Bool)</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The indirect communications between each page, bottom navigation and ViewController get complicated and out of hands very quickly.</p>
<p>This is a perfect problem for Rx to solve. If we look closely, the state of next button is a derivative of current index, how many items selected in preferences, valid form and agreement status.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BottomNavigation</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PreferencePage</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> itemCount = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormPage</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> valid = <span class="type">PublishSubject</span>&lt;<span class="type">Bool</span>&gt;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConsentPage</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> agree = <span class="type">PublishSubject</span>&lt;<span class="type">Bool</span>&gt;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> canNext = <span class="type">Observable</span></span><br><span class="line">  .combineLatest(bottomNavigation.index, preferencePage.itemCount, formPage.valid, consentPage.agree)</span><br><span class="line">  .<span class="built_in">map</span>(&#123; (index, itemCount, valid, agree) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">    <span class="comment">// Logic goes here to reduce, for example</span></span><br><span class="line">    <span class="keyword">switch</span> index &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> itemCount &gt; <span class="number">2</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">return</span> valid</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>: <span class="type">Return</span> agree</span><br><span class="line">      <span class="keyword">default</span>: <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-moveItem-in-NSCollectionView-in-AppKit"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-moveItem-in-NSCollectionView-in-AppKit/">How to use moveItem in NSCollectionView in AppKit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-moveItem-in-NSCollectionView-in-AppKit/" class="article-date">
	  <time datetime="2019-06-27T07:15:08.000Z" itemprop="datePublished">June 27, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/332" target="_blank" rel="noopener">#332</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/appkit/nscollectionview/1528159-moveitem" target="_blank" rel="noopener">moveItem(at:to:)</a></p>
<blockquote>
<p>Moves an item from one location to another in the collection view.</p>
</blockquote>
<blockquote>
<p>After rearranging items in your data source object, use this method to synchronize those changes with the collection view. Calling this method lets the collection view know that it must update its internal data structures and possibly update its visual appearance. You can move the item to a different section or to a new location in the same section. The collection view updates the layout as needed to account for the move, animating cells into position in response.</p>
</blockquote>
<blockquote>
<p>When inserting or deleting multiple sections and items, you can animate all of your changes at once using the performBatchUpdates(_:completionHandler:) method.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">notes.swapAt(index, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">collectionView.animator().moveItem(</span><br><span class="line">    at: index.toIndexPath(),</span><br><span class="line">    to: <span class="number">0</span>.toIndexPath()</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>There may be unknown reasons or bug that make other cells stay in incorrect state. The fix is to reload the rest cells</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">set</span> = <span class="type">Set</span>((<span class="number">1</span>..&lt;notes.<span class="built_in">count</span>).<span class="built_in">map</span>(&#123; $<span class="number">0</span>.toIndexPath() &#125;))</span><br><span class="line">collectionView.reloadItems(at: <span class="keyword">set</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-show-dropdown-from-NSSegmentedControl-in-AppKit"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-show-dropdown-from-NSSegmentedControl-in-AppKit/">How to show dropdown from NSSegmentedControl in AppKit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-show-dropdown-from-NSSegmentedControl-in-AppKit/" class="article-date">
	  <time datetime="2019-06-27T07:04:13.000Z" itemprop="datePublished">June 27, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/331" target="_blank" rel="noopener">#331</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/appkit/nssegmentedcontrol?language=objc" target="_blank" rel="noopener">NSSegmentedControl</a></p>
<blockquote>
<p>The features of a segmented control include the following:<br>A segment can have an image, text (label), menu, tooltip, and tag.<br>A segmented control can contain images or text, but not both.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> languageMenu = <span class="type">NSMenu</span>(title: <span class="string">""</span>)</span><br><span class="line"><span class="keyword">let</span> languages = [<span class="string">"Swift"</span>, <span class="string">"Javascript"</span>]</span><br><span class="line">languages.forEach &#123;</span><br><span class="line">    <span class="keyword">let</span> item = <span class="type">NSMenuItem</span>(title: $<span class="number">0</span>, action: #selector(handleSelectLanguage(<span class="number">_</span>:)), keyEquivalent: <span class="string">""</span>)</span><br><span class="line">    item.target = <span class="keyword">self</span></span><br><span class="line">    item.isEnabled = <span class="literal">true</span></span><br><span class="line">    languageMenu.addItem(item)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> themeMenu = <span class="type">NSMenu</span>(title: <span class="string">""</span>)</span><br><span class="line"><span class="keyword">let</span> themes = [<span class="string">"one dark"</span>, <span class="string">"one light"</span>]</span><br><span class="line">themes.forEach &#123;</span><br><span class="line">    <span class="keyword">let</span> item = <span class="type">NSMenuItem</span>(title: $<span class="number">0</span>, action: #selector(handleSelectLanguage(<span class="number">_</span>:)), keyEquivalent: <span class="string">""</span>)</span><br><span class="line">    item.target = <span class="keyword">self</span></span><br><span class="line">    item.isEnabled = <span class="literal">true</span></span><br><span class="line">    themeMenu.addItem(item)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">segment.segmentCount = <span class="number">2</span></span><br><span class="line">segment.selectedSegmentBezelColor = <span class="type">NSColor</span>.red</span><br><span class="line"></span><br><span class="line">segment.setLabel(<span class="string">"Language"</span>, forSegment: <span class="number">0</span>)</span><br><span class="line">segment.setLabel(<span class="string">"Theme"</span>, forSegment: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">segment.setMenu(languageMenu, forSegment: <span class="number">0</span>)</span><br><span class="line">segment.setMenu(themeMenu, forSegment: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">segment.showsMenuIndicator(forSegment: <span class="number">0</span>)</span><br><span class="line">segment.showsMenuIndicator(forSegment: <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-scrollable-NSTextView-in-AppKit"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-scrollable-NSTextView-in-AppKit/">How to make scrollable NSTextView in AppKit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-scrollable-NSTextView-in-AppKit/" class="article-date">
	  <time datetime="2019-06-26T18:07:38.000Z" itemprop="datePublished">June 26, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/330" target="_blank" rel="noopener">#330</a></strong></p>
<p>When adding <code>NSTextView</code> in xib, we see it is embedded under <code>NSClipView</code>. But if we try to use <code>NSClipView</code> to replicate what’s in the xib, it does not scroll. </p>
<p>To make it work, we can follow <a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/TextUILayer/Tasks/TextInScrollView.html" target="_blank" rel="noopener">Putting an NSTextView Object in an NSScrollView</a> and <a href="https://github.com/onmyway133/blog/issues/173" target="_blank" rel="noopener">How to make scrollable vertical NSStackView</a> to make our <code>ScrollableInput</code></p>
<p>For easy Auto Layout, we use <a href="https://github.com/onmyway133/Anchors" target="_blank" rel="noopener">Anchors</a> for <code>UIScrollView</code>. </p>
<p>Things worth mentioned for vertical scrolling</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">textContainer.heightTracksTextView = <span class="literal">false</span></span><br><span class="line">textView.autoresizingMask = [.width]</span><br><span class="line">textView.isVerticallyResizable = <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScrollableInput</span>: <span class="title">NSView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> scrollView = <span class="type">NSScrollView</span>()</span><br><span class="line">    <span class="keyword">let</span> textView = <span class="type">NSTextView</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame frameRect: <span class="type">NSRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frameRect)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> rect = <span class="type">CGRect</span>(</span><br><span class="line">            x: <span class="number">0</span>, y: <span class="number">0</span>,</span><br><span class="line">            width: <span class="number">0</span>, height: <span class="type">CGFloat</span>.greatestFiniteMagnitude</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> layoutManager = <span class="type">NSLayoutManager</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> textContainer = <span class="type">NSTextContainer</span>(size: rect.size)</span><br><span class="line">        layoutManager.addTextContainer(textContainer)</span><br><span class="line">        textView = <span class="type">NSTextView</span>(frame: rect, textContainer: textContainer)</span><br><span class="line">        textView.maxSize = <span class="type">NSSize</span>(width: <span class="number">0</span>, height: <span class="type">CGFloat</span>.greatestFiniteMagnitude)</span><br><span class="line"></span><br><span class="line">        textContainer.heightTracksTextView = <span class="literal">false</span></span><br><span class="line">        textContainer.widthTracksTextView = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">        textView.isRichText = <span class="literal">false</span></span><br><span class="line">        textView.importsGraphics = <span class="literal">false</span></span><br><span class="line">        textView.isEditable = <span class="literal">true</span></span><br><span class="line">        textView.isSelectable = <span class="literal">true</span></span><br><span class="line">        textView.font = <span class="type">R</span>.font.text</span><br><span class="line">        textView.textColor = <span class="type">R</span>.color.text</span><br><span class="line">        textView.isVerticallyResizable = <span class="literal">true</span></span><br><span class="line">        textView.isHorizontallyResizable = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">        addSubview(scrollView)</span><br><span class="line">        scrollView.hasVerticalScroller = <span class="literal">true</span></span><br><span class="line">        scrollView.drawsBackground = <span class="literal">false</span></span><br><span class="line">        scrollView.drawsBackground = <span class="literal">false</span></span><br><span class="line">        textView.drawsBackground = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">        activate(</span><br><span class="line">            scrollView.anchor.edges</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        scrollView.documentView = textView</span><br><span class="line">        textView.autoresizingMask = [.width]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder decoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/">How to handle keyboard for UITextField in scrolling UIStackView in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/" class="article-date">
	  <time datetime="2019-06-26T08:36:04.000Z" itemprop="datePublished">June 26, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/329" target="_blank" rel="noopener">#329</a></strong></p>
<p>Firstly, to make UIStackView scrollable, embed it inside UIScrollView. Read <a href="https://github.com/onmyway133/blog/issues/324" target="_blank" rel="noopener">How to embed UIStackView inside UIScrollView in iOS</a></p>
<p>It’s best to listen to <code>keyboardWillChangeFrameNotification</code> as it contains frame changes for Keyboard in different situation like custom keyboard, languages.</p>
<blockquote>
<p>Posted immediately prior to a change in the keyboard’s frame.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeyboardHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> scrollView: <span class="type">UIScrollView</span></span><br><span class="line">    <span class="keyword">let</span> stackView: <span class="type">UIStackView</span></span><br><span class="line">    <span class="keyword">var</span> observer: <span class="type">AnyObject?</span></span><br><span class="line">    <span class="keyword">var</span> keyboardHeightConstraint: <span class="type">NSLayoutConstraint!</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Info</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> frame: <span class="type">CGRect</span></span><br><span class="line">        <span class="keyword">let</span> duration: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(scrollView: <span class="type">UIScrollView</span>, stackView: <span class="type">UIStackView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.scrollView = scrollView</span><br><span class="line">        <span class="keyword">self</span>.stackView = stackView</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To make scrollView scroll beyond its <code>contentSize</code>, we can change its <code>contentInset.bottom</code>. Another way is to add a dummy view with certain height to <code>UIStackView</code> and alter its <code>NSLayoutConstraint</code> <code>constant</code></p>
<p>We can’t access <code>self</code> inside init, so it’s best to have setup function</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> space = <span class="type">UIView</span>()</span><br><span class="line">    keyboardHeightConstraint = space.heightAnchor.constraint(equalToConstant: <span class="number">0</span>)</span><br><span class="line">    <span class="type">NSLayoutConstraint</span>.on([keyboardHeightConstraint])</span><br><span class="line">    stackView.addArrangedSubview(spa</span><br><span class="line">    observer = <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">        forName: <span class="type">UIResponder</span>.keyboardWillChangeFrameNotification,</span><br><span class="line">        object: <span class="literal">nil</span>,</span><br><span class="line">        queue: .main,</span><br><span class="line">        using: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] notification <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>?.handle(notification)</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Convert <code>Notification</code> to a convenient <code>Info</code> struct</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">convert</span><span class="params">(notification: Notification)</span></span> -&gt; <span class="type">Info?</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span></span><br><span class="line">        <span class="keyword">let</span> frameValue = notification.userInfo?[<span class="type">UIResponder</span>.keyboardFrameEndUserInfoKey] <span class="type">NSValue</span>,</span><br><span class="line">        <span class="keyword">let</span> durationotification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationDurationUserInfoKey] <span class="keyword">as</span>? <span class="type">NSNumber</span>,</span><br><span class="line">        <span class="keyword">let</span> raw = notification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationCurveUserInfoKey] <span class="type">NSNumber</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="type">Info</span>(</span><br><span class="line">        frame: frameValue.cgRectValue,</span><br><span class="line">        duration: duration.doubleValue,</span><br><span class="line">        animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span>(rawValue: raw.uintValue)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then we can compare with UIScreen to check if Keyboard is showing or hiding</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> notification: Notification)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> info = convert(notification: notification) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">let</span> isHiding = info.frame.origin.y == <span class="type">UIScreen</span>.main.bounds.height</span><br><span class="line">    keyboardHeightConstraint.constant = isHiding ? <span class="number">0</span> : info.frame.hei</span><br><span class="line">    <span class="type">UIView</span>.animate(</span><br><span class="line">        withDuration: info.duration,</span><br><span class="line">        delay: <span class="number">0</span>,</span><br><span class="line">        options: info.animationOptions,</span><br><span class="line">        animations: &#123;</span><br><span class="line">            <span class="keyword">self</span>.scrollView.layoutIfNeeded()</span><br><span class="line">            <span class="keyword">self</span>.moveTextFieldIfNeeded(info: info)</span><br><span class="line">    &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To move <code>UITextField</code> we can use <a href="https://developer.apple.com/documentation/uikit/uiscrollview/1619439-scrollrecttovisible" target="_blank" rel="noopener"><code>scrollRectToVisible(_:animated:)</code></a> but we have little control over how much we want to scroll</p>
<blockquote>
<p>This method scrolls the content view so that the area defined by rect is just visible inside the scroll view. If the area is already visible, the method does nothing.</p>
</blockquote>
<p>Another way is to check if keyboard overlaps <code>UITextField</code>. To do that we use <a href="https://developer.apple.com/documentation/uikit/uiview/1622504-convertrect" target="_blank" rel="noopener"><code>convertRect:toView:</code></a> with <code>nil</code> target so it uses window coordinates. Since keyboard frame is always relative to window, we have frames in same coordinate space.</p>
<blockquote>
<p>Converts a rectangle from the receiver’s coordinate system to that of another view.</p>
</blockquote>
<blockquote>
<p>rect: A rectangle specified in the local coordinate system (bounds) of the receiver.<br>view: The view that is the target of the conversion operation. If view is nil, this method instead converts to window base coordinates. Otherwise, both view and the receiver must belong to the same UIWindow object.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">moveTextFieldIfNeeded</span><span class="params">(info: Info)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> input = stackView.arrangedSubviews</span><br><span class="line">        .compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UITextField</span> &#125;)</span><br><span class="line">        .first(<span class="keyword">where</span>: &#123; $<span class="number">0</span>.isFirstResponder &#125;)</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">let</span> inputFrame = input.convert(input.bounds, to: <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">if</span> inputFrame.intersects(info.frame) &#123;</span><br><span class="line">        scrollView.setContentOffset(<span class="type">CGPoint</span>(x: <span class="number">0</span>, y: inputFrame.height), animated: <span class="literal">true</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        scrollView.setContentOffset(.zero, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Move-up-the-entire-view"><a href="#Move-up-the-entire-view" class="headerlink" title="Move up the entire view"></a>Move up the entire view</h3><p>For simplicity, we can move up the entire view</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">move</span><span class="params">(info: Info)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> isHiding = info.frame.origin.y == <span class="type">UIScreen</span>.main.bounds.height</span><br><span class="line">    <span class="keyword">let</span> moveUp = <span class="type">CGAffineTransform</span>(translationX: <span class="number">0</span>, y: -info.frame.height)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (view.transform, isHiding) &#123;</span><br><span class="line">    <span class="keyword">case</span> (.identity, <span class="literal">false</span>):</span><br><span class="line">        view.transform = moveUp</span><br><span class="line">    <span class="keyword">case</span> (moveUp, <span class="literal">true</span>):</span><br><span class="line">        view.transform = .identity</span><br><span class="line">     <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Prefer-willShow-and-willHide"><a href="#Prefer-willShow-and-willHide" class="headerlink" title="Prefer willShow and willHide"></a>Prefer willShow and willHide</h3><p>There ‘s an edge case with the above switch on <code>view.transform</code> and <code>isHiding</code> with one time verification sms code, which make it into the correct <code>case</code> handling. It’s safe to just set view.transform depending on <code>show</code> with <code>willHide</code> and <code>willShow</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeyboardHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> view: <span class="type">UIView</span></span><br><span class="line">    <span class="keyword">var</span> observerForWillShow: <span class="type">AnyObject?</span></span><br><span class="line">    <span class="keyword">var</span> observerForWillHide: <span class="type">AnyObject?</span></span><br><span class="line">    <span class="keyword">var</span> keyboardHeightConstraint: <span class="type">NSLayoutConstraint!</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Info</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> frame: <span class="type">CGRect</span></span><br><span class="line">        <span class="keyword">let</span> duration: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">init</span>(view: <span class="type">UIView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.view = view</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        observerForWillShow = <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">            forName: <span class="type">UIResponder</span>.keyboardWillShowNotification,</span><br><span class="line">            object: <span class="literal">nil</span>,</span><br><span class="line">            queue: .main,</span><br><span class="line">            using: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] notification <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>?.handle(notification, show: <span class="literal">true</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        observerForWillHide = <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">            forName: <span class="type">UIResponder</span>.keyboardWillHideNotification,</span><br><span class="line">            object: <span class="literal">nil</span>,</span><br><span class="line">            queue: .main,</span><br><span class="line">            using: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] notification <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>?.handle(notification, show: <span class="literal">false</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> notification: Notification, show: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> info = convert(notification: notification) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">UIView</span>.animate(</span><br><span class="line">            withDuration: info.duration,</span><br><span class="line">            delay: <span class="number">0</span>,</span><br><span class="line">            options: info.animationOptions,</span><br><span class="line">            animations: &#123;</span><br><span class="line">				<span class="keyword">self</span>.move(info: info, show: show)</span><br><span class="line">        &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">move</span><span class="params">(info: Info, show: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> moveUp = <span class="type">CGAffineTransform</span>(translationX: <span class="number">0</span>, y: -info.frame.height)</span><br><span class="line">        <span class="keyword">if</span> show &#123;</span><br><span class="line">            view.transform = moveUp</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            view.transform = .identity</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">convert</span><span class="params">(notification: Notification)</span></span> -&gt; <span class="type">Info?</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> frameValue = notification.userInfo?[<span class="type">UIResponder</span>.keyboardFrameEndUserInfoKey] <span class="keyword">as</span>? <span class="type">NSValue</span>,</span><br><span class="line">            <span class="keyword">let</span> duration = notification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationDurationUserInfoKey] <span class="keyword">as</span>? <span class="type">NSNumber</span>,</span><br><span class="line">            <span class="keyword">let</span> raw = notification.userInfo?[<span class="type">UIResponder</span>.keyboardAnimationCurveUserInfoKey] <span class="keyword">as</span>? <span class="type">NSNumber</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">Info</span>(</span><br><span class="line">            frame: frameValue.cgRectValue,</span><br><span class="line">            duration: duration.doubleValue,</span><br><span class="line">            animationOptions: <span class="type">UIView</span>.<span class="type">AnimationOptions</span>(rawValue: raw.uintValue)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://developer.apple.com/library/archive/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html#//apple_ref/doc/uid/TP40009542-CH5-SW16" target="_blank" rel="noopener">Managing the Keyboard</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-simple-form-validator-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-simple-form-validator-in-Swift/">How to make simple form validator in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-simple-form-validator-in-Swift/" class="article-date">
	  <time datetime="2019-06-25T12:05:08.000Z" itemprop="datePublished">June 25, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/328" target="_blank" rel="noopener">#328</a></strong></p>
<p>Sometimes we want to validate forms with many fields, for example name, phone, email, and with different rules. If validation fails, we show error message.</p>
<p>We can make simple <code>Validator</code> and <code>Rule</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Validator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">validate</span><span class="params">(text: String, with rules: [Rule])</span></span> -&gt; <span class="type">String?</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> rules.compactMap(&#123; $<span class="number">0</span>.check(text) &#125;).first</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">validate</span><span class="params">(input: InputView, with rules: [Rule])</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> message = validate(text: input.textField.text ?? <span class="string">""</span>, with: rules) <span class="keyword">else</span> &#123;</span><br><span class="line">            input.messageLabel.isHidden = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        input.messageLabel.isHidden = <span class="literal">false</span></span><br><span class="line">        input.messageLabel.text = message</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rule</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Return nil if matches, error message otherwise</span></span><br><span class="line">    <span class="keyword">let</span> check: (<span class="type">String</span>) -&gt; <span class="type">String?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> notEmpty = <span class="type">Rule</span>(check: &#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="number">0</span>.isEmpty ? <span class="string">"Must not be empty"</span> : <span class="literal">nil</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> validEmail = <span class="type">Rule</span>(check: &#123;</span><br><span class="line">        <span class="keyword">let</span> regex = #<span class="string">"[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]&#123;2,64&#125;"</span>#</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> predicate = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, regex)</span><br><span class="line">        <span class="keyword">return</span> predicate.evaluate(with: $<span class="number">0</span>) ? <span class="literal">nil</span> : <span class="string">"Must have valid email"</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> countryCode = <span class="type">Rule</span>(check: &#123;</span><br><span class="line">        <span class="keyword">let</span> regex = #<span class="string">"^\+\d+.*"</span>#</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> predicate = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, regex)</span><br><span class="line">        <span class="keyword">return</span> predicate.evaluate(with: $<span class="number">0</span>) ? <span class="literal">nil</span> : <span class="string">"Must have prefix country code"</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then we can use very expressively</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> validator = <span class="type">Validator</span>()</span><br><span class="line">validator.validate(input: inputView, with: [.notEmpty, .validEmail])</span><br></pre></td></tr></table></figure>

<p>Then a few tests to make sure it works</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ValidatorTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> validator = <span class="type">Validator</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testEmpty</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="type">XCTAssertNil</span>(validator.validate(text: <span class="string">"a"</span>, with: [.notEmpty]))</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(validator.validate(text: <span class="string">""</span>, with: [.notEmpty]))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testEmail</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="type">XCTAssertNil</span>(validator.validate(text: <span class="string">"onmyway133@gmail.com"</span>, with: [.validEmail]))</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(validator.validate(text: <span class="string">"onmyway133"</span>, with: [.validEmail]))</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(validator.validate(text: <span class="string">"onmyway133.com"</span>, with: [.validEmail]))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testCountryCode</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="type">XCTAssertNil</span>(validator.validate(text: <span class="string">"+47 11 222 333"</span>, with: [.countryCode]))</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(validator.validate(text: <span class="string">"11 222 333"</span>, with: [.countryCode]))</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(validator.validate(text: <span class="string">"47 11 222 333"</span>, with: [.countryCode]))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="allSatisfy"><a href="#allSatisfy" class="headerlink" title="allSatisfy"></a>allSatisfy</h2><p>To check if all rules are ok, we can use reduce</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">check</span><span class="params">(text: String, with rules: [Rule])</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> rules.allSatisfy(&#123; $<span class="number">0</span>.check(text).isOk &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Or more concisely, use <code>allSatisfy</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">check</span><span class="params">(text: String, with rules: [Rule])</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> rules.allSatisfy(&#123; $<span class="number">0</span>.check(text).isOk &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/7/">Next</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div class="widget-wrap" style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 75%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 42px;" placeholder=" Search…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="Search">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Ohayou</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
          
     			  <li><a href="https://github.com/onmyway133" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="https://twitter.com/onmyway133" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 
          
   		
          
            <li><a href="mailto:onmyway133@gmail.com?subject=Hello&body=World" title="email"><i class="fa fa-envelope" aria-hidden="true"></i></a></li> 
          
   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>Recent Posts</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/Links-for-tools/">Links for tools</a></h6>
              <span>November 15, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-make-full-width-list-row-in-SwiftUI/">How to make full width list row in SwiftUI</a></h6>
              <span>November 14, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-make-full-screen-TabView-in-SwiftUI/">How to make full screen TabView in SwiftUI</a></h6>
              <span>November 14, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-map-error-in-Combine/">How to map error in Combine</a></h6>
              <span>November 14, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-fix-unable-to-infer-complex-closure-return-type-in-SwiftUI/">How to fix unable to infer complex closure return type in SwiftUI</a></h6>
              <span>November 13, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-make-Swift-Package-Manager-package-for-multiple-platforms/">How to make Swift Package Manager package for multiple platforms</a></h6>
              <span>November 13, 2019</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/accessibility/" style="font-size: 10px;">accessibility</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/android/" style="font-size: 17.65px;">android</a> <a href="/tags/apple-script/" style="font-size: 11.18px;">apple script</a> <a href="/tags/catalyst/" style="font-size: 10.59px;">catalyst</a> <a href="/tags/ci/" style="font-size: 11.18px;">ci</a> <a href="/tags/cloud/" style="font-size: 10.59px;">cloud</a> <a href="/tags/cocoapods/" style="font-size: 11.76px;">cocoapods</a> <a href="/tags/combine/" style="font-size: 10.59px;">combine</a> <a href="/tags/csharp/" style="font-size: 10px;">csharp</a> <a href="/tags/css/" style="font-size: 10.59px;">css</a> <a href="/tags/dart/" style="font-size: 11.76px;">dart</a> <a href="/tags/database/" style="font-size: 10.59px;">database</a> <a href="/tags/design/" style="font-size: 10.59px;">design</a> <a href="/tags/electron/" style="font-size: 11.76px;">electron</a> <a href="/tags/firebase/" style="font-size: 11.76px;">firebase</a> <a href="/tags/flutter/" style="font-size: 11.76px;">flutter</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 11.76px;">github</a> <a href="/tags/go/" style="font-size: 10.59px;">go</a> <a href="/tags/google/" style="font-size: 10px;">google</a> <a href="/tags/iOS/" style="font-size: 19.41px;">iOS</a> <a href="/tags/javascript/" style="font-size: 18.24px;">javascript</a> <a href="/tags/kotlin/" style="font-size: 17.06px;">kotlin</a> <a href="/tags/layout/" style="font-size: 11.76px;">layout</a> <a href="/tags/life/" style="font-size: 13.53px;">life</a> <a href="/tags/links/" style="font-size: 14.71px;">links</a> <a href="/tags/macOS/" style="font-size: 18.82px;">macOS</a> <a href="/tags/machine-learning/" style="font-size: 10.59px;">machine learning</a> <a href="/tags/maps/" style="font-size: 11.76px;">maps</a> <a href="/tags/networking/" style="font-size: 10px;">networking</a> <a href="/tags/node/" style="font-size: 12.94px;">node</a> <a href="/tags/objc/" style="font-size: 10.59px;">objc</a> <a href="/tags/push-notification/" style="font-size: 10px;">push notification</a> <a href="/tags/react/" style="font-size: 11.18px;">react</a> <a href="/tags/react-native/" style="font-size: 15.29px;">react native</a> <a href="/tags/realm/" style="font-size: 10px;">realm</a> <a href="/tags/rx/" style="font-size: 11.18px;">rx</a> <a href="/tags/script/" style="font-size: 10.59px;">script</a> <a href="/tags/spm/" style="font-size: 10px;">spm</a> <a href="/tags/swift/" style="font-size: 20px;">swift</a> <a href="/tags/swiftUI/" style="font-size: 16.47px;">swiftUI</a> <a href="/tags/tech/" style="font-size: 15.88px;">tech</a> <a href="/tags/terminal/" style="font-size: 10.59px;">terminal</a> <a href="/tags/testing/" style="font-size: 12.35px;">testing</a> <a href="/tags/unity/" style="font-size: 10px;">unity</a> <a href="/tags/voip/" style="font-size: 11.76px;">voip</a> <a href="/tags/watchOS/" style="font-size: 12.94px;">watchOS</a> <a href="/tags/web/" style="font-size: 10.59px;">web</a> <a href="/tags/wwdc/" style="font-size: 10.59px;">wwdc</a> <a href="/tags/xcode/" style="font-size: 14.12px;">xcode</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">26</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">49</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">50</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">46</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">24</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/accessibility/">accessibility</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">34</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apple-script/">apple script</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/catalyst/">catalyst</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ci/">ci</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/">cloud</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cocoapods/">cocoapods</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/combine/">combine</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/">csharp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dart/">dart</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/">electron</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firebase/">firebase</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flutter/">flutter</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google/">google</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a><span class="tag-list-count">135</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">36</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kotlin/">kotlin</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/layout/">layout</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/links/">links</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macOS/">macOS</a><span class="tag-list-count">68</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/">machine learning</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maps/">maps</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/networking/">networking</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/objc/">objc</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/push-notification/">push notification</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react-native/">react native</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/realm/">realm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rx/">rx</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/script/">script</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spm/">spm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swift/">swift</a><span class="tag-list-count">184</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swiftUI/">swiftUI</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/">tech</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/terminal/">terminal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/testing/">testing</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unity/">unity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/voip/">voip</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/watchOS/">watchOS</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wwdc/">wwdc</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xcode/">xcode</a><span class="tag-list-count">11</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 onmyway133 All Rights Reserved.
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about/" class="mobile-nav-link">About</a>
  
    <a href="/writing/" class="mobile-nav-link">Writing</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/speaking/" class="mobile-nav-link">Speaking</a>
  
    <a href="/opensource/" class="mobile-nav-link">Open Source</a>
  
    <a href="/projects/" class="mobile-nav-link">Projects</a>
  
    <a href="/news/" class="mobile-nav-link">News</a>
  
    <a href="/gumroad/" class="mobile-nav-link">Gumroad</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-40119591-5', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->












  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
