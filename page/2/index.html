<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-11-01T03:57:11.000Z" title="2020-11-01T03:57:11.000Z">2020-11-01</time><span class="level-item">2 minutes read (About 236 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-override-styles-in-SwiftUI/">How to override styles in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/688">#688</a></strong></p>
<p>In the app I’m working on <a href="https://onmyway133.com/elegantconverter/">Elegant Converter</a>, I usually like preset theme with a custom background color and a matching foreground color.</p>
<p>Thanks to SwiftUI style cascading, I can just declare in root <code>MainView</code> and it will be inherited down the view hierachy.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HSplitView</span> &#123;</span><br><span class="line">            <span class="type">ListView</span>()</span><br><span class="line">            <span class="type">RightView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        .foregroundColor(<span class="type">R</span>.color.text)</span><br><span class="line">        .background(<span class="type">R</span>.color.background)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This works great regardless of system light or dark mode, but in light mode it does not look good, as my designed theme is similar to dark mode. Here the color is pale for default Picker and Button.</p>
<img width="665" alt="Screenshot 2020-10-31 at 06 49 55" src="https://user-images.githubusercontent.com/2284279/97772225-4b99dc00-1b45-11eb-821f-7797e39d1da6.png">

<p>The way to fix that is to reset the <code>foregroundColor</code>, take a look at the documentation for <a href="https://developer.apple.com/documentation/swiftui/view/foregroundcolor(_:)">foregroundColor</a></p>
<blockquote>
<p>The foreground color to use when displaying this view. Pass nil to remove any custom foreground color and to allow the system or the container to provide its own foreground color. If a container-specific override doesn’t exist, the system uses the primary color.</p>
</blockquote>
<p>So we can pass <code>nil</code> and the controls will pick the correct color based on system preferences.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Picker</span>(selection: intent.fileType, label: <span class="type">EmptyView</span>()) &#123;</span><br><span class="line">    <span class="type">ForEach</span>(filtered, id: \.<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="type">Text</span>($<span class="number">0</span>.dropdownName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">.foregroundColor(<span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="type">Button</span>(action: convert) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Convert"</span>)</span><br><span class="line">&#125;</span><br><span class="line">.foregroundColor(<span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>Now Picker and Button look nice in both dark and light mode</p>
<img width="613" alt="Screenshot 2020-10-31 at 06 52 53" src="https://user-images.githubusercontent.com/2284279/97772260-b5b28100-1b45-11eb-8a24-367fef910ce3.png">

<img width="601" alt="Screenshot 2020-10-31 at 06 53 10" src="https://user-images.githubusercontent.com/2284279/97772265-c06d1600-1b45-11eb-88c9-340b045ba815.png">

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-27T08:56:38.000Z" title="2020-10-27T08:56:38.000Z">2020-10-27</time><span class="level-item">a few seconds read (About 94 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/When-to-use-function-vs-property-in-Swift/">When to use function vs property in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/687">#687</a></strong></p>
<p>Although I do Swift, I often follow Kotlin guideline <a href="https://kotlinlang.org/docs/reference/coding-conventions.html#functions-vs-properties">https://kotlinlang.org/docs/reference/coding-conventions.html#functions-vs-properties</a></p>
<p>In some cases functions with no arguments might be interchangeable with read-only properties. Although the semantics are similar, there are some stylistic conventions on when to prefer one to another.</p>
<p>Prefer a property over a function when the underlying algorithm:</p>
<ul>
<li>does not throw</li>
<li>is cheap to calculate (or cached on the first run)</li>
<li>returns the same result over invocations if the object state hasn’t changed</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-25T19:58:07.000Z" title="2020-10-25T19:58:07.000Z">2020-10-25</time><span class="level-item">2 minutes read (About 285 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-CoreData-safely/">How to use CoreData safely</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/686">#686</a></strong></p>
<p>I now use Core Data more often now. Here is how I usually use it, for example in <a href="https://onmyway133.com/pushhero/">Push Hero</a></p>
<p>From iOS 10 and macOS 10.12, <a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer">NSPersistentContainer</a> that simplifies Core Data setup quite a lot. I usually use 1 <code>NSPersistentContainer</code> and its <code>viewContext</code> together with <code>newBackgroundContext</code> attached to that <code>NSPersistentContainer</code></p>
<p>In Core Data, each context has a queue, except for <code>viewContext</code> using the <code>DispatchQueue.main</code>, and each <code>NSManagedObject</code> retrieved from 1 context is supposed to use within that context queue only, except for <code>objectId</code> property.</p>
<p>Although <code>NSManagedObject</code> subclasses from <code>NSObject</code>, it has a lot of other constraints that we need to be aware of. So it’s safe to treat Core Data as a cache layer, and use our own model on top of it. I usually perform operations on background context to avoid main thread blocking, and <code>automaticallyMergesChangesFromParent</code> handles merge changes automatically for us.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">SendHistoryItem</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toCoreData</span><span class="params">(context: NSManagedObjectContext)</span></span> &#123;</span><br><span class="line">        context.perform &#123;</span><br><span class="line">            <span class="keyword">let</span> cd = <span class="type">CDSendHistoryItem</span>(context: context)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CDSendHistoryItem</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toModel</span><span class="params">()</span></span> <span class="keyword">throws</span> -&gt; <span class="type">SendHistoryItem</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CoreDataManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> backgroundContext: <span class="type">NSManagedObjectContext?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.backgroundContext = <span class="keyword">self</span>.persistentContainer.newBackgroundContext()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> persistentContainer: <span class="type">NSPersistentContainer</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> container = <span class="type">NSPersistentContainer</span>(name: <span class="string">"PushHero"</span>)</span><br><span class="line">        container.loadPersistentStores(completionHandler: &#123; (storeDescription, error) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">                <span class="built_in">print</span>(error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> container</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">load</span><span class="params">(request: NSFetchRequest&lt;CDSendHistoryItem&gt;, completion: @escaping <span class="params">([SendHistoryItem])</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> context = <span class="type">CoreDataManager</span>.shared.backgroundContext <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">        context.perform &#123;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> cdItems = <span class="keyword">try</span> request.execute()</span><br><span class="line">                <span class="keyword">let</span> items = cdItems.compactMap(&#123; <span class="keyword">try</span>? $<span class="number">0</span>.toModel() &#125;)</span><br><span class="line">                completion(items)</span><br><span class="line">            &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                completion([])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">save</span><span class="params">(items: [SendHistoryItem])</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> context = backgroundContext <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        context.perform &#123;</span><br><span class="line">            items.forEach &#123;</span><br><span class="line">                <span class="keyword">let</span> <span class="number">_</span> = $<span class="number">0</span>.toCoreData(context: context)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> context.save()</span><br><span class="line">            &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://davedelong.com/blog/2018/05/09/the-laws-of-core-data/">https://davedelong.com/blog/2018/05/09/the-laws-of-core-data/</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-24T02:45:15.000Z" title="2020-10-24T02:45:15.000Z">2020-10-24</time><span class="level-item">a few seconds read (About 71 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-pass-ObservedObject-as-parameter-in-SwiftUI/">How to pass ObservedObject as parameter in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/685">#685</a></strong></p>
<p>Since we have custom init in <code>ChildView</code> to manually set a <code>State</code>, we need to pass <code>ObservedObject</code>. In the ParentView, use underscore <code>_</code> to access property wrapper type.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ChildView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">ObservedObject</span></span><br><span class="line">    <span class="keyword">var</span> store: <span class="type">Store</span></span><br><span class="line"></span><br><span class="line">    @<span class="type">State</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> selectedTask: <span class="type">AnyTask</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(store: <span class="type">ObservedObject</span>&lt;<span class="type">Store</span>&gt;) &#123;</span><br><span class="line">        _selectedTask = <span class="type">State</span>(initialValue: tasks.first!)</span><br><span class="line">        _store = store</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ParentView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">ObservedObject</span></span><br><span class="line">    <span class="keyword">var</span> store: <span class="type">Store</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ChildView</span>(store: _store)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-23T06:17:08.000Z" title="2020-10-23T06:17:08.000Z">2020-10-23</time><span class="level-item">a few seconds read (About 70 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-do-equal-width-in-SwiftUI/">How to do equal width in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/684">#684</a></strong></p>
<p>In SwiftUI, specifying <code>maxWidth</code> as <code>.infinity</code> means taking the whole available width of the container.<br>If many children ask for max width, then they will be divided equally.<br>This is similar to <code>weight</code> in <code>LinearLayout</code> in Android or css <code>flex-grow</code> property.</p>
<p>The same applies in vertical direct also.</p>
<p><img src="https://user-images.githubusercontent.com/2284279/96973946-da40a480-1518-11eb-8d32-5e9276b809b2.jpeg" alt="width"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-20T10:13:03.000Z" title="2020-10-20T10:13:03.000Z">2020-10-20</time><span class="level-item">19 minutes read (About 2810 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-test-push-notifications-in-simulator-and-production-iOS-apps/">How to test push notifications in simulator and production iOS apps</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/682">#682</a></strong></p>
<p>After has recently reminded about his updating <a href="https://developer.apple.com/news/?id=c88acm2b">APNs provider API</a> which makes me realised a lot has changed about push notifications, both in terms of client and provider approach. </p>
<blockquote>
<p>The HTTP/2-based Apple Push Notification service (APNs) provider API lets you take advantage of great features, such as authentication with a JSON Web Token, improved error messaging, and per-notification feedback. If you send push notifications with the legacy binary protocol, we strongly recommend upgrading to the APNs provider API.</p>
</blockquote>
<p>From the the iOS client point of view, you pretty much don’t need to care about provider API, as you only need to register for push notification capability and send the device token to your backend, and it’s the backend’s job to send push request to Apple notifications server.</p>
<p>But it’s good to know the underlying mechanism, especially when you want to troubleshoot push notification. Since a push notification failure can be because of many reasons: it could be due to some failed logic in your backend, or that the push certificate has expired, or that you have sent the wrong device token, or that user has turned off push permission in Settings app, or that the push has been delayed.</p>
<p>Here’s also a common abbreviations you need to learn: <code>APNs</code> it is short for Apple Push Notification service. You can think of it as the server your device always has connection with, so you’re ready for any server push messages from it.</p>
<h2 id="What-is-binary-provider-API"><a href="#What-is-binary-provider-API" class="headerlink" title="What is binary provider API"></a>What is binary provider API</h2><p>Push notification feature was first introduced by Apple in 2009 via a fairly complex <a href="https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/BinaryProviderAPI.html">binary provider API</a></p>
<p><img src="https://user-images.githubusercontent.com/2284279/95670009-ca26dd80-0b86-11eb-8ff9-5dbb4d1d312c.png" alt="binary"></p>
<p>In short, binary provider API is just a specification about which address and which format to send push request to Apple push server. The binary interface of the production environment is available through <code>gateway.push.apple.com, port 2195</code> and development environment <code>gateway.sandbox.push.apple.com, port 2195</code>. The binary interface employs a plain TCP socket for binary content that is streaming in nature.</p>
<p>As you can see in the package instruction above, we need specify frame length and data. Data is a key value pairs of multiple informations like device token, expiration, topic, priority.</p>
<p>Send request to the above addresses via secured TLS or SSL channel. The SSL certificate required for these connections is obtained from your developer account.</p>
<h2 id="The-new-HTTP-2-provider-API"><a href="#The-new-HTTP-2-provider-API" class="headerlink" title="The new HTTP/2 provider API"></a>The new HTTP/2 provider API</h2><p>The new <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/sending_notification_requests_to_apns/">HTTP2/ provider API</a> is recommended, it has detailed error reporting and better throughput. If you use <a href="https://developer.apple.com/documentation/foundation/urlsession">URLSession</a> which supports the HTTP/1.1 and HTTP/2 protocols. HTTP/2 support, as described by RFC 7540, you will feel familiar.</p>
<p>In short, when you have a notification to send to a user, your provider must construct a POST request and send it to Apple Push Notification service (APNs). Your request must include the following information:</p>
<ul>
<li>The JSON payload that you want to send</li>
<li>The device token for the user’s device</li>
<li>Request-header fields specifying how to deliver the notification</li>
<li>For token-based authentication, your provider server’s current authentication token</li>
</ul>
<p>Upon receiving your server’s POST request, APNs validates the request using either the provided authentication token or your server’s certificate. If validation succeeds, APNs uses the provided device token to identify the user’s device. It then tries to send your JSON payload to that device.</p>
<p>So it’s pretty much how you configure <code>URLRequest</code>with <code>URLSession</code>, specify base url, some request headers including the authorization and the payload body.</p>
<p>Use HTTP/2 and TLS 1.2 or later to establish a connection to the new provider API endpoint. For development serverit is <code>api.sandbox.push.apple.com:443</code> and for production server it is <code>api.push.apple.com:443</code>. You then send the request as <code>POST</code> and Apple will do its job to verify and send the push notification to the users device.</p>
<h2 id="Certificate-vs-token-based-authentication"><a href="#Certificate-vs-token-based-authentication" class="headerlink" title="Certificate vs token based authentication"></a>Certificate vs token based authentication</h2><p>To send push request to APNs, you need to authenticate to tell that is really from you. APNs support 2 types of authentication, the traditional way with a certificate, and the recently new recommended way with a p8 token.</p>
<h3 id="Certificate-based-authentication"><a href="#Certificate-based-authentication" class="headerlink" title="Certificate based authentication"></a>Certificate based authentication</h3><p>For <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/establishing_a_certificate-based_connection_to_apns">certificate based authentication</a>, you will need a p12 certificate which you can obtain and generate from your Developer account.</p>
<p><img src="https://user-images.githubusercontent.com/2284279/95670291-81bcef00-0b89-11eb-8e98-92112c414476.png" alt="cer"></p>
<p>Because there are sandbox and production push endpoint, few years ago it was required to have separate sandbox and production environment push certificate, which you had to create separately in your Apple developer account, then in testing need to specify the correct push certificate for each environment.</p>
<p>Now around iOS 10 year we can use just 1 single certificate for both sandbox and production, which is a relief for us developers. When we create certificate on Apple developer page, we need to upload a certificate signing request that we can generate from Keychain Access app. After we download the generated push certificate, download and run it in Keychain, there we can generate p12 key file that contains both certificate and private key to sign our push request.</p>
<p>Certificate and provisioning profiles valid for only 1 year. So every year you have to renew push notification certificates, which is also a good and bad thing. Besides that, every app differs from bundle id, so we kinda have to generate certificate for each app.</p>
<h3 id="Token-based-authentication"><a href="#Token-based-authentication" class="headerlink" title="Token based authentication"></a>Token based authentication</h3><p><a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/establishing_a_token-based_connection_to_apns">Token-based authentication</a> offers a stateless way to communicate with APNs. Stateless communication is faster than certificate-based communication because it doesn’t require APNs to look up the certificate, or other information, related to your provider server. There are other advantages to using token-based authentication:</p>
<p>The cool thing about token is that you can use one token to distribute notifications for all of your company’s apps. You can create in your Apple developer account. Key authentication is the recommended way to authenticate with Apple services, so it is used not only for push services, but also for MusicKit and DeviceCheck.</p>
<p><img src="https://user-images.githubusercontent.com/2284279/95670409-a796c380-0b8a-11eb-87a5-169d48e738de.png" alt="key"></p>
<p>When you request a key, Apple gives you a 10-character string with the Key ID which you must include this string in your JSON tokens and an authentication token signing key, specified as a text file (with a .p8 file extension). The key is allowed to download once and you need to keep it properly.</p>
<p>The token that you include with your notification requests uses the JSON Web Token (JWT) specification. The token itself contains four key-value pairs</p>
<img width="811" alt="Screenshot 2020-10-11 at 06 28 34" src="https://user-images.githubusercontent.com/2284279/95670434-ff352f00-0b8a-11eb-8d28-2e5b07a6875e.png">

<p>After all, the JSON Web Token is encoded in this <code>authorization</code> HTTP headers in your request like this</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">authorization &#x3D; bearer eyAia2lkIjogIjhZTDNHM1JSWDciIH0.eyAiaXNzIjogIkM4Nk5WOUpYM0QiLCAiaWF0I</span><br><span class="line">		 jogIjE0NTkxNDM1ODA2NTAiIH0.MEYCIQDzqyahmH1rz1s-LFNkylXEa2lZ_aOCX4daxxTZkVEGzwIhALvkClnx5m5eAT6</span><br><span class="line">		 Lxw7LZtEQcH6JENhJTMArwLf3sXwi</span><br></pre></td></tr></table></figure>

<p>For security, APNs requires you to refresh your token regularly. Refresh your token no more than once every 20 minutes and no less than once every 60 minutes.</p>
<h2 id="How-to-register-for-push-notifications-from-iOS-app"><a href="#How-to-register-for-push-notifications-from-iOS-app" class="headerlink" title="How to register for push notifications from iOS app"></a>How to register for push notifications from iOS app</h2><p>The APIs to register for remote notification has changed over the years.</p>
<h3 id="iOS-7"><a href="#iOS-7" class="headerlink" title="iOS 7"></a>iOS 7</h3><p>In iOS 7, we used to use this method <a href="https://developer.apple.com/documentation/uikit/uiapplication/1623010-registerforremotenotificationtyp?language=objc">registerForRemoteNotificationTypes</a> to register to receive remote notifications of the specified types via Apple Push Notification service.</p>
<p>The types can be <code>UIRemoteNotificationTypeBadge</code>, <code>UIRemoteNotificationTypeAlert</code>, <code>UIRemoteNotificationTypeSound</code></p>
<p>When you send this message, the device initiates the registration process with Apple Push Notification service. If it succeeds, the app delegate receives a device token in the <code>application:didRegisterForRemoteNotificationsWithDeviceToken:</code> method; if registration doesn’t succeed, the delegate is informed via the <code>application:didFailToRegisterForRemoteNotificationsWithError:</code>method. If the app delegate receives a device token, it should connect with its provider and pass it the token.</p>
<h3 id="iOS-8-with-registerUserNotificationSettings"><a href="#iOS-8-with-registerUserNotificationSettings" class="headerlink" title="iOS 8 with registerUserNotificationSettings"></a>iOS 8 with <code>registerUserNotificationSettings</code></h3><p>From iOS 8, there’s separation between asking for a remote notification with device token, and with presenting push message to the user. This confused developers as these 2 things are separate now.</p>
<p>First, we use <a href="https://developer.apple.com/documentation/uikit/uiapplication/1623078-registerforremotenotifications">registerForRemoteNotifications</a> to register to receive remote notifications via Apple Push Notification service.</p>
<p>Call this method to initiate the registration process with Apple Push Notification service. If registration succeeds, the app calls your app delegate object’s <code>application(_:didRegisterForRemoteNotificationsWithDeviceToken:)</code> method and passes it a device token. You should pass this token along to the server you use to generate remote notifications for the device. If registration fails, the app calls its app delegate’s <code>application(_:didFailToRegisterForRemoteNotificationsWithError:)</code> method instead.</p>
<p>In short, this is to receive device token from APNs so we can do silent push notification or other things. Note that we need to enable <code>Remote notification</code> capability for Background modes.</p>
<img width="999" alt="Screenshot 2020-10-11 at 06 39 46" src="https://user-images.githubusercontent.com/2284279/95670516-90f16c00-0b8c-11eb-8569-74fe99007ba5.png">

<p>To present push message to user via alert, banner, badge or sound, we need to explicitly ask for using this method <a href="https://developer.apple.com/documentation/uikit/uiapplication/1622932-registerusernotificationsettings">registerUserNotificationSettings</a> to registers your preferred options for notifying the user.</p>
<p>If your app displays alerts, play sounds, or badges its icon, you must call this method during your launch cycle to request permission to alert the user in these ways. After calling this method, the app calls the <code>application(_ application: UIApplication, didRegister notificationSettings: UIUserNotificationSettings)</code> method of its app delegate to report the results. You can use that method to determine if your request was granted or denied by the user.</p>
<h3 id="iOS-10-with-UserNotifications-framework"><a href="#iOS-10-with-UserNotifications-framework" class="headerlink" title="iOS 10 with UserNotifications framework"></a>iOS 10 with UserNotifications framework</h3><p>In iOS 10, Apple introduced <code>UserNotifications</code> and <code>UserNotificationsUI</code> framework and lots of new features to push notifications like actions and attachments.</p>
<p>To ask for permission to present push message from iOS 10, use the new <code>UNUserNotificationCenter</code> which accepts options and block callback with grant status.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UNUserNotificationCenter</span>.current().requestAuthorization(options: [.badge, .sound, .alert])</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/2284279/95670610-d95d5980-0b8d-11eb-86c9-4d4ab16e31f6.png" alt="abc"></p>
<p>There ‘s also <code>UNNotificationAction</code> and <code>UNNotificationAttachment</code> to specify additional actions and attachment to go along with the push message, this is very handy for visual purpose and convenient actions user can perform right away from the push message.</p>
<p>There’s also a convenient <code>UserNotificationsUI</code> that was shipped with iOS 10 that allows us to embed custom view controller from our push message</p>
<p><img src="https://user-images.githubusercontent.com/2284279/95670635-4e309380-0b8e-11eb-88c5-8cd591d8665e.png" alt="ui"></p>
<p>When an iOS device receives a notification containing an alert, the system displays the contents of the alert in two stages. Initially, it displays an abbreviated banner with the title, subtitle, and two to four lines of body text from the notification. If the user presses the abbreviated banner, iOS displays the full notification interface, including any notification-related actions. The system provides the interface for the abbreviated banner, but you can customize the full interface using a notification content app extension.</p>
<p>Also, there is this callback <a href="https://developer.apple.com/documentation/usernotifications/unusernotificationcenterdelegate/1649518-usernotificationcenter">userNotificationCenter _:willPresent</a> that asks the delegate how to handle a notification that arrived while the app was running in the foreground.</p>
<p>If your app is in the foreground when a notification arrives, the shared user notification center calls this method to deliver the notification directly to your app. If you implement this method, you can take whatever actions are necessary to process the notification or show it when your app is running.</p>
<h3 id="iOS-12-with-provisional-push"><a href="#iOS-12-with-provisional-push" class="headerlink" title="iOS 12 with provisional push"></a>iOS 12 with provisional push</h3><p>New in iOS 12 is the <code>UNAuthorizationStatus.provisional</code>, which are notifications that appear silently in the user’s notification center without appearing on the user’s home screen. We can start sending them as soon as a user has downloaded and run your app for the first time. You can send provisional push notifications unlimited times unless the user explicitly turns them off.</p>
<img width="333" alt="Screenshot 2020-10-11 at 06 58 34" src="https://user-images.githubusercontent.com/2284279/95670721-30aff980-0b8f-11eb-89c0-6d4c39d314c0.png">

<p>This is good to send unobtrusive push to users in their Notification Center where they can pick up at a later time.  </p>
<h3 id="iOS-13-with-apns-push-type"><a href="#iOS-13-with-apns-push-type" class="headerlink" title="iOS 13 with apns-push-type"></a>iOS 13 with apns-push-type</h3><p>Starting with iOS 13 and watchOS 6, there is <code>apns-push-type</code> which must accurately reflect the contents of your notification’s payload. If there is a mismatch, or if the header is missing on required systems, APNs may return an error.</p>
<p>The <code>apns-push-type</code> header field has six valid values. The descriptions below describe when and how to use these values. For example <code>alert</code> for notifications that trigger a user interaction and <code>background</code> for notifications that deliver content in the background.</p>
<p>In a WWDC 2019 session <a href="https://developer.apple.com/videos/play/wwdc2019/707/?time=799">Advances in App Background Execution</a>, <code>apns-priority</code> must be set to 5 for <code>content available</code> notifications.</p>
<h3 id="iOS-14-with-ephemeral-authorization-status-and-AppClip"><a href="#iOS-14-with-ephemeral-authorization-status-and-AppClip" class="headerlink" title="iOS 14 with ephemeral authorization status and AppClip"></a>iOS 14 with ephemeral authorization status and AppClip</h3><p>From <a href="https://developer.apple.com/documentation/app_clips/enabling_notifications_in_app_clips">Enable your App Clip to schedule and receive notifications for a short or extended time period.</a></p>
<blockquote>
<p>Some App Clips may need to schedule or receive notifications to provide value. Consider an App Clip that allows users to order food for delivery: By sending notifications, the App Clip informs the user about an upcoming delivery. If notifications are important for your App Clip’s functionality, enable it to schedule or receive notifications for up to 8 hours after each launch.</p>
</blockquote>
<h3 id="Remote-notification-only-with-content-available"><a href="#Remote-notification-only-with-content-available" class="headerlink" title="Remote notification only with content-available"></a>Remote notification only with content-available</h3><p>Besides user interface notification, there is <code>content-available</code> notification that delivers notifications that wake your app and update it in the background. If your app’s server-based content changes infrequently or at irregular intervals, you can use background notifications to notify your app when new content becomes available. Read <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/pushing_background_updates_to_your_app">Pushing Background Updates to Your App</a></p>
<h2 id="Testing-push-notification-in-simulator"><a href="#Testing-push-notification-in-simulator" class="headerlink" title="Testing push notification in simulator"></a>Testing push notification in simulator</h2><p>We have been able to drag images to the Photos app in simulator for years, but new in Xcode 11.4 is the ability to drag push payload to simulator to simulate remote push notification.</p>
<p>All we have to do is create an <code>apns</code> file with <code>Simulator Target Bundle</code> key to specify our app, then drag to the simulator</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"Simulator Target Bundle"</span>: <span class="string">"com.onmyway133.PushHero"</span>,</span><br><span class="line">    <span class="attr">"aps"</span>: &#123;</span><br><span class="line">        <span class="attr">"alert"</span>: <span class="string">"Welcome to Push Hero"</span>,</span><br><span class="line">        <span class="attr">"sound"</span>: <span class="string">"chime"</span>,</span><br><span class="line">        <span class="attr">"badge"</span>: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Many of the simulator features can be controlled via <code>xcrun simctl</code> command line tool where you can change status bar time, battery info, start and stop certain simulators and send push with <code>xcrun simctl push</code>. This is very handy in case you want to automate things.</p>
<h2 id="Test-push-notification-easily-with-Push-Hero"><a href="#Test-push-notification-easily-with-Push-Hero" class="headerlink" title="Test push notification easily with Push Hero"></a>Test push notification easily with Push Hero</h2><p>As iOS developers who need to test push notification a lot, I face this challenge. That’s why I made <a href="https://onmyway133.com/pushhero/">Push Hero</a> as a native macOS application that allows us to reliably test push notification. It is written in pure Swift with all the new APNs specification in mind.</p>
<img width="1364" alt="Screenshot 2020-10-08 at 06 17 12" src="https://user-images.githubusercontent.com/2284279/95670862-ec255d80-0b90-11eb-9a8d-694167f69d8d.png">

<p>With Push Hero, we can setup multiple test scenario for different app. Each we can specify the authentication method we want, either with p8 token or p12 certificate based. There’s also input validation and hint helper that explains which field is needed and in which format, so you save time to work on your push testing instead.</p>
<p>New in latest version of Push Hero is the ability to send multiple pushes to multiple device tokens, which is the most frequent request. In the right history pane, there’s information about each request and response content, together with apns id information.</p>
<p>Also in Push Hero is the popup to show explanation for each field, and you need to consult <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/sending_notification_requests_to_apns/">Sending Notification Requests to APNs</a> documentation as there are some specifications there. For example with VoIP push, the <code>apns-topic</code> header field must use your app’s bundle ID with <code>.voip</code> appended to the end. If you’re using certificate-based authentication, you must also register the certificate for VoIP services</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Push notification continues to be important for iOS apps, and Apple has over the years improved and changed it for the better. This also means lots of knowledge to keep up with. Understanding provider APNs, setting up certificate and JSON Web Token key can be intimidating and take time.</p>
<p>Hopefully the above summary gets you more understanding into push notification, not only the history of changes in both client and provider API, but also some ways to test it easily.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-16T16:01:04.000Z" title="2020-10-16T16:01:04.000Z">2020-10-16</time><span class="level-item">2 minutes read (About 231 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/What-define-a-good-developer/">What define a good developer</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/683">#683</a></strong></p>
<p>I always find myself asking this question “What define a good developer?”<br>I ‘ve asked many people and the answers vary, they ‘re all correct in certain aspects</p>
<blockquote>
<p>Good programmer is someone who has a solid knowledge of the “how-to” both in theory and in practices. Understanding customer requirements clearly and having a vision to fulfill it through dedication and execution !</p>
</blockquote>
<blockquote>
<p>Good programmer is one who has in depth knowledge of one particular major and wide understanding of many thing else</p>
</blockquote>
<blockquote>
<p>Algorithm (actually this was my definition)</p>
</blockquote>
<p>But I think I find the answer now, it is <code>responsibility</code></p>
<blockquote>
<p>The single most important trait of a professional programmer is personal responsibility. Professional programmers take responsibility for their career, their estimates, their schedule commitments, their mistakes, and their work- manship. A professional programmer does not pass that responsibility off on others.</p>
</blockquote>
<ul>
<li>If you are a professional, then you are responsible for your own career</li>
<li>Professionals take responsibility for the code they write</li>
<li>Professionals are team players</li>
<li>Professionals do not tolerate big bug lists</li>
<li>Professionals do not make a mess</li>
</ul>
<p>In fact, if we want to be successful, we need to be responsible for our work and our life.</p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ul>
<li>“The Professional Programmer” in the book <a href="http://www.amazon.com/Things-Every-Programmer-Should-Know/dp/0596809484">97 Things Every Programmer Should Know: Collective Wisdom from the Experts</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-11T03:45:56.000Z" title="2020-10-11T03:45:56.000Z">2020-10-11</time><span class="level-item">2 minutes read (About 242 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Hello-world-again/">Hello world, again</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/1">#1</a></strong></p>
<p>I’ve used Wordpress, then moved to GitHub Pages with <a href="https://jekyllrb.com/">Jekyll</a>, <a href="http://octopress.org/">Octopress</a>, <a href="https://hexo.io/">Hexo</a>, <a href="https://github.com/spf13/hugo">Hugo</a>. You can view my page here <a href="http://fantageek.com/">http://fantageek.com/</a>. It was good with all the custom themes and <a href="https://disqus.com/">Disqus</a></p>
<p>But then I was a bit lazy with all the commands <code>generate, commit, deploy</code>, it hinders me from writing, so I moved to <a href="https://medium.com/@onmyway133">Medium</a>. </p>
<p>The only thing I like about Medium is its discovery, your posts have high chanced of finding and viewing by people. What’s the point of writing if no one read it? But then I miss all the awesome markdown features of GitHub Pages. Medium is easy to use, but it seems it’s not for hackers, and I find it really uncomfortable when adding code block and headings. Medium also lists my comments as stories, which is kind of 😲 </p>
<p>I like to write fast, and with good comments system, and I love Markdown.</p>
<p>I like GitHub. I use GitHub for my <a href="https://github.com/onmyway133/notes">notes</a>, so I think I will use it for my blog as well. Hope all these GitHub convenience will encourage me to write more often. This will, of course, be less discoverable by people. So if you by any chance visit this blog, ohayou from me 👋 </p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-09T01:49:39.000Z" title="2020-10-09T01:49:39.000Z">2020-10-09</time><span class="level-item">a minute read (About 210 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-clear-List-background-color-in-SwiftUI-for-macOS/">How to clear List background color in SwiftUI for macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/680">#680</a></strong></p>
<p>For <code>List</code> in SwiftUI for macOS, it has default background color because of the enclosing <code>NSScrollView</code> via <code>NSTableView</code> that <code>List</code> uses under the hood. Using <code>listRowBackground</code> also gives no effect</p>
<p>The solution is to use a library like <a href="https://github.com/siteline/SwiftUI-Introspect">SwiftUI-Introspect</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Introspect</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">List</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">removeBackground</span><span class="params">()</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> introspectTableView &#123; tableView <span class="keyword">in</span></span><br><span class="line">            tableView.backgroundColor = .clear</span><br><span class="line">            tableView.enclosingScrollView!.drawsBackground = <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>then</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span> &#123;</span><br><span class="line">    <span class="type">ForEach</span>(items) &#123; item <span class="keyword">in</span></span><br><span class="line">        <span class="comment">// view here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">.removeBackground()</span><br></pre></td></tr></table></figure>

<p>Or we can add extension on <code>NSTableView</code> to alter its content when it moves to superview</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NSTableView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidMoveToWindow</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidMoveToWindow()</span><br><span class="line"></span><br><span class="line">        backgroundColor = <span class="type">NSColor</span>.clear</span><br><span class="line">        enclosingScrollView!.drawsBackground = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This works OK for me on macOS 10.15.5, 10.15.7 and macOS 10.11 beta. But it was reported crash during review on macOS 10.15.6</p>
<blockquote>
<p>The app launches briefly and then quits without error message.</p>
</blockquote>
<p>After inspecting crash log, it is because of <code>viewDidMoveToWindow</code>. So it’s wise not to mess with NSTableView for now</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Thread 0 Crashed:: Dispatch queue: com.apple.main-thread</span><br><span class="line">0   com.onmyway133.PushHero       	0x0000000104770b0a @objc NSTableView.viewDidMoveToWindow() (in Push Hero) (&lt;compiler-generated&gt;:296)</span><br><span class="line">1   com.apple.AppKit              	0x00007fff2d8638ea -[NSView _setWindow:] + 2416</span><br><span class="line">2   com.apple.AppKit              	0x00007fff2d8844ea -[NSControl _setWindow:] + 158</span><br><span class="line">3   com.apple.AppKit              	0x00007fff2d946ace -[NSTableView _setWindow:] + 306</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-07T03:02:01.000Z" title="2020-10-07T03:02:01.000Z">2020-10-07</time><span class="level-item">a few seconds read (About 100 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-style-multiline-Text-in-SwiftUI-for-macOS/">How to style multiline Text in SwiftUI for macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/681">#681</a></strong></p>
<p>Only need to specify <code>fixedSize</code> on text to preserve ideal height.</p>
<blockquote>
<p>The maximum number of lines is 1 if the value is less than 1. If the value is nil, the text uses as many lines as required. The default is nil.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(longText)</span><br><span class="line">    .lineLimit(<span class="literal">nil</span>) <span class="comment">// No need</span></span><br><span class="line">    .fixedSize(horizontal: <span class="literal">false</span>, vertical: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<p>If the Text is inside a row in a <code>List</code>, <code>fixedSize</code> causes the row to be in middle of the <code>List</code>, workaround is to use <code>ScrollView</code> and vertical <code>StackView</code>.</p>
<p>Sometimes for Text to properly size itself, specify an explicit frame width</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-05T11:23:34.000Z" title="2020-10-05T11:23:34.000Z">2020-10-05</time><span class="level-item">a minute read (About 142 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-ApiException-10-in-Flutter-for-Android/">How to fix ApiException  10 in Flutter for Android</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/188">#188</a></strong></p>
<p>Get error <code>com.google.android.gms.common.api.ApiException: 10</code> with <code>google_sign_in</code> package.</p>
<p>Read <a href="https://developers.google.com/android/guides/client-auth">https://developers.google.com/android/guides/client-auth</a></p>
<blockquote>
<p>Certain Google Play services (such as Google Sign-in and App Invites) require you to provide the SHA-1 of your signing certificate so we can create an OAuth2 client and API key for your app</p>
</blockquote>
<p>console.developers.google.com/apis/credentials</p>
<p>Credentials -&gt; OAuth client id<br>If we specify SHA1 in firebase, then <code>console.developers.google.com</code> will generate an Android oauth for us</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore &#123;keystore_name&#125; -<span class="built_in">alias</span> &#123;alias_name&#125;</span><br></pre></td></tr></table></figure>

<p>Use correct keystore for debug and release</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Add your own signing config for the release build.</span></span><br><span class="line">            <span class="comment">// Signing with the debug keys for now, so `flutter run --release` works.</span></span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">        &#125;</span><br><span class="line">        debug &#123;</span><br><span class="line">            signingConfig signingConfigs.debug</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-04T04:52:07.000Z" title="2020-10-04T04:52:07.000Z">2020-10-04</time><span class="level-item">a minute read (About 139 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-setup-multiple-git-accounts-for-GitHub-and-Bitbucket/">How to setup multiple git accounts for GitHub and Bitbucket</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/514">#514</a></strong></p>
<h2 id="Generate-SSH-keys"><a href="#Generate-SSH-keys" class="headerlink" title="Generate SSH keys"></a>Generate SSH keys</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;onmyway133@gmail.com&quot; -f &quot;id_rsa_github&quot;</span><br><span class="line">ssh-keygen -t rsa -C &quot;onmyway133bitbucket@gmail.com&quot; -f &quot;id_rsa_bitbucket&quot;</span><br><span class="line"></span><br><span class="line">pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa_github.pub</span><br><span class="line">pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa_bitbucket.pub</span><br><span class="line"></span><br><span class="line">ssh-add -D</span><br><span class="line">ssh-add id_rsa_github</span><br><span class="line">ssh-add id_rsa_bitbucket</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vim ~&#x2F;.ssh&#x2F;config</span><br><span class="line"></span><br><span class="line">#Github (personal)</span><br><span class="line">  Host gh</span><br><span class="line">  HostName github.com</span><br><span class="line">  User git</span><br><span class="line">  IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_github</span><br><span class="line"></span><br><span class="line">#Bitbucket (work)</span><br><span class="line">  Host bb</span><br><span class="line">  HostName bitbucket.org</span><br><span class="line">  User git</span><br><span class="line">  IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_bitbucket</span><br></pre></td></tr></table></figure>

<h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email &quot;onmyway133@gmail.com&quot;</span><br><span class="line">git config --local user.email &quot;onmyway133bitbucket@gmail.com&quot;</span><br></pre></td></tr></table></figure>


<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://medium.com/avocoders/github-and-bitbucket-accounts-in-a-same-pc-5f8c67fd89d2">https://medium.com/avocoders/github-and-bitbucket-accounts-in-a-same-pc-5f8c67fd89d2</a></li>
<li><a href="https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-config">https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-config</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-03T08:43:47.000Z" title="2020-10-03T08:43:47.000Z">2020-10-03</time><span class="level-item">2 minutes read (About 237 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-reload-data-without-using-onAppear-in-SwiftUI-in-watchOS/">How to reload data without using onAppear in SwiftUI in watchOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/468">#468</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/swiftui/text/3276931-onappear">onAppeear</a></p>
<blockquote>
<p>Adds an action to perform when the view appears.</p>
</blockquote>
<p>In theory, this should be triggered every time this view appears. But in practice, it is only called when it is pushed on navigation stack, not when we return to it.</p>
<p>So if user goes to a bookmark in a bookmark list, unbookmark an item and go back to the bookmark list, <code>onAppear</code> is not called again and the list is not updated.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BookmarksView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> service: <span class="type">Service</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> items: [<span class="type">AnyItem</span>]</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> storeContainer: <span class="type">StoreContainer</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(items)  &#123; item <span class="keyword">in</span></span><br><span class="line">            makeItemRow(item: item)</span><br><span class="line">                .padding([.top, .bottom], <span class="number">4</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .onAppear(perform: &#123;</span><br><span class="line">            <span class="keyword">self</span>.items = storeContainer.bookmarks(service: service).<span class="built_in">map</span>(&#123; <span class="type">AnyItem</span>(item: $<span class="number">0</span>) &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So instead of relying on UI state, we should rely on data state, by listening to <code>onReceive</code> and update our local <code>@State</code> </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BookmarksView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> service: <span class="type">Service</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> items: [<span class="type">AnyItem</span>]</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> storeContainer: <span class="type">StoreContainer</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(items)  &#123; item <span class="keyword">in</span></span><br><span class="line">            makeItemRow(item: item)</span><br><span class="line">                .padding([.top, .bottom], <span class="number">4</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .onAppear(perform: &#123;</span><br><span class="line">            <span class="keyword">self</span>.reload()</span><br><span class="line">        &#125;)</span><br><span class="line">        .onReceive(storeContainer.objectWillChange, perform: &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.reload()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">reload</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.items = storeContainer.bookmarks(service: service).<span class="built_in">map</span>(&#123; <span class="type">AnyItem</span>(item: $<span class="number">0</span>) &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Inside our <code>ObservableObject</code>, we need to trigger changes notification</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StoreContainer</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> objectWillChange = <span class="type">PassthroughSubject</span>&lt;(), <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">bookmark</span><span class="params">(item: ItemProtocol)</span></span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> &#123;</span><br><span class="line">            objectWillChange.send(())</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">unbookmark</span><span class="params">(item: ItemProtocol)</span></span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> &#123;</span><br><span class="line">            objectWillChange.send(())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-01T03:05:30.000Z" title="2020-10-01T03:05:30.000Z">2020-10-01</time><span class="level-item">a minute read (About 139 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-avoid-reduced-opacity-when-hiding-view-with-animation-in-SwiftUI/">How to avoid reduced opacity when hiding view with animation in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/679">#679</a></strong></p>
<p>While redesigning UI for my app <a href="https://onmyway133.com/pushhero/">Push Hero</a>, I ended up with an accordion style to toggle section.</p>
<img width="588" alt="Screenshot 2020-10-01 at 06 58 33" src="https://user-images.githubusercontent.com/2284279/94769940-86c4b600-03b3-11eb-87da-fbba61f13ace.png">

<p>It worked great so far, but after 1 collapsing, all image and text views have reduced opacity. This does not happen for other elements like dropdown button or text.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">extension View &#123;</span><br><span class="line">    func sectionBackground(_ title: String, _ shows: Binding&lt;Bool&gt;) -&gt; some View &#123;</span><br><span class="line">        VStack(alignment: .leading) &#123;</span><br><span class="line">            HStack &#123;</span><br><span class="line">                Text(title.uppercased())</span><br><span class="line">                Spacer()</span><br><span class="line">                if shows !&#x3D; nil &#123;</span><br><span class="line">                    SmallButton(</span><br><span class="line">                        imageName: &quot;downArrow&quot;,</span><br><span class="line">                        tooltip: shows!.wrappedValue ? &quot;Collapse&quot; : &quot;Expand&quot;,</span><br><span class="line">                        action: &#123;</span><br><span class="line">                           withAnimation(.easeInOut) &#123;</span><br><span class="line">                                shows!.wrappedValue.toggle()</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    )</span><br><span class="line">                    .rotationEffect(.radians(shows!.wrappedValue ? .pi : 0))</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if shows.wrappedValue &#123;</span><br><span class="line">                self</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The culprit is that <code>withAnimation</code>, it seems to apply opacity effect. So the workaround is to disable animation <code>wrappedValue</code>, or to tweak transition so that there’s no opacity adjustment.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> shows.wrappedValue &#123;</span><br><span class="line">    <span class="keyword">self</span>.transition(<span class="type">AnyTransition</span>.identity)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-01T02:24:15.000Z" title="2020-10-01T02:24:15.000Z">2020-10-01</time><span class="level-item">a few seconds read (About 85 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-dynamically-add-items-to-VStack-from-list-in-SwiftUI/">How to dynamically add items to VStack from list in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/678">#678</a></strong></p>
<p>Use <code>enumerated</code> to get <code>index</code> so we can assign to item in list. Here is how I show list of device tokens in my app <a href="https://onmyway133.com/pushhero">Push Hero</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> textViews: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> withIndex = input.deviceTokens.enumerated().<span class="built_in">map</span>(&#123; $<span class="number">0</span> &#125;)</span><br><span class="line">    <span class="keyword">let</span> binding: (<span class="type">Int</span>, <span class="type">Input</span>.<span class="type">DeviceToken</span>) -&gt; <span class="type">Binding</span>&lt;<span class="type">String</span>&gt; = &#123; index, token <span class="keyword">in</span></span><br><span class="line">        <span class="type">Binding</span>&lt;<span class="type">String</span>&gt;(</span><br><span class="line">            <span class="keyword">get</span>: &#123; token.token &#125;,</span><br><span class="line">            <span class="keyword">set</span>: &#123; <span class="keyword">self</span>.input.deviceTokens[index].token = $<span class="number">0</span> &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">VStack</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>(withIndex, id: \.element.id) &#123; index, token <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">DeviceTokenTextView</span>(text: binding(index, token))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-29T03:01:46.000Z" title="2020-09-29T03:01:46.000Z">2020-09-29</time><span class="level-item">a minute read (About 135 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-unwrap-Binding-with-Optional-in-SwiftUI/">How to unwrap Binding with Optional in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/677">#677</a></strong></p>
<p>The quick way to add new properties without breaking current saved Codable is to declare them as optional. For example if you use  <a href="https://github.com/onmyway133/EasyStash">EasyStash</a> library to save and load Codable models.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Input</span>: <span class="title">Codable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bundleId: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// New props</span></span><br><span class="line">    <span class="keyword">var</span> notificationId: <span class="type">String?</span></span><br></pre></td></tr></table></figure>

<p>This new property when using dollar syntax <code>$input.notificationId</code> turn into Binding with optional <code>Binding&lt;Strting?&gt;</code> which is incompatible in SwiftUI when we use Binding.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MaterialTextField</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> placeholder: <span class="type">String</span></span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> text: <span class="type">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The solution here is write an extension that converts <code>Binding&lt;String?&gt;</code> to <code>Binding&lt;String&gt;</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Binding</span> <span class="title">where</span> <span class="title">Value</span> == <span class="title">String</span>? </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toNonOptional</span><span class="params">()</span></span> -&gt; <span class="type">Binding</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Binding</span>&lt;<span class="type">String</span>&gt;(</span><br><span class="line">            <span class="keyword">get</span>: &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">self</span>.wrappedValue ?? <span class="string">""</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>: &#123;</span><br><span class="line">                <span class="keyword">self</span>.wrappedValue = $<span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>so we can use them as normal</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MaterialTextField</span>(text: $input.notificationId.toNonOptional())</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-29T02:55:14.000Z" title="2020-09-29T02:55:14.000Z">2020-09-29</time><span class="level-item">a minute read (About 194 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-custom-toggle-in-SwiftUI/">How to make custom toggle in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/676">#676</a></strong></p>
<p>I’ve used the default <code>SwiftUI</code> to achieve the 2 tab views in SwiftUI. It adds a default box around the content and also opinionated paddings. For now on light mode on macOS, the unselected tab has wrong colors.</p>
<p>The way to solve this is to come up with a custom toggle, that we can style and align the way we want. Here is how I did for my app <a href="https://onmyway133.com/pushhero">Push Hero</a></p>
<p>Using a Text instead of Button here gives me default static text look.</p>
<img width="752" alt="Screenshot 2020-09-29 at 06 52 33" src="https://user-images.githubusercontent.com/2284279/94513986-5bf62880-0220-11eb-9b29-bca0de5de64b.png">

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AuthenticationView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> input: <span class="type">Input</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        toggle</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> toggle: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HStack</span>(spacing: <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">"🔑 Key"</span>)</span><br><span class="line">                        .style(selected: input.authentication == .key)</span><br><span class="line">                        .onTapGesture &#123;</span><br><span class="line">                            <span class="keyword">self</span>.input.authentication = .key</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="type">Text</span>(<span class="string">"📰 Certificate"</span>)</span><br><span class="line">                        .style(selected: input.authentication == .certificate)</span><br><span class="line">                        .onTapGesture &#123;</span><br><span class="line">                            <span class="keyword">self</span>.input.authentication = .certificate</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .padding(<span class="number">3</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.white.opacity(<span class="number">0.2</span>))</span><br><span class="line">                .cornerRadius(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            choose</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> choose: <span class="type">AnyView</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> input.authentication &#123;</span><br><span class="line">        <span class="keyword">case</span> .key:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">KeyAuthenticationView</span>().erase()</span><br><span class="line">        <span class="keyword">case</span> .certificate:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">CertificateAuthenticationView</span>().erase()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">extension</span> <span class="title">Text</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">style</span><span class="params">(selected: Bool)</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span></span><br><span class="line">            .padding(.vertical, <span class="number">3</span>)</span><br><span class="line">            .padding(.horizontal, <span class="number">4</span>)</span><br><span class="line">            .background(selected ? <span class="type">Color</span>.white.opacity(<span class="number">0.5</span>) : <span class="type">Color</span>.clear)</span><br><span class="line">            .cornerRadius(<span class="number">6</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-26T16:02:30.000Z" title="2020-09-26T16:02:30.000Z">2020-09-26</time><span class="level-item">a minute read (About 203 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-change-app-icon-in-electron/">How to change app icon in electron</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/66">#66</a></strong></p>
<h3 id="Generate-icns"><a href="#Generate-icns" class="headerlink" title="Generate icns"></a>Generate icns</h3><ul>
<li>Generate <code>.iconset</code></li>
<li>Run <code>iconutil -c icns &quot;Icon.iconset&quot;</code>. Note that icon names must be first letter lowsercased, and use <code>_</code> instead of <code>-</code></li>
</ul>
<p><img src="https://user-images.githubusercontent.com/2284279/29305228-da1a8560-8197-11e7-8826-6a278157abf2.png" alt="icns"></p>
<h3 id="Use-icns"><a href="#Use-icns" class="headerlink" title="Use icns"></a>Use icns</h3><ul>
<li>In <code>main.js</code>, specify <code>icon</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">win = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">  width: <span class="number">800</span>, </span><br><span class="line">  height: <span class="number">600</span>,</span><br><span class="line">  icon: __dirname +  <span class="string">'/Icon/Icon.icns'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>You can also use helper url methods</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> iconUrl = url.format(&#123;</span><br><span class="line">  pathname: path.join(__dirname, <span class="string">'Icon/Icon.icns'</span>),</span><br><span class="line">  protocol: <span class="string">'file:'</span>,</span><br><span class="line">  slashes: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="If-app-icon-is-not-updated"><a href="#If-app-icon-is-not-updated" class="headerlink" title="If app icon is not updated"></a>If app icon is not updated</h3><ul>
<li>I get a problem that electron always shows default app icon. I tried using <code>png</code>, <code>NativeImage</code>, different icon sizes but still the problem. When I use <code>electron-packager</code> to make release build, the icon shows correctly, so it must be because of Electron caching or somehow 😠 </li>
<li>Go to <code>node_modules -&gt; electron -&gt; dist</code>, right click on <code>Electron</code>, choose <code>View Info</code></li>
<li>Drag another <code>icns</code> into the icon on the top left</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/2284279/29305340-83c8d058-8198-11e7-8057-742f904e2c1c.png" alt="info"></p>
<h3 id="Release-with-electron-packager"><a href="#Release-with-electron-packager" class="headerlink" title="Release with electron-packager"></a>Release with <code>electron-packager</code></h3><ul>
<li><code>icon</code> must be specified with <code>__dirname</code> (we already did) for <code>electron-packager</code> to pick up correct icons</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-25T02:01:53.000Z" title="2020-09-25T02:01:53.000Z">2020-09-25</time><span class="level-item">a few seconds read (About 49 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Binding-in-function-in-Swift/">How to use Binding in function in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/675">#675</a></strong></p>
<p>Use <code>wrappedValue</code> to get the underlying value that Binding contains</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addOverlay</span><span class="params">(shows: Binding&lt;Bool&gt;)</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="keyword">self</span></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        .overlay(</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                <span class="type">SmallButton</span>(</span><br><span class="line">                    imageName: <span class="string">"downArrow"</span>,</span><br><span class="line">                    tooltip: shows.wrappedValue ? <span class="string">"Collapse"</span> : <span class="string">"Expand"</span>,</span><br><span class="line">                    action: &#123;</span><br><span class="line">                        shows.wrappedValue.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">                .rotationEffect(.radians(shows.wrappedValue ? .pi : <span class="number">0</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-23T06:42:29.000Z" title="2020-09-23T06:42:29.000Z">2020-09-23</time><span class="level-item">a few seconds read (About 56 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-HSplitView-to-define-3-panes-view-in-SwiftUI-for-macOS/">How to use HSplitView to define 3 panes view in SwiftUI for macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/674">#674</a></strong></p>
<p>Specify <code>minWidth</code> to ensure miminum width, and use <code>.layoutPriority(1)</code> for the most important pane.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> store: <span class="type">Store</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HSplitView</span> &#123;</span><br><span class="line">            <span class="type">LeftPane</span>()</span><br><span class="line">                .padding()</span><br><span class="line">                .frame(minWidth: <span class="number">200</span>, maxWidth: <span class="number">500</span>)</span><br><span class="line">            <span class="type">MiddlePane</span>(store: store)</span><br><span class="line">                .padding()</span><br><span class="line">                .frame(minWidth: <span class="number">500</span>)</span><br><span class="line">                .layoutPriority(<span class="number">1</span>)</span><br><span class="line">            <span class="type">RightPane</span>()</span><br><span class="line">                .padding()</span><br><span class="line">                .frame(minWidth: <span class="number">300</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .background(<span class="type">R</span>.color.background)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-15T10:18:11.000Z" title="2020-09-15T10:18:11.000Z">2020-09-15</time><span class="level-item">a minute read (About 116 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-draw-arc-corner-using-Bezier-Path/">How to draw arc corner using Bezier Path</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/673">#673</a></strong></p>
<p>To draw rounded 2 corners at top left and top right, let’s start from bottom left</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> path = <span class="type">UIBezierPath</span>()</span><br><span class="line"><span class="comment">// bottom left</span></span><br><span class="line">path.move(to: <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: bounds.height))</span><br><span class="line"><span class="comment">// top left corner</span></span><br><span class="line">path.addArc(withCenter: <span class="type">CGPoint</span>(x: radius, y: radius), radius: radius, startAngle: <span class="type">CGFloat</span>.pi, endAngle: <span class="type">CGFloat</span>.pi * <span class="number">3</span> / <span class="number">2</span>, clockwise: <span class="literal">true</span>)</span><br><span class="line"><span class="comment">// top right corner</span></span><br><span class="line">path.addArc(withCenter: <span class="type">CGPoint</span>(x: bounds.width - radius, y: radius), radius: radius, startAngle: <span class="type">CGFloat</span>.pi * <span class="number">3</span> / <span class="number">2</span>, endAngle: <span class="number">0</span>, clockwise: <span class="literal">true</span>)</span><br><span class="line"><span class="comment">// bottom right</span></span><br><span class="line">path.addLine(to: <span class="type">CGPoint</span>(x: bounds.width, y: bounds.height))</span><br><span class="line">path.close()</span><br></pre></td></tr></table></figure>

<img width="598" alt="Screenshot 2020-09-15 at 14 16 01" src="https://user-images.githubusercontent.com/2284279/93209165-fdc84080-f75d-11ea-9e95-ed39d749b7d6.png">

<p><img src="https://user-images.githubusercontent.com/2284279/93209263-27816780-f75e-11ea-9de8-d50d72798313.png" alt="cc"></p>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="http://ronnqvi.st/thinking-like-a-bzier-path">http://ronnqvi.st/thinking-like-a-bzier-path</a> </li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-08T05:54:36.000Z" title="2020-09-08T05:54:36.000Z">2020-09-08</time><span class="level-item">a few seconds read (About 62 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-update-NSMenuItem-while-NSMenu-is-showing-in-macOS/">How to update NSMenuItem while NSMenu is showing in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/213">#213</a></strong></p>
<p>Use <code>Runloop</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">timer = <span class="type">Timer</span>.scheduledTimer(withTimeInterval: <span class="number">1</span>, repeats: <span class="literal">true</span>, block: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> date = <span class="type">Date</span>()</span><br><span class="line">    <span class="keyword">self</span>?.updateStopItem(seconds: finishDate.timeIntervalSince1970 - date.timeIntervalSince1970)</span><br><span class="line">&#125;)</span><br><span class="line">        </span><br><span class="line"><span class="type">RunLoop</span>.main.add(timer!, forMode: .common)</span><br></pre></td></tr></table></figure>

<p>Use <code>Dispatch</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">timer = <span class="type">Timer</span>.scheduledTimer(withTimeInterval: <span class="number">1</span>, repeats: <span class="literal">true</span>, block: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> date = <span class="type">Date</span>()</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">        <span class="keyword">self</span>?.updateStopItem(seconds: finishDate.timeIntervalSince1970 - date.timeIntervalSince1970)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-07T12:28:15.000Z" title="2020-09-07T12:28:15.000Z">2020-09-07</time><span class="level-item">a few seconds read (About 33 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-embed-UIStackView-inside-UIScrollView-in-iOS/">How to embed UIStackView inside UIScrollView in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/324">#324</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">view.addSubview(scrollView)</span><br><span class="line">scrollView.addSubview(stackView)</span><br><span class="line"></span><br><span class="line"><span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">    scrollView.pinEdges(view: view),</span><br><span class="line">    stackView.pinEdges(view: scrollView)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">    stackView.widthAnchor.constraint(equalTo: scrollView.widthAnchor, multiplier: <span class="number">1.0</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-31T10:19:33.000Z" title="2020-08-31T10:19:33.000Z">2020-08-31</time><span class="level-item">2 minutes read (About 290 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-stitch-and-sort-array-in-Swift/">How to stitch and sort array in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/672">#672</a></strong></p>
<p>Supposed we want to stitch magazines array into books array. The requirement is to sort them by <code>publishedDate</code>, but must keep <code>preferredOrder</code> of books. One way to solve this is to declare an enum to hold all possible cases, and then do a sort that check every possible combination </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> preferredOrder: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> publishedDate: <span class="type">Date</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Magazine</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> publishedDate: <span class="type">Date</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">StitchItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> book(<span class="type">Book</span>)</span><br><span class="line">    <span class="keyword">case</span> magazine(<span class="type">Magazine</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">stitch</span><span class="params">(<span class="number">_</span> books: [Book], magazines: [Magazine])</span></span> -&gt; [<span class="type">StitchItem</span>] &#123;</span><br><span class="line">    <span class="keyword">let</span> items = books.<span class="built_in">map</span>(&#123; <span class="type">StitchItem</span>.book($<span class="number">0</span>) &#125;) + magazines.<span class="built_in">map</span>(&#123; <span class="type">StitchItem</span>.magazine($<span class="number">0</span>) &#125;)</span><br><span class="line">    <span class="keyword">return</span> items.sorted(by: &#123; book, magazine <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">switch</span> (book, magazine) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> (.book(b1), .book(b2)):</span><br><span class="line">            <span class="keyword">return</span> b1.preferredOrder &lt; b2.preferredOrder</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> (.book(book), .magazine(magazine)):</span><br><span class="line">            <span class="keyword">if</span> book.publishedDate == magazine.publishedDate &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> book.publishedDate &lt; magazine.publishedDate</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> (.magazine(magazine), .book(book)):</span><br><span class="line">            <span class="keyword">if</span> book.publishedDate == magazine.publishedDate &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> book.publishedDate &lt; magazine.publishedDate</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> (.magazine(m1), .magazine(m2)):</span><br><span class="line">            <span class="keyword">return</span> m1.publishedDate &lt; m2.publishedDate</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The above sort function declares the intention but Swift just <code>sort</code> instead of trying to fully meet our requirements. </p>
<p>A manual solution is to sort each array first then use while loop to insert.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">stitch</span><span class="params">(<span class="number">_</span> books: [Book], magazines: [Magazine])</span></span> -&gt; [<span class="type">StitchItem</span>] &#123;</span><br><span class="line">    <span class="keyword">let</span> books = books</span><br><span class="line">        .sorted(by: &#123; $<span class="number">0</span>.preferredOrder &lt; $<span class="number">1</span>.preferredOrder &#125;)</span><br><span class="line">    <span class="keyword">let</span> magazines = magazines</span><br><span class="line">        .sorted(by: sortmagazines)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> bookIndex = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> magazineIndex = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> results: [<span class="type">StitchItem</span>] = []</span><br><span class="line">    <span class="keyword">while</span> (bookIndex &lt; books.<span class="built_in">count</span> &amp;&amp; magazineIndex &lt; magazines.<span class="built_in">count</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> book = books[bookIndex]</span><br><span class="line">        <span class="keyword">let</span> magazine = magazines[magazineIndex]</span><br><span class="line">        <span class="keyword">if</span> book.publishedDate &lt; magazine.publishedDate &#123;</span><br><span class="line">            results.append(<span class="type">StitchItem</span>.book(book))</span><br><span class="line">            bookIndex += <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            results.append(<span class="type">StitchItem</span>.magazine(magazine))</span><br><span class="line">            magazineIndex += <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (bookIndex &lt; books.<span class="built_in">count</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> book = books[bookIndex]</span><br><span class="line">        results.append(<span class="type">StitchItem</span>.book(book))</span><br><span class="line">        bookIndex += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (magazineIndex &lt; magazines.<span class="built_in">count</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> magazine = magazines[magazineIndex]</span><br><span class="line">        results.append(<span class="type">StitchItem</span>.magazine(magazine))</span><br><span class="line">        magazineIndex += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-14T05:30:07.000Z" title="2020-08-14T05:30:07.000Z">2020-08-14</time><span class="level-item">a few seconds read (About 92 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-test-for-view-disappear-in-navigation-controller/">How to test for view disappear in navigation controller</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/670">#670</a></strong></p>
<p>To test for <code>viewWillDisappear</code> during <code>UINavigationController</code> <code>popViewController</code> in unit test, we need to simulate <code>UIWindow</code> so view appearance works.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PopTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testPop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> window = <span class="type">UIWindow</span>(frame: <span class="type">UIScreen</span>.main.bounds)</span><br><span class="line">        <span class="keyword">let</span> navigationController = <span class="type">UINavigationController</span>()</span><br><span class="line">        window.rootViewController = navigationController</span><br><span class="line">        <span class="keyword">let</span> viewController = <span class="type">DetailViewController</span>()</span><br><span class="line"></span><br><span class="line">        navigationController.viewControllers = [</span><br><span class="line">            <span class="type">UIViewController</span>(),</span><br><span class="line">            viewController</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        window.makeKeyAndVisible()</span><br><span class="line">        <span class="keyword">let</span> expectation = <span class="type">XCTestExpectation</span>()</span><br><span class="line">        navigationController.popViewController(animated: <span class="literal">false</span>)</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() + <span class="number">0.1</span>) &#123;</span><br><span class="line">            <span class="type">XCTAssertTrue</span>(viewController.wasDismissed)</span><br><span class="line">            expectation.fulfill()</span><br><span class="line">        &#125;</span><br><span class="line">        wait(<span class="keyword">for</span>: [expectation], timeout: <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetailViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewWillDisappear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</span><br><span class="line">            <span class="keyword">super</span>.viewWillDisappear(animated)</span><br><span class="line">            <span class="keyword">if</span> isMovingFromParent &#123;</span><br><span class="line">                wasDismissed = <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-14T05:29:45.000Z" title="2020-08-14T05:29:45.000Z">2020-08-14</time><span class="level-item">a minute read (About 120 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-dynamic-font-size-for-UIButton/">How to make dynamic font size for UIButton</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/671">#671</a></strong></p>
<p>Use <a href="https://developer.apple.com/documentation/uikit/uicontentsizecategoryadjusting/1771731-adjustsfontforcontentsizecategor?language=objc">adjustsFontForContentSizeCategory</a></p>
<blockquote>
<p>A Boolean that indicates whether the object automatically updates its font when the device’s content size category changes.</p>
</blockquote>
<blockquote>
<p>If you set this property to YES, the element adjusts for a new content size category on a UIContentSizeCategoryDidChangeNotification.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">button.titleLabel?.adjustsFontForContentSizeCategory = <span class="literal">true</span></span><br><span class="line">button.backgroundColor = <span class="type">UIColor</span>.green</span><br><span class="line">button.titleLabel?.font = <span class="type">UIFont</span>.preferredFont(forTextStyle: .title1)</span><br><span class="line"></span><br><span class="line">label.adjustsFontForContentSizeCategory = <span class="literal">true</span></span><br><span class="line">label.backgroundColor = <span class="type">UIColor</span>.yellow</span><br><span class="line">label.font = <span class="type">UIFont</span>.preferredFont(forTextStyle: .title1)</span><br></pre></td></tr></table></figure>

<p>However it seems view (UIButton or UILabel) size is the same, just the inner text increases in size. A workaround is to put view inside <code>UIStackView</code> so UIButton or UILabel can automatically changes size.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-14T05:26:27.000Z" title="2020-08-14T05:26:27.000Z">2020-08-14</time><span class="level-item">a few seconds read (About 31 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-change-background-color-in-List-in-SwiftUI-for-macOS/">How to change background color in List in SwiftUI for macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/595">#595</a></strong></p>
<p>SwiftUI uses <code>ListCoreScrollView</code> and <code>ListCoreClipView</code> under the hood. For now the workaround, is to avoid using <code>List</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span> &#123;</span><br><span class="line">    <span class="type">ForEach</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>use</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="type">ForEach</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-11T14:27:22.000Z" title="2020-08-11T14:27:22.000Z">2020-08-11</time><span class="level-item">6 minutes read (About 926 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-SSLPeerUnverifiedException-in-Android/">How to fix SSLPeerUnverifiedException in Android</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/184">#184</a></strong></p>
<p>Get error <code>javax.net.ssl.SSLPeerUnverifiedException: No peer certificate</code> in Android API 16 to API 19</p>
<h2 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h2><p>Read about HTTPS and SSL <a href="https://developer.android.com/training/articles/security-ssl">https://developer.android.com/training/articles/security-ssl</a><br>Check backend TLS <a href="https://www.ssllabs.com/index.html">https://www.ssllabs.com/index.html</a><br>TLS by default in Android P <a href="https://android-developers.googleblog.com/2018/04/protecting-users-with-tls-by-default-in.html">https://android-developers.googleblog.com/2018/04/protecting-users-with-tls-by-default-in.html</a></p>
<h2 id="TLS-version"><a href="#TLS-version" class="headerlink" title="TLS version"></a>TLS version</h2><p>Read <a href="https://developer.android.com/reference/javax/net/ssl/SSLSocket.html">https://developer.android.com/reference/javax/net/ssl/SSLSocket.html</a></p>
<blockquote>
<p>This class extends Sockets and provides secure socket using protocols such as the “Secure Sockets Layer” (SSL) or IETF “Transport Layer Security” (TLS) protocols.</p>
</blockquote>
<img width="903" alt="ssl" src="https://user-images.githubusercontent.com/2284279/54885644-d6e9c080-4e7e-11e9-9f50-0d5a72b76202.png">

<p>TLS 1.1 and 1.2 are supported from API 16, but not enabled by default until API 20.</p>
<h2 id="Install-TLS-1-2-when-needed"><a href="#Install-TLS-1-2-when-needed" class="headerlink" title="Install TLS 1.2 when needed"></a>Install TLS 1.2 when needed</h2><p>Read <a href="https://medium.com/tech-quizlet/working-with-tls-1-2-on-android-4-4-and-lower-f4f5205629a">https://medium.com/tech-quizlet/working-with-tls-1-2-on-android-4-4-and-lower-f4f5205629a</a></p>
<blockquote>
<p>The first thing we realized was that despite documentation suggesting otherwise, not all devices on Android 4.1+ actually support TLS 1.2. Even though it is likely due to device manufacturers not fully following the official Android specs, we had to do what we could to ensure this would work for our users.</p>
</blockquote>
<blockquote>
<p>Luckily, Google Play Services provides a way to do this. The solution is to use ProviderInstaller from Google Play Services to try to update the device to support the latest and greatest security protocols.</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> Context.<span class="title">installTls12</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">      ProviderInstaller.installIfNeeded(<span class="keyword">this</span>)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e: GooglePlayServicesRepairableException) &#123;</span><br><span class="line">      <span class="comment">// Prompt the user to install/update/enable Google Play services.</span></span><br><span class="line">      GoogleApiAvailability.getInstance()</span><br><span class="line">          .showErrorNotification(<span class="keyword">this</span>, e.connectionStatusCode)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e: GooglePlayServicesNotAvailableException) &#123;</span><br><span class="line">      <span class="comment">// Indicates a non-recoverable error: let the user know.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Does not seem to work, as the root problem was that TLS was not enabled</p>
<h2 id="Try-normal-HttpsUrlConnection"><a href="#Try-normal-HttpsUrlConnection" class="headerlink" title="Try normal HttpsUrlConnection"></a>Try normal HttpsUrlConnection</h2><p>If we use any networking library and suspect it is the cause, then try using normal HttpsUrlConnection to check.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHttpRequestTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">String</span>,<span class="title">Integer</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(String... params)</span> </span>&#123;</span><br><span class="line">        String my_url = params[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            URL url = <span class="keyword">new</span> URL(my_url);</span><br><span class="line">            HttpsURLConnection httpURLConnection = (HttpsURLConnection) url.openConnection();</span><br><span class="line">            httpURLConnection.setSSLSocketFactory(<span class="keyword">new</span> MyFactory());</span><br><span class="line">            <span class="comment">// setting the  Request Method Type</span></span><br><span class="line">            httpURLConnection.setRequestMethod(<span class="string">"GET"</span>);</span><br><span class="line">            <span class="comment">// adding the headers for request</span></span><br><span class="line">            httpURLConnection.setRequestProperty(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            String result = readStream(httpURLConnection.getInputStream());</span><br><span class="line">            Log.e(<span class="string">"HttpsURLConnection"</span>, <span class="string">"data"</span> + result.toString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            Log.e(<span class="string">"HttpsURLConnection "</span>, <span class="string">"error"</span> + e.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">readStream</span><span class="params">(InputStream is)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is, Charset.forName(<span class="string">"US-ASCII"</span>)));</span><br><span class="line">        StringBuilder total = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            total.append(line);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (reader != <span class="keyword">null</span>) &#123;</span><br><span class="line">            reader.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFactory</span> <span class="keyword">extends</span> <span class="title">SSLSocketFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> javax.net.ssl.SSLSocketFactory internalSSLSocketFactory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFactory</span><span class="params">()</span> <span class="keyword">throws</span> KeyManagementException, NoSuchAlgorithmException </span>&#123;</span><br><span class="line">        SSLContext context = SSLContext.getInstance(<span class="string">"TLS"</span>);</span><br><span class="line">        context.init(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        internalSSLSocketFactory = context.getSocketFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getDefaultCipherSuites() &#123;</span><br><span class="line">        <span class="keyword">return</span> internalSSLSocketFactory.getDefaultCipherSuites();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getSupportedCipherSuites() &#123;</span><br><span class="line">        <span class="keyword">return</span> internalSSLSocketFactory.getSupportedCipherSuites();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(Socket s, String host, <span class="keyword">int</span> port, <span class="keyword">boolean</span> autoClose)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(s, host, port, autoClose));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(host, port));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port, InetAddress localHost, <span class="keyword">int</span> localPort)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(host, port, localHost, localPort));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(InetAddress host, <span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(host, port));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(InetAddress address, <span class="keyword">int</span> port, InetAddress localAddress, <span class="keyword">int</span> localPort)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(address, port, localAddress, localPort));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Socket <span class="title">enableTLSOnSocket</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(socket != <span class="keyword">null</span> &amp;&amp; (socket <span class="keyword">instanceof</span> SSLSocket)) &#123;</span><br><span class="line">            ((SSLSocket)socket).setEnabledProtocols(<span class="keyword">new</span> String[] &#123;<span class="string">"TLSv1.1"</span>, <span class="string">"TLSv1.2"</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The key is <code>setEnabledProtocols</code>. Then use</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String url = <span class="string">"https://www.myserver.com/data"</span></span><br><span class="line"><span class="keyword">new</span> MyHttpRequestTask().execute(url);</span><br></pre></td></tr></table></figure>

<h2 id="Use-custom-SSLSocketFactory-in-some-networking-libraries"><a href="#Use-custom-SSLSocketFactory-in-some-networking-libraries" class="headerlink" title="Use custom SSLSocketFactory in some networking libraries"></a>Use custom SSLSocketFactory in some networking libraries</h2><p>If our custom <code>MyFactory</code> works for <code>HttpsUrlConnection</code>, then the problem lies in some 3rd party networking libraries.</p>
<p>Read <a href="https://blog.dev-area.net/2015/08/13/android-4-1-enable-tls-1-1-and-tls-1-2/">https://blog.dev-area.net/2015/08/13/android-4-1-enable-tls-1-1-and-tls-1-2/</a></p>
<blockquote>
<p>The Android documentation for SSLSocket says that TLS 1.1 and TLS 1.2 is supported within android starting API level 16+ (Android 4.1, Jelly Bean). But it is by default disabled but starting with API level 20+ (Android 4.4 for watch, Kitkat Watch and Android 5.0 for phone, Lollipop) they are enabled. But it is very hard to find any documentation about how to enable it for phones running 4.1 for example.</p>
</blockquote>
<blockquote>
<p>The first thing you need to do is to make sure that your minimum required API level is 16 to have the following code working in your project.</p>
</blockquote>
<blockquote>
<p>To enable TLS 1.1 and 1.2 you need to create a custom SSLSocketFactory that is going to proxy all calls to a default  SSLSocketFactory implementation. In addition to that do we have to override all createSocket methods and callsetEnabledProtocols on the returned SSLSocket to enable TLS 1.1 and TLS 1.2. For an example implementation just follow the link below.</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFactory</span> <span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">http</span>.<span class="title">conn</span>.<span class="title">ssl</span>.<span class="title">SSLSocketFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> KeyStore <span class="title">getKeyStore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        KeyStore trustStore = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            trustStore = KeyStore.getInstance(KeyStore.getDefaultType());</span><br><span class="line">            trustStore.load(<span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            t.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> trustStore;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SSLSocketFactory internalSSLSocketFactory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFactory</span><span class="params">(KeyStore truststore)</span> <span class="keyword">throws</span> NoSuchAlgorithmException, KeyManagementException, KeyStoreException, UnrecoverableKeyException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(truststore);</span><br><span class="line">        SSLContext context = SSLContext.getInstance(<span class="string">"TLS"</span>);</span><br><span class="line">        context.init(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        internalSSLSocketFactory = context.getSocketFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(Socket socket, String host, <span class="keyword">int</span> port, <span class="keyword">boolean</span> autoClose)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(socket, host, port, autoClose));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Socket <span class="title">enableTLSOnSocket</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(socket != <span class="keyword">null</span> &amp;&amp; (socket <span class="keyword">instanceof</span> SSLSocket)) &#123;</span><br><span class="line">            ((SSLSocket)socket).setEnabledProtocols(<span class="keyword">new</span> String[] &#123;<span class="string">"TLSv1.1"</span>, <span class="string">"TLSv1.2"</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then maybe use it in a library, for example the ancient AsyncHttpClient</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">asyncHttpClient = <span class="keyword">new</span> AsyncHttpClient();</span><br><span class="line">asyncHttpClient.setTimeout(HTTP_GET_TIMEOUT);</span><br><span class="line">asyncHttpClient.setSSLSocketFactory(<span class="keyword">new</span> MyFactory(MyFactory.getKeyStore()));</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-07-12T06:43:21.000Z" title="2020-07-12T06:43:21.000Z">2020-07-12</time><span class="level-item">5 minutes read (About 683 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-credit-card-input-UI-in-Swift/">How to make credit card input UI in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/346">#346</a></strong></p>
<p>We have FrontCard that contains number and expiration date, BackCard that contains CVC. CardView is used to contain front and back sides for flipping transition.</p>
<p>We leverage <code>STPPaymentCardTextField</code> from Stripe for working input fields, then <code>CardHandler</code> is used to parse <code>STPPaymentCardTextField</code> content and update our UI.</p>
<p>For masked credit card numbers, we pad string to fit 16 characters with <code>●</code> symbol, then chunk into 4 parts and zip with labels to update.</p>
<p>For flipping animation, we use <code>UIView.transition</code> with <code>showHideTransitionViews</code></p>
<img width="370" alt="a1" src="https://user-images.githubusercontent.com/2284279/62470585-0dbfd380-b79b-11e9-9c31-13ea6cd17550.png">
<img width="362" alt="a2" src="https://user-images.githubusercontent.com/2284279/62470586-0dbfd380-b79b-11e9-9473-4c534b263b74.png">



<p><code>BackCard.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">BackCard</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> rectangle: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> cvcLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.font = <span class="type">R</span>.customFont.medium(<span class="number">14</span>)</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        label.textAlignment = .center</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> cvcBox: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">R</span>.color.lightText</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([rectangle, cvcBox, cvcLabel])</span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            rectangle.leftAnchor.constraint(equalTo: leftAnchor),</span><br><span class="line">            rectangle.rightAnchor.constraint(equalTo: rightAnchor),</span><br><span class="line">            rectangle.heightAnchor.constraint(equalToConstant: <span class="number">52</span>),</span><br><span class="line">            rectangle.topAnchor.constraint(equalTo: topAnchor, constant: <span class="number">30</span>),</span><br><span class="line"></span><br><span class="line">            cvcBox.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">16</span>),</span><br><span class="line">            cvcBox.topAnchor.constraint(equalTo: rectangle.bottomAnchor, constant: <span class="number">16</span>),</span><br><span class="line">            cvcBox.widthAnchor.constraint(equalToConstant: <span class="number">66</span>),</span><br><span class="line">            cvcBox.heightAnchor.constraint(equalToConstant: <span class="number">30</span>),</span><br><span class="line"></span><br><span class="line">            cvcLabel.centerXAnchor.constraint(equalTo: cvcBox.centerXAnchor),</span><br><span class="line">            cvcLabel.centerYAnchor.constraint(equalTo: cvcBox.centerYAnchor)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>FrontCard.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">FrontCard</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> stackView: <span class="type">UIStackView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> stackView = <span class="type">UIStackView</span>()</span><br><span class="line">        stackView.axis = .horizontal</span><br><span class="line">        stackView.distribution = .equalSpacing</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stackView</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> numberLabels: [<span class="type">UILabel</span>] = <span class="type">Array</span>(<span class="number">0</span>..&lt;<span class="number">4</span>).<span class="built_in">map</span>(&#123; <span class="number">_</span> <span class="keyword">in</span> <span class="keyword">return</span> <span class="type">UILabel</span>() &#125;)</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> expirationStaticLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.font = <span class="type">R</span>.customFont.regular(<span class="number">10</span>)</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> expirationLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.font = <span class="type">R</span>.customFont.medium(<span class="number">14</span>)</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubview(stackView)</span><br><span class="line">        numberLabels.forEach &#123;</span><br><span class="line">            stackView.addArrangedSubview($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        addSubviews([expirationStaticLabel, expirationLabel])</span><br><span class="line"></span><br><span class="line">        numberLabels.forEach &#123;</span><br><span class="line">            $<span class="number">0</span>.font = <span class="type">R</span>.customFont.medium(<span class="number">16</span>)</span><br><span class="line">            $<span class="number">0</span>.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">            $<span class="number">0</span>.textAlignment = .center</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            stackView.heightAnchor.constraint(equalToConstant: <span class="number">50</span>),</span><br><span class="line">            stackView.leftAnchor.constraint(equalTo: leftAnchor, constant: <span class="number">24</span>),</span><br><span class="line">            stackView.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">24</span>),</span><br><span class="line">            stackView.topAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line"></span><br><span class="line">            expirationStaticLabel.topAnchor.constraint(equalTo: stackView.bottomAnchor),</span><br><span class="line">            expirationStaticLabel.leftAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">70</span>),</span><br><span class="line"></span><br><span class="line">            expirationLabel.leftAnchor.constraint(equalTo: expirationStaticLabel.leftAnchor),</span><br><span class="line">            expirationLabel.topAnchor.constraint(equalTo: expirationStaticLabel.bottomAnchor)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>CardView.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CardView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> backCard = <span class="type">BackCard</span>()</span><br><span class="line">    <span class="keyword">let</span> frontCard = <span class="type">FrontCard</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubview(backCard)</span><br><span class="line">        addSubview(frontCard)</span><br><span class="line"></span><br><span class="line">        [backCard, frontCard].forEach &#123;</span><br><span class="line">            <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">                $<span class="number">0</span>.pinEdges(view: <span class="keyword">self</span>)</span><br><span class="line">            ])</span><br><span class="line"></span><br><span class="line">            $<span class="number">0</span>.clipsToBounds = <span class="literal">true</span></span><br><span class="line">            $<span class="number">0</span>.layer.cornerRadius = <span class="number">10</span></span><br><span class="line">            $<span class="number">0</span>.backgroundColor = <span class="type">R</span>.color.card.background</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>CardHandler.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Stripe</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CardHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> cardView: <span class="type">CardView</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(cardView: <span class="type">CardView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.cardView = cardView</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">reset</span><span class="params">()</span></span> &#123;</span><br><span class="line">        cardView.frontCard.expirationStaticLabel.text = <span class="type">R</span>.string.localizable.cardExpiration()</span><br><span class="line">        cardView.frontCard.expirationLabel.text = <span class="type">R</span>.string.localizable.cardExpirationPlaceholder()</span><br><span class="line">        cardView.backCard.cvcLabel.text = <span class="type">R</span>.string.localizable.cardCvcPlaceholder()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showFront</span><span class="params">()</span></span> &#123;</span><br><span class="line">        flip(</span><br><span class="line">            from: cardView.backCard,</span><br><span class="line">            to: cardView.frontCard,</span><br><span class="line">            options: .transitionFlipFromLeft</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showBack</span><span class="params">()</span></span> &#123;</span><br><span class="line">        flip(</span><br><span class="line">            from: cardView.frontCard,</span><br><span class="line">            to: cardView.backCard,</span><br><span class="line">            options: .transitionFlipFromRight</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(<span class="number">_</span> textField: STPPaymentCardTextField)</span></span> &#123;</span><br><span class="line">        handle(number: textField.cardNumber ?? <span class="string">""</span>)</span><br><span class="line">        handle(month: textField.formattedExpirationMonth, year: textField.formattedExpirationYear)</span><br><span class="line">        handle(cvc: textField.cvc)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(number: String)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> paddedNumber = number.padding(</span><br><span class="line">            toLength: <span class="number">16</span>,</span><br><span class="line">            withPad: <span class="type">R</span>.string.localizable.cardNumberPlaceholder(),</span><br><span class="line">            startingAt: <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> chunkedNumbers = paddedNumber.chunk(by: <span class="number">4</span>)</span><br><span class="line">        <span class="built_in">zip</span>(cardView.frontCard.numberLabels, chunkedNumbers).forEach &#123; tuple <span class="keyword">in</span></span><br><span class="line">            tuple.<span class="number">0</span>.text = tuple.<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(cvc: String?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> cvc = cvc, !cvc.isEmpty &#123;</span><br><span class="line">            cardView.backCard.cvcLabel.text = cvc</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cardView.backCard.cvcLabel.text = <span class="type">R</span>.string.localizable.cardCvcPlaceholder()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(month: String?, year: String?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> month = month, <span class="keyword">let</span> year = year,</span><br><span class="line">            !month.isEmpty</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cardView.frontCard.expirationLabel.text = <span class="type">R</span>.string.localizable.cardExpirationPlaceholder()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> formattedYear = year.ifEmpty(replaceWith: <span class="string">"00"</span>)</span><br><span class="line">        cardView.frontCard.expirationLabel.text = <span class="string">"\(month)/\(formattedYear)"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">flip</span><span class="params">(from: UIView, to: UIView, options: UIView.AnimationOptions)</span></span> &#123;</span><br><span class="line">        <span class="type">UIView</span>.transition(</span><br><span class="line">            from: from,</span><br><span class="line">            to: to,</span><br><span class="line">            duration: <span class="number">0.25</span>,</span><br><span class="line">            options: [options, .showHideTransitionViews],</span><br><span class="line">            completion: <span class="literal">nil</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>String+Extension.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ifEmpty</span><span class="params">(replaceWith: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isEmpty ? replaceWith : <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">chunk</span><span class="params">(by length: Int)</span></span> -&gt; [<span class="type">String</span>] &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: <span class="built_in">count</span>, by: length).<span class="built_in">map</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> start = index(startIndex, offsetBy: $<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">let</span> end = index(start, offsetBy: length, limitedBy: endIndex) ?? endIndex</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(<span class="keyword">self</span>[start..&lt;end])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-07-08T23:45:55.000Z" title="2020-07-08T23:45:55.000Z">2020-07-09</time><span class="level-item">a minute read (About 124 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-drag-and-drop-in-SwiftUI/">How to add drag and drop in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/594">#594</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SelectFileView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> buttonTitle: <span class="type">String</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> isDrop: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Button</span>(action: &#123;&#125;) &#123;</span><br><span class="line">                <span class="type">Text</span>(buttonTitle)</span><br><span class="line">            &#125;</span><br><span class="line">            .buttonStyle(<span class="type">ActionButtonStyle</span>())</span><br><span class="line">            .offset(x: -<span class="number">16</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">"Alternatively, you can drag and drop file here"</span>)</span><br><span class="line">                .font(.footnote)</span><br><span class="line">                .foregroundColor(<span class="type">Color</span>.gray)</span><br><span class="line">        &#125;</span><br><span class="line">        .border(isDrop ? <span class="type">R</span>.color.separator : <span class="type">Color</span>.clear)</span><br><span class="line">        .onDrop(of: [<span class="type">Constants</span>.urlFileType], delegate: <span class="keyword">self</span>)</span><br><span class="line">        .padding(.bottom, <span class="number">32</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">SelectFileView</span>: <span class="title">DropDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">dropEntered</span><span class="params">(info: DropInfo)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.isDrop = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">dropExited</span><span class="params">(info: DropInfo)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.isDrop = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">performDrop</span><span class="params">(info: DropInfo)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> itemProvider = info.itemProviders(<span class="keyword">for</span>: [<span class="type">Constants</span>.urlFileType]).first</span><br><span class="line">        <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</span><br><span class="line"></span><br><span class="line">        itemProvider.loadItem(forTypeIdentifier: <span class="type">Constants</span>.urlFileType, options: <span class="literal">nil</span>) &#123; item, error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span></span><br><span class="line">                <span class="keyword">let</span> data = item <span class="keyword">as</span>? <span class="type">Data</span>,</span><br><span class="line">                <span class="keyword">let</span> url = <span class="type">URL</span>(dataRepresentation: data, relativeTo: <span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/">Previous</a></div><div class="pagination-next"><a href="/page/3/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link is-current" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/22/">22</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">655</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">52</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-07T05:17:25.000Z">2020-12-07</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-support-right-click-menu-to-NSStatusItem/">How to support right click menu to NSStatusItem</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-07T05:05:04.000Z">2020-12-07</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-convert-struct-to-Core-Data-NSManagedObject/">How to convert struct to Core Data NSManagedObject</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-06T04:54:53.000Z">2020-12-06</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-hack-iOS-apps/">How to hack iOS apps</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-05T05:00:44.000Z">2020-12-05</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-format-ISO-date-string-in-Javascript/">How to format ISO date string in Javascript</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-05T04:44:54.000Z">2020-12-05</time></p><p class="title is-6"><a class="link-muted" href="/blog/Getting-to-know-some-pragmatic-programming-language-features/">Getting to know some pragmatic programming language features</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">45</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">47</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">34</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">165</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">50</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">107</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">304</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">66</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2020 Khoa Pham</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>