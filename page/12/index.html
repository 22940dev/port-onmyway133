<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>onmyway133</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta name="description" content="What you don&apos;t know is what you haven&apos;t learned">
<meta name="keywords" content="ios, android,javascript, react">
<meta property="og:type" content="website">
<meta property="og:title" content="onmyway133">
<meta property="og:url" content="https://onmyway133.github.io/page/12/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="What you don&apos;t know is what you haven&apos;t learned">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onmyway133">
<meta name="twitter:description" content="What you don&apos;t know is what you haven&apos;t learned">
  
    <link rel="alternate" href="/atom.xml" title="onmyway133" type="application/atom+xml">
  
  <link rel="icon" href="/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/about/"] = "About"; 

  themeMenus["/writing/"] = "writing"; 

  themeMenus["/archives"] = "Archives"; 

  themeMenus["/speaking/"] = "speaking"; 

  themeMenus["/opensource/"] = "open source"; 

  themeMenus["/projects/"] = "projects"; 

  themeMenus["/news/"] = "news"; 

  themeMenus["/gumroad/"] = "gumroad"; 

  themeMenus["/atom.xml"] = "rss"; 

</script>


  <body>


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="onmyway133" rel="home"> onmyway133 </a>
            
          </h1>

          
            <div class="site-description">What you don&#39;t know is what you haven&#39;t learned</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about/">About</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/writing/">writing</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/speaking/">speaking</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/opensource/">open source</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/projects/">projects</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/news/">news</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/gumroad/">gumroad</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/atom.xml">rss</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "https://avatars1.githubusercontent.com/u/2284279?s=460&v=4".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-Netcut-and-ARP"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Netcut-and-ARP/">Netcut and ARP</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Netcut-and-ARP/" class="article-date">
	  <time datetime="2018-02-27T11:18:35.000Z" itemprop="datePublished">February 27, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/153" target="_blank" rel="noopener">#153</a></strong></p>
<p>Bad people can use <a href="http://www.arcai.com/netcut/" target="_blank" rel="noopener">Netcut</a> to limit other ‘s internet access in same network</p>
<h3 id="How-does-Netcut-work"><a href="#How-does-Netcut-work" class="headerlink" title="How does Netcut work"></a>How does Netcut work</h3><p>Netcut uses attacking technique called ARP Spoofing.</p>
<p>ARP (Address Resolution Protocol) is a link layer procotol, it is used for resolving network layer address (IP) into link layer address (MAC).  </p>
<p>When we want to send IP packet to another host (a computer in the same LAN, or the Gateway), we must know the destination IP address. In order for the packet to reach the destination, the destination IP address must be converted to the corresponding MAC address, so the transmission can be processed in the data link layer. To setup this mapping IP-MAC in the ARP table, we must first send ARP request as broadcast one to the LAN. In the happy case, the one with the IP in the ARP request will reply us with his MAC address.</p>
<p>Unfortunately, ARP is a stateless protocol. This means we continue to accept ARP replies and overwrite the old ones, even they have not expired yet. Worse, ARP does not define any authentication method to check whether the replies come from the trusted one (the one we want to receive the replies). These offer chances for the attacker to perform ARP Spoofing.</p>
<h3 id="The-theory-behind-ARP-Spoofing"><a href="#The-theory-behind-ARP-Spoofing" class="headerlink" title="The theory behind ARP Spoofing"></a>The theory behind ARP Spoofing</h3><p>From the machine in the LAN, the attacker associate his MAC address and IP address of the target host (usually the Gateway), so that any traffic sent to that target host will come to the attacker. Here the attacker can decide whether to modify the packet, send or not.</p>
<h3 id="There-are-3-types-of-ARP-Spoofing"><a href="#There-are-3-types-of-ARP-Spoofing" class="headerlink" title="There are 3 types of ARP Spoofing"></a>There are 3 types of ARP Spoofing</h3><ol>
<li>Spoof the host computer  </li>
<li>Spoof the Gateway  </li>
<li>Spoof both the host computer and the Gateway</li>
</ol>
<h3 id="To-see-the-ARP-table"><a href="#To-see-the-ARP-table" class="headerlink" title="To see the ARP table"></a>To see the ARP table</h3><p>Open Command line (Windows) or Terminal (Mac OSX), and type</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp -a</span><br></pre></td></tr></table></figure>

<p>This will list the MAC address associated with a specific IP. Note that some mappings maybe wrong due to ARP Spoofing</p>
<h3 id="How-to-prevent-against-this"><a href="#How-to-prevent-against-this" class="headerlink" title="How to prevent against this ?"></a>How to prevent against this ?</h3><p>To prevent spoofing our computer, we can use softwares (search for Anti Netcut, Anti ARP spoofing, …) or set the static ARP ourselves. In fact, those softwares are based on setting static ARP. This way we set the static mapping IP-MAC for a specific host (computer or Gateway), and the OS definitely ignores all ARP replies for that IP.</p>
<p>Example of static ARP mapping associated with the Gateway, performed on the computer host</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.1 B4-B3-62-7C-CE-55</span><br></pre></td></tr></table></figure>

<p>Here 192.168.1.1 and B4-B3-62-7C-CE-55 are the Gateway’s IP and MAC address</p>
<p>To prevent spoofing the Gateway, we must set static ARP on that Gateway. Go to the Gateway/Router interface, in its ARP setting, fill in the mapping IP-MAC for a specific host  </p>
<p>Look for that Gateway manual or the related guide on how to perform this. This is devices dependent-method, but the theory remains the same.</p>
<p>Example of static ARP mapping associated with the computer host, performed on the Gateway</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.2 64-70-02-B2-9B-E1</span><br></pre></td></tr></table></figure>

<p>Here 192.168.1.2 and 64-70-02-B2-9B-E1 are the machine host ‘s IP and MAC address. The machine host can be any computer in the LAN</p>
<h3 id="How-to-set-static-ARP"><a href="#How-to-set-static-ARP" class="headerlink" title="How to set static ARP"></a>How to set static ARP</h3><p>Proposed that  </p>
<p>192.168.1.1 The destination host ‘s IP  </p>
<p>B4-B3-62-7C-CE-55 The destination host ‘s MAC  </p>
<p>Local Area Connection Our network interface name</p>
<p>Open Terminal (Mac OSX)</p>
<p>To delete specific mapping</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo arp -d 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>To set specific mapping</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo arp -s 192.168.1.1 B4-B3-62-7C-CE-55</span><br></pre></td></tr></table></figure>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ol>
<li><a href="http://en.wikipedia.org/wiki/ARP_spoofing" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/ARP_spoofing</a></li>
</ol>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tech/">tech</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Make-your-own-sliding-menu-on-Android-tutorial-Part-2"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Make-your-own-sliding-menu-on-Android-tutorial-Part-2/">Make your own sliding menu on Android tutorial – Part 2</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Make-your-own-sliding-menu-on-Android-tutorial-Part-2/" class="article-date">
	  <time datetime="2018-02-27T11:08:13.000Z" itemprop="datePublished">February 27, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        

          
            <div class="entry-summary" style="margin-left:0;">
            Issue #152
This is the part 2 of the tutorial. If you forget, here is the link to part 1.
Link to Github
In the first part, we learn about the idea, the structure of the project and how MainActivity uses the MainLayout. Now we learn how to actually implement the MainLayout
DISPLAY MENU AND CONTENT VIEWFirst we have MainLayout as a subclass of Li...
          

        
          <p class="article-more-link">
            <a href="/blog/Make-your-own-sliding-menu-on-Android-tutorial-Part-2/#more">Continue Reading →</a>
          </p>
        </div>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Make-your-own-sliding-menu-on-Android-tutorial-Part-1"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Make-your-own-sliding-menu-on-Android-tutorial-Part-1/">Make your own sliding menu on Android tutorial - Part 1</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Make-your-own-sliding-menu-on-Android-tutorial-Part-1/" class="article-date">
	  <time datetime="2018-02-27T11:07:48.000Z" itemprop="datePublished">February 27, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        

          
            <div class="entry-summary" style="margin-left:0;">
            Issue #151
This post was from long time ago when I did Android

I can’t deny that Facebook is so amazing, they made trends and people want to follow. That is the case of the sliding menu.
Searching many threads on SO, like these create android Sliding Menu like Facebook,gmail, Android sliding menu similar to the one on facebook, Android - Slidin...
          

        
          <p class="article-more-link">
            <a href="/blog/Make-your-own-sliding-menu-on-Android-tutorial-Part-1/#more">Continue Reading →</a>
          </p>
        </div>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Some-interesting-repositories"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Some-interesting-repositories/">Some interesting repositories</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Some-interesting-repositories/" class="article-date">
	  <time datetime="2018-02-15T12:48:02.000Z" itemprop="datePublished">February 15, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/150" target="_blank" rel="noopener">#150</a></strong></p>
<h3 id="Cool"><a href="#Cool" class="headerlink" title="Cool"></a>Cool</h3><ul>
<li><a href="https://github.com/GoogleChrome/puppeteer" target="_blank" rel="noopener">https://github.com/GoogleChrome/puppeteer</a></li>
</ul>
<h3 id="🙄"><a href="#🙄" class="headerlink" title="🙄"></a>🙄</h3><ul>
<li><a href="https://github.com/kelseyhightower/nocode" target="_blank" rel="noopener">https://github.com/kelseyhightower/nocode</a></li>
<li><a href="https://github.com/jackdclark/five" target="_blank" rel="noopener">https://github.com/jackdclark/five</a></li>
<li><a href="https://github.com/auchenberg/volkswagen" target="_blank" rel="noopener">https://github.com/auchenberg/volkswagen</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Dealing-with-updated-pod-in-BuddyBuild"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Dealing-with-updated-pod-in-BuddyBuild/">Dealing with updated pod in BuddyBuild</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Dealing-with-updated-pod-in-BuddyBuild/" class="article-date">
	  <time datetime="2018-02-01T11:37:57.000Z" itemprop="datePublished">February 1, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/149" target="_blank" rel="noopener">#149</a></strong></p>
<p>We’re using BuddyBuild as our CI. Today one of our dependencies gets a sweat update <a href="https://github.com/hyperoslo/BarcodeScanner/releases/tag/4.1.1" target="_blank" rel="noopener">https://github.com/hyperoslo/BarcodeScanner/releases/tag/4.1.1</a>. So we <code>pod update BarcodeScanner</code> in one of our projects that depends on it. All is fine when running locally. So I make a Pull Request and wait for the build to kick off in BuddyBuild.</p>
<p>For some reason, BuddyBuild can’t pick up the right version of Cocoapods, hence can’t update the new pods.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[!] The version of CocoaPods used to generate the lockfile (1.3.1) is higher than the version of the current executable (1.1.1). Incompatibility issues may arise.</span><br><span class="line"></span><br><span class="line">=== CocoaPods ===</span><br><span class="line">104</span><br><span class="line">    Switching CocoaPods version to 1.1.1</span><br><span class="line">105</span><br><span class="line">    Using Command Line: gem cleanup &quot;cocoapods&quot;</span><br><span class="line">106</span><br><span class="line">    Using Command Line: gem uninstall &quot;cocoapods&quot; --all --executables --force</span><br><span class="line">107</span><br><span class="line">    Using Command Line: gem install &quot;cocoapods&quot; --no-rdoc --no-ri --version &quot;1.1.1&quot;</span><br><span class="line">108</span><br><span class="line">    Unpacking caches - cocoapods pod specs</span><br><span class="line">109</span><br><span class="line">    Using Command Line: pod install --no-repo-update</span><br><span class="line">110</span><br><span class="line">    Analyzing dependencies</span><br><span class="line">111</span><br><span class="line">    Pre-downloading: `Tailor` from `https://github.com/zenangst/Tailor`, tag `3.0.0`</span><br><span class="line">112</span><br><span class="line">    [!] Unable to satisfy the following requirements:</span><br><span class="line">113</span><br><span class="line">    - `BarcodeScanner (~&gt; 4.0)` required by `Podfile`</span><br><span class="line">114</span><br><span class="line">    - `BarcodeScanner (~&gt; 4.0)` required by `Podfile`</span><br><span class="line">115</span><br><span class="line">    - `BarcodeScanner (~&gt; 4.0)` required by `Podfile`</span><br><span class="line">116</span><br><span class="line">    - `BarcodeScanner (~&gt; 4.0)` required by `Podfile`</span><br><span class="line">117</span><br><span class="line">    - `BarcodeScanner (~&gt; 4.0)` required by `Podfile`</span><br><span class="line">118</span><br><span class="line">    - `BarcodeScanner (~&gt; 4.0)` required by `Podfile`</span><br><span class="line">119</span><br><span class="line">    - `BarcodeScanner (= 4.1.1)` required by `Podfile.lock`</span><br><span class="line">120</span><br><span class="line">    None of your spec sources contain a spec satisfying the dependencies: `BarcodeScanner (~&gt; 4.0), BarcodeScanner (= 4.1.1)`.</span><br><span class="line">121</span><br><span class="line">    You have either:</span><br><span class="line">122</span><br><span class="line">     * out-of-date source repos which you can update with `pod repo update`.</span><br><span class="line">123</span><br><span class="line">     * mistyped the name or version.</span><br><span class="line">124</span><br><span class="line">     * not added the source repo that hosts the Podspec to your Podfile.</span><br><span class="line">125</span><br><span class="line">    Note: as of CocoaPods 1.0, `pod repo update` does not happen on `pod install` by default.</span><br></pre></td></tr></table></figure>

<h3 id="Trying-script"><a href="#Trying-script" class="headerlink" title="Trying script"></a>Trying script</h3><p>So I thought I could run some custom script to force BuddyBuild to update the pods. Start with <a href="https://docs.buddybuild.com/builds/custom_build_steps.html" target="_blank" rel="noopener">https://docs.buddybuild.com/builds/custom_build_steps.html</a></p>
<p>I commit the file <code>buddybuild_postclone.sh</code> with</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line"> </span><br><span class="line">pod repo update</span><br><span class="line">pod update BarcodeScanner</span><br></pre></td></tr></table></figure>

<p>Didn’t work. I then update the script with </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line"> </span><br><span class="line">pod repo remove master</span><br><span class="line">pod setup</span><br><span class="line">pod install</span><br></pre></td></tr></table></figure>

<p>Didn’t work. Taking a closer look at the log. I see</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Switching CocoaPods version to 1.1.1</span><br></pre></td></tr></table></figure>

<p>It seems BuddyBuild is using cocoapods 1.1.1. Mine is 1.4.0.</p>
<h3 id="Specifying-cocoapods-version"><a href="#Specifying-cocoapods-version" class="headerlink" title="Specifying cocoapods version"></a>Specifying cocoapods version</h3><p>So I need to specify the correct cocoapods version to make sure I and BuddyBuild are on the same page</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gem install bundler</span><br><span class="line">bundler init</span><br></pre></td></tr></table></figure>

<p>And in my <code>Gemfile</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># frozen_string_literal: true</span><br><span class="line"></span><br><span class="line">source &quot;https://rubygems.org&quot;</span><br><span class="line"></span><br><span class="line">git_source(:github) &#123;|repo_name| &quot;https://github.com/#&#123;repo_name&#125;&quot; &#125;</span><br><span class="line"></span><br><span class="line">gem &quot;cocoapods&quot;, &apos;~&gt; 1.0&apos;</span><br></pre></td></tr></table></figure>

<p>Then run</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundler install</span><br></pre></td></tr></table></figure>

<p>And check <code>Gemfile.lock</code> to make sure everything is OK</p>
<h3 id="Finally"><a href="#Finally" class="headerlink" title="Finally"></a>Finally</h3><p>Commit the changes, and now BuddyBuild is picking up the right cocoapods version, hence using the new pods</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">=== CocoaPods ===</span><br><span class="line">45</span><br><span class="line">    Switching CocoaPods version to 1.4.0</span><br><span class="line">46</span><br><span class="line">    Using Command Line: gem cleanup &quot;cocoapods&quot;</span><br><span class="line">47</span><br><span class="line">    Using Command Line: gem uninstall &quot;cocoapods&quot; --all --executables --force</span><br><span class="line">48</span><br><span class="line">    Using Command Line: gem install &quot;cocoapods&quot; --no-rdoc --no-ri --version &quot;1.4.0&quot;</span><br><span class="line">49</span><br><span class="line">    Unpacking caches - cocoapods pod specs</span><br><span class="line">50</span><br><span class="line">    Using Command Line: pod install --no-repo-update</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ci/">ci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cocoapods/">cocoapods</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Learning-from-Open-Source-Generic-Factory"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Learning-from-Open-Source-Generic-Factory/">Learning from Open Source  Generic Factory</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Learning-from-Open-Source-Generic-Factory/" class="article-date">
	  <time datetime="2018-01-26T12:40:28.000Z" itemprop="datePublished">January 26, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/148" target="_blank" rel="noopener">#148</a></strong></p>
<p>From <a href="https://github.com/devxoul/Pure/blob/master/Sources/Pure/FactoryModule.swift" target="_blank" rel="noopener">https://github.com/devxoul/Pure/blob/master/Sources/Pure/FactoryModule.swift</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">FactoryModule</span>: <span class="title">Module</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// A factory for `Self`.</span></span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Factory</span> = <span class="type">Pure</span>.<span class="type">Factory</span>&lt;<span class="type">Self</span>&gt;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// Creates an instance of a module with a dependency and a payload.</span></span><br><span class="line">  <span class="keyword">init</span>(dependency: <span class="type">Dependency</span>, payload: <span class="type">Payload</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From <a href="https://github.com/devxoul/Pure/blob/master/Sources/Pure/Factory.swift" target="_blank" rel="noopener">https://github.com/devxoul/Pure/blob/master/Sources/Pure/Factory.swift</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span>&lt;<span class="title">Module</span>: <span class="title">FactoryModule</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">let</span> dependencyClosure: () -&gt; <span class="type">Module</span>.<span class="type">Dependency</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/// A static dependency of a module.</span></span><br><span class="line">  <span class="keyword">open</span> <span class="keyword">var</span> dependency: <span class="type">Module</span>.<span class="type">Dependency</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.dependencyClosure()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// Creates an instance of `Factory`.</span></span><br><span class="line">  <span class="comment">///</span></span><br><span class="line">  <span class="comment">/// - parameter dependency: A static dependency which should be resolved in a composition root.</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(dependency: <span class="meta">@autoclosure</span> @escaping () -&gt; <span class="type">Module</span>.<span class="type">Dependency</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.dependencyClosure = dependency</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// Creates an instance of a module with a runtime parameter.</span></span><br><span class="line">  <span class="comment">///</span></span><br><span class="line">  <span class="comment">/// - parameter payload: A runtime parameter which is required to construct a module.</span></span><br><span class="line">  <span class="keyword">open</span> <span class="function"><span class="keyword">func</span> <span class="title">create</span><span class="params">(payload: Module.Payload)</span></span> -&gt; <span class="type">Module</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Module</span>.<span class="keyword">init</span>(dependency: <span class="keyword">self</span>.dependency, payload: payload)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From <a href="https://github.com/devxoul/Pure/blob/master/Tests/PureTests/PureSpec.swift#L72" target="_blank" rel="noopener">https://github.com/devxoul/Pure/blob/master/Tests/PureTests/PureSpec.swift#L72</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> factory = <span class="type">FactoryFixture</span>&lt;<span class="type">Dependency</span>, <span class="type">Payload</span>&gt;.<span class="type">Factory</span>(dependency: .<span class="keyword">init</span>(</span><br><span class="line">  networking: <span class="string">"Networking A"</span></span><br><span class="line">))</span><br><span class="line"><span class="keyword">let</span> instance = factory.create(payload: .<span class="keyword">init</span>(id: <span class="number">100</span>))</span><br><span class="line">expect(instance.dependency.networking) == <span class="string">"Networking A"</span></span><br><span class="line">expect(instance.payload.id) == <span class="number">100</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Using-camelCase-for-abbreviations"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Using-camelCase-for-abbreviations/">Using camelCase for abbreviations</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Using-camelCase-for-abbreviations/" class="article-date">
	  <time datetime="2018-01-26T12:02:44.000Z" itemprop="datePublished">January 26, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/147" target="_blank" rel="noopener">#147</a></strong></p>
<p>Each language and platform has its own coding style guide. This goes true when it comes to abbreviations. I’ve had some debates about whether to use <code>JSON</code>  or <code>Json</code>, <code>URL</code> or <code>Url</code>, <code>HTTP</code> or <code>Http</code>. </p>
<p>I personally prefer camelCase, so I’m very happy to see that Kotlin is on my side. See <a href="https://android.github.io/kotlin-guides/style.html#camel-case" target="_blank" rel="noopener">Kotlin Style guide</a>, I think this guide should be applied in other languages, such as Swift 😛 </p>
<blockquote>
<p>Sometimes there is more than one reasonable way to convert an English phrase into camel case, such as when acronyms or unusual constructs like “IPv6” or “iOS” are present. To improve predictability, use the following scheme.</p>
</blockquote>
<blockquote>
<p>Beginning with the prose form of the name:</p>
</blockquote>
<blockquote>
<ol>
<li>Convert the phrase to plain ASCII and remove any apostrophes. For example, “Müller’s algorithm” might become “Muellers algorithm”.</li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li>Divide this result into words, splitting on spaces and any remaining punctuation (typically hyphens).</li>
</ol>
</blockquote>
<blockquote>
<p>Recommended: if any word already has a conventional camel-case appearance in common usage, split this into its constituent parts (e.g., “AdWords” becomes “ad words”). Note that a word such as “iOS” is not really in camel case per se; it defies any convention, so this recommendation does not apply.</p>
</blockquote>
<blockquote>
<ol start="3">
<li>Now lowercase everything (including acronyms), then uppercase only the first character of:</li>
</ol>
</blockquote>
<blockquote>
<p>…each word, to yield pascal case, or</p>
</blockquote>
<blockquote>
<p>…each word except the first, to yield camel case</p>
</blockquote>
<blockquote>
<ol start="4">
<li>Finally, join all the words into a single identifier.</li>
</ol>
</blockquote>
<blockquote>
<p>Note that the casing of the original words is almost entirely disregarded.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Prose form</th>
<th>Correct</th>
<th>Incorrect</th>
</tr>
</thead>
<tbody><tr>
<td>“XML Http Request”</td>
<td>XmlHttpRequest</td>
<td>XMLHTTPRequest</td>
</tr>
<tr>
<td>“new customer ID”</td>
<td>newCustomerId</td>
<td>newCustomerID</td>
</tr>
<tr>
<td>“inner stopwatch”</td>
<td>innerStopwatch</td>
<td>innerStopWatch</td>
</tr>
<tr>
<td>“supports IPv6 on iOS”</td>
<td>supportsIpv6OnIos</td>
<td>supportsIPv6OnIOS</td>
</tr>
<tr>
<td>“YouTube importer”</td>
<td>YouTubeImporterYoutubeImporter*</td>
<td></td>
</tr>
</tbody></table>
<p>About <code>iOS</code> or <code>IOS</code>, I think I would go with <code>IOS</code>. I think <a href="https://facebook.github.io/react-native/docs/navigation.html#navigatorios" target="_blank" rel="noopener">React Native</a> thinks so too</p>
<blockquote>
<p>NavigatorIOS looks and feels just like UINavigationController, because it is actually built on top of it.</p>
</blockquote>
<h3 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h3><ul>
<li><a href="https://softwareengineering.stackexchange.com/questions/186277/should-the-variable-be-named-id-or-id" target="_blank" rel="noopener">https://softwareengineering.stackexchange.com/questions/186277/should-the-variable-be-named-id-or-id</a></li>
<li><a href="https://swift.org/documentation/api-design-guidelines/#promote-clear-usage" target="_blank" rel="noopener">https://swift.org/documentation/api-design-guidelines/#promote-clear-usage</a></li>
<li><a href="https://github.com/raywenderlich/swift-style-guide#naming" target="_blank" rel="noopener">https://github.com/raywenderlich/swift-style-guide#naming</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Learning-sine"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Learning-sine/">Learning sine</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Learning-sine/" class="article-date">
	  <time datetime="2018-01-26T11:53:54.000Z" itemprop="datePublished">January 26, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/146" target="_blank" rel="noopener">#146</a></strong></p>
<p>To be written …</p>
<p>Old math equations become useful today 😍 </p>
<ul>
<li><code>v = 1 - x</code></li>
<li>From <a href="https://www.desmos.com/calculator" target="_blank" rel="noopener">https://www.desmos.com/calculator</a></li>
</ul>
<p><img src="https://user-images.githubusercontent.com/2284279/35440591-576ec272-02a0-11e8-9e2a-b9749ad0db88.png" alt="sine"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tech/">tech</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-fix-Uncaught-Error-Cannot-find-module-react"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-fix-Uncaught-Error-Cannot-find-module-react/">How to fix Uncaught Error Cannot find module react</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-fix-Uncaught-Error-Cannot-find-module-react/" class="article-date">
	  <time datetime="2018-01-17T14:24:55.000Z" itemprop="datePublished">January 17, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/145" target="_blank" rel="noopener">#145</a></strong></p>
<p>This is my story through dealing with many dependencies when trying to package an electron app. Thanks to my friend <a href="https://github.com/timkurvers" target="_blank" rel="noopener">https://github.com/timkurvers</a> for helping me out ❤️  This is like a note for my future self</p>
<h3 id="Fixing-event"><a href="#Fixing-event" class="headerlink" title="Fixing event"></a>Fixing event</h3><p>The other I got an issue <a href="https://github.com/onmyway133/PushNotifications/issues/3" target="_blank" rel="noopener">https://github.com/onmyway133/PushNotifications/issues/3</a> that reports there’s something wrong with production environment. The problem is that I used <a href="http://www.material-ui.com/#/components/radio-button" target="_blank" rel="noopener">RadioButton</a> and its <code>onChange</code> callback takes 2 parameters instead of 1.</p>
<h3 id="Trying-packaging"><a href="#Trying-packaging" class="headerlink" title="Trying packaging"></a>Trying packaging</h3><p>After the fix, I bump version in <code>package.json</code> and run <code>yarn release</code>. To my surprise, the built app was just blank. I tried <code>win.toggleDevTools()</code> to see what’s going on. I can’t use shortcut to open the dev tool any more in production, but there are tools <a href="https://github.com/sindresorhus/electron-debug" target="_blank" rel="noopener">https://github.com/sindresorhus/electron-debug</a>. </p>
<p>The console says that it can’t find the module ‘react’. I then submitted an issue <a href="https://github.com/electron-userland/electron-packager/issues/787" target="_blank" rel="noopener">https://github.com/electron-userland/electron-packager/issues/787</a></p>
<blockquote>
<p>Uncaught Error: Cannot find module ‘react’</p>
</blockquote>
<p>My environment</p>
<ul>
<li>Node v8.4.0</li>
<li>npm 5.3.0</li>
<li>yarn 1.3.2</li>
<li>macOS 10.13.2</li>
</ul>
<h3 id="Inspecting-with-debug-mode"><a href="#Inspecting-with-debug-mode" class="headerlink" title="Inspecting with debug mode"></a>Inspecting with debug mode</h3><p>I then need to run in debug mode to see what’s really happening</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DEBUG=electron-packager npm run release</span><br></pre></td></tr></table></figure>

<p>The log says something about <code>npm</code></p>
<blockquote>
<p>Command failed: npm prune –production</p>
</blockquote>
<p>Digging a little, I found that this is quite a common issue</p>
<ul>
<li><a href="https://github.com/electron-userland/electron-packager/issues/686" target="_blank" rel="noopener">https://github.com/electron-userland/electron-packager/issues/686</a></li>
<li><a href="https://github.com/npm/npm/issues/17781" target="_blank" rel="noopener">https://github.com/npm/npm/issues/17781</a></li>
</ul>
<p>I think the issue may be because of I changed from <a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">https://github.com/creationix/nvm</a> to <a href="https://github.com/nodenv/nodenv" target="_blank" rel="noopener">https://github.com/nodenv/nodenv</a></p>
<h3 id="Updating-nodenv"><a href="#Updating-nodenv" class="headerlink" title="Updating nodenv"></a>Updating nodenv</h3><p>The latest stable version of <a href="https://nodejs.org/en/" target="_blank" rel="noopener">https://nodejs.org/en/</a> is 8.9.4. To enable <code>nodenv</code> to see it, we need</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew upgrade node-build</span><br></pre></td></tr></table></figure>

<p>Run the following so that you actually see the 8.9.4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodenv install --list</span><br></pre></td></tr></table></figure>

<h3 id="Updating-node-js"><a href="#Updating-node-js" class="headerlink" title="Updating node.js"></a>Updating node.js</h3><p>Install version 8.9.4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nodenv install 8.9.4</span><br><span class="line">nodenv global 8.9.4</span><br><span class="line">nodenv rehash</span><br></pre></td></tr></table></figure>

<h3 id="Updating-npm"><a href="#Updating-npm" class="headerlink" title="Updating npm"></a>Updating npm</h3><p>Run the following to update <code>npm</code> to 5.6.0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm update -g np</span><br></pre></td></tr></table></figure>

<h3 id="Installing-dependencies-from-scratch"><a href="#Installing-dependencies-from-scratch" class="headerlink" title="Installing dependencies from scratch"></a>Installing dependencies from scratch</h3><p>Clear old <code>node_modules</code> and <code>package-lock.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf node_modules</span><br><span class="line">rm -rf package-lock.json</span><br></pre></td></tr></table></figure>

<p>Then install again</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<h3 id="Packaging"><a href="#Packaging" class="headerlink" title="Packaging"></a>Packaging</h3><p>The final step is to package the app again</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn release</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-standalone-UINavigationBar-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-standalone-UINavigationBar-in-iOS/">How to use standalone UINavigationBar in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-standalone-UINavigationBar-in-iOS/" class="article-date">
	  <time datetime="2018-01-10T12:40:08.000Z" itemprop="datePublished">January 10, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/144" target="_blank" rel="noopener">#144</a></strong></p>
<p>There are times we want the same <code>UIViewController</code> to look good when it’s presented modally or pushed from <code>UINavigationController</code> stack. Take a look at BarcodeScanner and the PR <a href="https://github.com/hyperoslo/BarcodeScanner/pull/82" target="_blank" rel="noopener">https://github.com/hyperoslo/BarcodeScanner/pull/82</a></p>
<p>When it is presented, we need a header view so that we can show a title and a close button. We can create a custom <code>HeaderView</code> that inherits from <code>UIView</code> or either embed it in a <code>UINavigationController</code> before presenting.</p>
<p>If we go with the controller being embedded in <code>UINavigationController</code> approach, it will collide with the other <code>UINavigationController</code> when it is pushed.</p>
<p>If we go with custom <code>HeaderView</code>, then we need to layout the view so that it looks good on both portrait and landscape, and on iPhone X that as <code>safeAreaLayoutGuide</code>.</p>
<h2 id="Using-standalone-UINavigationBar"><a href="#Using-standalone-UINavigationBar" class="headerlink" title="Using standalone UINavigationBar"></a>Using standalone UINavigationBar</h2><p>Since <code>UINavigationController</code> uses <code>UINavigationBar</code> under the hood, which uses <code>UINavigationItem</code> info to present the content. We can imitate this behavior by using a standalone <code>UINavigationBar</code>. See <a href="https://developer.apple.com/documentation/uikit/uinavigationbar" target="_blank" rel="noopener">Adding Content to a Standalone Navigation Bar</a></p>
<blockquote>
<p>In the vast majority of scenarios you will use a navigation bar as part of a navigation controller. However, there are situations for which you might want to use the navigation bar UI and implement your own approach to content navigation. In these situations, you can use a standalone navigation bar.</p>
</blockquote>
<blockquote>
<p>A navigation bar manages a stack of UINavigationItem objects</p>
</blockquote>
<p>The beauty is that our standalone <code>UINavigationBar</code> and that of <code>UINavigationController</code> are the same, use the same <code>UINavigationItem</code> and no manual layout are needed</p>
<h3 id="Declare-UINavigationItem"><a href="#Declare-UINavigationItem" class="headerlink" title="Declare UINavigationItem"></a>Declare <code>UINavigationItem</code></h3><p>We can just set properties like we did with a normal <code>navigationItem</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> standaloneItem = <span class="type">UINavigationItem</span>()</span><br><span class="line">standaloneItem.leftBarButtonItem = <span class="type">UIBarButtonItem</span>(customView: closeButton)</span><br><span class="line">standaloneItem.titleView = <span class="type">UILabel</span>()</span><br></pre></td></tr></table></figure>

<h3 id="Adding-UINavigationBar"><a href="#Adding-UINavigationBar" class="headerlink" title="Adding UINavigationBar"></a>Adding <code>UINavigationBar</code></h3><p>Customise your bar, then declare layout constraints. You only need to pin left, right, and top. Note that you need to implement <code>UINavigationBarDelegate</code> to attach bar to status bar, so that it appears good on iPhone X too</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> navigationBar = <span class="type">UINavigationBar</span>()</span><br><span class="line">navigationBar.isTranslucent = <span class="literal">false</span></span><br><span class="line">navigationBar.delegate = <span class="keyword">self</span></span><br><span class="line">navigationBar.backgroundColor = .white</span><br><span class="line">navigationBar.items = [standaloneItem]</span><br><span class="line"> </span><br><span class="line">navigationBar.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">navigationBar.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = <span class="literal">true</span></span><br><span class="line">navigationBar.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = <span class="literal">true</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> #available(iOS <span class="number">11</span>, *) &#123;</span><br><span class="line">  navigationBar.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor).isActive = <span class="literal">true</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  navigationBar.topAnchor.constraint(equalTo: view.topAnchor).isActive = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">BarcodeScannerController</span>: <span class="title">UINavigationBarDelegate</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">position</span><span class="params">(<span class="keyword">for</span> bar: UIBarPositioning)</span></span> -&gt; <span class="type">UIBarPosition</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> .topAttached</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Inside-UINavigationController"><a href="#Inside-UINavigationController" class="headerlink" title="Inside UINavigationController"></a>Inside <code>UINavigationController</code></h3><p>When this <code>UIViewController</code> is pushed from a <code>UINavigationController</code> stack, we just need to hide our standalone <code>navigationBar</code>. If we prefer the default back button, we don’t need to set <code>leftBarButtonItem</code></p>
<p>On iOS 10, you need to call <code>sizeToFit</code> for any items in <code>UINavigationItem</code> for it to get actual size</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewWillAppear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewWillAppear(animated)</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">if</span> navigationController != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> label = <span class="type">HeaderElement</span>.makeLabel()</span><br><span class="line">      label.sizeToFit()</span><br><span class="line">      navigationItem.titleView = label</span><br><span class="line">    navigationBar.isHidden = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    navigationBar.isHidden = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-deal-with-animation-in-UITests-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-deal-with-animation-in-UITests-in-iOS/">How to deal with animation in UITests in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-deal-with-animation-in-UITests-in-iOS/" class="article-date">
	  <time datetime="2018-01-08T14:12:54.000Z" itemprop="datePublished">January 8, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/143" target="_blank" rel="noopener">#143</a></strong></p>
<p>Today I was writing tests and get this error related to <code>app idle</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t =    23.06s         Assertion Failure: &lt;unknown&gt;:0: Failed to scroll to visible (by AX action) Button, 0x6000003827d0, traits: 8858370049, label: &apos;cart&apos;, error: Error -25204 performing AXAction 2003 on element &lt;XCAccessibilityElement: 0x7fc391a2bd60&gt; pid: 91461, elementOrHash.elementID: 140658975676048.128</span><br></pre></td></tr></table></figure>

<p>It turns out that the project uses a HUD that is performing some progress animation. Even it was being called <code>HUD.hide()</code>, the problem still exists. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t =    31.55s     Wait for no.example.MyApp to idle</span><br><span class="line"> t =    91.69s         App animations complete notification not received, will attempt to continue.</span><br><span class="line"> t =    91.70s Tap Target Application 0x6040002a1260</span><br><span class="line"> t =    91.70s     Wait for no.example.MyApp to id</span><br></pre></td></tr></table></figure>

<p>No matter how I call <code>sleep,</code>wait`, still the problem</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sleep(<span class="number">10</span>)</span><br><span class="line">app.tap()</span><br><span class="line"><span class="number">_</span> = checkoutButton.waitForExistence(timeout: <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p>The fix is to disable animation. Start with setting argument when running tests</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.launchArguments.append(<span class="string">"--UITests"</span>)</span><br><span class="line">app.launch</span><br></pre></td></tr></table></figure>

<p>Then in <code>AppDelegate</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(<span class="number">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: <span class="keyword">Any</span>]?)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> <span class="type">CommandLine</span>.arguments.<span class="built_in">contains</span>(<span class="string">"--UITests"</span>) &#123;</span><br><span class="line">    <span class="type">UIView</span>.setAnimationsEnabled(<span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/testing/">testing</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-generate-QR-code-in-AppKit"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-generate-QR-code-in-AppKit/">How to generate QR code in AppKit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-generate-QR-code-in-AppKit/" class="article-date">
	  <time datetime="2018-01-06T17:41:50.000Z" itemprop="datePublished">January 6, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/140" target="_blank" rel="noopener">#140</a></strong></p>
<p>I need to generate QR code in <a href="https://github.com/onmyway133/AddressGenerator" target="_blank" rel="noopener">https://github.com/onmyway133/AddressGenerator</a>. Fortunately with <code>CoreImage</code> filter, it is very easy. Code is in Swift 4</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> AppKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">QRCodeGenerator</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">generate</span><span class="params">(string: String, size: CGSize)</span></span> -&gt; <span class="type">NSImage?</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> data = string.data(using: .utf8) <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Filter</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> <span class="built_in">filter</span> = <span class="type">CIFilter</span>(name: <span class="string">"CIQRCodeGenerator"</span>) <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">filter</span>.setValue(data, forKey: <span class="string">"inputMessage"</span>)</span><br><span class="line">    <span class="built_in">filter</span>.setValue(<span class="string">"Q"</span>, forKey: <span class="string">"inputCorrectionLevel"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CIImage</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> ciImage = <span class="built_in">filter</span>.outputImage <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// NSImage</span></span><br><span class="line">    <span class="keyword">let</span> rep = <span class="type">NSCIImageRep</span>(ciImage: ciImage)</span><br><span class="line">    <span class="keyword">let</span> image = <span class="type">NSImage</span>(size: rep.size)</span><br><span class="line">    image.addRepresentation(rep)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Scale</span></span><br><span class="line">    <span class="keyword">let</span> finalImage = <span class="type">NSImage</span>(size: size)</span><br><span class="line">    finalImage.lockFocus()</span><br><span class="line">    <span class="type">NSGraphicsContext</span>.current?.imageInterpolation = .<span class="keyword">none</span></span><br><span class="line">    image.draw(<span class="keyword">in</span>: <span class="type">NSRect</span>(origin: .zero, size: size))</span><br><span class="line">    finalImage.unlockFocus()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> finalImage</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-Function-Literals-with-Receiver-in-Kotlin"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-Function-Literals-with-Receiver-in-Kotlin/">How to use Function Literals with Receiver in Kotlin</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-Function-Literals-with-Receiver-in-Kotlin/" class="article-date">
	  <time datetime="2018-01-05T12:54:26.000Z" itemprop="datePublished">January 5, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/139" target="_blank" rel="noopener">#139</a></strong></p>
<p>From <a href="https://kotlinlang.org/docs/reference/lambdas.html" target="_blank" rel="noopener">https://kotlinlang.org/docs/reference/lambdas.html</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTML</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">body</span><span class="params">()</span></span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">html</span><span class="params">(<span class="keyword">init</span>: <span class="type">HTML</span>.() -&gt; <span class="type">Unit</span>)</span></span>: HTML &#123;</span><br><span class="line">    <span class="keyword">val</span> html = HTML()  <span class="comment">// create the receiver object</span></span><br><span class="line">    html.<span class="keyword">init</span>()        <span class="comment">// pass the receiver object to the lambda</span></span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">html &#123;       <span class="comment">// lambda with receiver begins here</span></span><br><span class="line">    body()   <span class="comment">// calling a method on the receiver object</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From <a href="https://github.com/JetBrains/kotlin/blob/master/libraries/stdlib/src/kotlin/util/Standard.kt" target="_blank" rel="noopener">https://github.com/JetBrains/kotlin/blob/master/libraries/stdlib/src/kotlin/util/Standard.kt</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@kotlin</span>.<span class="keyword">internal</span>.InlineOnly</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">apply</span><span class="params">(block: <span class="type">T</span>.() -&gt; <span class="type">Unit</span>)</span></span>: T &#123;</span><br><span class="line">    contract &#123;</span><br><span class="line">        callsInPlace(block, InvocationKind.EXACTLY_ONCE)</span><br><span class="line">    &#125;</span><br><span class="line">    block()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> person = Person().apply &#123;</span><br><span class="line">  name = <span class="string">"Superman"</span></span><br><span class="line">  age = <span class="number">20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From <a href="https://academy.realm.io/posts/kau-jake-wharton-testing-robots/" target="_blank" rel="noopener">https://academy.realm.io/posts/kau-jake-wharton-testing-robots/</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">payment</span><span class="params">(func: <span class="type">PaymentRobot</span>.() -&gt; <span class="type">Unit</span>)</span></span> = PaymentRobot().apply &#123; func() &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PaymentRobot</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">amount</span><span class="params">(amount: <span class="type">Long</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">recipient</span><span class="params">(recipient: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> <span class="title">send</span><span class="params">(func: <span class="type">ResultRobot</span>.() -&gt; <span class="type">Unit</span>)</span></span>: ResultRobot &#123;</span><br><span class="line">	  <span class="comment">// ...</span></span><br><span class="line">	  <span class="keyword">return</span> ResultRobot().apply &#123; func() &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultRobot</span> </span>&#123;</span><br><span class="line">	func isSuccess() &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">payment &#123;</span><br><span class="line">	amount(<span class="number">4200</span>)</span><br><span class="line">	recipient(<span class="symbol">superman@</span>google.com)</span><br><span class="line">&#125; send &#123;</span><br><span class="line">	isSuccess()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-R.swift-in-UITest-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-R.swift-in-UITest-in-iOS/">How to use R.swift in UITest in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-R.swift-in-UITest-in-iOS/" class="article-date">
	  <time datetime="2018-01-05T10:22:38.000Z" itemprop="datePublished">January 5, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/138" target="_blank" rel="noopener">#138</a></strong></p>
<p>Here is how to use <a href="https://github.com/mac-cain13/R.swift" target="_blank" rel="noopener">R.swift</a> in UITest target</p>
<ul>
<li>Add <code>Localizable.strings</code> to UITest target</li>
<li>Declare pod</li>
</ul>
<figure class="highlight rb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target <span class="string">'MyAppUITests'</span> <span class="keyword">do</span></span><br><span class="line">  pod <span class="string">'R.swift'</span>, <span class="string">'~&gt; 4.0'</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<ul>
<li>In UITest target settings, add <code>$(FRAMEWORK_SEARCH_PATHS)</code> to Runpath Search Path</li>
<li>Add <code>R.generated.swift</code> to UITest target</li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Hiding-back-button-in-navigation-bar-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Hiding-back-button-in-navigation-bar-in-iOS/">Hiding back button in navigation bar in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Hiding-back-button-in-navigation-bar-in-iOS/" class="article-date">
	  <time datetime="2018-01-04T08:25:12.000Z" itemprop="datePublished">January 4, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/137" target="_blank" rel="noopener">#137</a></strong></p>
<p>Use a custom <code>NavigationController</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NavigationController</span>: <span class="title">UINavigationController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">    navigationBar.tintColor = .white</span><br><span class="line">    navigationBar.barStyle = .black</span><br><span class="line">    navigationBar.isTranslucent = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">pushViewController</span><span class="params">(<span class="number">_</span> viewController: UIViewController, animated: Bool)</span></span> &#123;</span><br><span class="line">    viewController.navigationItem.backBarButtonItem =</span><br><span class="line">      <span class="type">UIBarButtonItem</span>(title: <span class="string">""</span>, style: .plain, target: <span class="literal">nil</span>, action: <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">super</span>.pushViewController(viewController, animated: animated)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Some-Swift-tips"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Some-Swift-tips/">Some Swift tips</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Some-Swift-tips/" class="article-date">
	  <time datetime="2018-01-03T14:09:55.000Z" itemprop="datePublished">January 3, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/136" target="_blank" rel="noopener">#136</a></strong></p>
<h3 id="Adding-final"><a href="#Adding-final" class="headerlink" title="Adding final"></a>Adding final</h3><ul>
<li><a href="https://gist.github.com/krzysztofzablocki/8c9a6c428cf5fcf19effca223a5548cd" target="_blank" rel="noopener">https://gist.github.com/krzysztofzablocki/8c9a6c428cf5fcf19effca223a5548cd</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Learning-from-Open-Source-Making-Deferred-in-Kotlin"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Learning-from-Open-Source-Making-Deferred-in-Kotlin/">Learning from Open Source  Making Deferred in Kotlin</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Learning-from-Open-Source-Making-Deferred-in-Kotlin/" class="article-date">
	  <time datetime="2018-01-03T12:52:21.000Z" itemprop="datePublished">January 3, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/135" target="_blank" rel="noopener">#135</a></strong></p>
<p>From <a href="https://github.com/JakeWharton/retrofit2-kotlin-coroutines-adapter/blob/master/src/main/java/com/jakewharton/retrofit2/adapter/kotlin/coroutines/experimental/CoroutineCallAdapterFactory.kt#L86" target="_blank" rel="noopener">https://github.com/JakeWharton/retrofit2-kotlin-coroutines-adapter/blob/master/src/main/java/com/jakewharton/retrofit2/adapter/kotlin/coroutines/experimental/CoroutineCallAdapterFactory.kt#L86</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">adapt</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;)</span></span>: Deferred&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">val</span> deferred = CompletableDeferred&lt;T&gt;()</span><br><span class="line"></span><br><span class="line">  deferred.invokeOnCompletion &#123;</span><br><span class="line">    <span class="keyword">if</span> (deferred.isCancelled) &#123;</span><br><span class="line">      call.cancel()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  call.enqueue(<span class="keyword">object</span> : Callback&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onFailure</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;, t: <span class="type">Throwable</span>)</span></span> &#123;</span><br><span class="line">      deferred.completeExceptionally(t)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onResponse</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;, response: <span class="type">Response</span>&lt;<span class="type">T</span>&gt;)</span></span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (response.isSuccessful) &#123;</span><br><span class="line">        deferred.complete(response.body()!!)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        deferred.completeExceptionally(HttpException(response))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> deferred</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Learning-from-Open-Source-Using-dylib-in-macOS-applications"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Learning-from-Open-Source-Using-dylib-in-macOS-applications/">Learning from Open Source  Using dylib in macOS applications</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Learning-from-Open-Source-Using-dylib-in-macOS-applications/" class="article-date">
	  <time datetime="2018-01-03T11:37:12.000Z" itemprop="datePublished">January 3, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/134" target="_blank" rel="noopener">#134</a></strong></p>
<ul>
<li><a href="https://github.com/mortenjust/androidtool-mac" target="_blank" rel="noopener">https://github.com/mortenjust/androidtool-mac</a></li>
<li><a href="https://github.com/mortenjust/droptogif" target="_blank" rel="noopener">https://github.com/mortenjust/droptogif</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Using-dlopen-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Using-dlopen-in-iOS/">Using dlopen in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Using-dlopen-in-iOS/" class="article-date">
	  <time datetime="2018-01-02T07:48:51.000Z" itemprop="datePublished">January 2, 2018</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/133" target="_blank" rel="noopener">#133</a></strong></p>
<p>With <code>dlopen</code> we can make uses of some private frameworks. It will be fun</p>
<p>From <a href="http://blog.zats.io/2017/12/27/iPhone-X-home-button/" target="_blank" rel="noopener">iPhone X home button</a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// somewhere in viewDidLoad</span></span><br><span class="line">dlopen([binaryPath cStringUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>], RTLD_NOW);</span><br><span class="line"><span class="built_in">UIView</span> *<span class="keyword">const</span> view = [[<span class="built_in">NSClassFromString</span>(<span class="string">@"SBHomeGrabberView"</span>) alloc] init];</span><br><span class="line">[view sizeToFit];</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:view];</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Learning-from-Open-Source-Hit-testing-with-UIWindow"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Learning-from-Open-Source-Hit-testing-with-UIWindow/">Learning from Open Source  Hit testing with UIWindow</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Learning-from-Open-Source-Hit-testing-with-UIWindow/" class="article-date">
	  <time datetime="2017-12-22T11:10:43.000Z" itemprop="datePublished">December 22, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/132" target="_blank" rel="noopener">#132</a></strong></p>
<p>From <a href="https://github.com/Flipboard/FLEX/blob/master/Classes/ExplorerInterface/FLEXWindow.m" target="_blank" rel="noopener">https://github.com/Flipboard/FLEX/blob/master/Classes/ExplorerInterface/FLEXWindow.m</a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.backgroundColor = [<span class="built_in">UIColor</span> clearColor];</span><br><span class="line">        <span class="comment">// Some apps have windows at UIWindowLevelStatusBar + n.</span></span><br><span class="line">        <span class="comment">// If we make the window level too high, we block out UIAlertViews.</span></span><br><span class="line">        <span class="comment">// There's a balance between staying above the app's windows and staying below alerts.</span></span><br><span class="line">        <span class="comment">// UIWindowLevelStatusBar + 100 seems to hit that balance.</span></span><br><span class="line">        <span class="keyword">self</span>.windowLevel = <span class="built_in">UIWindowLevelStatusBar</span> + <span class="number">100.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)pointInside:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> pointInside = <span class="literal">NO</span>;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.eventDelegate shouldHandleTouchAtPoint:point]) &#123;</span><br><span class="line">        pointInside = [<span class="keyword">super</span> pointInside:point withEvent:event];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pointInside;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From <a href="https://github.com/Flipboard/FLEX/blob/master/Classes/ExplorerInterface/FLEXExplorerViewController.m" target="_blank" rel="noopener">https://github.com/Flipboard/FLEX/blob/master/Classes/ExplorerInterface/FLEXExplorerViewController.m</a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)shouldReceiveTouchAtWindowPoint:(<span class="built_in">CGPoint</span>)pointInWindowCoordinates</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> shouldReceiveTouch = <span class="literal">NO</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGPoint</span> pointInLocalCoordinates = [<span class="keyword">self</span>.view convertPoint:pointInWindowCoordinates fromView:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Always if it's on the toolbar</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(<span class="keyword">self</span>.explorerToolbar.frame, pointInLocalCoordinates)) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Always if we're in selection mode</span></span><br><span class="line">    <span class="keyword">if</span> (!shouldReceiveTouch &amp;&amp; <span class="keyword">self</span>.currentMode == FLEXExplorerModeSelect) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Always in move mode too</span></span><br><span class="line">    <span class="keyword">if</span> (!shouldReceiveTouch &amp;&amp; <span class="keyword">self</span>.currentMode == FLEXExplorerModeMove) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Always if we have a modal presented</span></span><br><span class="line">    <span class="keyword">if</span> (!shouldReceiveTouch &amp;&amp; <span class="keyword">self</span>.presentedViewController) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> shouldReceiveTouch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-NSCollectionView-programatically-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-NSCollectionView-programatically-in-Swift/">How to make NSCollectionView programatically in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-NSCollectionView-programatically-in-Swift/" class="article-date">
	  <time datetime="2017-12-21T12:54:45.000Z" itemprop="datePublished">December 21, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/131" target="_blank" rel="noopener">#131</a></strong></p>
<p>Here’s how to create <code>NSCollectionView</code> programatically. We need to embed it inside <code>NScrollView</code> for scrolling to work. Code is in Swift 4</p>
<h3 id="NSCollectionView"><a href="#NSCollectionView" class="headerlink" title="NSCollectionView"></a>NSCollectionView</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> layout = <span class="type">NSCollectionViewFlowLayout</span>()</span><br><span class="line">layout.minimumLineSpacing = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">collectionView = <span class="type">NSCollectionView</span>()</span><br><span class="line">collectionView.dataSource = <span class="keyword">self</span></span><br><span class="line">collectionView.delegate = <span class="keyword">self</span></span><br><span class="line">collectionView.collectionViewLayout = layout</span><br><span class="line">collectionView.allowsMultipleSelection = <span class="literal">false</span></span><br><span class="line">collectionView.backgroundColors = [.clear]</span><br><span class="line">collectionView.isSelectable = <span class="literal">true</span></span><br><span class="line">collectionView.register(</span><br><span class="line">  <span class="type">Cell</span>.<span class="keyword">self</span>,</span><br><span class="line">  forItemWithIdentifier: <span class="type">NSUserInterfaceItemIdentifier</span>(rawValue: <span class="string">"Cell"</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="NScrollView"><a href="#NScrollView" class="headerlink" title="NScrollView"></a>NScrollView</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scrollView = <span class="type">NSScrollView</span>()</span><br><span class="line">scrollView.documentView = collectionView</span><br><span class="line">view.addSubview(scrollView)</span><br></pre></td></tr></table></figure>

<h3 id="NSCollectionViewItem"><a href="#NSCollectionViewItem" class="headerlink" title="NSCollectionViewItem"></a>NSCollectionViewItem</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Cell</span>: <span class="title">NSCollectionViewItem</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> label = <span class="type">Label</span>()</span><br><span class="line">  <span class="keyword">let</span> myImageView = <span class="type">NSImageView</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">loadView</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.view = <span class="type">NSView</span>()</span><br><span class="line">    <span class="keyword">self</span>.view.wantsLayer = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="NSCollectionViewDataSource"><a href="#NSCollectionViewDataSource" class="headerlink" title="NSCollectionViewDataSource"></a>NSCollectionViewDataSource</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: NSCollectionView, numberOfItemsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> coins.<span class="built_in">count</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: NSCollectionView, itemForRepresentedObjectAt indexPath: IndexPath)</span></span> -&gt; <span class="type">NSCollectionViewItem</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> cell = collectionView.makeItem(</span><br><span class="line">    withIdentifier: <span class="type">NSUserInterfaceItemIdentifier</span>(rawValue: <span class="string">"Cell"</span>),</span><br><span class="line">    <span class="keyword">for</span>: indexPath</span><br><span class="line">  ) <span class="keyword">as</span>! <span class="type">Cell</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> coin = coins[indexPath.item]</span><br><span class="line"></span><br><span class="line">  cell.label.stringValue = coin.name</span><br><span class="line">  cell.coinImageView.image =</span><br><span class="line">    <span class="type">NSImage</span>(named: <span class="type">NSImage</span>.<span class="type">Name</span>(rawValue: <span class="string">"USD"</span>))</span><br><span class="line">    ?? <span class="type">NSImage</span>(named: <span class="type">NSImage</span>.<span class="type">Name</span>(rawValue: <span class="string">"Others"</span>))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> cell</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="NSCollectionViewDelegateFlowLayout"><a href="#NSCollectionViewDelegateFlowLayout" class="headerlink" title="NSCollectionViewDelegateFlowLayout"></a>NSCollectionViewDelegateFlowLayout</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: NSCollectionView, didSelectItemsAt indexPaths: Set&lt;IndexPath&gt;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> indexPath = indexPaths.first,</span><br><span class="line">    <span class="keyword">let</span> cell = collectionView.item(at: indexPath) <span class="keyword">as</span>? <span class="type">Cell</span> <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: NSCollectionView, didDeselectItemsAt indexPaths: Set&lt;IndexPath&gt;)</span></span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> indexPath = indexPaths.first,</span><br><span class="line">    <span class="keyword">let</span> cell = collectionView.item(at: indexPath) <span class="keyword">as</span>? <span class="type">Cell</span> <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: NSCollectionView, layout collectionViewLayout: NSCollectionViewLayout, sizeForItemAt indexPath: IndexPath)</span></span> -&gt; <span class="type">NSSize</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="type">NSSize</span>(</span><br><span class="line">    width: collectionView.frame.size.width,</span><br><span class="line">    height: <span class="number">40</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-UnsafePointer-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/UnsafePointer-in-Swift/">UnsafePointer in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/UnsafePointer-in-Swift/" class="article-date">
	  <time datetime="2017-12-20T15:58:30.000Z" itemprop="datePublished">December 20, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/130" target="_blank" rel="noopener">#130</a></strong></p>
<p>Code is in Swift 4</p>
<h3 id="Constructing-UnsafeMutablePointer"><a href="#Constructing-UnsafeMutablePointer" class="headerlink" title="Constructing UnsafeMutablePointer"></a>Constructing UnsafeMutablePointer</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> byteCount = <span class="number">32</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">UInt8</span>&gt;.allocate(capacity: byteCount)</span><br></pre></td></tr></table></figure>

<h3 id="Data-to-UnsafePointer"><a href="#Data-to-UnsafePointer" class="headerlink" title="Data to UnsafePointer"></a>Data to UnsafePointer</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Data</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">toPointer</span><span class="params">()</span></span> -&gt; <span class="type">UnsafePointer</span>&lt;<span class="type">UInt8</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">let</span> buffer = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">UInt8</span>&gt;.allocate(capacity: <span class="built_in">count</span>)</span><br><span class="line">    <span class="keyword">let</span> stream = <span class="type">OutputStream</span>(toBuffer: buffer, capacity: <span class="built_in">count</span>)</span><br><span class="line"></span><br><span class="line">    stream.<span class="keyword">open</span>()</span><br><span class="line">    withUnsafeBytes(&#123; (p: <span class="type">UnsafePointer</span>&lt;<span class="type">UInt8</span>&gt;) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">      stream.write(p, maxLength: <span class="built_in">count</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    stream.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">UnsafePointer</span>&lt;<span class="type">UInt8</span>&gt;(buffer)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UnsafePointer-to-Data"><a href="#UnsafePointer-to-Data" class="headerlink" title="UnsafePointer to Data"></a>UnsafePointer to Data</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UnsafePointer</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">toData</span><span class="params">()</span></span> -&gt; <span class="type">Data</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Data</span>(bytes: <span class="type">UnsafeRawPointer</span>(<span class="keyword">self</span>), <span class="built_in">count</span>: <span class="number">32</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dealing-with-C-API"><a href="#Dealing-with-C-API" class="headerlink" title="Dealing with C API"></a>Dealing with C API</h3><p>This is how to do keccak hash using C API from <a href="https://github.com/ethereum/ethash/blob/master/src/libethash/sha3.c" target="_blank" rel="noopener">https://github.com/ethereum/ethash/blob/master/src/libethash/sha3.c</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeccakHash</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">hash</span><span class="params">(data: Data)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Data</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> dataPointer = data.toPointer() <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="type">InteralError</span>.invalid</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> byteCount = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">UInt8</span>&gt;.allocate(capacity: byteCount)</span><br><span class="line">    sha3_256(result, byteCount, dataPointer, data.<span class="built_in">count</span>)</span><br><span class="line">    <span class="keyword">return</span> result.toData()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li>See <a href="https://github.com/onmyway133/Reindeers/blob/master/Sources/Extensions.swift" target="_blank" rel="noopener">https://github.com/onmyway133/Reindeers/blob/master/Sources/Extensions.swift</a></li>
<li><a href="https://oleb.net/blog/2017/12/importing-c-library-into-swift/" target="_blank" rel="noopener"><br>How to import a C library in Swift using the Swift Package Manager</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-prevent-UIVisualEffectView-crash"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-prevent-UIVisualEffectView-crash/">How to prevent UIVisualEffectView crash</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-prevent-UIVisualEffectView-crash/" class="article-date">
	  <time datetime="2017-12-20T09:40:35.000Z" itemprop="datePublished">December 20, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/124" target="_blank" rel="noopener">#124</a></strong></p>
<p>We all know that there’s a potential crash with <code>UIVisualEffectView</code> on iOS 11. The fix is to not add sub views directly to <code>UIVisualEffectView</code>, but to its <code>contentView</code>. So we should change</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">effectView.addSubview(button)</span><br></pre></td></tr></table></figure>

<p>to </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">effectView.contentView.addubView(button)</span><br></pre></td></tr></table></figure>

<p>Here we don’t need to perform iOS version check, because <code>effectView.contentView</code> works for any iOS versions.</p>
<h3 id="Potential-cases-for-crashes"><a href="#Potential-cases-for-crashes" class="headerlink" title="Potential cases for crashes"></a>Potential cases for crashes</h3><p>Here are some cases you can potentially cause the crashes</p>
<p><strong><em>Strange namings</em></strong></p>
<p>Normally we name our <code>UIVisualEffectView</code> as <code>blurView</code>, <code>effectView</code>. But there’s times we name it differently like <code>navigationView</code>, <code>containerView</code>, <code>boxView</code>, … This way we may completely forget that it’s a <code>UIVisualEffectView</code> 🙀 </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">containerView.addSubview(button)</span><br><span class="line">boxView.insertSubview(label, at: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p><strong><em>Custom loadView</em></strong></p>
<p>Sometimes it’s convenient to have our <code>UIViewController &#39;s view</code> as a whole blur view, so that all things inside have a nice blur effect background</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OverlayController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> blurView = <span class="type">UIVisualEffectView</span>(effect: <span class="type">UIBlurEffect</span>(style: .dark))</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">loadView</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.loadView()</span><br><span class="line">    <span class="keyword">self</span>.view = blurView</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    view.addSubview(button)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>By setting our <code>blurView</code> as <code>view</code> in <code>loadView</code>, we have no idea afterwards that <code>view</code> is actually a <code>UIVisualEffectView</code> 🙀 </p>
<p><strong><em>Inheritance</em></strong></p>
<p>What happen if we have another <code>UIViewController</code> that inherits from our <code>OverlayController</code>, all it knows about <code>view</code> is <code>UIView</code>, it does not know that it is a disguising <code>UIVisualEffectView</code> 🙀 </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClocksController</span>: <span class="title">OverlayController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    view.addSubview(timeLabel)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><em>Superclass type</em></strong></p>
<p>Sometimes declare our things but with protocol or superclass types. Consumers of our API have no clue to know that it is <code>UIVisualEffectView</code> 🙀 </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> view: <span class="type">UIView</span> = <span class="type">UIVisualEffectView</span>(effect: <span class="type">UIBlurEffect</span>(style: .dark))</span><br></pre></td></tr></table></figure>

<p>Here it appears to us that <code>view</code> is of type <code>UIView</code></p>
<p><strong><em>Legacy codebase</em></strong></p>
<p>Now imagine you ‘ve handled a legacy codebase to deal with. Perform finding and replacing all those things related to <code>UIVisualEffectView</code> is very hard task. Especially since we tend to write less tests for UI</p>
<h3 id="Making-it-impossible-to-crash"><a href="#Making-it-impossible-to-crash" class="headerlink" title="Making it impossible to crash"></a>Making it impossible to crash</h3><p>I like concept like <a href="https://wiki.haskell.org/Phantom_type" target="_blank" rel="noopener">Phantom type</a> to limit interface. Here we’re not using type but a wrapper </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">BlurView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">let</span> effectView: <span class="type">UIVisualEffectView</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">init</span>(style: <span class="type">UIBlurEffectStyle</span>, backgroundColor: <span class="type">UIColor?</span> = <span class="literal">nil</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.effectView = <span class="type">UIVisualEffectView</span>(effect: <span class="type">UIBlurEffect</span>(style: style))</span><br><span class="line">    <span class="keyword">self</span>.effectView.backgroundColor = backgroundColor</span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>(frame: .zero)</span><br><span class="line">    insertSubview(effectView, at: <span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">    <span class="built_in">fatalError</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">addSubview</span><span class="params">(<span class="number">_</span> view: UIView)</span></span> &#123;</span><br><span class="line">    effectView.contentView.addSubview(view)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.layoutSubviews()</span><br><span class="line"></span><br><span class="line">    effectView.frame = bounds</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here we override <code>addSubview</code> to always add views to <code>effectView.contentView</code>. In the <code>init</code> method, we need to call <code>insertSubview</code> instead because of our overriden <code>addSubview</code></p>
<p>Now <code>BlurView</code> has a blur effect thanks to is underlying <code>UIVisualEffectView</code>, but expose only <code>addSubview</code> because of its <code>UIView</code> interface. This way it is impossible to cause crashes 😎 </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> blurView = <span class="type">BlurView</span>(style: .dark)</span><br><span class="line">blurView.addSubview(button(</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Understanding-suspend-function-in-Kotlin-Coroutine-in-Android"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Understanding-suspend-function-in-Kotlin-Coroutine-in-Android/">Understanding suspend function in Kotlin Coroutine in Android</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Understanding-suspend-function-in-Kotlin-Coroutine-in-Android/" class="article-date">
	  <time datetime="2017-12-18T14:41:21.000Z" itemprop="datePublished">December 18, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/123" target="_blank" rel="noopener">#123</a></strong></p>
<h2 id="Getting-to-know-Coroutine"><a href="#Getting-to-know-Coroutine" class="headerlink" title="Getting to know Coroutine"></a>Getting to know Coroutine</h2><p>From <a href="https://kotlinlang.org/docs/reference/coroutines.html" target="_blank" rel="noopener">https://kotlinlang.org/docs/reference/coroutines.html</a></p>
<blockquote>
<p>To continue the analogy, await() can be a suspending function (hence also callable from within an async {} block) that suspends a coroutine until some computation is done and returns its result:</p>
</blockquote>
<p>From <a href="https://kotlinlang.org/docs/tutorials/coroutines-basic-jvm.html" target="_blank" rel="noopener">https://kotlinlang.org/docs/tutorials/coroutines-basic-jvm.html</a></p>
<blockquote>
<p>We are using the delay() function that’s like Thread.sleep(), but better: it doesn’t block a thread, but only suspends the coroutine itself. The thread is returned to the pool while the coroutine is waiting, and when the waiting is done, the coroutine resumes on a free thread in the pool.</p>
</blockquote>
<blockquote>
<p>await() can not be called outside a coroutine, because it needs to suspend until the computation finishes, and only coroutines can suspend in a non-blocking way</p>
</blockquote>
<h2 id="What-does-suspend-function-mean-in-Kotlin-Coroutine-🤔"><a href="#What-does-suspend-function-mean-in-Kotlin-Coroutine-🤔" class="headerlink" title="What does suspend function mean in Kotlin Coroutine 🤔"></a>What does suspend function mean in Kotlin Coroutine 🤔</h2><p><a href="https://stackoverflow.com/questions/47871868/what-does-suspend-function-mean-in-kotlin-coroutine" target="_blank" rel="noopener">https://stackoverflow.com/questions/47871868/what-does-suspend-function-mean-in-kotlin-coroutine</a></p>
<p>I’m reading Kotlin Coroutine and know that it is based on suspend function. But what does suspend mean?</p>
<p>Coroutine or function gets suspended?</p>
<p>From <a href="https://kotlinlang.org/docs/reference/coroutines.html" target="_blank" rel="noopener">https://kotlinlang.org/docs/reference/coroutines.html</a></p>
<p>Basically, coroutines are computations that can be suspended without blocking a thread</p>
<p>I heard people often say “suspend function”. But I think it is the coroutine who gets suspended because it is waiting for the function to finished? “suspend” usually means “cease operation”, in this case the coroutine is idle.</p>
<p>Should we say the coroutine is suspended ?</p>
<p>Which coroutine gets suspended?</p>
<p>From <a href="https://kotlinlang.org/docs/reference/coroutines.html" target="_blank" rel="noopener">https://kotlinlang.org/docs/reference/coroutines.html</a></p>
<p>To continue the analogy, await() can be a suspending function (hence also callable from within an async {} block) that suspends a coroutine until some computation is done and returns its result:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">async &#123; <span class="comment">// Here I call it the outer async coroutine</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// Here I call computation the inner coroutine</span></span><br><span class="line">    <span class="keyword">val</span> result = computation.await()</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>🤔 It says “that suspends a coroutine until some computation is done”, but coroutine is like a lightweight thread. So if the coroutine is suspended, how can the computation is done ?</p>
<p>We see await is called on computation, so it might be async that returns Deferred, which means it can start another coroutine</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">computation</span><span class="params">()</span></span>: Deferred&lt;<span class="built_in">Boolean</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> async &#123;</span><br><span class="line">        <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>🤔 The quote say that suspends a coroutine. Does it mean suspend the outer async coroutine, or suspend the inner computation coroutine?</p>
<p>Does suspend mean that while outer async coroutine is waiting (await) for the inner computation coroutine to finish, it (the outer async coroutine) idles (hence the name suspend) and returns thread to the thread pool, and when the child computation coroutine finishes, it (the outer async coroutine) wakes up, takes another thread from the pool and continues?</p>
<p>The reason I mention the thread is because of <a href="https://kotlinlang.org/docs/tutorials/coroutines-basic-jvm.html" target="_blank" rel="noopener">https://kotlinlang.org/docs/tutorials/coroutines-basic-jvm.html</a></p>
<p>The thread is returned to the pool while the coroutine is waiting, and when the waiting is done, the coroutine resumes on a free thread in the pool</p>
<h2 id="Understanding-async"><a href="#Understanding-async" class="headerlink" title="Understanding async"></a>Understanding async</h2><p>From <a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md" target="_blank" rel="noopener">https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md</a></p>
<blockquote>
<p>Conceptually, async is just like launch. It starts a separate coroutine which is a light-weight thread that works concurrently with all the other coroutines. The difference is that launch returns a Job and does not carry any resulting value, while async returns a Deferred – a light-weight non-blocking future that represents a promise to provide a result later. You can use .await() on a deferred value to get its eventual result, but Deferred is also a Job, so you can cancel it if needed.</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">        <span class="keyword">val</span> one = async &#123; doSomethingUsefulOne() &#125;</span><br><span class="line">        <span class="keyword">val</span> two = async &#123; doSomethingUsefulTwo() &#125;</span><br><span class="line">        println(<span class="string">"The answer is <span class="subst">$&#123;one.await() + two.await()&#125;</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">"Completed in <span class="variable">$time</span> ms"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>There is a laziness option to async using an optional start parameter with a value of CoroutineStart.LAZY. It starts coroutine only when its result is needed by some await or if a start function is invoked. Run the following example that differs from the previous one only by this option:</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">        <span class="keyword">val</span> one = async(start = CoroutineStart.LAZY) &#123; doSomethingUsefulOne() &#125;</span><br><span class="line">        <span class="keyword">val</span> two = async(start = CoroutineStart.LAZY) &#123; doSomethingUsefulTwo() &#125;</span><br><span class="line">        println(<span class="string">"The answer is <span class="subst">$&#123;one.await() + two.await()&#125;</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">"Completed in <span class="variable">$time</span> ms"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="What-is-the-difference-between-launch-join-and-async-await-in-Kotlin-coroutines"><a href="#What-is-the-difference-between-launch-join-and-async-await-in-Kotlin-coroutines" class="headerlink" title="What is the difference between launch/join and async/await in Kotlin coroutines"></a>What is the difference between launch/join and async/await in Kotlin coroutines</h2><p><a href="https://stackoverflow.com/a/48079738/1418457" target="_blank" rel="noopener">https://stackoverflow.com/a/48079738/1418457</a></p>
<p>I find this guide <a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md" target="_blank" rel="noopener">https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md</a> to be useful. I will quote the essential parts</p>
<p>🦄 coroutine</p>
<p>Essentially, coroutines are light-weight threads.</p>
<p>So you can think of coroutine as something that manages thread in a very efficient way.</p>
<p>🐤 launch</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    launch &#123; <span class="comment">// launch new coroutine in background and continue</span></span><br><span class="line">        delay(<span class="number">1000L</span>) <span class="comment">// non-blocking delay for 1 second (default time unit is ms)</span></span><br><span class="line">        println(<span class="string">"World!"</span>) <span class="comment">// print after delay</span></span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">"Hello,"</span>) <span class="comment">// main thread continues while coroutine is delayed</span></span><br><span class="line">    Thread.sleep(<span class="number">2000L</span>) <span class="comment">// block main thread for 2 seconds to keep JVM alive</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So launch starts a background thread, does something, and returns a token immediately as Job. You can call join on this Job to block until this launch thread completes</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> job = launch &#123; <span class="comment">// launch new coroutine and keep a reference to its Job</span></span><br><span class="line">        delay(<span class="number">1000L</span>)</span><br><span class="line">        println(<span class="string">"World!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">"Hello,"</span>)</span><br><span class="line">    job.join() <span class="comment">// wait until child coroutine completes</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>🦆 async</p>
<p>Conceptually, async is just like launch. It starts a separate coroutine which is a light-weight thread that works concurrently with all the other coroutines. The difference is that launch returns a Job and does not carry any resulting value, while async returns a Deferred – a light-weight non-blocking future that represents a promise to provide a result later.</p>
<p>So async starts a background thread, does something, and returns a token immediately as Deferred.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">        <span class="keyword">val</span> one = async &#123; doSomethingUsefulOne() &#125;</span><br><span class="line">        <span class="keyword">val</span> two = async &#123; doSomethingUsefulTwo() &#125;</span><br><span class="line">        println(<span class="string">"The answer is <span class="subst">$&#123;one.await() + two.await()&#125;</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">"Completed in <span class="variable">$time</span> ms"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You can use .await() on a deferred value to get its eventual result, but Deferred is also a Job, so you can cancel it if needed.</p>
<p>So Deferred is actually a Job. See <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.experimental/-deferred/index.html" target="_blank" rel="noopener">https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.experimental/-deferred/index.html</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Deferred</span>&lt;<span class="type">out T</span>&gt; : <span class="type">Job </span></span>(source)</span><br></pre></td></tr></table></figure>

<p>🦋 async is eager by default</p>
<p>There is a laziness option to async using an optional start parameter with a value of CoroutineStart.LAZY. It starts coroutine only when its result is needed by some await or if a start function is invoked.</p>
<h2 id="Understand-Kotlin-Coroutines-on-Android-Google-I-O’19"><a href="#Understand-Kotlin-Coroutines-on-Android-Google-I-O’19" class="headerlink" title="Understand Kotlin Coroutines on Android (Google I/O’19)"></a>Understand Kotlin Coroutines on Android (Google I/O’19)</h2><p><a href="https://www.youtube.com/watch?v=BOHK_w09pVA" target="_blank" rel="noopener">https://www.youtube.com/watch?v=BOHK_w09pVA</a></p>
<img width="1176" alt="cor" src="https://user-images.githubusercontent.com/2284279/57587873-6836f400-750c-11e9-9944-2c00b8d83a87.png">

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kotlin/">kotlin</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Hashable-and-Set-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Hashable-and-Set-in-Swift/">Hashable and Set in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Hashable-and-Set-in-Swift/" class="article-date">
	  <time datetime="2017-12-13T14:10:40.000Z" itemprop="datePublished">December 13, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/122" target="_blank" rel="noopener">#122</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/swift/set" target="_blank" rel="noopener">Set</a></p>
<blockquote>
<p>You can create a set with any element type that conforms to the Hashable protocol. By default, most types in the standard library are hashable, including strings, numeric and Boolean types, enumeration cases without associated values, and even sets themselves.</p>
</blockquote>
<p>From <a href="https://developer.apple.com/documentation/swift/hashable" target="_blank" rel="noopener">Hashable</a></p>
<blockquote>
<p>The Hashable protocol inherits from the Equatable protocol, so you must also add an equal-to operator (==) function for your custom type.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Hashable</span> : <span class="title">Equatable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The hash value.</span></span><br><span class="line">    <span class="comment">///</span></span><br><span class="line">    <span class="comment">/// Hash values are not guaranteed to be equal across different executions of</span></span><br><span class="line">    <span class="comment">/// your program. Do not save hash values to use during a future execution.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> hashValue: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://useyourloaf.com/blog/swift-hashable/" target="_blank" rel="noopener">https://useyourloaf.com/blog/swift-hashable/</a></li>
<li><a href="http://kelan.io/2015/swift-hashable-for-sets/" target="_blank" rel="noopener">http://kelan.io/2015/swift-hashable-for-sets/</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Generic-declaration-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Generic-declaration-in-Swift/">Generic declaration in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Generic-declaration-in-Swift/" class="article-date">
	  <time datetime="2017-12-13T11:53:23.000Z" itemprop="datePublished">December 13, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/121" target="_blank" rel="noopener">#121</a></strong></p>
<p>These are different</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DiffService</span>&lt;<span class="title">T</span>: <span class="title">MKAnnotation</span> &amp; <span class="title">Equatable</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DiffService</span>&lt;<span class="title">T</span>: <span class="title">MKAnnotation</span>, <span class="title">Equatable</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-A-taste-of-MVVM-and-Reactive-paradigm"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/A-taste-of-MVVM-and-Reactive-paradigm/">A taste of MVVM and Reactive paradigm</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/A-taste-of-MVVM-and-Reactive-paradigm/" class="article-date">
	  <time datetime="2017-12-07T16:41:32.000Z" itemprop="datePublished">December 7, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/120" target="_blank" rel="noopener">#120</a></strong></p>
<p>Original post <a href="https://medium.com/flawless-app-stories/a-taste-of-mvvm-and-reactive-paradigm-5288a819cca1" target="_blank" rel="noopener">https://medium.com/flawless-app-stories/a-taste-of-mvvm-and-reactive-paradigm-5288a819cca1</a></p>
<hr>
<h2 id="A-taste-of-MVVM-and-Reactive-paradigm"><a href="#A-taste-of-MVVM-and-Reactive-paradigm" class="headerlink" title="A taste of MVVM and Reactive paradigm"></a>A taste of MVVM and Reactive paradigm</h2><p>I like Swift, like many other object oriented programming languages. Swift allows you to represent real world objects that have some characteristics and can perform some action.</p>
<p>I tend to think of an app as a world where each object is a person. They work and communicate. If a person can’t do the work alone, he needs to ask for help. Take a project, for example, if the manager has to do all of the work by himself, he will go crazy. So there is a need to organise and delegate tasks, and for many persons to collaborate on the project: designer, tester, scrum master, developer. After the task is done, the manager needs to be informed.</p>
<p>This may not a good example. But at least you get the importance of communication and delegation in OOP. I was very intrigued by the word “architecture” when I started iOS programming. But after doing for a while, it all comes down to identifying and splitting responsibilities. This article tells a bit about MVC and simple <a href="https://refactoring.com/catalog/extractClass.html" target="_blank" rel="noopener">Extract Class</a>refactoring to MVVM, and how to go further with Rx. You are free to create your own architecture, but whatever you do, consistence is key as to not confuse or surprise your teammates.</p>
<h2 id="Model-View-Controller"><a href="#Model-View-Controller" class="headerlink" title="Model View Controller"></a>Model View Controller</h2><p>Take a look at the architecture you know the best, MVC, short for Model View Controller. You always get one when you create a new iOS project. View is where you present your data, using UIView, UIButton, UILabel. Model is just a fancy word for data. It can be your entity, data from networking, object from database, or from cache. The controller is the thing that mediates between the model and the view.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*ETgFfqjBaD8SdQBd.png" alt></p>
<h2 id="UIViewController-is-the-center-of-the-universe"><a href="#UIViewController-is-the-center-of-the-universe" class="headerlink" title="UIViewController is the center of the universe"></a>UIViewController is the center of the universe</h2><p>The problem with ViewController is that it tends to be huge. Apple puts it as the center of the universe, where it has lots of properties and responsibilities. There are many things that you can only do with a UIViewController. Things like interacting with storyboard, managing the view, configuring view rotation, state restoration. UIViewController is designed with lots of hooks for you to override and customize.</p>
<p>Take a look at the many sections in UIViewController <a href="https://developer.apple.com/documentation/uikit/uiviewcontroller" target="_blank" rel="noopener">documentation</a>, you can’t do the following without a UIViewController.</p>
<pre><code>func viewDidLoad()
var preferredStatusBarStyle: UIStatusBarStyle { get }
UITableViewDataSource
var presentationController: UIPresentationController? { get }
func childViewControllerForScreenEdgesDeferringSystemGestures() -&gt; UIViewController?
func didMove(toParentViewController parent: UIViewController?)
var systemMinimumLayoutMargins: NSDirectionalEdgeInsets
var edgesForExtendedLayout: UIRectEdge
var previewActionItems: [UIPreviewActionItem]
var navigationItem: UINavigationItem
var shouldAutorotate: Bool</code></pre><p>As your app grows, we need to add more code for other logic. Such as networking, data source, handling multiple delegates, presenting child view controllers. We can, of course, put all the stuff on the view controller, but that results in big view controller and improvement in your scrolling skill. This is where you lose the big picture of responsibilities because all stuff stays in the mega view controller. You tend to introduce code duplication and bugs are hard to fix because they are all over the places.</p>
<p>The same goes with Page in Windows Phone or Activity in Android. They are intended for a screen or partial screen of functionality. There are certain actions that can only be done through them like <a href="https://msdn.microsoft.com/en-us/library/system.windows.controls.page.onnavigatedto%28v=vs.105%29.aspx" target="_blank" rel="noopener">Page.OnNavigatedTo</a>, <a href="https://developer.android.com/guide/components/activities/activity-lifecycle#oncreate" target="_blank" rel="noopener">Activity.onCreate</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/3000/0*FegPo70Zxmid6brv.png" alt></p>
<h2 id="The-buzzwords-of-architecture"><a href="#The-buzzwords-of-architecture" class="headerlink" title="The buzzwords of architecture"></a>The buzzwords of architecture</h2><p>What do you do when the ViewController is doing a lot? You offset the work to other components. By the way, if you want another object to do the user input handling, you can use the Presenter. If the Presenter is doing too much, then it can offset the business logic to the Interactor. Also, there are more buzzwords that can be used.</p>
<pre><code>let buzzWords = [
  &quot;Model&quot;, &quot;View&quot;, &quot;Controller&quot;, &quot;Entity&quot;, &quot;Router&quot;, &quot;Clean&quot;, &quot;Reactive&quot;, 
  &quot;Presenter&quot;, &quot;Interactor&quot;, &quot;Megatron&quot;, &quot;Coordinator&quot;, &quot;Flow&quot;, &quot;Manager&quot;
]
let architecture = buzzWords.shuffled().takeRandom()
let acronym = architecture.makeAcronym()</code></pre><p><img src="https://cdn-images-1.medium.com/max/2000/0*N785wG7eDrflu_OT.jpeg" alt></p>
<p>After all the buzzwords are assembled, we get an architecture. There are <a href="https://github.com/onmyway133/fantastic-ios-architecture" target="_blank" rel="noopener">many</a> of them, ranging from simple extract class refactoring, embracing MVC or taking inspiration from Clean Code, Rx, EventBus or Redux. The choice depends on project, and some teams prefer one architecture over the other.</p>
<h2 id="The-pragmatic-programmer"><a href="#The-pragmatic-programmer" class="headerlink" title="The pragmatic programmer"></a>The pragmatic programmer</h2><p>People have different opinion about what is good architecture. For me, it is about clear separation of concern, good communication pattern and being comfortable to use. Each component in the architecture should be identifiable and have a specific role. The communication must be clear so that we know which object is talking to each other. This together with good dependency injection will make testing easier.</p>
<p>Things that sound good in theory may not work well in practice. Separated domain objects are cool, protocol extensions are cool, multiple layers of abstraction are cool. But too many of them can be a problem.</p>
<p>If you read enough about design patterns, you know they all come down to these simple principles:</p>
<ul>
<li><p>Encapsulate what varies: identify the aspects of your application that vary and separate them from what stays the same.</p>
</li>
<li><p>Program to an interface, not an implementation</p>
</li>
<li><p>Prefer composition over inheritance</p>
</li>
</ul>
<p>If there’s one thing we should master, it’s <strong>composition</strong>. The key is to identify responsibility and compose them in a reasonable and consistent way. Consult with your team mates on what suits the most. Always writing code with the thought that you will also be the future maintainer. Then you will write it differently.</p>
<h2 id="Don’t-fight-against-the-system"><a href="#Don’t-fight-against-the-system" class="headerlink" title="Don’t fight against the system"></a>Don’t fight against the system</h2><p>Some architectures introduce completely new paradigm. Some of them are cumbersome that there people write scripts to generate boiler plate code. It’s good that there are many approaches to a problem. But for me sometimes it feels they are fighting the system. Some tasks are made easy while some trivial tasks become extremely hard. We should not constrain ourselves to one architecture simply because it are trendy. Be pragmatic, not dogmatic.</p>
<p>In iOS, we should embrace MVC. UIViewController is not meant for a full screen of content. They can contain and be composed to split the functionalities. We can use <a href="http://khanlou.com/2015/10/coordinators-redux/" target="_blank" rel="noopener">Coordinator</a> and <a href="https://github.com/onmyway133/blog/issues/106" target="_blank" rel="noopener">FlowController</a> to manage dependencies and handle flow. <a href="https://www.swiftbysundell.com/posts/custom-container-view-controllers-in-swift" target="_blank" rel="noopener">Container</a>for state transition, embedded logic <a href="https://www.swiftbysundell.com/posts/logic-controllers-in-swift" target="_blank" rel="noopener">controller</a>, <a href="https://davedelong.com/blog/2017/11/06/a-better-mvc-part-3-fixing-massive-view-controller/" target="_blank" rel="noopener">part</a> of full screen content. This embracing ViewController approach play nicely with MVC in iOS and is my preferable way of doing.</p>
<h2 id="Model-View-ViewModel"><a href="#Model-View-ViewModel" class="headerlink" title="Model View ViewModel"></a>Model View ViewModel</h2><p><img src="https://cdn-images-1.medium.com/max/2000/0*oRX6izHOCsHdhDoW.png" alt></p>
<p>Another good-enough way is to offload some of the tasks to another object, let’s call it ViewModel. The name does not matter, you can name it Reactor, Maestro, Dinosaur. The important thing is your team get an agreed name. ViewModel takes some tasks from the ViewController and reports when it’s done. There are <a href="https://www.objc.io/issues/7-foundation/communication-patterns/" target="_blank" rel="noopener">communication patterns</a> in Cocoa Touch such as delegate, closures to use.</p>
<p>ViewModel is self-contained, has no reference to UIKit, and has just input and output. We can put <a href="https://ashfurrow.com/blog/mvvm-is-exceptionally-ok/" target="_blank" rel="noopener">a lot of things</a> into ViewModel like calculation, formatting, networking, business logic. Also, if you don’t like the ViewModel to become massive, you surely need to create some dedicated objects. ViewModel is the first step to get a slim ViewController.</p>
<h2 id="Synchronously"><a href="#Synchronously" class="headerlink" title="Synchronously"></a>Synchronously</h2><p>Below is a very simple ViewModel, which formats data based on User model. This is done synchronously.</p>
<pre><code>class ProfileController: UIViewController {
  override func viewDidLoad() {
    super.viewDidLoad()
    let viewModel = ViewModel(user: user)
    nameLabel.text = viewModel.name
    birthdayLabel.text = viewModel.birthdayString
    salaryLabel.text = viewModel.salary
    piLabel.text = viewModel.millionthDigitOfPi
  }
}</code></pre><h2 id="Asynchronously"><a href="#Asynchronously" class="headerlink" title="Asynchronously"></a>Asynchronously</h2><p>We work with asynchronous API all the time. What if we want to show the user’s number of Facebook friends? For this to work we need to call Facebook API and this operation takes time. The ViewModel can report back via closure.</p>
<pre><code>viewModel.getFacebookFriends { friends in
  self.friendCountLabel.text = &quot;\(friends.count)&quot;
}</code></pre><p>Internally, the ViewModel may offload the task to a dedicated Facebook API client object.</p>
<pre><code>class ViewModel {
  func getFacebookFriends(completion: [User] -&gt; Void) {
    let client = APIClient()
    client.getFacebookFriends(for: user) { friends in
      DispatchQueue.main.async {
        completion(friends)
      }
    }
  }
}</code></pre><h2 id="Jetpack-in-Android"><a href="#Jetpack-in-Android" class="headerlink" title="Jetpack in Android"></a>Jetpack in Android</h2><p><img src="https://cdn-images-1.medium.com/max/2000/0*ORC4mswaenJBZOwP.png" alt></p>
<p>Google introduced Android Architecture Component, now part of Jetpack, at Google IO 2017. It has ViewModel and LiveData, which is also a type of MVVM applied in Android. ViewModel survives through configuration changes, and notify results in terms of LiveData for Activity to consume.</p>
<pre><code>class MyActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?, persistentState: PersistableBundle?) {
        super.onCreate(savedInstanceState, persistentState)

        val model = ViewModelProviders.of(this).get(MyViewModel::class.java)
        model.getUsers().observe(this, { users -&gt;
            // update UI
        })
    }
}</code></pre><p>This is one of the reason I like ViewModel. If we follow ViewModel like this, then code structures between iOS and Android become similar. There should be no need for some random Javascript cross platform solutions. You learn the concept once, and apply it on both iOS and Android. I learn ViewModel, RxSwift on iOS and feel right at home when I work with RxJava and RxBinding on Android. The Kickstarter project also proves that this works well in their <a href="https://github.com/kickstarter/ios-oss" target="_blank" rel="noopener">iOS</a> and <a href="https://github.com/kickstarter/android-oss" target="_blank" rel="noopener">Android</a> apps.</p>
<h2 id="Binding"><a href="#Binding" class="headerlink" title="Binding"></a>Binding</h2><p>To encapsulate the closure, we can create a class called Binding, which can notify one or multiple listeners. It takes advantage of didSet, and the observable property becomes clear.</p>
<pre><code>class Binding&lt;T&gt; {
  var value: T {
    didSet {
      listener?(value)
    }
  }
  private var listener: ((T) -&gt; Void)?
  init(value: T) {
    self.value = value
  }
  func bind(_ closure: @escaping (T) -&gt; Void) {
    closure(value)
    listener = closure
  }
}</code></pre><p>Here is how to use it inside ViewModel:</p>
<pre><code>class ViewModel {
  let friends = Binding&lt;[User]&gt;(value: [])
  init() {
    getFacebookFriends {
      friends.value = $0
    }
  }
  func getFacebookFriends(completion: ([User]) -&gt; Void) {
      // Do the work
  }
}</code></pre><p>When ever friends are fetched, or changed, the ViewController is updated accordingly. This is called reaction to changes.</p>
<pre><code>override func viewDidLoad() {
  super.viewDidLoad()
  viewModel.friends.bind { friends in
    self.friendsCountLabel.text = &quot;\(friends.count)&quot;
  }
}</code></pre><p>You often see MVVM introduction with reactive frameworks, and it is for a reason. They offer many chaining operators and make reactive programming easier and more declarative.</p>
<h2 id="RxSwift"><a href="#RxSwift" class="headerlink" title="RxSwift"></a>RxSwift</h2><p>Perhaps the most common reactive framework in Swift is <a href="https://github.com/ReactiveX/RxSwift" target="_blank" rel="noopener">RxSwift</a>. The thing I like about it is that it follows <a href="http://reactivex.io/" target="_blank" rel="noopener">ReactiveX</a> pattern. So you will feel more familiar if you already use <a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">RxJava</a>, <a href="https://github.com/ReactiveX/rxjs" target="_blank" rel="noopener">RxJs</a>, or <a href="https://github.com/ReactiveX/RxKotlin" target="_blank" rel="noopener">RxKotlin</a>.</p>
<h2 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h2><p><img src="https://cdn-images-1.medium.com/max/2000/0*GXJMWsuz8LvgkEXb.png" alt></p>
<p>RxSwift unifies sync and async operations through Observable. This is how you make one.</p>
<pre><code>class ViewModel {
  let friends: Observable&lt;[User]&gt;
  init() {
    let client = APIClient()
    friends = Observable&lt;[User]&gt;.create({ subscriber in
      client.getFacebookFriends(completion: { friends in
        subscriber.onNext(friends)
        subscriber.onCompleted()
      })
      return Disposables.create()
    })
  }
}</code></pre><p>The power of RxSwift lies in its numerous operators, which help you chain Observables. Here you can call 2 network requests, wait for both of them to finish, then sum up the friends. This is very streamlined and saves you lots of time. Here you can just subscribe to the Observable, it will be triggered when the request completes:</p>
<pre><code>override func viewDidLoad() {
  super.viewDidLoad()
  viewModel.friends.subscribe(onNext: { friends in
    self.friendsCountLabel.text = &quot;\(friends.count)&quot;
  })
}</code></pre><h2 id="Input-and-output"><a href="#Input-and-output" class="headerlink" title="Input and output"></a>Input and output</h2><p>One thing that is nice about ViewModel and Rx is that we can separate input and output using Observable, which gives a clear interface. Read more at <a href="https://github.com/onmyway133/blog/issues/87" target="_blank" rel="noopener">Learning from Open Source: Input and output container</a>.</p>
<p>Below it is clear that we fetch is an input, and friends is the viable output.</p>
<pre><code>class ViewModel {
  class Input {
    let fetch = PublishSubject&lt;()&gt;()
  }
  class Output {
    let friends: Driver&lt;[User]&gt;
  }
  let apiClient: APIClient
  let input: Input
  let output: Output
  init(apiClient: APIClient) {
    self.apiClient = apiClient
    // Connect input and output
  }
}

class ProfileViewController: BaseViewController&lt;ProfileView&gt; {
  let viewModel: ProfileViewModelType
  init(viewModel: ProfileViewModelType) {
    self.viewModel = viewModel
  }
  override func viewDidLoad() {
    super.viewDidLoad()
    // Input
    viewModel.input.fetch.onNext(())
    // Output
    viewModel.output.friends.subscribe(onNext: { friends in
      self.friendsCountLabel.text = &quot;\(friends.count)&quot;
    })
  }
}</code></pre><h2 id="How-reactive-works"><a href="#How-reactive-works" class="headerlink" title="How reactive works"></a>How reactive works</h2><p>If you feel like Rx, it’s good to get an understanding of them after using some frameworks for a while. There are some concepts like Signal, SignalProducer, Observable, Promise, Future, Task, Job, Launcher, Async and some people can have a very distinction about them. Here I simply call it Signal, which is something that can signal values.</p>
<h2 id="Monad"><a href="#Monad" class="headerlink" title="Monad"></a>Monad</h2><p>Signal and its <a href="https://en.wikipedia.org/wiki/Result_type" target="_blank" rel="noopener">Result</a> are just <a href="https://en.wikipedia.org/wiki/Monad_%28functional_programming%29" target="_blank" rel="noopener">monads</a>, which are thing that can be mapped and chained.</p>
<p>Signal makes use of deferred execution callback closures. It can be pushed or pulled. Which is just how the Signal updates its value and the order the callbacks are called.</p>
<p>Execution callback closure means that we pass a function to another function. And the passed in function will get called when appropriated.</p>
<h2 id="Sync-vs-Async"><a href="#Sync-vs-Async" class="headerlink" title="Sync vs Async"></a>Sync vs Async</h2><p>Monad can be in either sync or async mode. Sync is easier to understand, but async is somewhat you’re already familiar and used in practice.</p>
<p>Basically,</p>
<ul>
<li><p>Sync: you get the returned value right away via return</p>
</li>
<li><p>Async: you get the returned value via callback block</p>
</li>
</ul>
<p>Here is an example of simple sync and async free functions:</p>
<pre><code>// Sync
func sum(a: Int, b: Int) -&gt; Int {
    return a + b
}

// Async
func sum(a: Int, b: Int, completion: Int -&gt; Void) {
    // Assumed it is a very long task to get the result
    let result = a + b

    completion(result)
}</code></pre><p>And how sync and async apply to Result type. Notice the async version, we get the transformed value in a completion closure instead of immediate return from function.</p>
<pre><code>enum Result&lt;T&gt; {
  case value(value: T)
  case failure(error: Error)

  // Sync
  public func map&lt;U&gt;(f: (T) -&gt; U) -&gt; Result&lt;U&gt; {
    switch self {
    case let .value(value):
      return .value(value: f(value))
    case let .failure(error):
      return .failure(error: error)
    }
  }

  // Async
  public func map&lt;U&gt;(f: @escaping ((T), (U) -&gt; Void) -&gt; Void) -&gt; (((Result&lt;U&gt;) -&gt; Void) -&gt; Void) {
    return { g in   // g: Result&lt;U&gt; -&gt; Void
      switch self {
      case let .value(value):
        f(value) { transformedValue in  // transformedValue: U
          g(.value(value: transformedValue))
        }
      case let .failure(error):
        g(.failure(error: error))
      }
    }
  }
}</code></pre><h2 id="Push-Signal"><a href="#Push-Signal" class="headerlink" title="Push Signal"></a>Push Signal</h2><p>Given a chained signals like this:</p>
<p>A -(map)-&gt; B -(flatMap)-&gt; C -(flatMap)-&gt; D -(subscribe)</p>
<p>Push Signal, means that when the source signal A is sent an event, it propagates that event via callbacks. PushSignal is similar to PublishSubject in RxSwift.</p>
<ul>
<li><p>Triggered by sending event to the source signal.</p>
</li>
<li><p>We must keep A as it keeps the others around</p>
</li>
<li><p>We subscribe the last D</p>
</li>
<li><p>We send event to the first A</p>
</li>
<li><p>A ‘s callback gets called, it it in turn calls callback of B with the result of A ‘s map, then B ‘s callback calls C ‘s callback with the result of B‘s flatMap, and so on.</p>
</li>
</ul>
<p>It is similar to <a href="https://promisesaplus.com/" target="_blank" rel="noopener">Promise A+</a>, you can see my Swift implementation of Promise A+ <a href="https://github.com/onmyway133/Then/blob/master/Pod/Classes/Promise.swift" target="_blank" rel="noopener">in my Then framework</a>. For now, here is the Swift 4 implementation of a simple PushSignal.</p>
<pre><code>public final class PushSignal&lt;T&gt; {
  var event: Result&lt;T&gt;?
  var callbacks: [(Result&lt;T&gt;) -&gt; Void] = []
  let lockQueue = DispatchQueue(label: &quot;Serial Queue&quot;)

  func notify() {
    guard let event = event else {
      return
    }

    callbacks.forEach { callback in
      callback(event)
    }
  }

  func update(event: Result&lt;T&gt;) {
    lockQueue.sync {
      self.event = event
    }

    notify()
  }

  public func subscribe(f: @escaping (Result&lt;T&gt;) -&gt; Void) -&gt; Signal&lt;T&gt; {
    // Callback
    if let event = event {
      f(event)
    }

    callbacks.append(f)

    return self
  }

  public func map&lt;U&gt;(f: @escaping (T) -&gt; U) -&gt; Signal&lt;U&gt; {
    let signal = Signal&lt;U&gt;()

    _ = subscribe { event in
      signal.update(event: event.map(f: f))
    }

    return signal
  }
}</code></pre><p>Below is how a PushSignal is used to transform a chain from string to its length, you should see 4, the length of the string “test” printed.</p>
<pre><code>let signal = PushSignal&lt;String&gt;()

_ = signal.map { value in
  return value.count
}.subscribe { event in
  if case let .value(value) = event {
    print(value)
  } else {
    print(&quot;error&quot;)
  }
}

signal.update(event: .value(value: &quot;test&quot;))</code></pre><h2 id="Pull-Signal"><a href="#Pull-Signal" class="headerlink" title="Pull Signal"></a>Pull Signal</h2><p>Given a chained signals like this:</p>
<p>A -(map)-&gt; B -(flatMap)-&gt; C -(flatMap)-&gt; D -(subscribe)</p>
<p>Pull Signal, sometimes called Future, means when we subscribe to the final signal D, it causes the previous signals to action:</p>
<ul>
<li><p>Triggered by subscribing to the final signal D;</p>
</li>
<li><p>We must keep D as it keeps the others around;</p>
</li>
<li><p>We subscribe the last D;</p>
</li>
<li><p>D ‘s operation runs, and it cause C ‘s operation to runs, … then A ‘s operation runs. It is in A that the task is performed (like fetching network, retrieving database, file access, heavy computation, …) to get the result, and A ‘s completion gets called. Then A’s completion calls B ‘s completion with the result mapped by B ‘s map, … all the way to the subscriber ‘s completion block.</p>
</li>
</ul>
<p>Here is a Swift 4 implementation of PullSignal. PullSignal is similar to Observablein RxSwift and SignalProducer in ReactiveSwift.</p>
<pre><code>public struct PullSignal&lt;T&gt; {
  let operation: ((Result&lt;T&gt;) -&gt; Void) -&gt; Void

  public init(operation: @escaping ((Result&lt;T&gt;) -&gt; Void) -&gt; Void) {
    self.operation = operation
  }

  public func start(completion: (Result&lt;T&gt;) -&gt; Void) {
    operation() { event in
      completion(event)
    }
  }

  public func map&lt;U&gt;(f: @escaping (T) -&gt; U) -&gt; PullSignal&lt;U&gt; {
    return PullSignal&lt;U&gt; { completion in
      self.start { event in
        completion(event.map(f: f))
      }
    }
  }
}</code></pre><p>The chain is inactive until you call start at the last signal in the chain, which triggers operation flow all over to the first signal. Run this snippet and you should see 4, the length of the string “test” printed on the console.</p>
<pre><code>let signal = PullSignal&lt;String&gt; { completion in
  // There should be some long running operation here
  completion(Result.value(value: &quot;test&quot;))
}

signal.map { value in
  value.count
}.start { event in
  if case let .value(value) = event {
    print(value)
  } else {
    print(&quot;error&quot;)
  }
}</code></pre><p>I hope those snippets are simple enough to help you understand how signal works under the hood, and how to differentiate hot and cold signals. To get a fully working Signal framework, you need to implement more operations. Such as retry, rebounce, throttle, queue, flatten, filter, delay, combine and add support for UIKit like RxCocoa does. Find out how to implement in my <a href="https://github.com/onmyway133/archives/tree/master/Signal/Pod/Classes" target="_blank" rel="noopener">Signal</a> repo.</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Architecture is a very opinionated topic. Hopefully this article gives you some ideas to add into your decision points. MVC is dominant in iOS, MVVM is a good friend and Rx is a powerful tool. Here are some more interesting readings:</p>
<ul>
<li><a href="https://ashfurrow.com/blog/mvvm-is-exceptionally-ok/" target="_blank" rel="noopener">MVVM is Exceptionally OK</a></li>
<li><a href="https://academy.realm.io/posts/krzysztof-zablocki-mDevCamp-ios-architecture-mvvm-mvc-viper/" target="_blank" rel="noopener">Good iOS Application Architecture: MVVM vs. MVC vs. VIPER</a></li>
<li><a href="https://www.youtube.com/watch?v=YWVzCd5FYbs" target="_blank" rel="noopener">A Better MVC</a></li>
<li><a href="https://blog.uptech.team/taming-great-complexity-mvvm-coordinators-and-rxswift-8daf8a76e7fd" target="_blank" rel="noopener">Taming Great Complexity: MVVM, Coordinators and RxSwift</a></li>
<li><a href="http://blogs.microsoft.co.il/bnaya/2010/03/13/rx-for-beginners-part-9-hot-vs-cold-observable/" target="_blank" rel="noopener">Rx — for beginners (part 9): Hot Vs. Cold observable</a></li>
<li><a href="https://github.com/ReactiveX/RxSwift/blob/master/Documentation/HotAndColdObservables.md" target="_blank" rel="noopener">Hot and Cold Observables</a></li>
<li><a href="https://stackoverflow.com/questions/17082255/when-to-use-ienumerable-vs-iobservable" target="_blank" rel="noopener">When to use IEnumerable vs IObservable?</a></li>
<li><a href="https://www.youtube.com/watch?v=AcDaWe3S75c" target="_blank" rel="noopener">Functional Reactive Programming without Black Magic</a></li>
<li><a href="https://www.youtube.com/watch?v=mbd6g7NfR-8" target="_blank" rel="noopener">Swift Sync and Async Error Handling</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rx/">rx</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Collection-Update"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Collection-Update/">Collection Update</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Collection-Update/" class="article-date">
	  <time datetime="2017-12-07T15:22:39.000Z" itemprop="datePublished">December 7, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/119" target="_blank" rel="noopener">#119</a></strong></p>
<p>This is about collection update, how to provide correct IndexPath and a simple diffing algorithm</p>
<ul>
<li>Excerpt from my talk at CocoaHeads, Oslo <a href="https://www.meetup.com/CocoaHeads-Oslo/events/244892347/" target="_blank" rel="noopener">https://www.meetup.com/CocoaHeads-Oslo/events/244892347/</a></li>
<li>Slide <a href="https://speakerdeck.com/onmyway133/collection-update" target="_blank" rel="noopener">https://speakerdeck.com/onmyway133/collection-update</a></li>
</ul>
<h2 id="CollectionView"><a href="#CollectionView" class="headerlink" title="CollectionView"></a>CollectionView</h2><p>It’s hard to imagine of any apps that don’t use Table View or CollectionView. And by CollectionView, I actually mean UICollectionView 😉  . Most of the time, we show something with response from backend, then potentially update and insert new items as data changed.</p>
<p><img src="https://user-images.githubusercontent.com/2284279/34838146-55461fbc-f6fd-11e7-928f-b5461a51893f.png" alt="collectionview"></p>
<p>We can totally call <code>reloadData</code> to reflect the changes, but an animation is better here as it gives user better understanding of what’s going on, and to not surprise them. </p>
<p>This talks about <code>UICollectionView</code>, but <code>UITableView</code> behaves the same</p>
<h2 id="Drag-and-Drop"><a href="#Drag-and-Drop" class="headerlink" title="Drag and Drop"></a>Drag and Drop</h2><p>Let’s imagine an app where user are allowed to customise their experience by moving items from one collection to another.</p>
<p>You can take a look at the example <a href="https://github.com/onmyway133/CollectionUpdateExample/tree/master/DragAndDrop" target="_blank" rel="noopener">DragAndDrop</a> which is using the new <a href="https://developer.apple.com/ios/drag-and-drop/" target="_blank" rel="noopener">drag and drop API</a> in iOS 11.</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33726942-d084fa74-db76-11e7-95e0-6580f4c5fc9d.png" alt="ipad"></p>
<p>You must ensure that your data is changed before calling update methods on <code>UICollectionView</code>. And then we call <code>deleteItems</code> and <code>insertItems</code> to reflect data changes. <code>UICollectionView</code> performs a nice animation for you</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, performDropWith coordinator: UICollectionViewDropCoordinator)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> destinationIndexPath = coordinator.destinationIndexPath</span><br><span class="line">  <span class="keyword">let</span> sourceIndexPath = coordinator.items.last?.dragItem.localObject <span class="keyword">as</span>! <span class="type">IndexPath</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// remove</span></span><br><span class="line">  sourceItems.remove(at: sourceIndexPath.item)</span><br><span class="line">  sourceCollectionView.deleteItems(at: [sourceIndexPath])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// insert</span></span><br><span class="line">  destinationItems.insert(draggedItem, at: destinationIndexPath.item)</span><br><span class="line">  destinationCollectionView.insertItems(at: [destinationIndexPath])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="NSInternalInconsistencyException"><a href="#NSInternalInconsistencyException" class="headerlink" title="NSInternalInconsistencyException"></a>NSInternalInconsistencyException</h2><p>If you have large number of items with many insertions and deletions from backend response, you need to calculate the correct IndexPath to call, which are not easy thing. Most the time you will get the following crashes</p>
<blockquote>
<p>Terminating app due to uncaught exception ‘NSInternalInconsistencyException’,<br>reason: ‘Invalid update: invalid number of items in section 0.<br>The number of items contained in an existing section after the update (213)<br>must be equal to the number of items contained in that section before<br>the update (154), plus or minus the number of items inserted or<br>deleted from that section (40 inserted, 0 deleted) and plus<br>or minus the number of items moved into or out of<br>that section (0 moved in, 0 moved out).’</p>
</blockquote>
<p>In my experience it happened randomly because everyone has different data. Although the message is very descriptive, it may take a while to figure it out.</p>
<h2 id="Game-of-IndexPath"><a href="#Game-of-IndexPath" class="headerlink" title="Game of IndexPath"></a>Game of IndexPath</h2><p>Let’s refine our knowledge of <code>IndexPath</code> by going through some examples. With a collection of 6 items, we perform some update operations and figure out what <code>IndexPath</code> should be. </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">items = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>]</span><br></pre></td></tr></table></figure>

<p>Take a look at my example here <a href="https://github.com/onmyway133/CollectionUpdateExample/tree/master/CollectionUpdateExample" target="_blank" rel="noopener">CollectionUpdateExample</a>, there are many more examples</p>
<div align="center">
<img src="https://user-images.githubusercontent.com/2284279/33727113-647cfe34-db77-11e7-8533-4dd84657e718.png" height="400">
<img src="https://user-images.githubusercontent.com/2284279/33727115-6499e350-db77-11e7-8030-971bd9a29040.png" height="400">
</div>

<h2 id="index-vs-offset"><a href="#index-vs-offset" class="headerlink" title="index vs offset"></a>index vs offset</h2><p>Before we go any further, I just want to mention that, by <code>index</code> I actually mean <code>offset from the start</code>. If you take a look at the <a href="https://developer.apple.com/documentation/swift/array/1687832-enumerated" target="_blank" rel="noopener">enumerated</a> function, it suggests the name as <code>offset</code> instead of <code>index</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Array</span>(<span class="number">0</span>..&lt;<span class="number">10</span>).enumerated().forEach &#123; (offset, element) <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This <a href="https://en.wikipedia.org/wiki/Zero-based_numbering" target="_blank" rel="noopener">zero based numbering</a> could shed some light on this matter</p>
<blockquote>
<p>Particularly in C, where arrays are closely tied to pointer arithmetic, this makes for a simpler implementation: the subscript refers to an offset from the starting position of an array, so the first element has an offset of zero.</p>
</blockquote>
<h3 id="1-Insert-3-items-at-the-end"><a href="#1-Insert-3-items-at-the-end" class="headerlink" title="1.  Insert 3 items at the end"></a>1.  Insert 3 items at the end</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">items.append(contentsOf: [<span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// a, b, c, d, e, f, g, h, i</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> indexPaths = <span class="type">Array</span>(<span class="number">6</span>...<span class="number">8</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">collectionView.insertItems(at: indexPaths)</span><br></pre></td></tr></table></figure>

<h3 id="2-Delete-3-items-at-the-end"><a href="#2-Delete-3-items-at-the-end" class="headerlink" title="2. Delete 3 items at the end"></a>2. Delete 3 items at the end</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">items.removeLast()</span><br><span class="line">items.removeLast()</span><br><span class="line">items.removeLast()</span><br><span class="line"></span><br><span class="line"><span class="comment">// a, b, c</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> indexPaths = <span class="type">Array</span>(<span class="number">3</span>...<span class="number">5</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">collectionView.deleteItems(at: indexPaths)</span><br></pre></td></tr></table></figure>

<h3 id="3-Update-item-at-index-2"><a href="#3-Update-item-at-index-2" class="headerlink" title="3. Update item at index 2"></a>3. Update item at index 2</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">items[<span class="number">2</span>] = <span class="string">"👻"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a, b, 👻, d, e, f</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> indexPath = <span class="type">IndexPath</span>(item: <span class="number">2</span>, section: <span class="number">0</span>)</span><br><span class="line">collectionView.reloadItems(at: [indexPath])</span><br></pre></td></tr></table></figure>

<h3 id="4-Move-item-“c”-to-the-end"><a href="#4-Move-item-“c”-to-the-end" class="headerlink" title="4. Move item “c” to the end"></a>4. Move item “c” to the end</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">items.remove(at: <span class="number">2</span>)</span><br><span class="line">items.append(<span class="string">"c"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// a, b, d, e, f, c</span></span><br><span class="line"></span><br><span class="line">collectionView.moveItem(</span><br><span class="line">  at: <span class="type">IndexPath</span>(item: <span class="number">2</span>, section: <span class="number">0</span>),</span><br><span class="line">  to: <span class="type">IndexPath</span>(item: <span class="number">5</span>, section :<span class="number">0</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="5-Delete-3-items-at-the-beginning-then-insert-3-items-at-the-end"><a href="#5-Delete-3-items-at-the-beginning-then-insert-3-items-at-the-end" class="headerlink" title="5. Delete 3 items at the beginning, then insert 3 items at the end"></a>5. Delete 3 items at the beginning, then insert 3 items at the end</h3><p>With multiple different operations, we should use <a href="https://developer.apple.com/documentation/uikit/uicollectionview/1618045-performbatchupdates" target="_blank" rel="noopener">performBatchUpdates</a></p>
<blockquote>
<p>You can use this method in cases where you want to make multiple changes to the collection view in one single animated operation, as opposed to in several separate animations. You might use this method to insert, delete, reload, or move cells or use it to change the layout parameters associated with one or more cells</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">items.removeFirst()</span><br><span class="line">items.removeFirst()</span><br><span class="line">items.removeFirst()</span><br><span class="line"></span><br><span class="line">items.append(contentsOf: [<span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// d, e, f, g, h, i</span></span><br><span class="line"></span><br><span class="line">collectionView.performBatchUpdates(&#123;</span><br><span class="line">  <span class="keyword">let</span> deleteIndexPaths = <span class="type">Array</span>(<span class="number">0</span>...<span class="number">2</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">  collectionView.deleteItems(at: deleteIndexPaths)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> insertIndexPaths = <span class="type">Array</span>(<span class="number">3</span>...<span class="number">5</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">  collectionView.insertItems(at: insertIndexPaths)</span><br><span class="line">&#125;, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<h3 id="6-Insert-3-items-at-the-end-then-delete-3-items-beginning"><a href="#6-Insert-3-items-at-the-end-then-delete-3-items-beginning" class="headerlink" title="6. Insert 3 items at the end, then delete 3 items beginning"></a>6. Insert 3 items at the end, then delete 3 items beginning</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">items.append(contentsOf: [<span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>])</span><br><span class="line"></span><br><span class="line">items.removeFirst()</span><br><span class="line">items.removeFirst()</span><br><span class="line">items.removeFirst()</span><br><span class="line"></span><br><span class="line"><span class="comment">// d, e, f, g, h, i</span></span><br><span class="line"></span><br><span class="line">collectionView.performBatchUpdates(&#123;</span><br><span class="line">  <span class="keyword">let</span> insertIndexPaths = <span class="type">Array</span>(<span class="number">6</span>...<span class="number">8</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">  collectionView.insertItems(at: insertIndexPaths)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> deleteIndexPaths = <span class="type">Array</span>(<span class="number">0</span>...<span class="number">2</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">  collectionView.deleteItems(at: deleteIndexPaths)</span><br><span class="line">&#125;, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<h2 id="🙀"><a href="#🙀" class="headerlink" title="🙀"></a>🙀</h2><p>If you run the example 6, you will get a crash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Terminating app due to uncaught exception </span><br><span class="line">&apos;NSInternalInconsistencyException&apos;, </span><br><span class="line">reason: &apos;attempt to insert item 6 into section 0, </span><br><span class="line">but there are only 6 items in section 0 after the update&apos;</span><br></pre></td></tr></table></figure>

<h2 id="performBatchUpdates"><a href="#performBatchUpdates" class="headerlink" title="performBatchUpdates"></a>performBatchUpdates</h2><p>It is because the way <code>performBatchUpdates</code> works. If you take a look at the <a href="https://developer.apple.com/documentation/uikit/uicollectionview/1618045-performbatchupdates" target="_blank" rel="noopener">documentation</a></p>
<blockquote>
<p>Deletes are processed before inserts in batch operations. This means the indexes for the deletions are processed relative to the indexes of the collection view’s state before the batch operation, and the indexes for the insertions are processed relative to the indexes of the state after all the deletions in the batch operation.</p>
</blockquote>
<p>No matter how we call insert or delete, <code>performBatchUpdates</code> always performs deletions first. So we need to call <code>deleteItems</code> and <code>insertItems</code> as if the deletions occur first.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">items.append(contentsOf: [<span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>])</span><br><span class="line"></span><br><span class="line">items.removeFirst()</span><br><span class="line">items.removeFirst()</span><br><span class="line">items.removeFirst()</span><br><span class="line"></span><br><span class="line"><span class="comment">// d, e, f, g, h, i</span></span><br><span class="line"></span><br><span class="line">collectionView.performBatchUpdates(&#123;</span><br><span class="line">  <span class="keyword">let</span> deleteIndexPaths = <span class="type">Array</span>(<span class="number">0</span>...<span class="number">2</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">  collectionView.deleteItems(at: deleteIndexPaths)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> insertIndexPaths = <span class="type">Array</span>(<span class="number">3</span>...<span class="number">5</span>).<span class="built_in">map</span> &#123; <span class="type">IndexPath</span>(item: $<span class="number">0</span>, section: <span class="number">0</span>) &#125;</span><br><span class="line">  collectionView.insertItems(at: insertIndexPaths)</span><br><span class="line">&#125;, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Operations"><a href="#Operations" class="headerlink" title="Operations"></a>Operations</h2><p>There are many operations on <code>UICollectionView</code>, and there are operations to update whole section as well. Take a look <a href="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/TableView_iPhone/ManageInsertDeleteRow/ManageInsertDeleteRow.html" target="_blank" rel="noopener">Ordering of Operations and Index Paths</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insertItems(at indexPaths: [<span class="type">IndexPath</span>])</span><br><span class="line">deleteItems(at indexPaths: [<span class="type">IndexPath</span>])</span><br><span class="line">reloadItems(at indexPaths: [<span class="type">IndexPath</span>])</span><br><span class="line">moveItem(at indexPath: <span class="type">IndexPath</span>, to newIndexPath: <span class="type">IndexPath</span>)</span><br><span class="line">performBatchUpdates(<span class="number">_</span> updates, completion)</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insertSections(<span class="number">_</span> sections: <span class="type">IndexSet</span>)</span><br><span class="line">deleteSections(<span class="number">_</span> sections: <span class="type">IndexSet</span>)</span><br><span class="line">reloadSections(<span class="number">_</span> sections: <span class="type">IndexSet</span>)</span><br><span class="line">moveSection(<span class="number">_</span> section: <span class="type">Int</span>, toSection newSection: <span class="type">Int</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/TableView_iPhone/Art/batch_insert_delete.jpg" alt="inline"></p>
<h2 id="Edit-distance"><a href="#Edit-distance" class="headerlink" title="Edit distance"></a>Edit distance</h2><p>Doing these calculations by hand is quite tedious and error prone. We can build our own abstraction using some algorithms. The naive one is <a href="https://en.wikipedia.org/wiki/Wagner%E2%80%93Fischer_algorithm" target="_blank" rel="noopener">Wagner–Fischer algorithm</a> which uses <a href="https://en.wikipedia.org/wiki/Dynamic_programming" target="_blank" rel="noopener">Dynamic Programming</a> to tell the edit distance between two strings of characters.</p>
<p>Edit distance means the number of steps needed to change from one string to another. String is just a collection of characters, so we can generalise this concept to make it work for any collection of items. Instead of comparing character, we require items to conform to <code>Equatable</code></p>
<h2 id="“kit”-gt-“kat”"><a href="#“kit”-gt-“kat”" class="headerlink" title="“kit” -&gt; “kat”"></a>“kit” -&gt; “kat”</h2><p>How can we transform form the word “kit” to “kat”? What kinds of operations do we nede to perform? You may tell “just change the i to a”, but this trivial example helps you understand the algorithm. Let’s get started.</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33278613-5dc25c70-d39c-11e7-8a5c-2e8e6946ae36.jpg" alt="inline"></p>
<h3 id="Deletions"><a href="#Deletions" class="headerlink" title="Deletions"></a>Deletions</h3><p>If we go from “kit” to an empty string “”, we need 3 deletions </p>
<p><img src="https://user-images.githubusercontent.com/2284279/33243688-2bade616-d2eb-11e7-8463-f913695818ef.png" alt="inline"></p>
<p>“k” -&gt; “”  👉 1 deletion<br>“ki” -&gt; “” 👉 2 deletions<br>“kit” -&gt; “” 👉    3 deletions</p>
<h3 id="Insertions"><a href="#Insertions" class="headerlink" title="Insertions"></a>Insertions</h3><p>If we go from an empty string “” to “kat”, we need 3 insertions</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33243726-c078ee3a-d2eb-11e7-918f-8bba30be0c0e.png" alt="inline"></p>
<p>“” -&gt; “k”  👉    1 insertion<br>“” -&gt; “ka”  👉    2 insertions<br>“” -&gt; “kat”  👉    3 insertions</p>
<h3 id="If-equal-take-value-from-the-top-left"><a href="#If-equal-take-value-from-the-top-left" class="headerlink" title="If equal, take value from the top left"></a>If equal, take value from the top left</h3><p>You can think of the algorithm as if we go from source string, to empty string, to destination string. We try to find the minimum steps to update. Going horizontally means insertions, vertically means deletions and diagonally means substitutions</p>
<p>This way we can build our matrix, iterate from row to row, column by column. First, the letter “k” from source collection is the same with letter “k” from destination collection, we simply take value from the top left, which is 0 substituion</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33243911-9f1e87d8-d2ee-11e7-8dde-bb2f02593eca.png" alt="inline"></p>
<h3 id="If-not-equal"><a href="#If-not-equal" class="headerlink" title="If not equal"></a>If not equal</h3><p>We continue with the next letter from the destination collection. Here “k” and “a” are not the same. We take minimum value from left, top, top left. Then increase by one</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33243912-9f371230-d2ee-11e7-8386-85ed3f9f4bcf.png" alt="inline"></p>
<p>Here we take value from left, which is horizontally, so we increase by 1 insertion</p>
<h3 id="“k”-gt-“kat”-👉-2-insertions"><a href="#“k”-gt-“kat”-👉-2-insertions" class="headerlink" title="“k” -&gt; “kat” 👉 2 insertions"></a>“k” -&gt; “kat” 👉 2 insertions</h3><p>Continue, they are not the same, so we take value from left horizontally. Here you can see it kind makes sense, as to go from “k” to “kat”, we need 2 insertions, which is to insert letters “a” and “t”</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33243913-9f4ed1ea-d2ee-11e7-9fae-71693ec1844d.png" alt="inline"></p>
<h3 id="The-bottom-right-value"><a href="#The-bottom-right-value" class="headerlink" title="The bottom right value"></a>The bottom right value</h3><p>Continue with the next row, and next row until we  got to the bottom right value, which gives you the edit distance. Here 1 substitution means that we need to perform 1 substitution to go from “kit” to “kat”, which is update “i” with “a’</p>
<p><img src="https://user-images.githubusercontent.com/2284279/35505204-a7b5f0f6-04e5-11e8-8124-4e8868f2ea8d.png" alt="final"></p>
<p>You can easily see that we need to update index 1. But how do we know that it is index 1 🤔 </p>
<h2 id="Edit-steps"><a href="#Edit-steps" class="headerlink" title="Edit steps"></a>Edit steps</h2><p>In each step, we need to associate the index of item in source and destination collection. You can take a look at my implementation <a href="https://github.com/onmyway133/DeepDiff" target="_blank" rel="noopener">DeepDiff</a></p>
<p><img src="https://github.com/onmyway133/DeepDiff/raw/master/Screenshots/collection.gif" alt="inline"></p>
<h2 id="Complexity"><a href="#Complexity" class="headerlink" title="Complexity"></a>Complexity</h2><p>We iterate through the matrix, with <code>m</code> and <code>n</code> are the length of source and destination collection respectively, we can see that the complexity of this algorithm is 0(mn).</p>
<p>Also the performance greatly depends on the size of the collection and how complex the item is. The more complex and how deep you want to perform <code>Equatable</code> can greatly affect your performance.</p>
<h2 id="Improving-performance"><a href="#Improving-performance" class="headerlink" title="Improving performance"></a>Improving performance</h2><p>The section <a href="https://github.com/onmyway133/DeepDiff#how-does-it-work" target="_blank" rel="noopener">How does it work</a> shows several ways we can improve performance.</p>
<p>Firstly, instead of building a matrix, which costs memory <code>m*n</code>, we can just use temporary arrays as holder. </p>
<p>Secondly, to quickly compare 2 items, we can use <code>Hashable</code>, as 2 identical items will always have the same hash.</p>
<h2 id="More-performance"><a href="#More-performance" class="headerlink" title="More performance"></a>More performance</h2><p>If you want better performance, then algorithms with linear complexity may be interested to you. Take a look at <a href="https://github.com/onmyway133/blog/issues/99" target="_blank" rel="noopener">Diff algorithm</a></p>
<ul>
<li><a href="http://documents.scribd.com/docs/10ro9oowpo1h81pgh1as.pdf" target="_blank" rel="noopener">Heckel</a></li>
<li><a href="https://publications.mpi-cbg.de/Wu_1990_6334.pdf" target="_blank" rel="noopener">Wu</a></li>
<li><a href="http://www.xmailserver.org/diff2.pdf" target="_blank" rel="noopener">Myers</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Commit-as-another-user-on-GitHub"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Commit-as-another-user-on-GitHub/">Commit as another user on GitHub</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Commit-as-another-user-on-GitHub/" class="article-date">
	  <time datetime="2017-12-07T15:19:40.000Z" itemprop="datePublished">December 7, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/118" target="_blank" rel="noopener">#118</a></strong></p>
<p>GitHub identifies users by email, so you can totally commit using someone ‘s email. This is how to configure in SourceTree</p>
<p><img src="https://user-images.githubusercontent.com/2284279/33725599-e8fb350e-db72-11e7-959a-4d8eca6f5a9a.png" alt="sourcetree"></p>
<ul>
<li><a href="https://help.github.com/articles/signing-commits-using-gpg/" target="_blank" rel="noopener">https://help.github.com/articles/signing-commits-using-gpg/</a></li>
<li><a href="https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/" target="_blank" rel="noopener">https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Badge-in-GitHub"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Badge-in-GitHub/">Badge in GitHub</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Badge-in-GitHub/" class="article-date">
	  <time datetime="2017-12-07T15:17:57.000Z" itemprop="datePublished">December 7, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/117" target="_blank" rel="noopener">#117</a></strong></p>
<p>GitHub is so awesome. It is where people around the world collaborate with each other.<br>It is more awesome to show more about you in your GitHub profile. How about a badge? a welcome text?<br>It is doable with organization. GitHub takes time and name of the organiazations you joined to determined how it displays on your profile</p>
<p>This used to be what shown on my GitHub profile <a href="https://github.com/onmyway133" target="_blank" rel="noopener">https://github.com/onmyway133</a></p>
<p><img src="https://user-images.githubusercontent.com/2284279/33725489-8d4994a8-db72-11e7-9dd8-e5cfc83a0975.png" alt="1_61enfsc61onicous7vdwkw"></p>
<p>For me, I display the text “Hello World”, so I have to create organizations for “h”, “e”, “l”, “l”, “o”, “w”, “o”, “r”, “l”, “d”<br>To ensure the order, you can name your organization like “org-h”, “org-he”, “org-hel”, “org-hell”, “org-hello”, … and you must join the organization in the correct order<br>I create another GitHub account called <a href="https://github.com/fantabot" target="_blank" rel="noopener">https://github.com/fantabot</a> to manage my organizations<br>Your imaginary is your limit. May your code continue to compile :grin:</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/11/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/13/">Next</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div class="widget-wrap" style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 75%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 42px;" placeholder=" Search…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="Search">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Ohayou</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
          
     			  <li><a href="https://github.com/onmyway133" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="https://twitter.com/onmyway133" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 
          
   		
          
            <li><a href="mailto:onmyway133@gmail.com?subject=Hello&body=World" title="email"><i class="fa fa-envelope" aria-hidden="true"></i></a></li> 
          
   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>Recent Posts</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-allow-unnotarized-app-to-run-on-macOS-Catalina/">How to allow unnotarized app to run on macOS Catalina</a></h6>
              <span>November 28, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-use-flipper/">How to use flipper</a></h6>
              <span>November 27, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-test-UserDefaults-in-iOS/">How to test UserDefaults in iOS</a></h6>
              <span>November 25, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-use-ForEach-with-ScrollView-in-SwiftUI/">How to use ForEach with ScrollView in SwiftUI</a></h6>
              <span>November 22, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-modify-data-inside-array-in-SwiftUI/">How to modify data inside array in SwiftUI</a></h6>
              <span>November 22, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-use-index-in-SwiftUI-list/">How to use index in SwiftUI list</a></h6>
              <span>November 22, 2019</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/android/" style="font-size: 17.65px;">android</a> <a href="/tags/apple-script/" style="font-size: 11.18px;">apple script</a> <a href="/tags/catalyst/" style="font-size: 10px;">catalyst</a> <a href="/tags/ci/" style="font-size: 11.18px;">ci</a> <a href="/tags/cloud/" style="font-size: 10.59px;">cloud</a> <a href="/tags/cocoapods/" style="font-size: 11.76px;">cocoapods</a> <a href="/tags/combine/" style="font-size: 11.18px;">combine</a> <a href="/tags/csharp/" style="font-size: 10px;">csharp</a> <a href="/tags/css/" style="font-size: 10.59px;">css</a> <a href="/tags/dart/" style="font-size: 11.76px;">dart</a> <a href="/tags/database/" style="font-size: 10.59px;">database</a> <a href="/tags/design/" style="font-size: 10.59px;">design</a> <a href="/tags/electron/" style="font-size: 11.76px;">electron</a> <a href="/tags/firebase/" style="font-size: 11.76px;">firebase</a> <a href="/tags/flutter/" style="font-size: 11.76px;">flutter</a> <a href="/tags/git/" style="font-size: 10.59px;">git</a> <a href="/tags/github/" style="font-size: 12.35px;">github</a> <a href="/tags/go/" style="font-size: 10.59px;">go</a> <a href="/tags/google/" style="font-size: 10px;">google</a> <a href="/tags/iOS/" style="font-size: 19.41px;">iOS</a> <a href="/tags/javascript/" style="font-size: 18.24px;">javascript</a> <a href="/tags/kotlin/" style="font-size: 17.06px;">kotlin</a> <a href="/tags/layout/" style="font-size: 11.18px;">layout</a> <a href="/tags/life/" style="font-size: 14.12px;">life</a> <a href="/tags/links/" style="font-size: 14.71px;">links</a> <a href="/tags/macOS/" style="font-size: 18.82px;">macOS</a> <a href="/tags/machine-learning/" style="font-size: 10.59px;">machine learning</a> <a href="/tags/maps/" style="font-size: 11.76px;">maps</a> <a href="/tags/networking/" style="font-size: 10px;">networking</a> <a href="/tags/node/" style="font-size: 13.53px;">node</a> <a href="/tags/objc/" style="font-size: 10.59px;">objc</a> <a href="/tags/react/" style="font-size: 11.18px;">react</a> <a href="/tags/react-native/" style="font-size: 15.29px;">react native</a> <a href="/tags/realm/" style="font-size: 10px;">realm</a> <a href="/tags/rx/" style="font-size: 11.18px;">rx</a> <a href="/tags/script/" style="font-size: 10.59px;">script</a> <a href="/tags/spm/" style="font-size: 10px;">spm</a> <a href="/tags/swift/" style="font-size: 20px;">swift</a> <a href="/tags/swiftUI/" style="font-size: 16.47px;">swiftUI</a> <a href="/tags/tech/" style="font-size: 15.88px;">tech</a> <a href="/tags/terminal/" style="font-size: 12.35px;">terminal</a> <a href="/tags/testing/" style="font-size: 12.94px;">testing</a> <a href="/tags/tool/" style="font-size: 10px;">tool</a> <a href="/tags/unity/" style="font-size: 10px;">unity</a> <a href="/tags/voip/" style="font-size: 11.76px;">voip</a> <a href="/tags/watchOS/" style="font-size: 14.12px;">watchOS</a> <a href="/tags/web/" style="font-size: 10.59px;">web</a> <a href="/tags/wwdc/" style="font-size: 10.59px;">wwdc</a> <a href="/tags/xcode/" style="font-size: 14.71px;">xcode</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">33</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">49</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">50</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">47</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">24</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">34</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apple-script/">apple script</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/catalyst/">catalyst</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ci/">ci</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/">cloud</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cocoapods/">cocoapods</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/combine/">combine</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/">csharp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dart/">dart</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/">electron</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firebase/">firebase</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flutter/">flutter</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google/">google</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a><span class="tag-list-count">135</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">36</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kotlin/">kotlin</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/layout/">layout</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/links/">links</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macOS/">macOS</a><span class="tag-list-count">69</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/">machine learning</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maps/">maps</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/networking/">networking</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/objc/">objc</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react-native/">react native</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/realm/">realm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rx/">rx</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/script/">script</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spm/">spm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swift/">swift</a><span class="tag-list-count">186</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swiftUI/">swiftUI</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/">tech</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/terminal/">terminal</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/testing/">testing</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/">tool</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unity/">unity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/voip/">voip</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/watchOS/">watchOS</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wwdc/">wwdc</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xcode/">xcode</a><span class="tag-list-count">11</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 onmyway133 All Rights Reserved.
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about/" class="mobile-nav-link">About</a>
  
    <a href="/writing/" class="mobile-nav-link">Writing</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/speaking/" class="mobile-nav-link">Speaking</a>
  
    <a href="/opensource/" class="mobile-nav-link">Open Source</a>
  
    <a href="/projects/" class="mobile-nav-link">Projects</a>
  
    <a href="/news/" class="mobile-nav-link">News</a>
  
    <a href="/gumroad/" class="mobile-nav-link">Gumroad</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-40119591-5', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->












  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
