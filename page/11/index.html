<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>onmyway133</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="ios, android, kotlin, mac, swift, electron, javascript, node">
  
  
  
  
  <meta name="description" content="What you don&apos;t know is what you haven&apos;t learned">
<meta name="keywords" content="ios, android,javascript, react">
<meta property="og:type" content="website">
<meta property="og:title" content="onmyway133">
<meta property="og:url" content="https://onmyway133.github.io/page/11/index.html">
<meta property="og:site_name" content="onmyway133">
<meta property="og:description" content="What you don&apos;t know is what you haven&apos;t learned">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onmyway133">
<meta name="twitter:description" content="What you don&apos;t know is what you haven&apos;t learned">
  
    <link rel="alternate" href="/atom.xml" title="onmyway133" type="application/atom+xml">
  
  <link rel="icon" href="/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/about/"] = "About"; 

  themeMenus["/writing/"] = "writing"; 

  themeMenus["/archives"] = "Archives"; 

  themeMenus["/speaking/"] = "speaking"; 

  themeMenus["/opensource/"] = "open source"; 

  themeMenus["/projects/"] = "projects"; 

  themeMenus["/news/"] = "news"; 

  themeMenus["/gumroad/"] = "gumroad"; 

  themeMenus["/atom.xml"] = "rss"; 

</script>


  <body>


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="onmyway133" rel="home"> onmyway133 </a>
            
          </h1>

          
            <div class="site-description">What you don&#39;t know is what you haven&#39;t learned</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about/">About</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/writing/">writing</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/speaking/">speaking</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/opensource/">open source</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/projects/">projects</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/news/">news</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/gumroad/">gumroad</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/atom.xml">rss</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "https://avatars1.githubusercontent.com/u/2284279?s=460&v=4".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-How-to-position-element-at-the-bottom-of-the-screen-using-Flexbox-in-React-Native"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-position-element-at-the-bottom-of-the-screen-using-Flexbox-in-React-Native/">How to position element at the bottom of the screen using Flexbox in React Native</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-position-element-at-the-bottom-of-the-screen-using-Flexbox-in-React-Native/" class="article-date">
	  <time datetime="2019-05-23T14:47:40.000Z" itemprop="datePublished">May 23, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/259" target="_blank" rel="noopener">#259</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/position-element-at-the-bottom-of-the-screen-using-flexbox-in-react-native-a00b3790ca42" target="_blank" rel="noopener">https://medium.com/react-native-training/position-element-at-the-bottom-of-the-screen-using-flexbox-in-react-native-a00b3790ca42</a></p>
<hr>
<p>React Native uses <a href="https://github.com/facebook/yoga" target="_blank" rel="noopener">Yoga</a> to achieve <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox" target="_blank" rel="noopener">Flexbox</a> style layout, which helps us set up layout in a declarative and easy way.</p>
<blockquote>
<p>The Flexible Box Module, usually referred to as flexbox, was designed as a one-dimensional layout model, and as a method that could offer space distribution between items in an interface and powerful alignment capabilities</p>
</blockquote>
<p>As someone who worked with Auto Layout in iOS and Constrain Layout in Android, I sometimes find it difficult to work with Flexbox in React Native. One of them is how to position certain element at the top or the bottom of the screen. This is the scenario when one element does not follow the rule i the container.</p>
<h2 id="A-traditional-layout"><a href="#A-traditional-layout" class="headerlink" title="A traditional layout"></a>A traditional layout</h2><p>Consider this traditional welcome screen, where we have some texts and a login button.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*mYxO00FDyT91dNaFHeCvIA.png" alt></p>
<p>Which is easily achieved with</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Image, Text, Button } from &apos;react-native&apos;
import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;
import ImageButton from &apos;library/components/ImageButton&apos;

export default class Welcome extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Image
          style={styles.image}
          source={images.placeholder} /&gt;
        &lt;Text style={styles.heading}&gt;{strings.onboarding.welcome.heading.toUpperCase()}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text1}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text2}&lt;/Text&gt;
        &lt;ImageButton
          style={styles.button}
          title={strings.onboarding.welcome.button} /&gt;
      &lt;/View&gt;
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  image: {
    marginTop: 50
  },
  heading: {
    ...palette.heading, ...{
      marginTop: 40
    }
  },
  text: {
    ...palette.text, ...{
      marginHorizontal: 8,
      marginVertical: 10
    }
  }
})</code></pre><p>Pay attention to styles . Unlike in web, Flexbox in React Native defaults main axis to be vertical, so elements are laid out from top to bottom. alignItems makes sure all elements are centered in the horizontal axis, which is the cross axis according to Flexbox terminology.</p>
<h2 id="Position-button-at-the-bottom"><a href="#Position-button-at-the-bottom" class="headerlink" title="Position button at the bottom"></a>Position button at the bottom</h2><p>According to design, the button should be positioned at the bottom of the screen. A dark though might suggest us to use position: ‘absolute’ , something like</p>
<pre><code>button: {
  position: &apos;absolute&apos;,
  bottom:0
}</code></pre><p>It workaround could work, but it’s like opting out of Flexbox. We like Flexbox and we like to embrace it. The solution is to use add a container for the button, and use flex-end inside so that the button moves to the bottom.</p>
<p>Let’s add a container</p>
<pre><code>&lt;View style={styles.bottom}&gt;
  &lt;ImageButton
    style={styles.button}
    title={strings.onboarding.welcome.button} /&gt;
&lt;/View&gt;</code></pre><p>and styles</p>
<pre><code>bottom: {
  flex: 1,
  justifyContent: &apos;flex-end&apos;,
  marginBottom: 36
}</code></pre><p>The flex tells the bottom view to take the remaining space. And inside this space, the bottom is laid out from the bottom, that’s what the flex-end means.</p>
<p>Here is how the result looks like</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*J2SIgsqzREyRz-GSsgoKIA.png" alt></p>
<p>And there is the full code</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Image, Text, Button } from &apos;react-native&apos;
import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;
import ImageButton from &apos;library/components/ImageButton&apos;

export default class Welcome extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Image
          style={styles.image}
          source={images.placeholder} /&gt;
        &lt;Text style={styles.heading}&gt;{strings.onboarding.welcome.heading.toUpperCase()}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text1}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text2}&lt;/Text&gt;
        &lt;View style={styles.bottom}&gt;
          &lt;ImageButton
            style={styles.button}
            title={strings.onboarding.welcome.button} /&gt;
        &lt;/View&gt;
      &lt;/View&gt;
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  image: {
    marginTop: 50
  },
  heading: {
    ...palette.heading, ...{
      marginTop: 40
    }
  },
  text: {
    ...palette.text, ...{
      marginHorizontal: 8,
      marginVertical: 10
    }
  },
  bottom: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})</code></pre><h2 id="What-is-flex-1"><a href="#What-is-flex-1" class="headerlink" title="What is flex: 1"></a>What is flex: 1</h2><p>According to <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox" target="_blank" rel="noopener">Basic concepts of flexbox</a></p>
<blockquote>
<p>The <strong>flex</strong> <a href="https://developer.mozilla.org/en-US/docs/CSS" target="_blank" rel="noopener">CSS</a> property specifies how a flex item will grow or shrink so as to fit the space available in its flex container. This is a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Shorthand_properties" target="_blank" rel="noopener">shorthand</a> property that sets <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex-grow" target="_blank" rel="noopener">flex-grow</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex-shrink" target="_blank" rel="noopener">flex-shrink</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex-basis" target="_blank" rel="noopener">flex-basis</a>.</p>
</blockquote>
<p>and <a href="https://www.w3.org/TR/css-flexbox-1/#flex-common" target="_blank" rel="noopener">w3</a></p>
<blockquote>
<p><a href="https://www.w3.org/TR/css-flexbox-1/#propdef-flex" target="_blank" rel="noopener">flex: <positive-number></positive-number></a> Equivalent to <a href="https://www.w3.org/TR/css-flexbox-1/#propdef-flex" target="_blank" rel="noopener">flex: <positive-number> 1 0</positive-number></a>. Makes the flex item flexible and sets the <a href="https://www.w3.org/TR/css-flexbox-1/#flex-flex-basis" target="_blank" rel="noopener">flex basis</a> to zero, resulting in an item that receives the specified proportion of the free space in the flex container. If all items in the flex container use this pattern, their sizes will be proportional to the specified flex factor.</p>
</blockquote>
<p>In most browsers, flex: 1 equals 1 1 0 , which means flex-grow: 1, flex-shrink:1, flex-basis: 0 . The flex-grow and flex-shrink specifies how much the item will grow or shrink relative to the rest of the flexible items inside the same container. And the flex-basis specifies the initial length of a flexible item. In this case the bottom View will take up the remaining space. And in that space, we can have whatever flow we want. To move the button to the bottom, we use justifyContent to lay out items in the main axis, with flex-end , which aligns the flex items at the end of the container.</p>
<h2 id="A-compositional-approach"><a href="#A-compositional-approach" class="headerlink" title="A compositional approach"></a>A compositional approach</h2><p>While this works, code can be duplicated quickly as we need to do this in a lot of screens. All we need is to wrap this ImageButton inside a container . Let’s encapsulate this with a a utility function. Add this utils/moveToBottom.js</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet } from &apos;react-native&apos;

function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})

export default moveToBottom</code></pre><p>Now in our screen, we just need to import</p>
<pre><code>import moveToBottom from &apos;library/utils/moveToBottom&apos;</code></pre><p>and wrap our button</p>
<pre><code>{
  moveToBottom(
    &lt;ImageButton
      style={styles.button}
      title={strings.onboarding.welcome.button}
      onPress={() =&gt; {
        this.props.navigation.navigate(&apos;Term&apos;)
      }} /&gt;
  )
}</code></pre><p>This time, we have the same screen as before, but with more reusable code. Since the styles are inside our moveToBottom module, we don’t need to specify styles in our screen any more. Here is the full code</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Image, Text, Button } from &apos;react-native&apos;
import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;
import ImageButton from &apos;library/components/ImageButton&apos;
import moveToBottom from &apos;library/utils/moveToBottom&apos;

export default class Welcome extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Image
          style={styles.logo}
          source={images.logo} /&gt;
        &lt;Image
          style={styles.image}
          source={images.placeholder} /&gt;
        &lt;Text style={styles.heading}&gt;{strings.onboarding.welcome.heading.toUpperCase()}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text1}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text2}&lt;/Text&gt;
        {
          moveToBottom(
            &lt;ImageButton
              style={styles.button}
              title={strings.onboarding.welcome.button}
              onPress={() =&gt; {
                this.props.navigation.navigate(&apos;Term&apos;)
              }} /&gt;
          )
        }
      &lt;/View&gt;
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  logo: {
    marginTop: 70,
    marginBottom: 42,
  },
  image: {

},
  heading: {
    ...palette.heading, ...{
      marginTop: 40
    }
  },
  text: {
    ...palette.text, ...{
      marginHorizontal: 8,
      marginVertical: 10
    }
  }
})</code></pre><h2 id="How-to-pass-component-as-parameter"><a href="#How-to-pass-component-as-parameter" class="headerlink" title="How to pass component as parameter"></a>How to pass component as parameter</h2><p>I have to admit that I initially implement moveToBottom using Component (we need uppercase since React has a convention of using initial uppercase for components) to embed the Component inside View</p>
<pre><code>function moveToBottom(Component) {
  return (
    &lt;View style={styles.container}&gt;
      &lt;Component /&gt;
    &lt;/View&gt;
  )
}</code></pre><p>But this results in bundling error</p>
<pre><code>ExceptionsManager.js:84 Warning: React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: &lt;ImageButton /&gt;. Did you accidentally export a JSX literal instead of a component?</code></pre><p>and</p>
<pre><code>ExceptionsManager.js:76 Invariant Violation: Invariant Violation: Invariant Violation: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object.</code></pre><p>As this moment I release that the thing I pass in is actually an object, not a class , so I treat it as an object and it works</p>
<pre><code>function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}</code></pre><h2 id="marginBottom-on-Android"><a href="#marginBottom-on-Android" class="headerlink" title="marginBottom on Android"></a>marginBottom on Android</h2><p>In the above moveToBottom function, I use marginBottom to have some margin from the bottom. This works on iOS but somehow does not have any effect in Android, and I use react-native 0.57.0 at the moment. This inconsistence can happen often in React Native development. A quick workaround is to perform platform check, we can make it into a nifty function in src/library/utils/check</p>
<pre><code>import { Platform } from &apos;react-native&apos;

const check = {
  isAndroid: () =&gt; {
    return Platform.OS === &apos;android&apos;
  }
}

export default check</code></pre><p>Then in moveToBottom , let ‘s use paddingBottom in case of app running in Android</p>
<pre><code>const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    paddingBottom: check.isAndroid ? 14 : 0
  }
})</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>In this post, we go from absolute position to another container, get to know flex , how to add reusable function and how to correctly pass component as parameter. Hope you find it useful. You can also check out this post <a href="https://medium.com/react-native-training/facebook-sdk-with-login-for-react-native-apps-in-2018-196601804f66" target="_blank" rel="noopener">React Native Login Using the Facebook SDK</a> where I shows more tips for React Native developments and recommended links to learn about Flexbox.</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/layout/">layout</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-native/">react native</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-setup-Android-projects"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-setup-Android-projects/">How to setup Android projects</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-setup-Android-projects/" class="article-date">
	  <time datetime="2019-05-23T07:44:52.000Z" itemprop="datePublished">May 23, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/257" target="_blank" rel="noopener">#257</a></strong></p>
<h2 id="checkstyle-Java"><a href="#checkstyle-Java" class="headerlink" title="checkstyle (Java)"></a>checkstyle (Java)</h2><ul>
<li><a href="http://checkstyle.sourceforge.net/" target="_blank" rel="noopener">http://checkstyle.sourceforge.net/</a></li>
<li><a href="https://github.com/checkstyle/checkstyle" target="_blank" rel="noopener">https://github.com/checkstyle/checkstyle</a></li>
</ul>
<blockquote>
<p>Checkstyle is a development tool to help programmers write Java code that adheres to a coding standard. It automates the process of checking Java code to spare humans of this boring (but important) task. This makes it ideal for projects that want to enforce a coding standard.</p>
</blockquote>
<p><code>app/build.gradle</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'checkstyle'</span></span><br><span class="line"></span><br><span class="line">task checkstyle(<span class="string">type:</span> Checkstyle) &#123;</span><br><span class="line">    description <span class="string">'Check code standard'</span></span><br><span class="line">    group <span class="string">'verification'</span></span><br><span class="line"></span><br><span class="line">    configFile file(<span class="string">'$project.rootDir/tools/checkstyle.xml'</span>)</span><br><span class="line">    source <span class="string">'src'</span></span><br><span class="line">    include <span class="string">'**/*.kt'</span></span><br><span class="line">    exclude <span class="string">'**/gen/**'</span></span><br><span class="line"></span><br><span class="line">    classpath = files()</span><br><span class="line">    ignoreFailures = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/chekcstyle</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span><span class="meta">&lt;!DOCTYPE module PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Puppy Crawl//DTD Check Configuration 1.2//EN"</span></span><br><span class="line"><span class="meta">        "http://www.puppycrawl.com/dtds/configuration_1_2.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"Checker"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"FileTabCharacter"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"TreeWalker"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Checks for Naming Conventions                            --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- See http://checkstyle.sourceforge.net/config_naming.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"MethodName"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"ConstantName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Checks for Imports                                 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- See http://checkstyle.sourceforge.net/config_imports.html--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"AvoidStarImport"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"UnusedImports"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Checks for Size                                          --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- See http://checkstyle.sourceforge.net/config_sizes       --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"ParameterNumber"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"max"</span> <span class="attr">value</span>=<span class="string">"6"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- other rules ignored for brevity --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="findbugs-Java"><a href="#findbugs-Java" class="headerlink" title="findbugs (Java)"></a>findbugs (Java)</h2><ul>
<li><a href="http://findbugs.sourceforge.net/" target="_blank" rel="noopener">http://findbugs.sourceforge.net/</a></li>
</ul>
<blockquote>
<p>A program which uses static analysis to look for bugs in Java code</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'findbugs'</span></span><br><span class="line"></span><br><span class="line">task findbugs(<span class="string">type:</span> FindBugs) &#123;</span><br><span class="line">    ignoreFailures = <span class="literal">false</span></span><br><span class="line">    effort = <span class="string">"max"</span></span><br><span class="line">    reportLevel = <span class="string">"low"</span></span><br><span class="line">    classes = files(<span class="string">"$project.buildDir/intermediates/javac"</span>)</span><br><span class="line"></span><br><span class="line">    excludeFilter = file(<span class="string">"$rootProject.rootDir/tools/findbugs-exclude.xml"</span>)</span><br><span class="line"></span><br><span class="line">    source = fileTree(<span class="string">'src/main/java/'</span>)</span><br><span class="line">    classpath = files()</span><br><span class="line"></span><br><span class="line">    reports &#123;</span><br><span class="line">        xml.enabled = <span class="literal">false</span></span><br><span class="line">        html.enabled = <span class="literal">true</span></span><br><span class="line">        html.destination file(<span class="string">"$project.buildDir/outputs/findbugs/findbugs-output.html"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/findbugs-exclude.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FindBugsFilter</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Do not check auto-generated resources classes --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span> <span class="attr">name</span>=<span class="string">"~.*R\$.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Do not check auto-generated manifest classes --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span> <span class="attr">name</span>=<span class="string">"~.*Manifest\$.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Do not check auto-generated classes (Dagger puts $ into class names) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span> <span class="attr">name</span>=<span class="string">"~.*Dagger*.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- http://findbugs.sourceforge.net/bugDescriptions.html#ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Bug</span> <span class="attr">pattern</span>=<span class="string">"ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FindBugsFilter</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="pmd-Java"><a href="#pmd-Java" class="headerlink" title="pmd (Java)"></a>pmd (Java)</h2><ul>
<li><a href="https://github.com/pmd/pmd" target="_blank" rel="noopener">https://github.com/pmd/pmd</a></li>
</ul>
<blockquote>
<p>PMD is a source code analyzer. It finds common programming flaws like unused variables, empty catch blocks, unnecessary object creation, and so forth</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'pmd'</span></span><br><span class="line"></span><br><span class="line">task pmd(<span class="string">type:</span> Pmd) &#123;</span><br><span class="line">    ruleSetFiles = files(<span class="string">"$&#123;project.rootDir&#125;/tools/pmd-rules.xml"</span>)</span><br><span class="line">    ignoreFailures = <span class="literal">false</span></span><br><span class="line">    ruleSets = []</span><br><span class="line"></span><br><span class="line">    source <span class="string">'src'</span></span><br><span class="line">    include <span class="string">'**/*.kt'</span></span><br><span class="line">    exclude <span class="string">'**/gen/**'</span></span><br><span class="line"></span><br><span class="line">    reports &#123;</span><br><span class="line">        xml.enabled = <span class="literal">false</span></span><br><span class="line">        html.enabled = <span class="literal">true</span></span><br><span class="line">        html.destination = file(<span class="string">"$project.buildDir/outputs/pmd/pmd.html"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/pmd-rules.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ruleset</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns</span>=<span class="string">"http://pmd.sourceforge.net/ruleset/2.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://pmd.sourceforge.net/ruleset/2.0.0 http://pmd.sourceforge.net/ruleset_2_0_0.xsd"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">exclude-pattern</span>&gt;</span>.*/R.java<span class="tag">&lt;/<span class="name">exclude-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclude-pattern</span>&gt;</span>.*/gen/.*<span class="tag">&lt;/<span class="name">exclude-pattern</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/basic.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/braces.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/strings.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/design.xml"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">name</span>=<span class="string">"AvoidDeeplyNestedIfStmts"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/unusedcode.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="lint"><a href="#lint" class="headerlink" title="lint"></a>lint</h2><ul>
<li><a href="https://developer.android.com/studio/write/lint" target="_blank" rel="noopener">https://developer.android.com/studio/write/lint</a></li>
</ul>
<blockquote>
<p>Android Studio provides a code scanning tool called lint that can help you to identify and correct problems with the structural quality of your code without your having to execute the app or write test cases</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  lintOptions &#123;</span><br><span class="line">        lintConfig file(<span class="string">"$project.rootDir/tools/lint-rules.xml"</span>)</span><br><span class="line">        htmlOutput file(<span class="string">"$project.buildDir/outputs/lint/lint.html"</span>)</span><br><span class="line">        warningsAsErrors <span class="literal">true</span></span><br><span class="line">        xmlReport <span class="literal">false</span></span><br><span class="line">        htmlReport <span class="literal">true</span></span><br><span class="line">        abortOnError <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/lint-rules.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lint</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"GoogleAppIndexWarning"</span> <span class="attr">severity</span>=<span class="string">"ignore"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"InvalidPackage"</span> <span class="attr">severity</span>=<span class="string">"error"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ignore</span> <span class="attr">regexp</span>=<span class="string">"okio.*jar"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ignore</span> <span class="attr">regexp</span>=<span class="string">"retrofit.*jar"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">issue</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Disable the given check in this project --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"IconMissingDensityFolder"</span> <span class="attr">severity</span>=<span class="string">"ignore"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Change the severity of hardcoded strings to "error" --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"HardcodedText"</span> <span class="attr">severity</span>=<span class="string">"error"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">lint</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Strict-mode"><a href="#Strict-mode" class="headerlink" title="Strict mode"></a>Strict mode</h2><ul>
<li><a href="https://developer.android.com/reference/android/os/StrictMode" target="_blank" rel="noopener">https://developer.android.com/reference/android/os/StrictMode</a></li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.app.Application</span><br><span class="line"><span class="keyword">import</span> android.os.StrictMode</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>: <span class="type">Application</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line"></span><br><span class="line">        enableStrictMode()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">enableStrictMode</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (BuildConfig.DEBUG) &#123;</span><br><span class="line">            StrictMode.setThreadPolicy(</span><br><span class="line">                StrictMode.ThreadPolicy.Builder()</span><br><span class="line">                    .detectAll()</span><br><span class="line">                    .penaltyLog()</span><br><span class="line">                    .build()</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            StrictMode.setVmPolicy(</span><br><span class="line">                StrictMode.VmPolicy.Builder()</span><br><span class="line">                    .detectAll()</span><br><span class="line">                    .penaltyLog()</span><br><span class="line">                    .build()</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Version-code"><a href="#Version-code" class="headerlink" title="Version code"></a>Version code</h2><p>tools/grgit.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'org.ajoberstar:grgit:1.5.0'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.ajoberstar.grgit.Grgit</span><br><span class="line"></span><br><span class="line">ext &#123;</span><br><span class="line">    git = Grgit.open(<span class="string">currentDir:</span> projectDir)</span><br><span class="line">    gitCommitCount = git.log().size()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task printVersion() &#123;</span><br><span class="line">    println(<span class="string">"Commit count: $gitCommitCount"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        versionCode gitCommitCount</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Obfuscation"><a href="#Obfuscation" class="headerlink" title="Obfuscation"></a>Obfuscation</h2><ul>
<li><a href="https://developer.android.com/studio/build/shrink-code" target="_blank" rel="noopener">https://developer.android.com/studio/build/shrink-code</a></li>
</ul>
<blockquote>
<p>To make your app as small as possible, you should enable shrinking in your release build to remove unused code and resources. When enabling shrinking, you also benefit from obfuscation, which shortens the names of your app’s classes and members, and optimization, which applies more aggressive strategies to further reduce the size of your app</p>
</blockquote>
<blockquote>
<p>When you use Android Studio 3.4 or Android Gradle plugin 3.4.0 and higher, R8 is the default compiler that converts your project’s Java bytecode into the DEX format that runs on the Android platform</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  buildTypes &#123;</span><br><span class="line">        debug &#123;</span><br><span class="line">            signingConfig signingConfigs.debug</span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android-optimize.txt'</span>), <span class="string">'$project.rootDir/tools/proguard-rules-debug.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        release &#123;</span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            shrinkResources <span class="literal">true</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android-optimize.txt'</span>), <span class="string">'$project.rootDir/tools/proguard-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/proguard-rules.pro</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-ignorewarnings</span><br><span class="line"></span><br><span class="line"># Remove logs</span><br><span class="line">-assumenosideeffects class android.util.Log &#123;</span><br><span class="line">    public static boolean isLoggable(java.lang.String, int);</span><br><span class="line">    public static int v(...);</span><br><span class="line">    public static int i(...);</span><br><span class="line">    public static int w(...);</span><br><span class="line">    public static int d(...);</span><br><span class="line">    public static int e(...);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/proguard-rules-debug.pro</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-ignorewarnings</span><br><span class="line">-dontobfuscate</span><br><span class="line">-dontoptimize</span><br><span class="line">-ignorewarnings</span><br></pre></td></tr></table></figure>

<p>More proguard snippets <a href="https://github.com/krschultz/android-proguard-snippets" target="_blank" rel="noopener">https://github.com/krschultz/android-proguard-snippets</a></p>
<h2 id="quality"><a href="#quality" class="headerlink" title="quality"></a>quality</h2><p>tools/quality.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">task findbugs</span><br><span class="line">task pmd</span><br><span class="line">task checkstyle</span><br></pre></td></tr></table></figure>

<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">from:</span> <span class="string">"$project.rootDir/tools/quality.gradle"</span></span><br></pre></td></tr></table></figure>

<h2 id="File-format"><a href="#File-format" class="headerlink" title="File format"></a>File format</h2><ul>
<li><a href="https://twitter.com/kotlin/status/1067825173196414976?lang=en" target="_blank" rel="noopener">https://twitter.com/kotlin/status/1067825173196414976?lang=en</a></li>
</ul>
<blockquote>
<p>You don’t need to use ktlint or detekt to ensure that your code is formatted consistently. Simply enable “File is not formatted according to project settings” in the inspection settings.</p>
</blockquote>
<h2 id="ktlint-Kotlin"><a href="#ktlint-Kotlin" class="headerlink" title="ktlint (Kotlin)"></a>ktlint (Kotlin)</h2><ul>
<li><a href="https://github.com/pinterest/ktlint" target="_blank" rel="noopener">https://github.com/pinterest/ktlint</a></li>
</ul>
<blockquote>
<p>An anti-bikeshedding Kotlin linter with built-in formatter</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">from:</span> <span class="string">"$project.rootDir/tools/ktlint.gradle"</span></span><br></pre></td></tr></table></figure>

<p>tools/ktlint.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    jcenter()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configurations &#123;</span><br><span class="line">    ktlint</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    ktlint <span class="string">"com.pinterest:ktlint:0.32.0"</span></span><br><span class="line">    <span class="comment">// additional 3rd party ruleset(s) can be specified here</span></span><br><span class="line">    <span class="comment">// just add them to the classpath (e.g. ktlint 'groupId:artifactId:version') and</span></span><br><span class="line">    <span class="comment">// ktlint will pick them up</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task ktlint(<span class="string">type:</span> JavaExec, <span class="string">group:</span> <span class="string">"verification"</span>) &#123;</span><br><span class="line">    description = <span class="string">"Check Kotlin code style."</span></span><br><span class="line">    classpath = configurations.ktlint</span><br><span class="line">    main = <span class="string">"com.pinterest.ktlint.Main"</span></span><br><span class="line">    args <span class="string">"src/**/*.kt"</span>, <span class="string">"--reporter=checkstyle, output=$&#123;buildDir&#125;/outputs/ktlint.xml"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">task ktlintFormat(<span class="string">type:</span> JavaExec, <span class="string">group:</span> <span class="string">"formatting"</span>) &#123;</span><br><span class="line">    description = <span class="string">"Fix Kotlin code style deviations."</span></span><br><span class="line">    classpath = configurations.ktlint</span><br><span class="line">    main = <span class="string">"com.pinterest.ktlint.Main"</span></span><br><span class="line">    args <span class="string">"-F"</span>, <span class="string">"src/**/*.kt"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>.editorconfig</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[*.&#123;kt,kts&#125;]</span><br><span class="line">indent_size=4</span><br></pre></td></tr></table></figure>

<h2 id="detekt-Kotlin"><a href="#detekt-Kotlin" class="headerlink" title="detekt (Kotlin)"></a>detekt (Kotlin)</h2><ul>
<li><a href="https://github.com/arturbosch/detekt" target="_blank" rel="noopener">https://github.com/arturbosch/detekt</a></li>
</ul>
<blockquote>
<p>Static code analysis for Kotlin</p>
</blockquote>
<p>build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;&#125;</span><br><span class="line"></span><br><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">"io.gitlab.arturbosch.detekt"</span> version <span class="string">"1.0.0-RC14"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>tools/detekt.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">detekt &#123;</span><br><span class="line">    toolVersion = <span class="string">"1.0.0-RC14"</span></span><br><span class="line">    input = files(<span class="string">"src/main"</span>)</span><br><span class="line">    filters = <span class="string">".*/resources/.*,.*/build/.*"</span></span><br><span class="line">    baseline = file(<span class="string">"$&#123;project.rootDir&#125;/tools/detekt-baseline.xml"</span>)</span><br><span class="line">    config = files(file(<span class="string">"$project.rootDir/tools/detekt.yml"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/detekt.xml </p>
<ul>
<li><a href="https://github.com/arturbosch/detekt/blob/master/docs/pages/baseline.md" target="_blank" rel="noopener">https://github.com/arturbosch/detekt/blob/master/docs/pages/baseline.md</a></li>
</ul>
<blockquote>
<p>The intention of a whitelist is that only new code smells are printed on further analysis. The blacklist can be used to write down false positive detections (instead of suppressing them and polute your code base).</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">SmellBaseline</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Blacklist</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>CatchRuntimeException:Junk.kt$e: RuntimeException<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Blacklist</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Whitelist</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>NestedBlockDepth:Indentation.kt$Indentation$override fun procedure(node: ASTNode)<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>TooManyFunctions:LargeClass.kt$io.gitlab.arturbosch.detekt.rules.complexity.LargeClass.kt<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>ComplexMethod:DetektExtension.kt$DetektExtension$fun convertToArguments(): MutableList&amp;lt;String&amp;gt;<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Whitelist</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">SmellBaseline</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>tools/detekt.yml </p>
<ul>
<li><a href="https://github.com/arturbosch/detekt/blob/master/detekt-cli/src/main/resources/default-detekt-config.yml" target="_blank" rel="noopener">https://github.com/arturbosch/detekt/blob/master/detekt-cli/src/main/resources/default-detekt-config.yml</a></li>
<li><a href="https://arturbosch.github.io/detekt/configurations.html" target="_blank" rel="noopener">https://arturbosch.github.io/detekt/configurations.html</a></li>
</ul>
<blockquote>
<p>detekt uses a yaml style configuration file for various things:</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">autoCorrect:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line"><span class="attr">  maxIssues:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">  weights:</span></span><br><span class="line">    <span class="comment"># complexity: 2</span></span><br><span class="line">    <span class="comment"># LongParameterList: 1</span></span><br><span class="line">    <span class="comment"># style: 1</span></span><br><span class="line">    <span class="comment"># comments: 1</span></span><br></pre></td></tr></table></figure>

<p>Run</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew detekt</span><br></pre></td></tr></table></figure>

<h2 id="check"><a href="#check" class="headerlink" title="check"></a>check</h2><p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">check.dependsOn <span class="string">'checkstyle'</span>, <span class="string">'findbugs'</span>, <span class="string">'pmd'</span>, <span class="string">'lint'</span>, <span class="string">'ktlint'</span>, <span class="string">'detekt'</span></span><br></pre></td></tr></table></figure>

<p>Run</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew check</span><br></pre></td></tr></table></figure>

<h2 id="Gradle-Kotlin-DSL"><a href="#Gradle-Kotlin-DSL" class="headerlink" title="Gradle Kotlin DSL"></a>Gradle Kotlin DSL</h2><ul>
<li>How to use Gradle Kotlin DSL in Android <a href="https://github.com/onmyway133/blog/issues/285" target="_blank" rel="noopener">https://github.com/onmyway133/blog/issues/285</a></li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://proandroiddev.com/configuring-android-project-little-things-that-matter-d6a9d34c1ce0" target="_blank" rel="noopener">Configuring Android Project — Little Things That Matter</a></li>
<li><a href="https://code.tutsplus.com/tutorials/ensure-high-quality-android-code-with-static-analysis-tools--cms-28787" target="_blank" rel="noopener">Ensure High-Quality Android Code With Static Analysis Tools</a></li>
<li><a href="https://proandroiddev.com/kotlin-static-analysis-why-and-how-a12042e34a98" target="_blank" rel="noopener">Kotlin Static Analysis — why and how?</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-structure-your-project-and-manage-static-resources-in-React-Native"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-structure-your-project-and-manage-static-resources-in-React-Native/">How to structure your project and manage static resources in React Native</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-structure-your-project-and-manage-static-resources-in-React-Native/" class="article-date">
	  <time datetime="2019-05-23T05:48:09.000Z" itemprop="datePublished">May 23, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/256" target="_blank" rel="noopener">#256</a></strong></p>
<p>Original post <a href="https://medium.freecodecamp.org/how-to-structure-your-project-and-manage-static-resources-in-react-native-6f4cfc947d92" target="_blank" rel="noopener">https://medium.freecodecamp.org/how-to-structure-your-project-and-manage-static-resources-in-react-native-6f4cfc947d92</a></p>
<hr>
<p>React and React Native are just frameworks, and they do not dictate how we should structure our projects. It all depends on your personal taste and the project you’re working on.</p>
<p>In this post, we will go through how to structure a project and how to manage local assets. This of course is not written in stone, and you are free to apply only the pieces that suit you. Hope you learn something.</p>
<p>For a project bootstrapped with <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3" target="_blank" rel="noopener">react-native init</a> , we get only the <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3" target="_blank" rel="noopener">basic structure</a>.</p>
<p>There is the ios folder for Xcode projects, the android folder for Android projects, and an index.js and an App.js file for the React Native starting point.</p>
<pre><code>ios/
android/
index.js
App.js</code></pre><p>As someone who has worked with native on both Windows Phone, iOS and Android, I find that structuring a project all comes down to separating files by <strong>type</strong> or <strong>feature</strong></p>
<h2 id="type-vs-feature"><a href="#type-vs-feature" class="headerlink" title="type vs feature"></a>type vs feature</h2><p>Separating by type means that we organise files by their type. If it is a component, there are container and presentational files. If it is Redux, there are action, reducer, and store files. If it is view, there are JavaScript, HTML, and CSS files.</p>
<h3 id="Group-by-type"><a href="#Group-by-type" class="headerlink" title="Group by type"></a>Group by type</h3><pre><code>redux
  actions
  store
  reducers
components
  container
  presentational
view
  javascript
  html
  css</code></pre><p>This way, we can see the type of each file, and easily run a script toward a certain file type. This is general for all projects, but it does not answer the question “what is this project about?” Is it news application? Is it a loyalty app? Is it about nutrition tracking?</p>
<p>Organising files by type is for a machine, not for a human. Many times we work on a feature, and finding files to fix in multiple directories is a hassle. It’s also a pain if we plan to make a framework out of our project, as files are spread across many places.</p>
<h3 id="Group-by-feature"><a href="#Group-by-feature" class="headerlink" title="Group by feature"></a>Group by feature</h3><p>A more reasonable solution is to organise files by feature. Files related to a feature should be placed together. And <a href="https://medium.com/@JeffLombardJr/organizing-tests-in-jest-17fc431ff850" target="_blank" rel="noopener">test files</a> should stay close to the source files. Check out <a href="https://medium.com/@JeffLombardJr/organizing-tests-in-jest-17fc431ff850" target="_blank" rel="noopener">this article</a> to learn more.</p>
<p>A feature can be related to login, sign up, onboarding, or a user’s profile. A feature can contain sub-features as long as they belong to the same flow. If we wanted to move the sub feature around, it would be easy, as all related files are already grouped together.</p>
<p>My typical project structure based on features looks like this:</p>
<pre><code>index.js
App.js
ios/
android/
src
  screens
    login
      LoginScreen.js
      LoginNavigator.js
    onboarding
      OnboardingNavigator    
      welcome 
        WelcomeScreen.js
      term
        TermScreen.js
      notification
        NotificationScreen.js
    main
      MainNavigator.js
      news
        NewsScreen.js
      profile
        ProfileScreen.js
      search
        SearchScreen.js
  library
    package.json
    components
      ImageButton.js
      RoundImage.js
    utils
      moveToBottom.js
      safeArea.js
    networking
      API.js
      Auth.js
  res
    package.json
    strings.js
    colors.js
    palette.js
    fonts.js
    images.js
    images
      logo@2x.png
      logo@3x.png
      button@2x.png
      button@3x.png
scripts
  images.js
  clear.js</code></pre><p>Besides the traditional files App.js and index.js and the ios1 and android folders, I put all the source files inside the src folder. Inside src I have res for resources, library for common files used across features, and screens for a screen of content.</p>
<h3 id="As-few-dependencies-as-possible"><a href="#As-few-dependencies-as-possible" class="headerlink" title="As few dependencies as possible"></a>As few dependencies as possible</h3><p>Since React Native is heavily dependent on tons of dependencies, I try to be pretty aware when adding more. In my project I use just react-navigation for navigation. And I’m not a fan of redux as it adds unneeded complexity. Only add a dependency when you really need it, otherwise you are just setting yourself up for more trouble than value.</p>
<p>The thing I like about React is the components. A component is where we define view, style and behavior. React has inline style — it’s like using JavaScript to define script, HTML and CSS. This fits the feature approach we are aiming for. That’s why I don’t use <a href="https://github.com/styled-components/styled-components" target="_blank" rel="noopener">styled-components</a>. Since styles are just JavaScript objects, we can just share comment styles in library .</p>
<h2 id="src"><a href="#src" class="headerlink" title="src"></a>src</h2><p>I like Android a lot, so I name src and res to match its folder conventions.</p>
<p>react-native init sets up babel for us. But for a typical JavaScript project, it’s good to organise files in the src folder. In my electron.js application <a href="https://github.com/onmyway133/IconGenerator/tree/master/src" target="_blank" rel="noopener">IconGenerator</a>, I put the source files inside the src folder. This not only helps in terms of organising, but also helps babel transpile the entire folder at once. Just a command and I have the files in src transpiled to dist in a blink.</p>
<pre><code>babel ./src --out-dir ./dist --copy-files</code></pre><h2 id="Screen"><a href="#Screen" class="headerlink" title="Screen"></a>Screen</h2><p>React is based around components. Yup. There are <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener">container and presentational components</a>, but we can compose components to build more complex components. They usually end in showing in the full screen. It is called Page in Windows Phone, ViewController in iOS and Activity in Android. The React Native guide mentions <a href="https://facebook.github.io/react-native/docs/navigation" target="_blank" rel="noopener">screen</a> very often as something that covers the entire space:</p>
<blockquote>
<h1 id="Mobile-apps-are-rarely-made-up-of-a-single-screen-Managing-the-presentation-of-and-transition-between-multiple-screens-is-typically-handled-by-what-is-known-as-a-navigator"><a href="#Mobile-apps-are-rarely-made-up-of-a-single-screen-Managing-the-presentation-of-and-transition-between-multiple-screens-is-typically-handled-by-what-is-known-as-a-navigator" class="headerlink" title="Mobile apps are rarely made up of a single screen. Managing the presentation of, and transition between, multiple screens is typically handled by what is known as a navigator."></a>Mobile apps are rarely made up of a single screen. Managing the presentation of, and transition between, multiple screens is typically handled by what is known as a navigator.</h1></blockquote>
<h3 id="index-js-or-not"><a href="#index-js-or-not" class="headerlink" title="index.js or not?"></a>index.js or not?</h3><p>Each screen is considered the entry point for each feature. You can rename the LoginScreen.js to index.js by leveraging the Node <a href="https://medium.freecodecamp.org/requiring-modules-in-node-js-everything-you-need-to-know-e7fbd119be8" target="_blank" rel="noopener">module</a> feature:</p>
<blockquote>
<p>Modules don’t have to be files. We can also create a find-me folder under node_modules and place an index.js file in there. The same require(‘find-me’) line will use that folder’s index.js file</p>
</blockquote>
<p>So instead of import LoginScreen from ‘./screens/LoginScreen’ , we can just do import LoginScreen from ‘./screens’.</p>
<p>Using index.js results in encapsulation and provides a public interface for the feature. This is all personal taste. I myself prefer explicit naming for a file, hence the name LoginScreen.js.</p>
<h2 id="Navigator"><a href="#Navigator" class="headerlink" title="Navigator"></a>Navigator</h2><p><a href="https://github.com/react-navigation/react-navigation" target="_blank" rel="noopener">react-navigation</a> seems to be the most popular choice for handling navigation in a React Native app. For a feature like onboarding, there are probably many screens managed by a stack navigation, so there is OnboardingNavigator .</p>
<p>You can think of Navigator as something that groups sub screens or features. Since we group by feature, it’s reasonable to place Navigator inside the feature folder. It basically looks like this:</p>
<pre><code>import { createStackNavigator } from &apos;react-navigation&apos;
import Welcome from &apos;./Welcome&apos;
import Term from &apos;./Term&apos;

const routeConfig = {
  Welcome: {
    screen: Welcome
  },
  Term: {
    screen: Term
  }
}

const navigatorConfig = {
  navigationOptions: {
    header: null
  }
}

export default OnboardingNavigator = createStackNavigator(routeConfig, navigatorConfig)</code></pre><h2 id="library"><a href="#library" class="headerlink" title="library"></a>library</h2><p>This is the most controversial part of structuring a project. If you don’t like the name library, you can name it utilities, common, citadel , whatever…</p>
<p>This is not meant for homeless files, but it is where we place common utilities and components that are used by many features. Things like atomic components, wrappers, quick fixes function, networking stuff, and login info are used a lot, and it’s hard to move them to a specific feature folder. Sometimes we just need to be practical and get the work done.</p>
<p>In React Native, we often need to implement a button with an image background in many screens. Here is a simple one that stays inside library/components/ImageButton.js . The components folder is for reusable components, sometimes called <a href="https://medium.com/joeydinardo/a-brief-look-at-atomic-components-39cbe71d38b5" target="_blank" rel="noopener">atomic components</a>. According to React naming conventions, the first letter should be uppercase.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; TouchableOpacity, View, Image, Text, StyleSheet &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> images <span class="keyword">from</span> <span class="string">'res/images'</span></span><br><span class="line"><span class="keyword">import</span> colors <span class="keyword">from</span> <span class="string">'res/colors'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;TouchableOpacity style=&#123;styles.touchable&#125; onPress=&#123;<span class="keyword">this</span>.props.onPress&#125;&gt;</span><br><span class="line">                &lt;View style=&#123;styles.view&#125;&gt;</span><br><span class="line">                    &lt;Text style=&#123;styles.text&#125;&gt;&#123;<span class="keyword">this</span>.props.title&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>View&gt;</span><br><span class="line">                &lt;Image</span><br><span class="line">                    source=&#123;images.button&#125;</span><br><span class="line">                    style=&#123;styles.image&#125; /&gt;</span><br><span class="line">            &lt;<span class="regexp">/TouchableOpacity&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    view: &#123;</span></span><br><span class="line"><span class="regexp">        position: 'absolute',</span></span><br><span class="line"><span class="regexp">        backgroundColor: 'transparent'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    image: &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    touchable: &#123;</span></span><br><span class="line"><span class="regexp">        alignItems: 'center',</span></span><br><span class="line"><span class="regexp">        justifyContent: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    text: &#123;</span></span><br><span class="line"><span class="regexp">        color: colors.button,</span></span><br><span class="line"><span class="regexp">        fontSize: 18,</span></span><br><span class="line"><span class="regexp">        textAlign: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<p>And if we want to place the button at the bottom, we use a utility function to prevent code duplication. Here is library/utils/moveToBottom.js:</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet } from &apos;react-native&apos;

function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})

export default moveToBottom</code></pre><h3 id="Use-package-json-to-avoid-relative-path"><a href="#Use-package-json-to-avoid-relative-path" class="headerlink" title="Use package.json to avoid relative path"></a>Use package.json to avoid relative path</h3><p>Then somewhere in the src/screens/onboarding/term/Term.js , we can import by using relative paths:</p>
<pre><code>import moveToBottom from &apos;../../../../library/utils/move&apos;
import ImageButton from &apos;../../../../library/components/ImageButton&apos;</code></pre><p>This is a big red flag in my eyes. It’s error prone, as we need to calculate how many .. we need to perform. And if we move feature around, all of the paths need to be recalculated.</p>
<p>Since library is meant to be used many places, it’s good to reference it as an absolute path. In JavaScript there are usually 1000 libraries to a single problem. A quick search on Google reveals tons of libraries to tackle this issue. But we don’t need another dependency as this is extremely easy to fix.</p>
<p>The solution is to turn library into a module so node can find it. Adding package.json to any folder makes it into a Node module . Add package.json inside the library folder with this simple content:</p>
<pre><code>{
  &quot;name&quot;: &quot;library&quot;,
  &quot;version&quot;: &quot;0.0.1&quot;
}</code></pre><p>Now in Term.js we can easily import things from library because it is now a module:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, StyleSheet, Image, Text, Button &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> strings <span class="keyword">from</span> <span class="string">'res/strings'</span></span><br><span class="line"><span class="keyword">import</span> palette <span class="keyword">from</span> <span class="string">'res/palette'</span></span><br><span class="line"><span class="keyword">import</span> images <span class="keyword">from</span> <span class="string">'res/images'</span></span><br><span class="line"><span class="keyword">import</span> ImageButton <span class="keyword">from</span> <span class="string">'library/components/ImageButton'</span></span><br><span class="line"><span class="keyword">import</span> moveToBottom <span class="keyword">from</span> <span class="string">'library/utils/moveToBottom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Term</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">                &lt;Text style=&#123;styles.heading&#125;&gt;&#123;strings.onboarding.term.heading.toUpperCase()&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">                &#123;</span></span><br><span class="line"><span class="regexp">                    moveToBottom(</span></span><br><span class="line"><span class="regexp">                        &lt;ImageButton style=&#123;styles.button&#125; title=&#123;strings.onboarding.term.button.toUpperCase()&#125; /</span>&gt;</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    container: &#123;</span></span><br><span class="line"><span class="regexp">        flex: 1,</span></span><br><span class="line"><span class="regexp">        alignItems: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    heading: &#123;</span></span><br><span class="line"><span class="regexp">        ...palette.heading, ...&#123;</span></span><br><span class="line"><span class="regexp">            marginTop: 72</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="res"><a href="#res" class="headerlink" title="res"></a>res</h2><p>You may wonder what res/colors, res/strings , res/images and res/fonts are in the above examples. Well, for front end projects, we usually have components and style them using fonts, localised strings, colors, images and styles. JavaScript is a very dynamic language, and it’s easy to use stringly types everywhere. We could have a bunch of #00B75D color across many files, or Fira as a fontFamily in many Text components. This is error-prone and hard to refactor.</p>
<p>Let’s encapsulate resource usage inside the res folder with safer objects. They look like the examples below:</p>
<p><strong>res/colors</strong></p>
<pre><code>const colors = {
  title: &apos;#00B75D&apos;,
  text: &apos;#0C222B&apos;,
  button: &apos;#036675&apos;
}

export default colors</code></pre><p><strong>res/strings</strong></p>
<pre><code>const strings = {
  onboarding: {
    welcome: {
      heading: &apos;Welcome&apos;,
      text1: &quot;What you don&apos;t know is what you haven&apos;t learn&quot;,
      text2: &apos;Visit my GitHub at [https://github.com/onmyway133&apos;](https://github.com/onmyway133&apos;),
      button: &apos;Log in&apos;
    },
    term: {
      heading: &apos;Terms and conditions&apos;,
      button: &apos;Read&apos;
    }
  }
}

export default strings</code></pre><p><strong>res/fonts</strong></p>
<pre><code>const fonts = {
  title: &apos;Arial&apos;,
  text: &apos;SanFrancisco&apos;,
  code: &apos;Fira&apos;
}

export default fonts</code></pre><p><strong>res/images</strong></p>
<pre><code>const images = {
  button: require(&apos;./images/button.png&apos;),
  logo: require(&apos;./images/logo.png&apos;),
  placeholder: require(&apos;./images/placeholder.png&apos;)
}

export default images</code></pre><p>Like library , res files can be access from anywhere, so let’s make it a module . Add package.json to the res folder:</p>
<pre><code>{
  &quot;name&quot;: &quot;res&quot;,
  &quot;version&quot;: &quot;0.0.1&quot;
}</code></pre><p>so we can access resource files like normal modules:</p>
<pre><code>import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;</code></pre><h3 id="Group-colors-images-fonts-with-palette"><a href="#Group-colors-images-fonts-with-palette" class="headerlink" title="Group colors, images, fonts with palette"></a>Group colors, images, fonts with palette</h3><p>The design of the app should be consistent. Certain elements should have the same look and feel so they don’t confuse the user. For example, the heading Text should use one color, font, and font size. The Image component should use the same placeholder image. In React Native, we already use the name styles with const styles = StyleSheet.create({}) so let’s use the name palette.</p>
<p>Below is my simple palette. It defines common styles for heading and Text:</p>
<h3 id="res-palette"><a href="#res-palette" class="headerlink" title="res/palette"></a>res/palette</h3><pre><code>import colors from &apos;./colors&apos;

const palette = {
  heading: {
    color: colors.title,
    fontSize: 20,
    textAlign: &apos;center&apos;
  },
  text: {
    color: colors.text,
    fontSize: 17,
    textAlign: &apos;center&apos;
  }
}

export default palette</code></pre><p>And then we can use them in our screen:</p>
<pre><code>const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  heading: {...palette.heading, ...{
    marginTop: 72
  }}
})</code></pre><p>Here we use the <a href="https://github.com/tc39/proposal-object-rest-spread" target="_blank" rel="noopener">object spread operator</a> to merge palette.heading and our custom style object. This means that we use the styles from palette.heading but also specify more properties.</p>
<p>If we were to reskin the app for multiple brands, we could have multiple palettes. This is a really powerful pattern.</p>
<h3 id="Generate-images"><a href="#Generate-images" class="headerlink" title="Generate images"></a>Generate images</h3><p>You can see that in /src/res/images.js we have properties for each image in the src/res/images folder:</p>
<pre><code>const images = {
  button: require(&apos;./images/button.png&apos;),
  logo: require(&apos;./images/logo.png&apos;),
  placeholder: require(&apos;./images/placeholder.png&apos;)
}

export default images</code></pre><p>This is tedious to do manually, and we have to update if there’s changes in image naming convention. Instead, we can add a script to generate the images.js based on the images we have. Add a file at the root of the project /scripts/images.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imageFileNames = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> array = fs</span><br><span class="line">        .readdirSync(<span class="string">'src/res/images'</span>)</span><br><span class="line">        .filter(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.endsWith(<span class="string">'.png'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.replace(<span class="string">'[@2x](http://twitter.com/2x).png'</span>, <span class="string">''</span>).replace(<span class="string">'[@3x](http://twitter.com/3x).png'</span>, <span class="string">''</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> properties = imageFileNames()</span><br><span class="line">        .map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;name&#125;</span>: require('./images/<span class="subst">$&#123;name&#125;</span>.png')`</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">',\n  '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> string = <span class="string">`const images = &#123;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;properties&#125;</span></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default images</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(<span class="string">'src/res/images.js'</span>, string, <span class="string">'utf8'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generate()</span><br></pre></td></tr></table></figure>

<p>The cool thing about Node is that we have access to the fs module, which is really good at file processing. Here we simply traverse through images, and update /src/res/images.js accordingly.</p>
<p>Whenever we add or change images, we can run:</p>
<pre><code>node scripts/images.js</code></pre><p>And we can also declare the script inside our main package.json :</p>
<pre><code>&quot;scripts&quot;: {
  &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;,
  &quot;test&quot;: &quot;jest&quot;,
  &quot;lint&quot;: &quot;eslint *.js **/*.js&quot;,
  &quot;images&quot;: &quot;node scripts/images.js&quot;
}</code></pre><p>Now we can just run npm run images and we get an up-to-date images.js resource file.</p>
<h3 id="How-about-custom-fonts"><a href="#How-about-custom-fonts" class="headerlink" title="How about custom fonts"></a>How about custom fonts</h3><p>React Native has some <a href="https://medium.com/react-native-training/list-of-available-react-native-fonts-ed78b48bd45e" target="_blank" rel="noopener">custom fonts</a> that may be good enough for your projects. You can also use custom fonts.</p>
<p>One thing to note is that Android uses the name of the font file, but iOS uses the full name. You can see the full name in Font Book app, or by inspecting in running app</p>
<pre><code>for (NSString* family in [UIFont familyNames]) {
  NSLog(@&quot;%@&quot;, family);

for (NSString* name in [UIFont fontNamesForFamilyName: family]) {
    NSLog(@&quot;Family name:  %@&quot;, name);
  }
}</code></pre><p>For custom fonts to be registered in iOS, we need to declare UIAppFonts in Info.plist using the file name of the fonts, and for Android, the fonts need to be placed at app/src/main/assets/fonts .</p>
<p>It is good practice to name the font file the same as full name. React Native is said to dynamically load custom fonts, but in case you get “Unrecognized font family”, then simply add those fonts to target within Xcode.</p>
<p>Doing this by hand takes time, luckily we have <a href="https://github.com/rnpm/rnpm" target="_blank" rel="noopener">rnpm</a> that can help. First add all the fonts inside res/fonts folder. Then simply declare rnpm in package.json and run react-native link . This should declare UIAppFonts in iOS and move all the fonts into app/src/main/assets/fonts for Android.</p>
<pre><code>&quot;rnpm&quot;: {
  &quot;assets&quot;: [
    &quot;./src/res/fonts/&quot;
  ]
}</code></pre><p>Accessing fonts by name is error prone, we can create a script similar to what we have done with images to generate a safer accession. Add fonts.js to our scripts folder</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fontFileNames = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> array = fs</span><br><span class="line">        .readdirSync(<span class="string">'src/res/fonts'</span>)</span><br><span class="line">        .map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.replace(<span class="string">'.ttf'</span>, <span class="string">''</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> properties = fontFileNames()</span><br><span class="line">        .map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> key = name.replace(<span class="regexp">/\s/g</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;key&#125;</span>: '<span class="subst">$&#123;name&#125;</span>'`</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">',\n  '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> string = <span class="string">`const fonts = &#123;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;properties&#125;</span></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default fonts</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(<span class="string">'src/res/fonts.js'</span>, string, <span class="string">'utf8'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generate()</span><br></pre></td></tr></table></figure>

<p>Now you can use custom font via R namespace.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> R <span class="keyword">from</span> <span class="string">'res/R'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">    text: &#123;</span><br><span class="line">        fontFamily: R.fonts.FireCodeNormal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="The-R-namespace"><a href="#The-R-namespace" class="headerlink" title="The R namespace"></a>The R namespace</h2><p>This step depends on personal taste, but I find it more organised if we introduce the R namespace, just like how Android does for assets with the generated <a href="https://stackoverflow.com/questions/9408544/what-is-r-class-in-android/9408589" target="_blank" rel="noopener">R class</a>.</p>
<blockquote>
<p>Once you externalize your app resources, you can access them using resource IDs that are generated in your project’s Rclass. This document shows you how to group your resources in your Android project and provide alternative resources for specific device configurations, and then access them from your app code or other XML files.</p>
</blockquote>
<p>This way, let’s make a file called R.js in src/res:</p>
<pre><code>import strings from &apos;./strings&apos;
import images from &apos;./images&apos;
import colors from &apos;./colors&apos;
import palette from &apos;./palette&apos;

const R = {
  strings,
  images,
  colors,
  palette
}

export default R</code></pre><p>And access it in the screen:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> R <span class="keyword">from</span> <span class="string">'res/R'</span></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;SafeAreaView style=&#123;styles.container&#125;&gt;</span><br><span class="line">      &lt;Image</span><br><span class="line">        style=&#123;styles.logo&#125;</span><br><span class="line">        source=&#123;R.images.logo&#125; /&gt;</span><br><span class="line">      &lt;Image</span><br><span class="line">        style=&#123;styles.image&#125;</span><br><span class="line">        source=&#123;R.images.placeholder&#125; /&gt;</span><br><span class="line">      &lt;Text style=&#123;styles.title&#125;&gt;&#123;R.strings.onboarding.welcome.title.toUpperCase()&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Replace strings with R.strings, colors with R.colors, and images with R.images. With the R annotation, it is clear that we are accessing static assets from the app bundle.</p>
<p>This also matches the Airbnb <a href="https://github.com/airbnb/javascript#naming--PascalCase-singleton" target="_blank" rel="noopener">convention</a> for singleton, as our R is now like a global constant.</p>
<blockquote>
<p><a href="https://github.com/airbnb/javascript#naming--PascalCase-singleton" target="_blank" rel="noopener">23.8</a> Use PascalCase when you export a constructor / class / singleton / function library / bare object.</p>
</blockquote>
<pre><code>const AirbnbStyleGuide = {
  es6: {
  },
}

export default AirbnbStyleGuide</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>In this post, I’ve shown you how I think you should structure folders and files in a React Native project. We’ve also learned how to manage resources and access them in a safer manner. I hope you’ve found it useful. Here are some more resources to explore further:</p>
<ul>
<li><a href="https://medium.com/the-react-native-log/organizing-a-react-native-project-9514dfadaa0" target="_blank" rel="noopener">Organizing a React Native Project</a></li>
<li><a href="https://hackernoon.com/structuring-projects-and-naming-components-in-react-1261b6e18d76" target="_blank" rel="noopener">Structuring projects and naming components in React</a></li>
<li><a href="https://alligator.io/react/index-js-public-interfaces/" target="_blank" rel="noopener">Using index.js for Fun and Public Interfaces</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-native/">react native</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-overlay-view-on-another-view-in-React-Native"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-overlay-view-on-another-view-in-React-Native/">How to overlay view on another view in React Native</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-overlay-view-on-another-view-in-React-Native/" class="article-date">
	  <time datetime="2019-05-22T17:14:43.000Z" itemprop="datePublished">May 22, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/254" target="_blank" rel="noopener">#254</a></strong></p>
<p>Original post <a href="https://stackoverflow.com/a/54108708/1418457" target="_blank" rel="noopener">https://stackoverflow.com/a/54108708/1418457</a></p>
<hr>
<p>Make our own convenient OverlayContainer. The trick is to use <code>absolute</code> with <code>100%</code> size</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @flow</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, StyleSheet &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">  behind: React.Component,</span><br><span class="line">  front: React.Component,</span><br><span class="line">  under: React.Component</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Show something on top of other</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">OverlayContainer</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">Props</span>&gt; </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; behind, front, under &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;View style=&#123;styles.center&#125;&gt;</span><br><span class="line">          &lt;View style=&#123;styles.behind&#125;&gt;</span><br><span class="line">            &#123;behind&#125;</span><br><span class="line">          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">          &#123;front&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>View&gt;</span><br><span class="line">        &#123;under&#125;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">  container: &#123;</span></span><br><span class="line"><span class="regexp">    flex: 1,</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    height: 100,</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  center: &#123;</span></span><br><span class="line"><span class="regexp">    width: '100%',</span></span><br><span class="line"><span class="regexp">    height: '100%',</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  behind: &#123;</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">    position: 'absolute',</span></span><br><span class="line"><span class="regexp">    left: 0,</span></span><br><span class="line"><span class="regexp">    top: 0,</span></span><br><span class="line"><span class="regexp">    width: '100%',</span></span><br><span class="line"><span class="regexp">    height: '100%'</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-native/">react native</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-remove-Cartography-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-remove-Cartography-in-iOS/">How to remove Cartography in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-remove-Cartography-in-iOS/" class="article-date">
	  <time datetime="2019-05-21T09:11:44.000Z" itemprop="datePublished">May 21, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/252" target="_blank" rel="noopener">#252</a></strong></p>
<p>Read more <a href="https://medium.com/flawless-app-stories/how-to-make-auto-layout-more-convenient-in-ios-df3b42fed37f" target="_blank" rel="noopener">https://medium.com/flawless-app-stories/how-to-make-auto-layout-more-convenient-in-ios-df3b42fed37f</a></p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>This is a script to remove Cartography, and use plain NSLayoutAnchor syntax.<br>Use Constraint.on() from Sugar.<br>It will change all .swift files recursively under provided folder.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Constraint</span>.on(</span><br><span class="line">    logoImageView.widthAnchor.constraint(equalToConstant: <span class="number">74</span>),</span><br><span class="line">    view1.leftAnchor.constraint(equalTo: view2.leftAnchor, constant: <span class="number">20</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><ul>
<li>Parse recursively</li>
<li>Parse a single file</li>
<li>Parse each constrain block separately</li>
<li>Handle ==, &gt;=, &lt;=</li>
<li>Handle center, edges</li>
<li>Infer indentation</li>
<li>Handle relation with other item</li>
<li>Handle relation with constant</li>
<li>Handle multiplier</li>
<li>Auto import Sugar</li>
<li>Infer superView</li>
</ul>
<h2 id="Prepare"><a href="#Prepare" class="headerlink" title="Prepare"></a>Prepare</h2><p>Install tool if needed</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install yarn</span><br></pre></td></tr></table></figure>

<p>How to use</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br><span class="line">yarn start /Users/khoa/path/to/project</span><br></pre></td></tr></table></figure>

<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> Glob = <span class="built_in">require</span>(<span class="string">'glob'</span>)</span><br><span class="line"><span class="keyword">const</span> Fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> projectPath = getProjectPath()</span><br><span class="line">  <span class="keyword">const</span> files = getAllFiles(projectPath)</span><br><span class="line"></span><br><span class="line">  files.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">    handleFile(file)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// The 1st argument is node, 2nd is index.js, 3rd is path</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProjectPath</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> process.argv[<span class="number">2</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Only select `swift` file</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAllFiles</span>(<span class="params">projectPath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (projectPath.endsWith(<span class="string">'.swift'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> [projectPath]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> files = Glob.sync(<span class="string">`<span class="subst">$&#123;projectPath&#125;</span>/**/*.swift`</span>)</span><br><span class="line">    <span class="keyword">return</span> files</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Read file, replace by matches, and write again</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleFile</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(file)</span><br><span class="line"></span><br><span class="line">  Fs.readFile(file, <span class="string">'utf8'</span>, (error, data) =&gt; &#123;</span><br><span class="line">    <span class="comment">// non greedy `*?`</span></span><br><span class="line">    <span class="keyword">const</span> pattern = <span class="string">'(.)*constrain\\(.+\\) &#123;\\s(\\s|.)*?\\n(\\s)*&#125;'</span></span><br><span class="line">    <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> matches = data.match(regex)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RegEx only return the 1st match per execution, let's do a recursion</span></span><br><span class="line">    <span class="keyword">while</span> (matches != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> match = matches[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> indentationLength = findIndentationLength(match)</span><br><span class="line">      <span class="keyword">const</span> rawTransforms = handleMatch(match)</span><br><span class="line">      <span class="keyword">const</span> transforms = handleSuperview(rawTransforms, match)</span><br><span class="line">      <span class="keyword">const</span> statements = handleTransforms(transforms, indentationLength)</span><br><span class="line">      <span class="keyword">const</span> string = handleStatements(statements, indentationLength)</span><br><span class="line">      data = data.replace(match, string)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Examine again</span></span><br><span class="line">      matches = data.match(regex)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle import</span></span><br><span class="line">    data = handleImport(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Fs.writeFile(file, data, <span class="string">'utf8'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Replace or remove import</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleImport</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (data.includes(<span class="string">'import Sugar'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">'import Cartography'</span>, <span class="string">''</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">'import Cartography'</span>, <span class="string">'import Sugar'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Format transform to have `,` and linebreaks</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleTransforms</span>(<span class="params">transforms, indentationLength</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> string = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Expect the first is always line break</span></span><br><span class="line">  <span class="keyword">if</span> (transforms[<span class="number">0</span>] != <span class="string">'\n'</span>) &#123;</span><br><span class="line">    transforms.unshift(<span class="string">'\n'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> indentation = makeIndentation(indentationLength + <span class="number">2</span>)</span><br><span class="line">  </span><br><span class="line">  transforms.forEach(<span class="function">(<span class="params">line, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (line.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">      string = string.concat(indentation + line)</span><br><span class="line">      <span class="keyword">if</span> (index &lt; transforms.length - <span class="number">1</span>) &#123;</span><br><span class="line">        string = string.concat(<span class="string">',\n'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      string = string.concat(<span class="string">'\n'</span>)</span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Replace superView</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleSuperview</span>(<span class="params">transforms, match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> superView = findSuperview(match)</span><br><span class="line">  <span class="keyword">if</span> (superView == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> transforms</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> superViewPattern = <span class="string">' superView.'</span></span><br><span class="line">  transforms = transforms.map(<span class="function">(<span class="params">transform</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (transform.includes(superViewPattern)) &#123;</span><br><span class="line">      <span class="keyword">return</span> transform.replace(superViewPattern, <span class="string">` <span class="subst">$&#123;superView&#125;</span>.`</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> transform</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> transforms</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Embed the statements inside `Constraint.on`</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleStatements</span>(<span class="params">statements, indentationLength</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> indentation = makeIndentation(indentationLength)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;indentation&#125;</span>Constraint.on(<span class="subst">$&#123;statements&#125;</span>\n<span class="subst">$&#123;indentation&#125;</span>)`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Turn every line into flatten transformed line</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleMatch</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> lines = match.split(<span class="string">'\n'</span>)</span><br><span class="line">  lines = lines.map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> handleLine(line.trim())</span><br><span class="line">  &#125;).filter(<span class="function">(<span class="params">transforms</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> transforms != <span class="literal">null</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> flatten = [].concat.apply([], lines)</span><br><span class="line">  <span class="keyword">return</span> flatten</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Check to handle lines, turn them into `LayoutAnchor` statements</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleLine</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> itemPattern = <span class="string">'\\w*\\.\\w* (=|&lt;|&gt;)= \\w*\\.*\\..*'</span></span><br><span class="line">  <span class="keyword">const</span> sizePattern = <span class="string">'\w*\.\w* (=|&lt;|&gt;)= (\s|.)*'</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'edges == '</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleEdges(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'center == '</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleCenter(line) </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPattern(line, itemPattern) &amp;&amp; !hasSizeKeywords(line)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleItem(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPattern(line, sizePattern)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleSize(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&gt;='</span>) || line.includes(<span class="string">'&gt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'.'</span>)) &#123;</span><br><span class="line">    <span class="comment">// return the line itself to let the human fix</span></span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'\n'</span>]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: listView.bottom == listView.superview!.bottom - 43</span></span><br><span class="line"><span class="comment">/// listView.bottom == listView.superview!.bottom - Metrics.BackButtonWidth</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleItem</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> equalSign = getEqualSign(line)</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">` <span class="subst">$&#123;equalSign&#125;</span> `</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> rightParts = parts[<span class="number">1</span>].trim()</span><br><span class="line">  <span class="keyword">let</span> right = rightParts.split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">let</span> number = rightParts.replace(right, <span class="string">''</span>).replace(<span class="string">'- '</span>, <span class="string">'-'</span>).trim()</span><br><span class="line">  <span class="keyword">if</span> (number.startsWith(<span class="string">'+ '</span>)) &#123;</span><br><span class="line">    number = number.slice(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> equal = getEqual(line)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (number == <span class="literal">null</span> || number.length == <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>: <span class="subst">$&#123;right&#125;</span>Anchor)`</span></span><br><span class="line">    ]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>: <span class="subst">$&#123;right&#125;</span>Anchor, constant: <span class="subst">$&#123;number&#125;</span>)`</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: segmentedControl.height == 24</span></span><br><span class="line"><span class="comment">/// backButton.width == Metrics.BackButtonWidth</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleSize</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> equalSign = getEqualSign(line)</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">` <span class="subst">$&#123;equalSign&#125;</span> `</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = parts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> equal = getEqual(line)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>Constant: <span class="subst">$&#123;right&#125;</span>)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: mapView.edges == listView.edges</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleEdges</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">' == '</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = removeLastPart(parts[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.topAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.topAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.bottomAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.bottomAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.leftAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.leftAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.rightAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.rightAnchor)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: mapView.center == listView.center</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleCenter</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">' == '</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = removeLastPart(parts[<span class="number">1</span>])</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.centerXAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.centerXAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.centerYAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.centerYAnchor)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPattern</span>(<span class="params">string, pattern</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">  <span class="keyword">let</span> matches = string.match(regex)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (matches == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  matches = matches.filter(<span class="function">(<span class="params">match</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> match !== <span class="literal">undefined</span> &amp;&amp; match.length &gt; <span class="number">1</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> matches.length &gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeLastPart</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = string.split(<span class="string">'.'</span>)</span><br><span class="line">  parts.pop()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> parts.join(<span class="string">'.'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEqual</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'=='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'equalTo'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&lt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'lessThanOrEqualTo'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'greaterThanOrEqualTo'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEqualSign</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'=='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'=='</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&gt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&gt;='</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&lt;='</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findIndentationLength</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> match.split(<span class="string">'constrain'</span>)[<span class="number">0</span>].length + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeIndentation</span>(<span class="params">length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>(length).join(<span class="string">' '</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// For ex: constrain(tableView, headerView, view) &#123; tableView, headerView, superView in</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findSuperview</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> line = match.split(<span class="string">'\n'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">if</span> (!line.includes(<span class="string">' superView in'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pattern = <span class="string">', \\w*\\)'</span></span><br><span class="line">  <span class="keyword">const</span> regex = <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">  <span class="keyword">const</span> string =  line.match(regex)[<span class="number">0</span>] <span class="comment">// `, view)</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string.replace(<span class="string">', '</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check special size keywords</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasSizeKeywords</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> keywords = [<span class="string">'Metrics'</span>, <span class="string">'Dimensions'</span>, <span class="string">'UIScreen'</span>]</span><br><span class="line">  <span class="keyword">return</span> keywords.filter(<span class="function">(<span class="params">keyword</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> line.includes(keyword)</span><br><span class="line">  &#125;).length != <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node/">node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/script/">script</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-sort-strings-with-number-in-Javascript"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-sort-strings-with-number-in-Javascript/">How to sort strings with number in Javascript</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-sort-strings-with-number-in-Javascript/" class="article-date">
	  <time datetime="2019-05-21T09:08:50.000Z" itemprop="datePublished">May 21, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/251" target="_blank" rel="noopener">#251</a></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> string = </span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string">- Favorite WWDC 2017 sessions https://github.com/onmyway133/blog/issues/56</span></span><br><span class="line"><span class="string">- Favorite WWDC 2018 sessions https://github.com/onmyway133/blog/issues/245</span></span><br><span class="line"><span class="string">- How to do clustering with Google Maps in iOS https://github.com/onmyway133/blog/issues/191</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> lines = string</span><br><span class="line">        .split(<span class="string">'\n'</span>)</span><br><span class="line">        .filter(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123; <span class="keyword">return</span> line.length &gt; <span class="number">0</span> &#125;)</span><br><span class="line">        .map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> parts = line.trimEnd().split(<span class="string">' '</span>)</span><br><span class="line">            <span class="keyword">let</span> lastPart = parts[parts.length<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">let</span> number = lastPart.replace(<span class="string">'https://github.com/onmyway133/blog/issues/'</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                line,</span><br><span class="line">                number: <span class="built_in">parseInt</span>(number)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    lines.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (a.number &lt; b.number) ? <span class="number">-1</span> : <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> sortedString = lines</span><br><span class="line">        .map(<span class="function">(<span class="params">tuple</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> tuple.line</span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(sortedString)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then <code>node index.js</code></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-move-tab-bar-icons-down-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-move-tab-bar-icons-down-in-iOS/">How to move tab bar icons down in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-move-tab-bar-icons-down-in-iOS/" class="article-date">
	  <time datetime="2019-05-21T08:08:34.000Z" itemprop="datePublished">May 21, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/250" target="_blank" rel="noopener">#250</a></strong></p>
<p><code>UITabBarItem</code> subclasses from <code>UIBarItem</code> which has <code>imageInsets</code>. We need both <code>top</code> and <code>bottom</code> to avoid shrinking</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewController1.tabBarItem.imageInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">10</span>, <span class="keyword">left</span>: <span class="number">0</span>, bottom: -<span class="number">10</span>, <span class="keyword">right</span>: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-test-LaunchScreen-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-test-LaunchScreen-in-iOS/">How to test LaunchScreen in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-test-LaunchScreen-in-iOS/" class="article-date">
	  <time datetime="2019-05-21T06:48:44.000Z" itemprop="datePublished">May 21, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/249" target="_blank" rel="noopener">#249</a></strong></p>
<p>Making splash screen with <code>LaunchScreen.storyboard</code> is now the default way to do in iOS. Testing it with UITests is a bit tricky as this screen is showed the system, and if we test that, we are just testing the system.</p>
<p>What we should test is the content we put in the LaunchScreen storyboard. Is it showing correctly on different screen sizes? Is it missing any texts or images?</p>
<p>One way to test that is via Unit Test. LaunchScreen storyboard always come with 1 <code>UIViewController</code> configured as an initial view controller</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LauncScreenTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testLaunchScreen</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> launchScreen = <span class="type">UIStoryboard</span>(name: <span class="string">"LaunchScreen"</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">let</span> viewController = launchScreen.instantiateInitialViewController()!</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> label = viewController.view.subviews.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UILabel</span> &#125;).first!</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(label.text, <span class="string">"Welcome to my app"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> imageView = viewController.view.subviews.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UIImageView</span> &#125;).first!</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(imageView.image)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/testing/">testing</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-remote-theme-for-GitHub-Pages"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-remote-theme-for-GitHub-Pages/">How to use remote theme for GitHub Pages</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-remote-theme-for-GitHub-Pages/" class="article-date">
	  <time datetime="2019-05-21T05:40:26.000Z" itemprop="datePublished">May 21, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/248" target="_blank" rel="noopener">#248</a></strong></p>
<p>Visit <a href="https://github.com/onmyway133/onmyway133.github.io" target="_blank" rel="noopener">https://github.com/onmyway133/onmyway133.github.io</a></p>
<hr>
<p><a href="https://github.blog/2017-11-29-use-any-theme-with-github-pages/" target="_blank" rel="noopener">https://github.blog/2017-11-29-use-any-theme-with-github-pages/</a></p>
<blockquote>
<p>Starting today, you can use any of the hundreds of community-curated themes on GitHub.com. To build your site with any public, GitHub-hosted theme, add the following to your site’s _config.yml file:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">remote_theme: owner/name</span><br></pre></td></tr></table></figure>

<p>Browse themes <a href="https://github.com/topics/jekyll-theme" target="_blank" rel="noopener">https://github.com/topics/jekyll-theme</a><br>Example config file with navigation <a href="https://github.com/daviddarnes/alembic/blob/master/_config.yml" target="_blank" rel="noopener">https://github.com/daviddarnes/alembic/blob/master/_config.yml</a></p>
<h2 id="Link-to-a-new-page"><a href="#Link-to-a-new-page" class="headerlink" title="Link to a new page"></a>Link to a new page</h2><p>Each page must have a description. Link must point to generated html file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apps: /apps.html</span><br></pre></td></tr></table></figure>

<p>Do not specify <code>layout: default</code> to keep overall theme</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Another Page</span><br><span class="line">description:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-enable-black-mode-in-Google-Maps-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-enable-black-mode-in-Google-Maps-in-iOS/">How to enable black mode in Google Maps in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-enable-black-mode-in-Google-Maps-in-iOS/" class="article-date">
	  <time datetime="2019-05-20T08:13:11.000Z" itemprop="datePublished">May 20, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/246" target="_blank" rel="noopener">#246</a></strong></p>
<p>Use GMSMapStyle <a href="https://developers.google.com/maps/documentation/android-sdk/styling" target="_blank" rel="noopener">https://developers.google.com/maps/documentation/android-sdk/styling</a><br>Export styling json from <a href="https://mapstyle.withgoogle.com/" target="_blank" rel="noopener">https://mapstyle.withgoogle.com/</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mapStyleUrl = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"mapStyle"</span>, withExtension: <span class="string">"json"</span>)!</span><br><span class="line">mapView.mapStyle = <span class="keyword">try</span>? <span class="type">GMSMapStyle</span>(contentsOfFileURL: mapStyleUrl)</span><br></pre></td></tr></table></figure>

<p>To change overall color, search for mostly <code>&quot;elementType&quot;: &quot;geometry&quot;</code> and <code>&quot;featureType&quot;: &quot;water&quot;</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"elementType"</span>: <span class="string">"geometry"</span>,</span><br><span class="line">    <span class="attr">"stylers"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"color"</span>: <span class="string">"#424242"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"featureType"</span>: <span class="string">"water"</span>,</span><br><span class="line">    <span class="attr">"elementType"</span>: <span class="string">"geometry"</span>,</span><br><span class="line">    <span class="attr">"stylers"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"color"</span>: <span class="string">"#2E2E2E"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/google/">google</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maps/">maps</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Favorite-WWDC-2018-sessions"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Favorite-WWDC-2018-sessions/">Favorite WWDC 2018 sessions</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Favorite-WWDC-2018-sessions/" class="article-date">
	  <time datetime="2019-05-19T16:33:17.000Z" itemprop="datePublished">May 19, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/245" target="_blank" rel="noopener">#245</a></strong></p>
<p>Original post <a href="https://medium.com/fantageek/my-favourite-wwdc-2018-sessions-363d3fc9c9d5" target="_blank" rel="noopener">https://medium.com/fantageek/my-favourite-wwdc-2018-sessions-363d3fc9c9d5</a></p>
<hr>
<h1 id="Favourite-WWDC-2018-sessions"><a href="#Favourite-WWDC-2018-sessions" class="headerlink" title="Favourite WWDC 2018 sessions"></a>Favourite WWDC 2018 sessions</h1><p>This year I failed the lottery ticket to WWDC, and I also missed the keynote live stream because I was <a href="https://twitter.com/onmyway133/status/1003584883116167169" target="_blank" rel="noopener">sailing</a> on the Christian Radich outside Oslo fjord that day. Luckily all the videos are available on <a href="https://developer.apple.com/videos/wwdc2018/" target="_blank" rel="noopener">Apple Developer site</a> very shortly, and we can watch them now on Chrome or the <a href="https://github.com/insidegui/WWDC" target="_blank" rel="noopener">unofficial WWDC</a> app on macOS. I recommend the <a href="https://github.com/insidegui/WWDC" target="_blank" rel="noopener">WWDC</a> macOS app as it allows to mark favourites and filter, also offers the ability to adjust play speed to 1.25 or 1.5 saves me some time watching.</p>
<p>This year WWDC focuses a lot on privacy, stability, and speed, which are all I wish, so many thanks to Apple engineers who made that happen, and the resit to install the so called <a href="https://twitter.com/bagelturf/status/1004444007424905216?s=21" target="_blank" rel="noopener">more stable iOS 12</a> is real. As an iOS engineers, I like to focus more about the necessary things to me, that is about the Swift programming language, new changes in Cocoa Touch, enhancements in Xcode and testing tricks. I also like to explore more <a href="https://medium.com/flawless-app-stories/detecting-avengers-superheroes-in-your-ios-app-with-ibm-watson-and-coreml-fe38e493a4d1" target="_blank" rel="noopener">about</a> <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-turi-create-and-coreml-5ddce0dc8e26" target="_blank" rel="noopener">machine</a> <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-azure-custom-vision-and-coreml-645e93f35eee" target="_blank" rel="noopener">learning</a> so I’m very glad that Apple is investing more into this technology with the introduction of Turi Create and Create ML.</p>
<p>To me, APIs come and get deprecated very often and it’s good to know them, but the most important thing is to invest in your programming, debugging and testing skill which you can apply in many other platforms.</p>
<p>Continued from last year <a href="https://medium.com/@onmyway133/my-favourite-wwdc-2017-sessions-a777fa5aabaf" target="_blank" rel="noopener">favourites</a> list, below are my favourite sessions with personal notes. Things are listed in no particular order. Hope you find it useful.</p>
<h3 id="Platforms-State-of-the-Union"><a href="#Platforms-State-of-the-Union" class="headerlink" title="Platforms State of the Union"></a><a href="https://developer.apple.com/videos/play/wwdc2018/102/" target="_blank" rel="noopener">Platforms State of the Union</a></h3><p>If you don’t have time, you should watch only this session. Platform State of the Union is like keynote for developers as it highlights important changes.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*5zkWPlmZ9oYfY9-O.jpg" alt></p>
<ul>
<li><p>Privacy: Apple confirms on its commitment in privacy and security, also introduces password management feature and auto fill on iOS 12. Generating strong password, integrating with 3rd password management and quickly populating OTP field from SMS message have never been easier. <a href="https://support.apple.com/en-us/HT202491" target="_blank" rel="noopener">GateKeeper</a> gets some improvements as well and begins to require app to be notarised.</p>
</li>
<li><p>iOS 12: huge improvement in performance, Siri gets smarter with Shortcut support, group calling in FaceTime and grouped notification. Also for emoji fan, Memoji was introduced.</p>
</li>
<li><p>macOS 10.14 Mojave: more with Dark Mode. They demo mostly with Xcode in dark mode, which looks so cool. This year WWDC banner give hints about iOS and macOS cross-platform apps, which is partially true with <a href="https://www.imore.com/marzipan" target="_blank" rel="noopener">Marzipan</a>, a way to allow iOS apps to run on the mac.</p>
</li>
<li><p>Xcode 10: with improvements in code editing and source control changes bar indicator. Debugging with memory debug tool, LLDB performance enhancement and particular the new build system completely rewritten in Swift with parallel tasks are exciting news.</p>
</li>
<li><p>Swift 4.2: if you follow swift repo then <a href="https://github.com/ole/whats-new-in-swift-4-2" target="_blank" rel="noopener">Swift 4.2</a> may not be very surprising. There are also announcements for Swift 5 plan.</p>
</li>
<li><p>Machine Learning: is never hotter than this. This year we see huge investments in machine learning with Create ML, Turi Create, Natural Language frameworks, CoreML 2, new detection capabilities in Vision.</p>
</li>
<li><p>ARKit 2, watchOS 5, tvOS 12, AppStore Connect and AppStore Connect APIs are some other important news you don’t want to miss.</p>
</li>
</ul>
<h3 id="What’s-new-in-Swift"><a href="#What’s-new-in-Swift" class="headerlink" title="What’s new in Swift"></a><a href="https://developer.apple.com/videos/play/wwdc2018/401/" target="_blank" rel="noopener">What’s new in Swift</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*JQCScM5dRcK9dX-_.jpg" alt></p>
<p>Together with this session, I recommend you to read <a href="https://www.hackingwithswift.com/articles/77/whats-new-in-swift-4-2" target="_blank" rel="noopener">What’s new in Swift 4.2</a> summary which is very succinct. Besides improvement in complication and runtime, Swift 4.2 offers some new features: iterable enum case, synthesised Equatable and Hashable, handy functions for shuffling, random generating. To me, the need to explicitly handle Implicitly unwrapped optional is also a reasonable change.</p>
<h3 id="What’s-New-in-Cocoa-Touch"><a href="#What’s-New-in-Cocoa-Touch" class="headerlink" title="What’s New in Cocoa Touch"></a><a href="https://developer.apple.com/videos/play/wwdc2018/202/" target="_blank" rel="noopener">What’s New in Cocoa Touch</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*n1X4HddAZ-4ZHpaf.jpg" alt></p>
<p>This is a brief introduction to all changes coming to iOS 12, together with tips on how to be a good iOS citizen. Learn what can affect scrolling experience and prefetching technique, memory consumption and automatic backing stores, how to get the best from UIImage and UIImageView . <a href="https://developer.apple.com/videos/play/wwdc2018/220/" target="_blank" rel="noopener">AutoLayout</a> engine got a lot of performance improvement so it won’t bother you any more. To me the most satisfying is to get all the UIKit notifications and classes reorganised under nested types, which makes code reasoning very easy.</p>
<h3 id="Getting-the-Most-out-of-Playgrounds-in-Xcode"><a href="#Getting-the-Most-out-of-Playgrounds-in-Xcode" class="headerlink" title="Getting the Most out of Playgrounds in Xcode"></a><a href="https://developer.apple.com/videos/play/wwdc2018/402/" target="_blank" rel="noopener">Getting the Most out of Playgrounds in Xcode</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*cl4xdnHojOq-PNBc.jpg" alt></p>
<p>I’ve <a href="https://medium.com/flawless-app-stories/playground-driven-development-in-swift-cf167489fe7b" target="_blank" rel="noopener">written about Playground</a> before and I’m very glad that Apple also invests a lot in it. The way people can interact and train model [Create ML](<a href="http://Introducing" target="_blank" rel="noopener">http://Introducing</a> Create ML) in Playground is mesmerising. People may question how Playground works so well in session’s demos, but we can’t resist the new changes coming to Playground like Step by Step execution, markup rendering improvements and also how easy it is to consume custom frameworks. We can also now publish our own <a href="https://developer.apple.com/videos/play/wwdc2018/413/" target="_blank" rel="noopener">Playground through subscription</a>.</p>
<h3 id="What’s-New-in-Core-ML"><a href="#What’s-New-in-Core-ML" class="headerlink" title="What’s New in Core ML"></a><a href="https://developer.apple.com/videos/play/wwdc2018/708/" target="_blank" rel="noopener">What’s New in Core ML</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*1-xUL2gFr-Ys8WQT.jpg" alt></p>
<p>Apple starts the machine learning trend last year with the introduction of Core ML. We might be excited and frustrated at the same time as Core ML is powerful but there’s no way we can customise it. Now the <a href="https://developer.apple.com/videos/play/wwdc2018/708/" target="_blank" rel="noopener">2</a> <a href="https://developer.apple.com/videos/play/wwdc2018/709/" target="_blank" rel="noopener">parts</a> tell us how to implement custom layer and model, techniques to reduce model size like quantisation and flexible model. This makes the foundation for improvement in <a href="https://developer.apple.com/videos/play/wwdc2018/717/" target="_blank" rel="noopener">Vision</a> in object tracking and the debut of <a href="https://developer.apple.com/videos/play/wwdc2018/713/" target="_blank" rel="noopener">Natural Language</a> framework. Machine learning has never been easier.</p>
<h3 id="What’s-New-in-Testing"><a href="#What’s-New-in-Testing" class="headerlink" title="What’s New in Testing"></a><a href="https://developer.apple.com/videos/play/wwdc2018/403/" target="_blank" rel="noopener">What’s New in Testing</a></h3><p>I can’t miss any testing sessions as it is part of every day’s work. How can your program avoids regression bugs and ready for refactoring without any tests?</p>
<p>This session shows improvement in coverage and the introduction of xccov tool to help us build automation on top of coverage report. Parallel distributed testing in Xcode 10 can save us some time to have coffee. Another wonderful news is that tests have multiple order execution mode to avoid bugs due to implicit dependencies.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*7Gw1utFOl4C3PKqV.jpg" alt></p>
<h3 id="Testing-Tips-amp-Tricks-🌟"><a href="#Testing-Tips-amp-Tricks-🌟" class="headerlink" title="Testing Tips &amp; Tricks 🌟"></a><a href="https://developer.apple.com/videos/play/wwdc2018/417/" target="_blank" rel="noopener">Testing Tips &amp; Tricks</a> 🌟</h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*OHjJdWEhHj7Fc4rq.jpg" alt></p>
<p>This is my most favourite. The session starts with a pyramid of tests with unit integration and end-to-end test analogy explanation, then to some very cool tips and tricks.</p>
<ul>
<li>Testing network request: I like the separation of APIRequest and APIRequestLoader with URLSession , dependency injection with default parameter and the customisation of URLProtocol in URLSessionConfiguration</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2066/1*xJzqnw37CZKFhhMwym2HHQ.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2684/1*VUxjS-DpOfee7d5zTA1vrg.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2326/1*rgRwQla_YK3ADRwxZ4xpkg.png" alt></p>
<ul>
<li>Testing notification: Notification is system wide and I try to avoid it as much as possible. This shows how to inject dependency with default parameter and use of own NotificationCenter instead of NotificationCenter.default to ease testing</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2602/1*mXiNRzit8VcFM4_GNM3ebg.png" alt></p>
<ul>
<li><p>Testing location: build abstraction with LocationProvider and LocationFetcher . How to use custom protocol and protocol for delegate to mock during test</p>
</li>
<li><p>Testing timer: how to use and mock RunLoop behaviour with Timer</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*obf6GcsXcHAbGFy-lUENNw.png" alt></p>
<h3 id="Advanced-Debugging-with-Xcode-and-LLDB"><a href="#Advanced-Debugging-with-Xcode-and-LLDB" class="headerlink" title="Advanced Debugging with Xcode and LLDB"></a><a href="https://developer.apple.com/videos/play/wwdc2018/412/" target="_blank" rel="noopener">Advanced Debugging with Xcode and LLDB</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*6c81NEXU7tKYPEbQ.jpg" alt></p>
<p>LLDB has been improved to enable to debugging reliability experience, issues with AST context corruption, Swift type resolution are now things in the past. We can review how to use some common LLDB commands with handy arguments, and how to use Xcode breakpoint to its best.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ZtVpOaDnmt4VsDTHRiB6Ww.png" alt></p>
<h3 id="A-Tour-of-UICollectionView-🌟"><a href="#A-Tour-of-UICollectionView-🌟" class="headerlink" title="A Tour of UICollectionView 🌟"></a><a href="https://developer.apple.com/videos/play/wwdc2018/225/" target="_blank" rel="noopener">A Tour of UICollectionView</a> 🌟</h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*skJgSTHlTohIj_DT.jpg" alt></p>
<p>I begin to use UICollectionView more than UITableView , and it also has same code as NSCollectionView,which is more comfortable solution than the horrible NSTableView .</p>
<ul>
<li>Item size in UICollectionViewLayout : I often rely on UICollectionViewDelegateFlowLayout to specify item size but after watching this session, I feel like moving size related code to Layout object feels more like a good way to go</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2718/1*FS6OykJZ_zIPTzaWPPYk6g.png" alt></p>
<ul>
<li><p>Mosaic layout: This is not new, but good to watch again. You learn how to implement custom layout using cached layout attributes</p>
</li>
<li><p>Data Source update: I didn’t expect Apple mentions this, but it is a good lesson on how UICollectionView handles batch update. I ‘ve written about this before in my <a href="https://medium.com/flawless-app-stories/a-better-way-to-update-uicollectionview-data-in-swift-with-diff-framework-924db158db86" target="_blank" rel="noopener">A better way to update UICollectionView data in Swift with diff framework</a> and that post gets a lot of attractions. In this session we need to remember that *<em>ordering matters in data source update, but not in collection view update *</em>❗️❗️❗️</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*VMqhNo3bXxI-79e-r9iNvA.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*KiWef6geZ3z0-jRaWNuqRg.png" alt></p>
<h3 id="Swift-Generics"><a href="#Swift-Generics" class="headerlink" title="Swift Generics"></a><a href="https://developer.apple.com/videos/play/wwdc2018/406/" target="_blank" rel="noopener">Swift Generics</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*KWRTeiOV8FBNK3Mu.jpg" alt></p>
<p>Generic was a core feature of Swift since the beginning, we all know that it helps us to implement generic code that can work with many types in a type safe manner. This session reminds that I ‘ve never learned enough, especially the reasonable design behind it.</p>
<p>The sessions showcases Collection protocol and its protocol inheritances: MutableCollection , BidirectionalCollection , RandomAccessCollection and how they can be combined to provide generic functionalities for conformers. The associatedtype requirement in each protocol, especially Index and Element, is very minimal and has enough constraints for the protocol to implement lots of necessary functionalities in its protocol extension, which is eye opening for me. I very like to read open source, so looking at the <a href="https://github.com/apple/swift/blob/master/stdlib/public/core/BidirectionalCollection.swift" target="_blank" rel="noopener">source code</a> for such protocols helps me understand more.</p>
<p><img src="https://cdn-images-1.medium.com/max/2102/1*QIepiAZqK4QmX2IbLFKz0w.png" alt></p>
<p>The part about <a href="https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle" target="_blank" rel="noopener">Fisher Yates shuffle algorithm</a> details how we can come up with necessary protocol while still make them generic</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*actyrEg4E4qSFYu--K6uzA.png" alt></p>
<p>Pay attention to when they mention count and map , you can learn more how each concrete type can hook into the customisation point in protocol extension</p>
<p><img src="https://cdn-images-1.medium.com/max/2704/1*IG15tCSq49SqgvgJrXHDWw.png" alt></p>
<p>Finally learn the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle" target="_blank" rel="noopener">Liskov substitution principle</a> with protocol in class inheritance. You should also <a href="https://developer.apple.com/videos/play/wwdc2018/229/" target="_blank" rel="noopener">Using Collections Effectively</a> for how to utilise handy functions in Collection.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*oIKcsw6-H37i2A1t.jpg" alt></p>
<h3 id="Data-You-Can-Trust"><a href="#Data-You-Can-Trust" class="headerlink" title="Data You Can Trust"></a><a href="https://developer.apple.com/videos/play/wwdc2018/222/" target="_blank" rel="noopener">Data You Can Trust</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*Iv80a99O1g6k-oO4.jpg" alt></p>
<p>Although Codable has a lot to offers in term of data integrity, this is good to know about to make sure the data you receive is actually the right data in correct format and structure. <a href="https://twitter.com/mgratzer/status/1003882651038683136" target="_blank" rel="noopener">CommonCrypto</a> is also part of new iOS SDK so you don’t need my <a href="https://github.com/onmyway133/Arcane" target="_blank" rel="noopener">Arcane</a> library to handle encryption and hashing in your apps.</p>
<h3 id="Embracing-Algorithms"><a href="#Embracing-Algorithms" class="headerlink" title="Embracing Algorithms"></a><a href="https://developer.apple.com/videos/play/wwdc2018/223/" target="_blank" rel="noopener">Embracing Algorithms</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*qocdXtZ8cCAJ0mKV.jpg" alt></p>
<p>This is the most pleasant to watch as it is like a conversation between the speaker and the imaginary manager Crusty. Here I learn how to be aware of algorithm complexity and also how to utilise built in Foundation functions which are already optimised for performance.</p>
<p>After this session I can’t help myself but going to Swift repo to read the <a href="https://github.com/apple/swift/blob/master/test/Prototypes/Algorithms.swift" target="_blank" rel="noopener">Algorithms.swift</a> file immediately.</p>
<h3 id="Image-and-Graphics-Best-Practices"><a href="#Image-and-Graphics-Best-Practices" class="headerlink" title="Image and Graphics Best Practices"></a><a href="https://developer.apple.com/videos/play/wwdc2018/219/" target="_blank" rel="noopener">Image and Graphics Best Practices</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*-qDMSLxL89PuOm-m.jpg" alt></p>
<p>Learn how image encoding and decoding works through data and image buffer and how that affects memory and performance. There are techniques like downsampling that can tackle this problem. This also recommends against using backing store, and instead, use UIImageView</p>
<p><img src="https://cdn-images-1.medium.com/max/2766/1*mt70wBlbwC9Kz18vXN5THQ.png" alt></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*uV9Ata-pPnb-US3WrI6Y_A.png" alt></p>
<h3 id="A-Guide-to-Turi-Create"><a href="#A-Guide-to-Turi-Create" class="headerlink" title="A Guide to Turi Create"></a><a href="https://developer.apple.com/videos/play/wwdc2018/712/" target="_blank" rel="noopener">A Guide to Turi Create</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*yWr3HKYpIslcV-Zz.jpg" alt></p>
<p>I’ve <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-turi-create-and-coreml-5ddce0dc8e26" target="_blank" rel="noopener">written about Turi Create</a> before, but it is just scratching the surface of the many tasks offered by Turi. This year Apple releases <a href="https://github.com/apple/turicreate/releases/tag/5.0b1" target="_blank" rel="noopener">Turi Create 5</a> with style transfer task, Vision Feature Print, GPU acceleration and recommender model improvements. I can’t wait to explore. And if you take a look at MLDataTable in Create ML framework, it looks like this has Turi ‘s SFrame under the hood.</p>
<p>That’s it. Thanks for reading. What are your favourite sessions this year? Please share in the comment section below</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-get-running-window-informations-in-macOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-get-running-window-informations-in-macOS/">How to get running window informations in macOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-get-running-window-informations-in-macOS/" class="article-date">
	  <time datetime="2019-05-16T11:03:35.000Z" itemprop="datePublished">May 16, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/243" target="_blank" rel="noopener">#243</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/coregraphics/1455137-cgwindowlistcopywindowinfo" target="_blank" rel="noopener">https://developer.apple.com/documentation/coregraphics/1455137-cgwindowlistcopywindowinfo</a></p>
<blockquote>
<p>Generates and returns information about the selected windows in the current user session.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyWindowInfo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> frame: <span class="type">CGRect</span></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> pid: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> number: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>?(json: [<span class="type">String</span>: <span class="type">Any</span>]) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> pid = json[<span class="string">"kCGWindowOwnerPID"</span>] <span class="keyword">as</span>? <span class="type">Int</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> name = json[<span class="string">"kCGWindowOwnerName"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> rect = json[<span class="string">"kCGWindowBounds"</span>] <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> x = rect[<span class="string">"X"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> y = rect[<span class="string">"Y"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> height = rect[<span class="string">"Height"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> width = rect[<span class="string">"Width"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> number = json[<span class="string">"kCGWindowNumber"</span>] <span class="keyword">as</span>? <span class="type">Int</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.pid = pid</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">self</span>.number = number</span><br><span class="line">        <span class="keyword">self</span>.frame = <span class="type">CGRect</span>(x: x, y: y, width: width, height: height)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> jsons = <span class="type">CGWindowListCopyWindowInfo</span>(.optionAll, kCGNullWindowID) <span class="keyword">as</span>? [[<span class="type">String</span>: <span class="type">Any</span>]] <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> infos = jsons.compactMap(&#123; <span class="type">MyWindowInfo</span>(json: $<span class="number">0</span>) &#125;)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-show-full-screen-window-programmatically-in-macOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-show-full-screen-window-programmatically-in-macOS/">How to show full screen window programmatically in macOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-show-full-screen-window-programmatically-in-macOS/" class="article-date">
	  <time datetime="2019-05-16T10:20:45.000Z" itemprop="datePublished">May 16, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/242" target="_blank" rel="noopener">#242</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> window = <span class="type">NSWindow</span>(contentRect: mainScreen.frame, styleMask: .borderless, backing: .buffered, <span class="keyword">defer</span>: <span class="literal">false</span>)</span><br><span class="line">window.level = .floating</span><br><span class="line">window.contentView = <span class="type">NSView</span>()</span><br><span class="line">window.makeKeyAndOrderFront(<span class="type">NSApp</span>)</span><br><span class="line"><span class="type">NSApp</span>.activate(ignoringOtherApps: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<p>and then later hide it</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.orderOut(<span class="type">NSApp</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-Useful-git-commands-for-everyday-use!"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/Useful-git-commands-for-everyday-use!/">Useful git commands for everyday use!</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/Useful-git-commands-for-everyday-use!/" class="article-date">
	  <time datetime="2019-05-15T17:55:29.000Z" itemprop="datePublished">May 15, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/239" target="_blank" rel="noopener">#239</a></strong></p>
<p>Original post <a href="https://medium.com/flawless-app-stories/useful-git-commands-for-everyday-use-e1a4de64037d" target="_blank" rel="noopener">https://medium.com/flawless-app-stories/useful-git-commands-for-everyday-use-e1a4de64037d</a></p>
<hr>
<p>Do you know that questions about <a href="https://stackoverflow.com/tags/git" target="_blank" rel="noopener">git</a> get the most views on StackOverflow? I’ve searched a lot on Google how to execute certain actions with git, and this actually slowed me down a lot. There are some actions that we tend to use a lot, so it’s good to learn them. Here are my favorites, learning from friends and internet, hope you find them useful.</p>
<p>Before we begin, you should run git –version to check your current git version, mine is 2.12.2 as in macOS High Sierra. <a href="https://git-scm.com/" target="_blank" rel="noopener">Here</a> is the official git documentation, you can read details about git commands, parameters and new releases of git.</p>
<h2 id="Useful-commands"><a href="#Useful-commands" class="headerlink" title="Useful commands"></a>Useful commands</h2><h3 id="Diff"><a href="#Diff" class="headerlink" title="Diff"></a>Diff</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git diff feature/my_branch develop &gt; file.diff</span><br><span class="line">git apply file.diff</span><br></pre></td></tr></table></figure>

<h3 id="🔍-Status"><a href="#🔍-Status" class="headerlink" title="🔍 Status"></a>🔍 Status</h3><p>Check the status of working directory and staging area:</p>
<pre><code>git status</code></pre><p>Show changes between HEAD and working directory:</p>
<pre><code>git diff</code></pre><p>Show the list of commits in one line format:</p>
<pre><code>git log --oneline</code></pre><p>Show commits that make add or remove a certain string:</p>
<pre><code>git log -S &apos;LoginViewController&apos;</code></pre><p>Search commits that contain a log message:</p>
<pre><code>git log — all — grep=’day of week’</code></pre><h3 id="🔍-Tag"><a href="#🔍-Tag" class="headerlink" title="🔍 Tag"></a>🔍 Tag</h3><p>List all tags:</p>
<pre><code>git tag</code></pre><p>Tag a commit:</p>
<pre><code>git tag -a 1.4 -m &quot;my version 1.4&quot;</code></pre><p>Delete remote tags:</p>
<pre><code>git push --delete origin tagname

git push origin :tagname</code></pre><p>Push tag to remote:</p>
<pre><code>git push origin tagname</code></pre><p>Rename tag:</p>
<pre><code>git tag new old
git tag -d old
git push origin :refs/tags/old
git push --tags</code></pre><p>Move tag from one commit to another commit:</p>
<pre><code>git push origin :refs/tags/&lt;tagname&gt;
git tag -fa tagname
git push origin master --tags</code></pre><h3 id="🔍-Remote"><a href="#🔍-Remote" class="headerlink" title="🔍 Remote"></a>🔍 Remote</h3><p>List all remote:</p>
<pre><code>git remote</code></pre><p>Rename remote:</p>
<pre><code>git remote rename old new</code></pre><p>Remove stale remote tracking branches:</p>
<pre><code>git remote prune origin</code></pre><h3 id="🔍-Branch"><a href="#🔍-Branch" class="headerlink" title="🔍 Branch"></a>🔍 Branch</h3><p>List all branches:</p>
<pre><code>git branch</code></pre><p>Create the branch on your local machine and switch in this branch:</p>
<pre><code>git checkout -b branch_name</code></pre><p>Create branch from commit:</p>
<pre><code>git branch branch_name sha1_of_commit</code></pre><p>Push the branch to remote:</p>
<pre><code>git push origin branch_name</code></pre><p>Rename other branch:</p>
<pre><code>git branch -m old new</code></pre><p>Rename current branch:</p>
<pre><code>git branch -m new</code></pre><p>Rename remote branch:</p>
<pre><code>git branch -m old new               # Rename branch locally    
git push origin :old                 # Delete the old branch    
git push --set-upstream origin new   # Push the new branch, set local branch to track the new remote</code></pre><p>Delete a branch:</p>
<pre><code>git branch -D the_local_branch

git push origin :the_remote_branch</code></pre><p>Delete all local branches but master</p>
<pre><code>git branch | grep -v &quot;master&quot; | xargs git branch -D</code></pre><h3 id="🔍-Commit"><a href="#🔍-Commit" class="headerlink" title="🔍 Commit"></a>🔍 Commit</h3><p>Undo last commit:</p>
<pre><code>git reset --hard HEAD~1</code></pre><p>Squash last n commits into one commit:</p>
<pre><code>git rebase -i HEAD~5

git reset --soft HEAD~5
git add .
git commit -m &quot;Update&quot;
git push -f origin master</code></pre><p>Move last commits into new branch:</p>
<pre><code>git branch newbranch
git reset --hard HEAD~3 # Go back 3 commits. You *will* lose uncommitted work.*1
git checkout newbranch</code></pre><h3 id="🔍-Cherry-Pick"><a href="#🔍-Cherry-Pick" class="headerlink" title="🔍 Cherry Pick"></a>🔍 Cherry Pick</h3><p>Add some commits to the top of the current branch:</p>
<pre><code>git cherry-pick hash_commit_A hash_commit_B</code></pre><h3 id="🔍-Reflog"><a href="#🔍-Reflog" class="headerlink" title="🔍 Reflog"></a>🔍 Reflog</h3><p>Show reflog:</p>
<pre><code>git reflog</code></pre><p>Get commit:</p>
<pre><code>git reset --hard 0254ea7

git cherry-pick 12944d8</code></pre><h3 id="🔍-Revert"><a href="#🔍-Revert" class="headerlink" title="🔍 Revert"></a>🔍 Revert</h3><p>Revert the previous commit:</p>
<pre><code>git revert HEAD
git commit</code></pre><p>Revert the changes from previous 3 commits without making commit:</p>
<pre><code>git revert --no-commit HEAD~3..</code></pre><h3 id="🔍-Amend"><a href="#🔍-Amend" class="headerlink" title="🔍 Amend"></a>🔍 Amend</h3><p>Amend previous commit:</p>
<pre><code>git commit --amend

git commit --amend --no-edit

git commit --amend -m &quot;New commit message&quot;</code></pre><p><a href="http://stackoverflow.com/questions/8981194/changing-git-commit-message-after-push-given-that-no-one-pulled-from-remote" target="_blank" rel="noopener">Changing git commit message after push</a>:</p>
<pre><code>git commit --amend -m &quot;New commit message&quot;
git push --force &lt;repository&gt; &lt;branch&gt;</code></pre><h3 id="🔍-Checkout"><a href="#🔍-Checkout" class="headerlink" title="🔍 Checkout"></a>🔍 Checkout</h3><p>Checkout a tag:</p>
<pre><code>git checkout tagname

git checkout -b newbranchname tagname</code></pre><p>Checkout a branch:</p>
<pre><code>git checkout destination_branch</code></pre><p>Use -m if there is merge conflict:</p>
<pre><code>git checkout -m master // from feature branch to master</code></pre><p>Checkout a commit:</p>
<pre><code>git checkout commit_hash

git checkout -b newbranchname HEAD~4

git checkout -b newbranchname commit_hash

git checkout commit_hash file</code></pre><p>Checkout a file:</p>
<pre><code>git checkout c5f567 -- Relative/Path/To/File</code></pre><h3 id="🔍-Stash"><a href="#🔍-Stash" class="headerlink" title="🔍 Stash"></a>🔍 Stash</h3><p>Save a change to stash:</p>
<pre><code>git stash save &quot;stash name&quot;

git stash</code></pre><p>List all stashes:</p>
<pre><code>git stash list</code></pre><p>Apply a stash:</p>
<pre><code>git stash pop

git stash apply

git stash apply stash@{2}</code></pre><h3 id="🔍-Rebase"><a href="#🔍-Rebase" class="headerlink" title="🔍 Rebase"></a>🔍 Rebase</h3><p>Rebase the current branch onto master:</p>
<pre><code>git rebase master // rebase the current branch onto master</code></pre><p>Continue rebase:</p>
<pre><code>git rebase --continue</code></pre><p>Abort rebase:</p>
<pre><code>git rebase --abort</code></pre><h3 id="🔍-gitignore"><a href="#🔍-gitignore" class="headerlink" title="🔍 .gitignore"></a>🔍 .gitignore</h3><p>Un-track files that have just been declared in .gitignore:</p>
<pre><code>git rm -r --cached .
git add .
git commit -am &quot;Remove ignored files&quot;</code></pre><h3 id="🔍-Index"><a href="#🔍-Index" class="headerlink" title="🔍 Index"></a>🔍 Index</h3><p>Remove untracked files:</p>
<pre><code>git clean</code></pre><p>Remove file from index:</p>
<pre><code>git reset file</code></pre><p>Reset the index to match the most recent commit:</p>
<pre><code>git reset</code></pre><p>Reset the index and the working directory to match the most recent commit:</p>
<pre><code>git reset --hard</code></pre><h3 id="🔍-Misc"><a href="#🔍-Misc" class="headerlink" title="🔍 Misc"></a>🔍 Misc</h3><p>Get their changes during git rebase:</p>
<pre><code>git checkout --ours foo/bar.java
git add foo/bar.java</code></pre><p>Get their changes during git merge:</p>
<pre><code>git pull -X theirs

git checkout --theirs path/to/the/conflicted_file.php

git checkout --theirs .
git add .

git checkout branchA
git merge -X theirs branchB</code></pre><p>Merge commits from master into feature branch:</p>
<pre><code>git checkout feature1
git merge --no-ff master</code></pre><p>Find bug in commit history in a binary search tree style:</p>
<pre><code>git bisect start

git bisect good

git bisect bad</code></pre><h2 id="Git-alias"><a href="#Git-alias" class="headerlink" title="Git alias"></a>Git alias</h2><p>If there are commands that you use a lot, then consider using git alias. This is how to make alias for git status, then you can just type git st:</p>
<pre><code>git config — global alias.st status</code></pre><p>Alias configurations are stored in .gitconfig file, you can learn some cool aliases from <a href="https://github.com/thoughtbot/dotfiles/blob/master/gitconfig" target="_blank" rel="noopener">thoughtbot</a> and <a href="https://github.com/mathiasbynens/dotfiles/blob/master/.gitconfig" target="_blank" rel="noopener">mathiasbynens</a>.</p>
<h3 id="Delete-all-local-branches-except-master"><a href="#Delete-all-local-branches-except-master" class="headerlink" title="Delete all local branches except master"></a>Delete all local branches except master</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.dlb &apos;!git branch | grep -v &quot;master&quot; | xargs git branch -D&apos;</span><br></pre></td></tr></table></figure>

<h3 id="Prune-upstream-branches"><a href="#Prune-upstream-branches" class="headerlink" title="Prune upstream branches"></a>Prune upstream branches</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.pu &apos;remote prune upstream&apos;</span><br></pre></td></tr></table></figure>

<h2 id="GUI-clients"><a href="#GUI-clients" class="headerlink" title="GUI clients"></a>GUI clients</h2><p>Doing things in command line is cool and faster. However for viewing branches and commits, I find using a GUI client more visualizing and comfortable. You can see a list of all GUI clients <a href="https://git-scm.com/download/gui/mac" target="_blank" rel="noopener">here</a>, I myself use <a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">SourceTree</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/2900/1*g2NL2JUXNAFWYrPydraqsg.png" alt></p>
<h2 id="Check-before-you-commit"><a href="#Check-before-you-commit" class="headerlink" title="Check before you commit"></a>Check before you commit</h2><p>We usually have some experiment code that we don’t want they to step into our commit. I usually mark my experiment with // <test> but sometimes forget to unstage that.</test></p>
<p>Starting with 2.9, Git has improvement on its commit hook which makes it globally using <strong><em>hooksPath.</em></strong></p>
<p>Firstly we nee to create a file called pre-commit, and place it into, for example, /Users/khoa/hooks:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># https://appventure.me/2016/04/04/prevent-accidental-test-code-commits/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> git rev-parse --verify HEAD &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  against=HEAD</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="comment"># Initial commit: diff against an empty tree object</span></span><br><span class="line">  against=4b825dc642cb6eb9a060e54bf8d69288fbee4904</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The special marker tag to mark things which we still need to change</span></span><br><span class="line">marker=<span class="string">"&lt;TEST&gt;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redirect output to stderr.</span></span><br><span class="line"><span class="built_in">exec</span> 1&gt;&amp;2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> $(git diff --cached -z <span class="variable">$against</span> | grep <span class="variable">$marker</span> | wc -c) != 0 </span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    cat &lt;&lt;\EOF</span><br><span class="line">    Error: Still has invalid debug markers <span class="keyword">in</span> code:</span><br><span class="line">EOF</span><br><span class="line">    <span class="built_in">echo</span> `git diff --cached -z <span class="variable">$against</span> -G <span class="variable">$marker</span>`</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p>In your project, run git config core.hooksPath /Users/khoa/hooks.</p>
<p>Whenever you commit a file with that pattern, it won’t let you commit. For how to make this work in SourceTree, check:<br><a href="https://medium.com/@onmyway133/sourcetree-and-pre-commit-hook-52545f22fe10" target="_blank" rel="noopener"><strong>SourceTree and pre commit hook</strong><br><em>Pre-commit file works perfectly in terminal, but SourceTree seems to ignore it. I use both terminal and SourceTree, as…</em>medium.com</a></p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>This is just scratching the surface of what git can do, if you want to learn more, here are some links to get started.</p>
<ul>
<li><a href="https://www.atlassian.com/git/tutorials/setting-up-a-repository" target="_blank" rel="noopener">Atlassian Git Tutorial</a>: overview of how to set up a repository (repo) under Git version control</li>
<li><a href="https://github.com/arslanbilal/git-cheat-sheet" target="_blank" rel="noopener">git-cheat-sheet</a>: Git cheat sheet saves you from learning all the commands by heart.</li>
<li><a href="http://www.learnenough.com/git-tutorial" target="_blank" rel="noopener">Learn Enough Git to Be Dangerous</a></li>
<li><a href="http://www.toptal.com/git/git-workflows-for-pros-a-good-git-guide" target="_blank" rel="noopener">Git Workflows for Pros: A Good Git Guide</a></li>
<li><a href="https://codewords.recurse.com/issues/two/git-from-the-inside-out" target="_blank" rel="noopener">Git from the inside out</a>: The essay focuses on the graph structure that underpins Git</li>
<li><a href="https://github.com/git-game/git-game" target="_blank" rel="noopener">git-game</a>: terminal game to test git skills</li>
<li><a href="https://www.youtube.com/watch?v=xbLVvrb2-fY" target="_blank" rel="noopener">Introduction to Git — talk by Scott Chacon</a></li>
<li><a href="http://www.raywenderlich.com/74258/git-tutorial-intermediate" target="_blank" rel="noopener">Git Tutorial — Git Fu With The Command Line</a></li>
<li><a href="http://gitimmersion.com/" target="_blank" rel="noopener">Git Immersion</a>: The surest path to mastering Git is to immerse oneself in its utilities and operations, to experience it first-hand</li>
<li><a href="https://github.com/k88hudson/git-flight-rules" target="_blank" rel="noopener">git-flight-rules</a> Flight rules for git</li>
<li><a href="https://github.com/nvie/gitflow" target="_blank" rel="noopener">gitflow</a> Git extensions to provide high-level repository operations for Vincent Driessen’s branching model</li>
<li><a href="https://github.com/so-fancy/diff-so-fancy" target="_blank" rel="noopener">diff-so-fancy</a> Good-lookin’ diffs with diff-highlight and more</li>
<li><a href="https://github.com/tiimgreen/github-cheat-sheet" target="_blank" rel="noopener">github-cheat-sheet</a> A list of cool features of Git and GitHub</li>
<li><a href="https://github.com/git-tips/tips" target="_blank" rel="noopener">git tips</a> Most commonly used git tips and tricks</li>
<li><a href="https://csswizardry.com/2017/05/little-things-i-like-to-do-with-git/" target="_blank" rel="noopener">Little Things I Like to Do with Git</a></li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/links/">links</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-work-around-app-damaged-warning-in-macOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-work-around-app-damaged-warning-in-macOS/">How to work around app damaged warning in macOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-work-around-app-damaged-warning-in-macOS/" class="article-date">
	  <time datetime="2019-05-15T17:46:15.000Z" itemprop="datePublished">May 15, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/238" target="_blank" rel="noopener">#238</a></strong></p>
<blockquote>
<p>“App” is damaged and can’t be opened. You should move it to the Trash. </p>
</blockquote>
<p>👉 Disable gate keeper</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo spctl --master-disable</span><br><span class="line">spctl --status</span><br></pre></td></tr></table></figure>

<p>Current workaround is to remove Launch At Login handling code.</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/terminal/">terminal</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-shake-NSView-in-macOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-shake-NSView-in-macOS/">How to shake NSView in macOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-shake-NSView-in-macOS/" class="article-date">
	  <time datetime="2019-05-15T06:00:57.000Z" itemprop="datePublished">May 15, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/233" target="_blank" rel="noopener">#233</a></strong></p>
<h2 id="Animation-on-macOS-using-CAAnimation"><a href="#Animation-on-macOS-using-CAAnimation" class="headerlink" title="Animation on macOS using CAAnimation"></a>Animation on macOS using CAAnimation</h2><p>Shake</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> midX = box.layer?.position.x ?? <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> midY = box.layer?.position.y ?? <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position"</span>)</span><br><span class="line">animation.duration = <span class="number">0.06</span></span><br><span class="line">animation.repeatCount = <span class="number">4</span></span><br><span class="line">animation.autoreverses = <span class="literal">true</span></span><br><span class="line">animation.fromValue = <span class="type">CGPoint</span>(x: midX - <span class="number">10</span>, y: midY)</span><br><span class="line">animation.toValue = <span class="type">CGPoint</span>(x: midX + <span class="number">10</span>, y: midY)</span><br><span class="line">box.layer?.add(animation, forKey: <span class="string">"position"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Animation-on-macOS-using-NSAnimationContext"><a href="#Animation-on-macOS-using-NSAnimationContext" class="headerlink" title="Animation on macOS  using NSAnimationContext"></a>Animation on macOS  using NSAnimationContext</h2><p>Wiggle</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSAnimationContext</span>.runAnimationGroup(&#123; context <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> animation = <span class="type">CAKeyframeAnimation</span>(keyPath: <span class="string">"transform"</span>)</span><br><span class="line">    animation.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">5.0</span></span><br><span class="line">    animation.duration = <span class="number">0.1</span></span><br><span class="line">    animation.autoreverses = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">let</span> wobbleAngle: <span class="type">CGFloat</span> = <span class="number">0.08</span></span><br><span class="line">    animation.values = [</span><br><span class="line">        <span class="type">NSValue</span>(caTransform3D: <span class="type">CATransform3DMakeRotation</span>(wobbleAngle, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>)),</span><br><span class="line">        <span class="type">NSValue</span>(caTransform3D: <span class="type">CATransform3DMakeRotation</span>(-wobbleAngle, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>))</span><br><span class="line">    ]</span><br><span class="line">    view.layer?.add(animation, forKey: <span class="string">"transform"</span>)</span><br><span class="line">&#125;, completionHandler: &#123;</span><br><span class="line">    <span class="keyword">self</span>.makeAnimation(view: view)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Animation-on-iOS-using-UIView-animation-block"><a href="#Animation-on-iOS-using-UIView-animation-block" class="headerlink" title="Animation on iOS using UIView animation  block"></a>Animation on iOS using UIView animation  block</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">shake</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.transform = <span class="type">CGAffineTransform</span>(translationX: <span class="number">16</span>, y: <span class="number">0</span>)</span><br><span class="line">        <span class="type">UIView</span>.animate(withDuration: <span class="number">0.4</span>, delay: <span class="number">0</span>, usingSpringWithDamping: <span class="number">0.2</span>, initialSpringVelocity: <span class="number">1</span>, options: .curveEaseInOut, animations: &#123;</span><br><span class="line">            <span class="keyword">self</span>.transform = <span class="type">CGAffineTransform</span>.identity</span><br><span class="line">        &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-CAReplicatorLayer-to-make-activity-indicator-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-CAReplicatorLayer-to-make-activity-indicator-in-iOS/">How to use CAReplicatorLayer to make activity indicator in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-CAReplicatorLayer-to-make-activity-indicator-in-iOS/" class="article-date">
	  <time datetime="2019-05-13T11:43:49.000Z" itemprop="datePublished">May 13, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/230" target="_blank" rel="noopener">#230</a></strong></p>
<p><a href="https://developer.apple.com/documentation/quartzcore/careplicatorlayer" target="_blank" rel="noopener">CAReplicatorLayer</a> is a layer that creates a specified number of sublayer copies with varying geometric, temporal, and color transformations</p>
<p>Here we use <code>instanceTransform</code> which applies transformation matrix around the center of the replicator layer</p>
<p>Below is how we use <code>replicatorLayer</code> to replicate lots of <code>line</code> and rotate them around the center.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> replicatorLayer = <span class="type">CAReplicatorLayer</span>()</span><br><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: #keyPath(<span class="type">CALayer</span>.opacity))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> line = <span class="type">CALayer</span>()</span><br><span class="line"><span class="keyword">let</span> lineCount: <span class="type">Int</span> = <span class="number">12</span></span><br><span class="line"><span class="keyword">let</span> duration: <span class="type">TimeInterval</span> = <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> lineSize: <span class="type">CGSize</span> = <span class="type">CGSize</span>(width: <span class="number">20</span>, height: <span class="number">6</span>)</span><br><span class="line"><span class="keyword">let</span> lineColor: <span class="type">UIColor</span> = <span class="type">UIColor</span>.darkGray</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> angle = <span class="type">CGFloat</span>.pi * <span class="number">2</span> / <span class="type">CGFloat</span>(lineCount)</span><br><span class="line"><span class="keyword">let</span> rotation = <span class="type">CATransform3DMakeRotation</span>(angle, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">replicatorLayer.instanceTransform = rotation</span><br><span class="line">replicatorLayer.instanceCount = lineCount</span><br><span class="line">replicatorLayer.instanceDelay = duration / <span class="type">TimeInterval</span>(lineCount)</span><br><span class="line"></span><br><span class="line">line.backgroundColor = lineColor.cgColor</span><br><span class="line">line.frame.size = lineSize</span><br><span class="line">line.cornerRadius = lineSize.height / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">animation.fromValue = <span class="number">1.0</span></span><br><span class="line">animation.toValue = <span class="number">0.0</span></span><br><span class="line">animation.repeatCount = <span class="type">Float</span>.greatestFiniteMagnitude</span><br><span class="line">animation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: .linear)</span><br><span class="line">animation.duration = duration</span><br><span class="line"></span><br><span class="line">replicatorLayer.addSublayer(line)</span><br><span class="line">layer.addSublayer(replicatorLayer)</span><br><span class="line"></span><br><span class="line"><span class="comment">// x: </span></span><br><span class="line"><span class="comment">// y: half the height, changing affects rotation of lines</span></span><br><span class="line">line.position = <span class="type">CGPoint</span>(x: <span class="number">48</span>, y: <span class="number">75</span>)</span><br><span class="line"></span><br><span class="line">line.add(animation, forKey: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>Pay attention to <code>position</code> of the <code>line</code>. The larger the <code>x</code>, the closer to center. <code>y</code> should be half the height of the replicator layer size, changing it affects the skewness of the <code>line</code>.</p>
<img width="584" alt="indicator" src="https://user-images.githubusercontent.com/2284279/57626103-809f2100-7595-11e9-9851-2df8b6013757.png">

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-do-rotation-for-CALayer-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-do-rotation-for-CALayer-in-iOS/">How to do rotation for CALayer in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-do-rotation-for-CALayer-in-iOS/" class="article-date">
	  <time datetime="2019-05-13T10:20:29.000Z" itemprop="datePublished">May 13, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/229" target="_blank" rel="noopener">#229</a></strong></p>
<h2 id="Use-keypath"><a href="#Use-keypath" class="headerlink" title="Use keypath"></a>Use keypath</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animation = <span class="type">CASpringAnimation</span>(keyPath: #keyPath(<span class="type">CALayer</span>.transform))</span><br><span class="line">animation.fromValue = <span class="number">0</span></span><br><span class="line">animation.valueFunction = <span class="type">CAValueFunction</span>(name: <span class="type">CAValueFunctionName</span>.rotateZ)</span><br><span class="line">animation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: .easeIn)</span><br><span class="line"></span><br><span class="line">animation.toValue = <span class="type">CGFloat</span>.pi / <span class="number">4</span></span><br></pre></td></tr></table></figure>

<h2 id="Avoid-setting-frame-many-times"><a href="#Avoid-setting-frame-many-times" class="headerlink" title="Avoid setting frame many times"></a>Avoid setting frame many times</h2><p>Otherwise, <code>frame</code> is the box that covers the rotation transform, and <code>backgroundColor</code> now fills that huge box</p>
<p><img src="https://user-images.githubusercontent.com/2284279/57622665-67df3d00-758e-11e9-9e4c-f2baec78b4af.jpg" alt="abc"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.layoutSubviews()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> line.frame.width &lt;= <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    line.backgroundColor = <span class="type">UIColor</span>.red.cgColor</span><br><span class="line">    line.cornerRadius = <span class="number">3</span></span><br><span class="line">	line.frame.size = <span class="type">CGSize</span>(width: bounds.width*<span class="number">0.6</span>, height: <span class="number">6</span>)</span><br><span class="line">    line.position = layer.position</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Auto-Layout"><a href="#Auto-Layout" class="headerlink" title="Auto Layout"></a>Auto Layout</h2><p>Avoid using Auto Layout for the rotated view</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-not-use-isRemovedOnCompletion-for-CAAnimation-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-not-use-isRemovedOnCompletion-for-CAAnimation-in-iOS/">How to not use isRemovedOnCompletion for CAAnimation in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-not-use-isRemovedOnCompletion-for-CAAnimation-in-iOS/" class="article-date">
	  <time datetime="2019-05-13T09:17:43.000Z" itemprop="datePublished">May 13, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/228" target="_blank" rel="noopener">#228</a></strong></p>
<p>CAAnimation is about presentation layer, after animation completes, the view snaps back to its original state. If we want to keep the state after animation, then the wrong way is to use <code>CAMediaTimingFillMode.forward</code> and <code>isRemovedOnCompletion</code></p>
<h2 id="Animation-never-ends"><a href="#Animation-never-ends" class="headerlink" title="Animation never ends"></a>Animation never ends</h2><p><code>forwards</code> <a href="https://developer.apple.com/documentation/quartzcore/camediatimingfillmode/1427658-forwards" target="_blank" rel="noopener">https://developer.apple.com/documentation/quartzcore/camediatimingfillmode/1427658-forwards</a></p>
<blockquote>
<p>The receiver remains visible in its final state when the animation is completed.</p>
</blockquote>
<p><code>isRemovedOnCompletion</code></p>
<p><a href="https://developer.apple.com/documentation/quartzcore/caanimation/1412458-isremovedoncompletion" target="_blank" rel="noopener">https://developer.apple.com/documentation/quartzcore/caanimation/1412458-isremovedoncompletion</a></p>
<blockquote>
<p>When true, the animation is removed from the target layer’s animations once its active duration has passed. Defaults to true.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">layer.fillMode = .forwards</span><br><span class="line">animation. isRemovedOnCompletion = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>This is to tell the animation to never ends and keep its last presentation state. Wrong approach ❗️</p>
<h2 id="Set-final-state-before-calling-animation"><a href="#Set-final-state-before-calling-animation" class="headerlink" title="Set final state before calling animation"></a>Set final state before calling animation</h2><p>The presentation state is just for animation, the source of truth lies in the layer itself. We need to set the final state before calling animation</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: #keyPath(<span class="type">CAShapeLayer</span>.strokeEnd))</span><br><span class="line"></span><br><span class="line">shapeLayer.strokeEnd = <span class="number">1.0</span></span><br><span class="line">shapeLayer.add(animation, forKey: <span class="string">""</span>)</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-simple-search-box-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-simple-search-box-in-iOS/">How to make simple search box in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-simple-search-box-in-iOS/" class="article-date">
	  <time datetime="2019-05-07T12:30:28.000Z" itemprop="datePublished">May 7, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/227" target="_blank" rel="noopener">#227</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchBox</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> textField: <span class="type">UITextField</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> textField = <span class="type">UITextField</span>()</span><br><span class="line">        <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(image: <span class="type">R</span>.image.search()!)</span><br><span class="line">        imageView.frame.size = <span class="type">CGSize</span>(width: <span class="number">20</span> + <span class="number">8</span>, height: <span class="number">20</span>)</span><br><span class="line">        imageView.contentMode = .scaleAspectFit</span><br><span class="line">        textField.leftView = imageView</span><br><span class="line">        textField.leftViewMode = .always</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> textField</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> filterButton: <span class="type">UIButton</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> button = <span class="type">UIButton</span>(type: .custom)</span><br><span class="line">        button.setImage(<span class="type">R</span>.image.<span class="built_in">filter</span>()!, <span class="keyword">for</span>: .normal)</span><br><span class="line">        button.imageEdgeInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">10</span>, <span class="keyword">left</span>: <span class="number">10</span>, bottom: <span class="number">10</span>, <span class="keyword">right</span>: <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> button</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> backView: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = .white</span><br><span class="line">        view.layer.cornerRadius = <span class="number">10</span></span><br><span class="line">        view.layer.borderColor = <span class="type">R</span>.color.lightGray.cgColor</span><br><span class="line">        view.layer.borderWidth = <span class="number">0.5</span></span><br><span class="line">        view.layer.shadowOffset = <span class="type">CGSize</span>(width: <span class="number">1</span>, height: <span class="number">1</span>)</span><br><span class="line">        view.layer.shadowOpacity = <span class="number">0.8</span></span><br><span class="line">        view.layer.shadowColor = <span class="type">R</span>.color.lightGray.cgColor</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line"></span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([backView, textField, filterButton])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            filterButton.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">8</span>),</span><br><span class="line">            filterButton.centerYAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line">            filterButton.heightAnchor.constraint(equalToConstant: <span class="number">44</span>),</span><br><span class="line">            filterButton.widthAnchor.constraint(equalToConstant: <span class="number">44</span>),</span><br><span class="line"></span><br><span class="line">            textField.centerYAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line">            textField.leftAnchor.constraint(equalTo: leftAnchor, constant: <span class="number">16</span>),</span><br><span class="line">            textField.rightAnchor.constraint(equalTo: filterButton.leftAnchor, constant: -<span class="number">8</span>)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            backView.pinEdges(view: <span class="keyword">self</span>, inset: <span class="type">UIEdgeInsets</span>(top: <span class="number">4</span>, <span class="keyword">left</span>: <span class="number">4</span>, bottom: -<span class="number">4</span>, <span class="keyword">right</span>: -<span class="number">4</span>))</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To apply padding to <code>leftView</code>, increase <code>width</code> and use <code>contentMode</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">imageView.frame.size = <span class="type">CGSize</span>(width: <span class="number">20</span> + <span class="number">8</span>, height: <span class="number">20</span>)</span><br><span class="line">imageView.contentMode = .scaleAspectFit</span><br></pre></td></tr></table></figure>

<p>To make image in button smaller, use <code>imageEdgeInsets</code> with all positive values<br>To have round and shadow, specify <code>shadowOpacity</code>, <code>cornerRadius</code>, <code>shadowOffset</code></p>
<img width="584" alt="searchbox" src="https://user-images.githubusercontent.com/2284279/57307753-6a045000-70e5-11e9-9f2d-db5835f5b21b.png">

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-capture-video-in-iOS-simulator"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-capture-video-in-iOS-simulator/">How to capture video in iOS simulator</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-capture-video-in-iOS-simulator/" class="article-date">
	  <time datetime="2019-05-07T10:43:16.000Z" itemprop="datePublished">May 7, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/226" target="_blank" rel="noopener">#226</a></strong></p>
<p>Take screenshot</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl io booted screenshot image.png</span><br></pre></td></tr></table></figure>

<p>Record video</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl io booted recordVideo video.mp4</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-custom-fonts-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-custom-fonts-in-iOS/">How to use custom fonts in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-custom-fonts-in-iOS/" class="article-date">
	  <time datetime="2019-05-07T07:17:28.000Z" itemprop="datePublished">May 7, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/225" target="_blank" rel="noopener">#225</a></strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>UIAppFonts<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Bold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-BoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-ExtraBold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-ExtraBoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Italic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Light.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-LightItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Regular.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-SemiBold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-SemiBoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Read <a href="https://developer.apple.com/documentation/uikit/text_display_and_fonts/adding_a_custom_font_to_your_app" target="_blank" rel="noopener">Adding a Custom Font to Your App</a></p>
<blockquote>
<p>The name of the font isn’t always obvious, and rarely matches the font file name. A quick way to find the font name is to get the list of fonts available to your app, which you can do with the following code:</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> family <span class="keyword">in</span> <span class="type">UIFont</span>.familyNames.sorted() &#123;</span><br><span class="line">    <span class="keyword">let</span> names = <span class="type">UIFont</span>.fontNames(forFamilyName: family)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Family: \(family) Font names: \(names)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-create-UITabBarController-programmatically-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-create-UITabBarController-programmatically-in-iOS/">How to create UITabBarController programmatically in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-create-UITabBarController-programmatically-in-iOS/" class="article-date">
	  <time datetime="2019-05-07T06:54:17.000Z" itemprop="datePublished">May 7, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/224" target="_blank" rel="noopener">#224</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tabBarController = <span class="type">UITabBarController</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> navigationController1 = <span class="type">UINavigationController</span>(rootViewController: viewController1)</span><br><span class="line"><span class="keyword">let</span> navigationController2 = <span class="type">UINavigationController</span>(rootViewController: viewController2)</span><br><span class="line"><span class="keyword">let</span> navigationController3 = <span class="type">UINavigationController</span>(rootViewController: viewController3)</span><br><span class="line"></span><br><span class="line">navigationController2.isNavigationBarHidden = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">navigationController1.tabBarItem.image = <span class="type">R</span>.image.profile()</span><br><span class="line">navigationController2.tabBarItem.image = <span class="type">R</span>.image.books()</span><br><span class="line">navigationController3.tabBarItem.image = <span class="type">R</span>.image.settings()</span><br><span class="line"></span><br><span class="line">tabBarController.tabBar.tintColor = .yellow</span><br><span class="line">tabBarController.viewControllers = [navigationController1, navigationController2, navigationController3]</span><br></pre></td></tr></table></figure>

<p>Use <code>tintColor</code> instead of the deprecated <code>selectedImageTintColor</code> to indicate selected item color.</p>
<p>For icon size, check <a href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/custom-icons/" target="_blank" rel="noopener">Tab Bar Icon Size</a>, usually 50x50 for 2x and 75x75 for 3x</p>
<blockquote>
<p>In portrait orientation, tab bar icons appear above tab titles. In landscape orientation, the icons and titles appear side-by-side. Depending on the device and orientation, the system displays either a regular or compact tab bar. Your app should include custom tab bar icons for both sizes.</p>
</blockquote>
<img width="769" alt="tab" src="https://user-images.githubusercontent.com/2284279/57286819-71f8cb80-70b6-11e9-937e-a3572fb3bb57.png">


      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-run-AppleScript-in-macOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-run-AppleScript-in-macOS/">How to run AppleScript in macOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-run-AppleScript-in-macOS/" class="article-date">
	  <time datetime="2019-05-02T18:19:25.000Z" itemprop="datePublished">May 2, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/223" target="_blank" rel="noopener">#223</a></strong></p>
<h2 id="Surround-script-by-single-quotes"><a href="#Surround-script-by-single-quotes" class="headerlink" title="Surround script by single quotes"></a>Surround script by single quotes</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> script = </span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">tell application "XcodeWay"</span></span><br><span class="line"><span class="string">    activate</span></span><br><span class="line"><span class="string">end tell</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> command = <span class="string">"osascript -e '\(script)'"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> process = <span class="type">Process</span>()</span><br><span class="line">process.launchPath = <span class="string">"/bin/bash"</span></span><br><span class="line">process.arguments = [<span class="string">"-c"</span>, command]</span><br></pre></td></tr></table></figure>

<h2 id="Run-as-administrator"><a href="#Run-as-administrator" class="headerlink" title="Run as administrator"></a>Run as administrator</h2><p>In terminal, we can</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Library</span><br><span class="line">sudo mkdir MyNewFolder</span><br></pre></td></tr></table></figure>

<p>In code, we use <code>with administrator privileges</code>, this when run will ask for password or fingerprint</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">do shell script &quot;mkdir MyNewFolder&quot; with administrator privileges</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apple-script/">apple script</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-make-simple-networking-client-in-Swift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-make-simple-networking-client-in-Swift/">How to make simple networking client in Swift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-make-simple-networking-client-in-Swift/" class="article-date">
	  <time datetime="2019-05-02T05:57:54.000Z" itemprop="datePublished">May 2, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/222" target="_blank" rel="noopener">#222</a></strong></p>
<p>For more mature networking, visit <a href="https://github.com/onmyway133/Miami" target="_blank" rel="noopener">https://github.com/onmyway133/Miami</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">NetworkClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> session: <span class="type">URLSession</span></span><br><span class="line">    <span class="keyword">let</span> baseUrl: <span class="type">URL</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(session: <span class="type">URLSession</span> = .shared, baseUrl: <span class="type">URL</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.session = session</span><br><span class="line">        <span class="keyword">self</span>.baseUrl = baseUrl</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">make</span><span class="params">(options: Options, completion: @escaping <span class="params">(Result&lt;Data, Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> request = options.toRequest(baseUrl: baseUrl) <span class="keyword">else</span> &#123;</span><br><span class="line">            completion(.failure(<span class="type">AppError</span>.request))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> task = session.dataTask(with: request, completionHandler: &#123; data, <span class="number">_</span>, error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> data = data &#123;</span><br><span class="line">                completion(.success(data))</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">                completion(.failure(error))</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                completion(.failure(<span class="type">AppError</span>.unknown))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        task.resume()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makeJson</span><span class="params">(options: Options, completion: @escaping <span class="params">(Result&lt;[String: <span class="keyword">Any</span>], Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        make(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> mapped = result.flatMap(&#123; data -&gt; <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt; <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> json = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.jsonObject(with: data, options: [])</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> json = json <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt;.success(json)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt;.failure(<span class="type">AppError</span>.parse)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt;.failure(error)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">            completion(mapped)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Options</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> path: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">var</span> httpMethod: <span class="type">HttpMethod</span> = .<span class="keyword">get</span></span><br><span class="line">    <span class="keyword">var</span> parameters: [<span class="type">String</span>: <span class="type">Any</span>] = [:]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toRequest</span><span class="params">(baseUrl: URL)</span></span> -&gt; <span class="type">URLRequest?</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> url = baseUrl.appendingPathComponent(path)</span><br><span class="line">        <span class="keyword">let</span> items: [<span class="type">URLQueryItem</span>] = parameters.<span class="built_in">map</span>(&#123; tuple -&gt; <span class="type">URLQueryItem</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">URLQueryItem</span>(name: tuple.key, value: <span class="string">"\(tuple.value)"</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> components = <span class="type">URLComponents</span>(url: url, resolvingAgainstBaseURL: <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> httpMethod == .<span class="keyword">get</span> &#123;</span><br><span class="line">            components?.queryItems = items</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> finalUrl = components?.url <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> request = <span class="type">URLRequest</span>(url: finalUrl)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> httpMethod == .post &#123;</span><br><span class="line">            <span class="keyword">let</span> data = <span class="keyword">try</span>? <span class="type">JSONSerialization</span>.data(withJSONObject: parameters, options: [])</span><br><span class="line">            request.httpBody = data</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        request.httpMethod = httpMethod.rawValue</span><br><span class="line">        <span class="keyword">return</span> request</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AppError</span>: <span class="title">Error</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> request</span><br><span class="line">    <span class="keyword">case</span> unknown</span><br><span class="line">    <span class="keyword">case</span> parse</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">HttpMethod</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">get</span> = <span class="string">"GET"</span></span><br><span class="line">    <span class="keyword">case</span> put = <span class="string">"PUT"</span></span><br><span class="line">    <span class="keyword">case</span> post = <span class="string">"POST"</span></span><br><span class="line">    <span class="keyword">case</span> patch = <span class="string">"PATCH"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/networking/">networking</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-ignore-App-Transport-Security-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-ignore-App-Transport-Security-in-iOS/">How to ignore App Transport Security in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-ignore-App-Transport-Security-in-iOS/" class="article-date">
	  <time datetime="2019-04-30T11:17:03.000Z" itemprop="datePublished">April 30, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/221" target="_blank" rel="noopener">#221</a></strong></p>
<h2 id="Ignore-a-host"><a href="#Ignore-a-host" class="headerlink" title="Ignore a host"></a>Ignore a host</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionDomains<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>example.com<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSIncludesSubdomains<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionAllowsInsecureHTTPLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionRequiresForwardSecrecy<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionMinimumTLSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>TLSv1.2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionAllowsInsecureHTTPLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionRequiresForwardSecrecy<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionMinimumTLSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>TLSv1.2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSRequiresCertificateTransparency<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Ignore-all"><a href="#Ignore-all" class="headerlink" title="Ignore all"></a>Ignore all</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAllowsArbitraryLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-run-simple-http-server-in-Go"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-run-simple-http-server-in-Go/">How to run simple http server in Go</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-run-simple-http-server-in-Go/" class="article-date">
	  <time datetime="2019-04-30T11:04:16.000Z" itemprop="datePublished">April 30, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/220" target="_blank" rel="noopener">#220</a></strong></p>
<h2 id="Handle-url-parameter"><a href="#Handle-url-parameter" class="headerlink" title="Handle url parameter"></a>Handle url parameter</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"net/http"</span></span><br><span class="line">  <span class="string">"log"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleGreeting</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">  messages, ok := r.URL.Query()[<span class="string">"message"</span>]</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">if</span> !ok || <span class="built_in">len</span>(messages[<span class="number">0</span>]) &lt; <span class="number">1</span> &#123;</span><br><span class="line">    log.Println(<span class="string">"Message is missing"</span>)</span><br><span class="line">    w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  message := messages[<span class="number">0</span>]</span><br><span class="line">  w.Write([]<span class="keyword">byte</span>(message))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  http.HandleFunc(<span class="string">"/greet"</span>, handleGreeting)</span><br><span class="line">  <span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":8080"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Handle-body"><a href="#Handle-body" class="headerlink" title="Handle body"></a>Handle body</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyRequest <span class="keyword">struct</span> &#123;</span><br><span class="line">    Message <span class="keyword">string</span> <span class="string">`json:"message"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">decoder := json.NewDecoder(r.Body)</span><br><span class="line"><span class="keyword">var</span> t EphemeralKeysRequest</span><br><span class="line">err := decoder.Decode(&amp;t)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">message := t.Message</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/">go</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-use-Stripe-and-Apple-Pay-in-iOS"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-use-Stripe-and-Apple-Pay-in-iOS/">How to use Stripe and Apple Pay in iOS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-use-Stripe-and-Apple-Pay-in-iOS/" class="article-date">
	  <time datetime="2019-04-30T09:12:12.000Z" itemprop="datePublished">April 30, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/219" target="_blank" rel="noopener">#219</a></strong></p>
<ul>
<li><a href="https://stripe.com/docs/mobile/ios" target="_blank" rel="noopener">iOS Integration</a></li>
<li><a href="https://developer.apple.com/documentation/passkit/apple_pay/setting_up_apple_pay_requirements" target="_blank" rel="noopener">Setting Up Apple Pay Requirements</a></li>
<li><a href="https://stripe.com/docs/apple-pay" target="_blank" rel="noopener">Apple Pay</a></li>
</ul>
<h2 id="Show-basic-add-card-in-iOS"><a href="#Show-basic-add-card-in-iOS" class="headerlink" title="Show basic add card in iOS"></a>Show basic add card in iOS</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> Stripe</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MainController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showPayment</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> addCardViewController = <span class="type">STPAddCardViewController</span>()</span><br><span class="line">        addCardViewController.delegate = <span class="keyword">self</span></span><br><span class="line">        <span class="keyword">let</span> navigationController = <span class="type">UINavigationController</span>(rootViewController: addCardViewController)</span><br><span class="line"></span><br><span class="line">        present(navigationController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">STPAddCardViewControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addCardViewControllerDidCancel</span><span class="params">(<span class="number">_</span> addCardViewController: STPAddCardViewController)</span></span> &#123;</span><br><span class="line">        dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addCardViewController</span><span class="params">(<span class="number">_</span> addCardViewController: STPAddCardViewController, didCreateToken token: STPToken, completion: @escaping STPErrorBlock)</span></span> &#123;</span><br><span class="line">        <span class="number">_</span> = token.tokenId</span><br><span class="line">        completion(<span class="literal">nil</span>)</span><br><span class="line">        dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Generate-ephemeral-key"><a href="#Generate-ephemeral-key" class="headerlink" title="Generate ephemeral key"></a>Generate ephemeral key</h2><p><a href="https://stripe.com/docs/mobile/ios/standard#ephemeral-key" target="_blank" rel="noopener">https://stripe.com/docs/mobile/ios/standard#ephemeral-key</a></p>
<blockquote>
<p>In order for our prebuilt UI elements to function, you’ll need to provide them with an ephemeral key, a short-lived API key with restricted API access. You can think of an ephemeral key as a session, authorizing the SDK to retrieve and update a specific Customer object for the duration of the session.</p>
</blockquote>
<h3 id="Backend-in-Go"><a href="#Backend-in-Go" class="headerlink" title="Backend in Go"></a>Backend in Go</h3><p><a href="https://github.com/stripe/stripe-go" target="_blank" rel="noopener">https://github.com/stripe/stripe-go</a></p>
<p>Need a secret key by going to <code>Stripe dashboard -&gt; Developers -&gt; API keys -&gt; Secret key</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stripe.Key = &quot;sk_key&quot;</span><br></pre></td></tr></table></figure>

<p>Need customer id. We can manually create one in <code>Stripe dashboard -&gt; Customers</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">	<span class="string">"github.com/stripe/stripe-go"</span></span><br><span class="line">    <span class="string">"github.com/stripe/stripe-go/ephemeralkey"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	stripe.Key = <span class="string">"sk_test_mM2MkqO61n7vvbVRfeYmBgWm00Si2PtWab"</span></span><br><span class="line"></span><br><span class="line">	http.HandleFunc(<span class="string">"/ephemeral_keys"</span>, generateEphemeralKey)</span><br><span class="line">  	<span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":8080"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    	<span class="built_in">panic</span>(err)</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> EphemeralKeysRequest <span class="keyword">struct</span> &#123;</span><br><span class="line">    ApiVersion <span class="keyword">string</span> <span class="string">`json:"api_version"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateEphemeralKey</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	customerId := <span class="string">"cus_Eys6aeP5xR89ab"</span></span><br><span class="line"></span><br><span class="line">	decoder := json.NewDecoder(r.Body)</span><br><span class="line">    <span class="keyword">var</span> t EphemeralKeysRequest</span><br><span class="line">    err := decoder.Decode(&amp;t)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stripeVersion := t.ApiVersion</span><br><span class="line">    <span class="keyword">if</span> stripeVersion == <span class="string">""</span> &#123;</span><br><span class="line">        log.Printf(<span class="string">"Stripe-Version not found\n"</span>)</span><br><span class="line">        w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    params := &amp;stripe.EphemeralKeyParams&#123;</span><br><span class="line">        Customer: stripe.String(customerId),</span><br><span class="line">        StripeVersion: stripe.String(stripeVersion),</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    key, err := ephemeralkey.New(params)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Printf(<span class="string">"Stripe bindings call failed, %v\n"</span>, err)</span><br><span class="line">        w.WriteHeader(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    w.Write(key.RawJSON)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-client"><a href="#iOS-client" class="headerlink" title="iOS client"></a>iOS client</h3><p>Networking client uses <a href="https://github.com/onmyway133/blog/issues/222" target="_blank" rel="noopener">How to make simple networking client in Swift</a></p>
<p>Need an object that conforms to <code>STPCustomerEphemeralKeyProvider</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">EphemeralKeyClient</span>: <span class="title">NSObject</span>, <span class="title">STPCustomerEphemeralKeyProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">NetworkClient</span>(baseUrl: <span class="type">URL</span>(string: <span class="string">"http://localhost:8080"</span>)!)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">createCustomerKey</span><span class="params">(withAPIVersion apiVersion: String, completion: @escaping STPJSONResponseCompletionBlock)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> options = <span class="type">Options</span>()</span><br><span class="line">        options.httpMethod = .post</span><br><span class="line">        options.path = <span class="string">"ephemeral_keys"</span></span><br><span class="line">        options.parameters = [</span><br><span class="line">            <span class="string">"api_version"</span>: apiVersion</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        client.makeJson(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success(<span class="keyword">let</span> json):</span><br><span class="line">                completion(json, <span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                completion(<span class="literal">nil</span>, error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Setting up <code>STPCustomerContext</code> and <code>STPPaymentContext</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MainController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">EphemeralKeyClient</span>()</span><br><span class="line">    <span class="keyword">let</span> customerContext: <span class="type">STPCustomerContext</span></span><br><span class="line">    <span class="keyword">let</span> paymentContext: <span class="type">STPPaymentContext</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.customerContext = <span class="type">STPCustomerContext</span>(keyProvider: client)</span><br><span class="line">        <span class="keyword">self</span>.paymentContext = <span class="type">STPPaymentContext</span>(customerContext: customerContext)</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">        paymentContext.delegate = <span class="keyword">self</span></span><br><span class="line">        paymentContext.hostViewController = <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">start</span><span class="params">()</span></span> &#123;</span><br><span class="line">        paymentContext.presentShippingViewController()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Handle-charge"><a href="#Handle-charge" class="headerlink" title="Handle charge"></a>Handle charge</h2><p><a href="https://stripe.com/docs/charges" target="_blank" rel="noopener">https://stripe.com/docs/charges</a></p>
<h3 id="Backend-in-Go-1"><a href="#Backend-in-Go-1" class="headerlink" title="Backend in Go"></a>Backend in Go</h3><p>If we use <code>stripe_id</code> from card, which has the form of <code>card_xxx</code>, we need to include <code>customer</code> info</p>
<p>If we use <code>token</code>, which has the form <code>tok_xxx</code>, then no need for <code>customer</code> info</p>
<p>From <code>STPPaymentResult</code></p>
<blockquote>
<p>When you’re using <code>STPPaymentContext</code> to request your user’s payment details, this is the object that will be returned to your application when they’ve successfully made a payment. It currently just contains a <code>source</code>, but in the future will include any relevant metadata as well. You should pass <code>source.stripeID</code> to your server, and call the charge creation endpoint. This assumes you are charging a Customer, so you should specify the <code>customer</code> parameter to be that customer’s ID and the <code>source</code> parameter to the value returned here. For more information, see <a href="https://stripe.com/docs/api#create_charge" target="_blank" rel="noopener">https://stripe.com/docs/api#create_charge</a></p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">	<span class="string">"github.com/stripe/stripe-go/charge"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	stripe.Key = <span class="string">"sk_test_mM2MkqO61n7vvbVRfeYmBgWm00Si2PtWab"</span></span><br><span class="line"></span><br><span class="line">	http.HandleFunc(<span class="string">"/request_charge"</span>, handleCharge)</span><br><span class="line">  	<span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":8080"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    	<span class="built_in">panic</span>(err)</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> customerId = <span class="string">"cus_Eys6aeP5xR89ab"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> PaymentResult <span class="keyword">struct</span> &#123;</span><br><span class="line">    StripeId <span class="keyword">string</span> <span class="string">`json:"stripe_id"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleCharge</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	decoder := json.NewDecoder(r.Body)</span><br><span class="line">    <span class="keyword">var</span> t PaymentResult</span><br><span class="line">    err := decoder.Decode(&amp;t)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    params := &amp;stripe.ChargeParams&#123;</span><br><span class="line">        Amount:      stripe.Int64(<span class="number">150</span>),</span><br><span class="line">        Currency:    stripe.String(<span class="keyword">string</span>(stripe.CurrencyUSD)),</span><br><span class="line">		Description: stripe.String(<span class="string">"Charge from my Go backend"</span>),</span><br><span class="line">		Customer: stripe.String(customerId),</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">	params.SetSource(t.StripeId)</span><br><span class="line">    ch, err := charge.New(params)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Fprintf(w, <span class="string">"Could not process payment: %v"</span>, err)</span><br><span class="line">		fmt.Println(ch)</span><br><span class="line">		w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	w.WriteHeader(<span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-client-1"><a href="#iOS-client-1" class="headerlink" title="iOS client"></a>iOS client</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">NetworkClient</span>(baseUrl: <span class="type">URL</span>(string: <span class="string">"http://192.168.210.219:8080"</span>)!)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">requestCharge</span><span class="params">(source: STPSourceProtocol, completion: @escaping <span class="params">(Result&lt;<span class="params">()</span></span></span></span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> options = <span class="type">Options</span>()</span><br><span class="line">        options.httpMethod = .post</span><br><span class="line">        options.path = <span class="string">"request_charge"</span></span><br><span class="line">        options.parameters = [</span><br><span class="line">            <span class="string">"stripe_id"</span>: source.stripeID</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        client.makeJson(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            completion(result.<span class="built_in">map</span>(&#123; <span class="number">_</span> <span class="keyword">in</span> () &#125;))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">paymentContext.requestPayment()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">STPPaymentContextDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentContext</span><span class="params">(<span class="number">_</span> paymentContext: STPPaymentContext, didCreatePaymentResult paymentResult: STPPaymentResult, completion: @escaping STPErrorBlock)</span></span> &#123;</span><br><span class="line">        client.requestCharge(source: paymentResult.source, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success:</span><br><span class="line">                completion(<span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                completion(error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Token-from-card"><a href="#Token-from-card" class="headerlink" title="Token from card"></a>Token from card</h2><p>Use <code>STPAPIClient.shared().createToken</code> to get token from card <a href="https://stripe.com/docs/mobile/ios/custom#collecting-card-details" target="_blank" rel="noopener">https://stripe.com/docs/mobile/ios/custom#collecting-card-details</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cardParams = <span class="type">STPCardParams</span>()</span><br><span class="line">cardParams.number = <span class="string">"4242424242424242"</span></span><br><span class="line">cardParams.expMonth = <span class="number">10</span></span><br><span class="line">cardParams.expYear = <span class="number">2021</span></span><br><span class="line">cardParams.cvc = <span class="string">"123"</span></span><br><span class="line"></span><br><span class="line"><span class="type">STPAPIClient</span>.shared().createToken(withCard: cardParams) &#123; (token: <span class="type">STPToken?</span>, error: <span class="type">Error?</span>) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> token = token, error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Present error to user...</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    submitTokenToBackend(token, completion: &#123; (error: <span class="type">Error?</span>) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">            <span class="comment">// Present error to user...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Continue with payment...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Payment-options-and-shipping-view-controllers"><a href="#Payment-options-and-shipping-view-controllers" class="headerlink" title="Payment options and shipping view controllers"></a>Payment options and shipping view controllers</h2><p>Instead of using <code>paymentContext</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">paymentContext.pushShippingViewController()</span><br><span class="line">paymentContext.pushPaymentOptionsViewController()</span><br></pre></td></tr></table></figure>

<p>We can use view controllers <a href="https://stripe.com/docs/mobile/ios/custom#stppaymentoptionsviewcontroller" target="_blank" rel="noopener">https://stripe.com/docs/mobile/ios/custom#stppaymentoptionsviewcontroller</a> directly with <code>STPPaymentOptionsViewController</code> and <code>STPShippingAddressViewController</code>. Then implement <code>STPPaymentOptionsViewControllerDelegate</code> and <code>STPShippingAddressViewControllerDelegate</code></p>
<h2 id="Register-merchant-Id-and-Apple-Pay-certificate"><a href="#Register-merchant-Id-and-Apple-Pay-certificate" class="headerlink" title="Register merchant Id and Apple Pay certificate"></a>Register merchant Id and Apple Pay certificate</h2><p><a href="https://stripe.com/docs/apple-pay/apps" target="_blank" rel="noopener">https://stripe.com/docs/apple-pay/apps</a></p>
<p>Get Certificate signing request file from Stripe <a href="https://dashboard.stripe.com/account/apple_pay" target="_blank" rel="noopener">https://dashboard.stripe.com/account/apple_pay</a></p>
<p>We can’t register merchant id with Enterprise account</p>
<h2 id="Use-Apple-Pay"><a href="#Use-Apple-Pay" class="headerlink" title="Use Apple Pay"></a>Use Apple Pay</h2><h3 id="Go-backend"><a href="#Go-backend" class="headerlink" title="Go backend"></a>Go backend</h3><p>Use token</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ApplePayRequest <span class="keyword">struct</span> &#123;</span><br><span class="line">    Token <span class="keyword">string</span> <span class="string">`json:"token"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleChargeUsingApplePay</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	decoder := json.NewDecoder(r.Body)</span><br><span class="line">    <span class="keyword">var</span> t ApplePayRequest</span><br><span class="line">    err := decoder.Decode(&amp;t)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    params := &amp;stripe.ChargeParams&#123;</span><br><span class="line">        Amount:      stripe.Int64(<span class="number">150</span>),</span><br><span class="line">        Currency:    stripe.String(<span class="keyword">string</span>(stripe.CurrencyUSD)),</span><br><span class="line">		Description: stripe.String(<span class="string">"Charge from my Go backend for Apple Pay"</span>),</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">	params.SetSource(t.Token)</span><br><span class="line">    ch, err := charge.New(params)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Fprintf(w, <span class="string">"Could not process payment: %v"</span>, err)</span><br><span class="line">		fmt.Println(ch)</span><br><span class="line">		w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	w.WriteHeader(<span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-client-2"><a href="#iOS-client-2" class="headerlink" title="iOS client"></a>iOS client</h3><p>Update client to send <code>STPToken</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentClient</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> client = <span class="type">NetworkClient</span>(baseUrl: <span class="type">URL</span>(string: <span class="string">"localhost:8080"</span>)!)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">requestCharge</span><span class="params">(token: STPToken, completion: @escaping <span class="params">(Result&lt;<span class="params">()</span></span></span></span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> options = <span class="type">Options</span>()</span><br><span class="line">        options.httpMethod = .post</span><br><span class="line">        options.path = <span class="string">"request_charge_apple_pay"</span></span><br><span class="line">        options.parameters = [</span><br><span class="line">            <span class="string">"token"</span>: token.tokenId</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        client.make(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            completion(result.<span class="built_in">map</span>(&#123; <span class="number">_</span> <span class="keyword">in</span> () &#125;))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">useApplePay</span><span class="params">(payment: PKPayment, completion: @escaping <span class="params">(Result&lt;<span class="params">()</span></span></span></span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="type">STPAPIClient</span>.shared().createToken(with: payment, completion: &#123; (token: <span class="type">STPToken?</span>, error: <span class="type">Error?</span>) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> token = token, error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">self</span>.requestCharge(token: token, completion: completion)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Use <code>PKPaymentAuthorizationViewController</code>, not <code>PKPaymentAuthorizationController</code></p>
<p><a href="https://developer.apple.com/documentation/passkit/pkpaymentauthorizationcontroller" target="_blank" rel="noopener">https://developer.apple.com/documentation/passkit/pkpaymentauthorizationcontroller</a></p>
<blockquote>
<p>The PKPaymentAuthorizationController class performs the same role as the PKPaymentAuthorizationViewController class, but it does not depend on the UIKit framework. This means that the authorization controller can be used in places where a view controller cannot (for example, in watchOS apps or in SiriKit extensions).</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showApplePay</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> merchantId = <span class="string">"merchant.com.onmyway133.MyApp"</span></span><br><span class="line">        <span class="keyword">let</span> paymentRequest = <span class="type">Stripe</span>.paymentRequest(withMerchantIdentifier: merchantId, country: <span class="string">"US"</span>, currency: <span class="string">"USD"</span>)</span><br><span class="line">        paymentRequest.paymentSummaryItems = [</span><br><span class="line">            <span class="type">PKPaymentSummaryItem</span>(label: <span class="string">"Rubber duck"</span>, amount: <span class="number">1.5</span>)</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="type">Stripe</span>.canSubmitPaymentRequest(paymentRequest) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">assertionFailure</span>()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> authorizationViewController = <span class="type">PKPaymentAuthorizationViewController</span>(paymentRequest: paymentRequest) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">assertionFailure</span>()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        authorizationViewController.delegate = <span class="keyword">self</span></span><br><span class="line">        innerNavigationController.present(authorizationViewController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">PKPaymentAuthorizationViewControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentAuthorizationViewControllerDidFinish</span><span class="params">(<span class="number">_</span> controller: PKPaymentAuthorizationViewController)</span></span> &#123;</span><br><span class="line">        controller.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentAuthorizationViewController</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> controller: PKPaymentAuthorizationViewController,</span></span></span><br><span class="line"><span class="function"><span class="params">        didAuthorizePayment payment: PKPayment,</span></span></span><br><span class="line"><span class="function"><span class="params">        handler completion: @escaping <span class="params">(PKPaymentAuthorizationResult)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line"></span><br><span class="line">        client.useApplePay(payment: payment, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success:</span><br><span class="line">                completion(.<span class="keyword">init</span>(status: .success, errors: <span class="literal">nil</span>))</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                completion(.<span class="keyword">init</span>(status: .failure, errors: [error]))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Showing-Apple-Pay-option"><a href="#Showing-Apple-Pay-option" class="headerlink" title="Showing Apple Pay option"></a>Showing Apple Pay option</h2><p>From <code>appleMerchantIdentifier</code></p>
<blockquote>
<p>The Apple Merchant Identifier to use during Apple Pay transactions. To create one of these, see our guide at <a href="https://stripe.com/docs/mobile/apple-pay" target="_blank" rel="noopener">https://stripe.com/docs/mobile/apple-pay</a> . You must set this to a valid identifier in order to automatically enable Apple Pay.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="type">Stripe</span>.deviceSupportsApplePay() &#123;</span><br><span class="line">    <span class="type">STPPaymentConfiguration</span>.shared().appleMerchantIdentifier = <span class="string">"merchant.com.onmyway133.MyApp"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">paymentContext.pushPaymentOptionsViewController()</span><br></pre></td></tr></table></figure>

<h2 id="requestPayment-not-showing-UI"><a href="#requestPayment-not-showing-UI" class="headerlink" title="requestPayment not showing UI"></a>requestPayment not showing UI</h2><p>From <code>requestPayment</code></p>
<blockquote>
<p>Requests payment from the user. This may need to present some supplemental UI to the user, in which case it will be presented on the payment context’s <code>hostViewController</code>. For instance, if they’ve selected Apple Pay as their payment method, calling this method will show the payment sheet. If the user has a card on file, this will use that without presenting any additional UI. After this is called, the <code>paymentContext:didCreatePaymentResult:completion:</code> and <code>paymentContext:didFinishWithStatus:error:</code> methods will be called on the context’s <code>delegate</code>.</p>
</blockquote>
<p>Use <code>STPPaymentOptionsViewController</code> to show cards and Apple Pay options</p>
<p>Code for <code>requestPayment</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)requestPayment &#123;</span><br><span class="line">    WEAK(<span class="keyword">self</span>);</span><br><span class="line">    [[[<span class="keyword">self</span>.didAppearPromise voidFlatMap:^STPPromise * _Nonnull&#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.loadingPromise;</span><br><span class="line">    &#125;] onSuccess:^(__unused STPPaymentOptionTuple *tuple) &#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.state != STPPaymentContextStateNone) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>.selectedPaymentOption) &#123;</span><br><span class="line">            [<span class="keyword">self</span> presentPaymentOptionsViewControllerWithNewState:STPPaymentContextStateRequestingPayment];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span> requestPaymentShouldPresentShippingViewController]) &#123;</span><br><span class="line">            [<span class="keyword">self</span> presentShippingViewControllerWithNewState:STPPaymentContextStateRequestingPayment];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span>.selectedPaymentOption isKindOfClass:[STPCard <span class="keyword">class</span>]] ||</span><br><span class="line">                 [<span class="keyword">self</span>.selectedPaymentOption isKindOfClass:[STPSource <span class="keyword">class</span>]]) &#123;</span><br><span class="line">            <span class="keyword">self</span>.state = STPPaymentContextStateRequestingPayment;</span><br><span class="line">            STPPaymentResult *result = [[STPPaymentResult alloc] initWithSource:(<span class="keyword">id</span>&lt;STPSourceProtocol&gt;)<span class="keyword">self</span>.selectedPaymentOption];</span><br><span class="line">            [<span class="keyword">self</span>.delegate paymentContext:<span class="keyword">self</span> didCreatePaymentResult:result completion:^(<span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">                stpDispatchToMainThreadIfNecessary(^&#123;</span><br><span class="line">                    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                        [<span class="keyword">self</span> didFinishWithStatus:STPPaymentStatusError error:error];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        [<span class="keyword">self</span> didFinishWithStatus:STPPaymentStatusSuccess error:<span class="literal">nil</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span>.selectedPaymentOption isKindOfClass:[STPApplePayPaymentOption <span class="keyword">class</span>]]) &#123;</span><br><span class="line">      <span class="comment">// ....</span></span><br></pre></td></tr></table></figure>

<h2 id="Payment-options"><a href="#Payment-options" class="headerlink" title="Payment options"></a>Payment options</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">paymentOptionsViewController</span><span class="params">(<span class="number">_</span> paymentOptionsViewController: STPPaymentOptionsViewController, didSelect paymentOption: STPPaymentOption)</span></span> &#123;</span><br><span class="line">	<span class="comment">// No op</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>After user selects payment option, the change is saved in dashboard <code>https://dashboard.stripe.com/test/customers</code>, but for card only. Select Apple Pay does not reflect change in web dashboard.</p>
<p>Apple pay option is added manually locally, from <code>STPCustomer+SourceTuple.m</code> 😲</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (STPPaymentOptionTuple *)filteredSourceTupleForUIWithConfiguration:(STPPaymentConfiguration *)configuration &#123;</span><br><span class="line">    <span class="keyword">id</span>&lt;STPPaymentOption&gt; _Nullable selectedMethod = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSMutableArray</span>&lt;<span class="keyword">id</span>&lt;STPPaymentOption&gt;&gt; *methods = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">id</span>&lt;STPSourceProtocol&gt; customerSource <span class="keyword">in</span> <span class="keyword">self</span>.sources) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([customerSource isKindOfClass:[STPCard <span class="keyword">class</span>]]) &#123;</span><br><span class="line">            STPCard *card = (STPCard *)customerSource;</span><br><span class="line">            [methods addObject:card];</span><br><span class="line">            <span class="keyword">if</span> ([card.stripeID isEqualToString:<span class="keyword">self</span>.defaultSource.stripeID]) &#123;</span><br><span class="line">                selectedMethod = card;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ([customerSource isKindOfClass:[STPSource <span class="keyword">class</span>]]) &#123;</span><br><span class="line">            STPSource *source = (STPSource *)customerSource;</span><br><span class="line">            <span class="keyword">if</span> (source.type == STPSourceTypeCard</span><br><span class="line">                &amp;&amp; source.cardDetails != <span class="literal">nil</span>) &#123;</span><br><span class="line">                [methods addObject:source];</span><br><span class="line">                <span class="keyword">if</span> ([source.stripeID isEqualToString:<span class="keyword">self</span>.defaultSource.stripeID]) &#123;</span><br><span class="line">                    selectedMethod = source;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [STPPaymentOptionTuple tupleWithPaymentOptions:methods</span><br><span class="line">                                    selectedPaymentOption:selectedMethod</span><br><span class="line">                                        addApplePayOption:configuration.applePayEnabled];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>STPApplePayPaymentOption<code>is not available in</code>paymentContext.paymentOptions` immediately</p>
<h2 id="Change-selected-payment-option"><a href="#Change-selected-payment-option" class="headerlink" title="Change selected payment option"></a>Change selected payment option</h2><p>In <code>STPPaymentContext</code></p>
<p><code>setSelectedPaymentOption</code> is read only and trigger <code>paymentContextDidChange</code>, but it checks if <code>the new selected payment option</code> is equal to existing selected payment option</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setSelectedPaymentOption:(<span class="keyword">id</span>&lt;STPPaymentOption&gt;)selectedPaymentOption &#123;</span><br><span class="line">    <span class="keyword">if</span> (selectedPaymentOption &amp;&amp; ![<span class="keyword">self</span>.paymentOptions containsObject:selectedPaymentOption]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.paymentOptions = [<span class="keyword">self</span>.paymentOptions arrayByAddingObject:selectedPaymentOption];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (![_selectedPaymentOption isEqual:selectedPaymentOption]) &#123;</span><br><span class="line">        _selectedPaymentOption = selectedPaymentOption;</span><br><span class="line">        stpDispatchToMainThreadIfNecessary(^&#123;</span><br><span class="line">            [<span class="keyword">self</span>.delegate paymentContextDidChange:<span class="keyword">self</span>];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>There is <code>retryLoading</code> which is called at <code>init</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)retryLoading &#123;</span><br><span class="line">    <span class="comment">// Clear any cached customer object before refetching</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.apiAdapter isKindOfClass:[STPCustomerContext <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        STPCustomerContext *customerContext = (STPCustomerContext *)<span class="keyword">self</span>.apiAdapter;</span><br><span class="line">        [customerContext clearCachedCustomer];</span><br><span class="line">    &#125;</span><br><span class="line">    WEAK(<span class="keyword">self</span>);</span><br><span class="line">    <span class="keyword">self</span>.loadingPromise = [[[STPPromise&lt;STPPaymentOptionTuple *&gt; new] onSuccess:^(STPPaymentOptionTuple *tuple) &#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">self</span>.paymentOptions = tuple.paymentOptions;</span><br><span class="line">        <span class="keyword">self</span>.selectedPaymentOption = tuple.selectedPaymentOption;</span><br><span class="line">    &#125;] onFailure:^(<span class="built_in">NSError</span> * _Nonnull error) &#123;</span><br><span class="line">        STRONG(<span class="keyword">self</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.hostViewController) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.didAppearPromise onSuccess:^(__unused <span class="keyword">id</span> value) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">self</span>.paymentOptionsViewController) &#123;</span><br><span class="line">                    [<span class="keyword">self</span> appropriatelyDismissPaymentOptionsViewController:<span class="keyword">self</span>.paymentOptionsViewController completion:^&#123;</span><br><span class="line">                        [<span class="keyword">self</span>.delegate paymentContext:<span class="keyword">self</span> didFailToLoadWithError:error];</span><br><span class="line">                    &#125;];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    [<span class="keyword">self</span>.delegate paymentContext:<span class="keyword">self</span> didFailToLoadWithError:error];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    [<span class="keyword">self</span>.apiAdapter retrieveCustomer:^(STPCustomer * _Nullable customer, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        stpDispatchToMainThreadIfNecessary(^&#123;</span><br><span class="line">            STRONG(<span class="keyword">self</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                [<span class="keyword">self</span>.loadingPromise fail:error];</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">self</span>.shippingAddress &amp;&amp; customer.shippingAddress) &#123;</span><br><span class="line">                <span class="keyword">self</span>.shippingAddress = customer.shippingAddress;</span><br><span class="line">                <span class="keyword">self</span>.shippingAddressNeedsVerification = <span class="literal">YES</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            STPPaymentOptionTuple *paymentTuple = [customer filteredSourceTupleForUIWithConfiguration:<span class="keyword">self</span>.configuration];</span><br><span class="line"></span><br><span class="line">            [<span class="keyword">self</span>.loadingPromise succeed:paymentTuple];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Which in turns call <code>STPCustomerEphemeralKeyProvider</code>. As stripe does not save Apple Pay option in dashboard, this method return list of card payment options, together with the default card as selected payment option 😲</p>
<p>Although the new <code>STPCard</code> has a different address, it is the exact same card with the same info, and the <code>isEqual</code> method of <code>STPCard</code> is</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)isEqualToCard:(<span class="keyword">nullable</span> STPCard *)other &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> == other) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!other || ![other isKindOfClass:<span class="keyword">self</span>.class]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>.stripeID isEqualToString:other.stripeID];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I raised an issue <a href="https://github.com/stripe/stripe-ios/issues/1175" target="_blank" rel="noopener">How to change selected payment option?</a> hope it gets resolved soon 😢</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-test-PublishSubject-in-RxSwift"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-test-PublishSubject-in-RxSwift/">How to test PublishSubject in RxSwift</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-test-PublishSubject-in-RxSwift/" class="article-date">
	  <time datetime="2019-04-29T12:12:34.000Z" itemprop="datePublished">April 29, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/218" target="_blank" rel="noopener">#218</a></strong></p>
<ul>
<li>RxBlocking does not work with Variable and PublishSubject, see <a href="https://github.com/ReactiveX/RxSwift/blob/0b66f666ba6955a51cba1ad530311b030fa4db9c/Tests/RxSwiftTests/Observable%2BSubscriptionTest.swift#L165" target="_blank" rel="noopener">https://github.com/ReactiveX/RxSwift/blob/0b66f666ba6955a51cba1ad530311b030fa4db9c/Tests/RxSwiftTests/Observable%2BSubscriptionTest.swift#L165</a></li>
</ul>
<h2 id="Use-homemade-Recorder"><a href="#Use-homemade-Recorder" class="headerlink" title="Use homemade Recorder"></a>Use homemade <code>Recorder</code></h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Recorder</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> items = [<span class="type">T</span>]()</span><br><span class="line">    <span class="keyword">let</span> bag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">on</span><span class="params">(arraySubject: PublishSubject&lt;[T]&gt;)</span></span> &#123;</span><br><span class="line">        arraySubject.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.items = value</span><br><span class="line">        &#125;).disposed(by: bag)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">on</span><span class="params">(valueSubject: PublishSubject&lt;T&gt;)</span></span> &#123;</span><br><span class="line">        valueSubject.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.items.append(value)</span><br><span class="line">        &#125;).disposed(by: bag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then test</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">BookViewModelTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testBooks</span><span class="params">()</span></span> <span class="keyword">throws</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> expectation = <span class="keyword">self</span>.expectation(description: #function)</span><br><span class="line">        <span class="keyword">let</span> recorder = <span class="type">Recorder</span>&lt;<span class="type">Book</span>&gt;()</span><br><span class="line">        <span class="keyword">let</span> viewModel = <span class="type">BookViewModel</span>(bookClient: <span class="type">MockBookClient</span>())</span><br><span class="line">        recorder.on(arraySubject: viewModel.books)</span><br><span class="line">        viewModel.load()</span><br><span class="line"></span><br><span class="line">        <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: <span class="type">DispatchTime</span>.now() + <span class="number">0.5</span>, execute: &#123;</span><br><span class="line">            expectation.fulfill()</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        wait(<span class="keyword">for</span>: [expectation], timeout: <span class="number">2</span>)</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(recorder.items.<span class="built_in">count</span>, <span class="number">3</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Need to use great <code>timeout</code> value as <code>DispatchQueue</code> is not guaranteed to be precise, a block needs to wait for the queue to be empty before it can be executed</p>
<h2 id="Make-expectation-less-cumbersome"><a href="#Make-expectation-less-cumbersome" class="headerlink" title="Make expectation less cumbersome"></a>Make <code>expectation</code> less cumbersome</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">waitOrFail</span><span class="params">(timeout: TimeInterval)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> expectation = <span class="keyword">self</span>.expectation(description: #function)</span><br><span class="line"></span><br><span class="line">        <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: <span class="type">DispatchTime</span>.now() + timeout, execute: &#123;</span><br><span class="line">            expectation.fulfill()</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        wait(<span class="keyword">for</span>: [expectation], timeout: timeout + <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rx/">rx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-How-to-fix-not-found-zlib-problem-in-macOS-Mojave"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/blog/How-to-fix-not-found-zlib-problem-in-macOS-Mojave/">How to fix not found zlib problem in macOS Mojave</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/blog/How-to-fix-not-found-zlib-problem-in-macOS-Mojave/" class="article-date">
	  <time datetime="2019-04-29T07:36:45.000Z" itemprop="datePublished">April 29, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/217" target="_blank" rel="noopener">#217</a></strong></p>
<p><a href="https://developer.apple.com/documentation/xcode_release_notes/xcode_10_release_notes" target="_blank" rel="noopener">https://developer.apple.com/documentation/xcode_release_notes/xcode_10_release_notes</a></p>
<blockquote>
<p>The command line tools will search the SDK for system headers by default. However, some software may fail to build correctly against the SDK and require macOS headers to be installed in the base system under /usr/include. If you are the maintainer of such software, we encourage you to update your project to work with the SDK or file a bug report for issues that are preventing you from doing so. As a workaround, an extra package is provided which will install the headers to the base system. In a future release, this package will no longer be provided. You can find this package at:</p>
</blockquote>
<blockquote>
<p>/Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg</p>
</blockquote>
<blockquote>
<p> To make sure that you’re using the intended version of the command line tools, run xcode-select -s <path to xcode> or xcode select -s /Library/Developer/CommandLineTools after installing.</path></p>
</blockquote>
<p>Run </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macOS/">macOS</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/10/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/12/">Next</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div class="widget-wrap" style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 75%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 42px;" placeholder=" Search…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="Search">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Ohayou</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
          
     			  <li><a href="https://github.com/onmyway133" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="https://twitter.com/onmyway133" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 
          
   		
          
            <li><a href="mailto:onmyway133@gmail.com?subject=Hello&body=World" title="email"><i class="fa fa-envelope" aria-hidden="true"></i></a></li> 
          
   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>Recent Posts</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-handle-radio-group-for-NSButton/">How to handle radio group for NSButton</a></h6>
              <span>January 17, 2020</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-specify-locale-in-Swift/">How to specify locale in Swift</a></h6>
              <span>January 14, 2020</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-workaround-URLSession-issue-in-watchOS-6.1.1/">How to workaround URLSession issue in watchOS 6.1.1</a></h6>
              <span>January 13, 2020</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-generate-XCTest-test-methods/">How to generate XCTest test methods</a></h6>
              <span>January 12, 2020</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-use-ObjC-in-Swift-Package-Manager/">How to use ObjC in Swift Package Manager</a></h6>
              <span>January 11, 2020</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/blog/How-to-expression-cast-type-in-lldb-in-Swit/">How to expression cast type in lldb in Swit</a></h6>
              <span>January 10, 2020</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/android/" style="font-size: 17.65px;">android</a> <a href="/tags/apple-script/" style="font-size: 11.18px;">apple script</a> <a href="/tags/catalyst/" style="font-size: 10px;">catalyst</a> <a href="/tags/ci/" style="font-size: 11.18px;">ci</a> <a href="/tags/cloud/" style="font-size: 10.59px;">cloud</a> <a href="/tags/cocoapods/" style="font-size: 11.76px;">cocoapods</a> <a href="/tags/combine/" style="font-size: 11.76px;">combine</a> <a href="/tags/csharp/" style="font-size: 10px;">csharp</a> <a href="/tags/css/" style="font-size: 10.59px;">css</a> <a href="/tags/dart/" style="font-size: 11.76px;">dart</a> <a href="/tags/database/" style="font-size: 10.59px;">database</a> <a href="/tags/design/" style="font-size: 10.59px;">design</a> <a href="/tags/electron/" style="font-size: 11.76px;">electron</a> <a href="/tags/firebase/" style="font-size: 11.76px;">firebase</a> <a href="/tags/flutter/" style="font-size: 11.76px;">flutter</a> <a href="/tags/git/" style="font-size: 11.18px;">git</a> <a href="/tags/github/" style="font-size: 12.35px;">github</a> <a href="/tags/go/" style="font-size: 10.59px;">go</a> <a href="/tags/google/" style="font-size: 10px;">google</a> <a href="/tags/iOS/" style="font-size: 19.41px;">iOS</a> <a href="/tags/javascript/" style="font-size: 18.24px;">javascript</a> <a href="/tags/kotlin/" style="font-size: 17.06px;">kotlin</a> <a href="/tags/layout/" style="font-size: 11.76px;">layout</a> <a href="/tags/life/" style="font-size: 13.53px;">life</a> <a href="/tags/links/" style="font-size: 13.53px;">links</a> <a href="/tags/macOS/" style="font-size: 18.82px;">macOS</a> <a href="/tags/machine-learning/" style="font-size: 10.59px;">machine learning</a> <a href="/tags/maps/" style="font-size: 11.76px;">maps</a> <a href="/tags/networking/" style="font-size: 10px;">networking</a> <a href="/tags/node/" style="font-size: 12.94px;">node</a> <a href="/tags/objc/" style="font-size: 10.59px;">objc</a> <a href="/tags/react/" style="font-size: 11.18px;">react</a> <a href="/tags/react-native/" style="font-size: 14.71px;">react native</a> <a href="/tags/realm/" style="font-size: 10px;">realm</a> <a href="/tags/rx/" style="font-size: 11.18px;">rx</a> <a href="/tags/script/" style="font-size: 10.59px;">script</a> <a href="/tags/spm/" style="font-size: 12.35px;">spm</a> <a href="/tags/swift/" style="font-size: 20px;">swift</a> <a href="/tags/swiftUI/" style="font-size: 16.47px;">swiftUI</a> <a href="/tags/tech/" style="font-size: 15.29px;">tech</a> <a href="/tags/terminal/" style="font-size: 13.53px;">terminal</a> <a href="/tags/testing/" style="font-size: 12.94px;">testing</a> <a href="/tags/tool/" style="font-size: 10px;">tool</a> <a href="/tags/unity/" style="font-size: 10px;">unity</a> <a href="/tags/voip/" style="font-size: 11.76px;">voip</a> <a href="/tags/watchOS/" style="font-size: 14.12px;">watchOS</a> <a href="/tags/web/" style="font-size: 10.59px;">web</a> <a href="/tags/wwdc/" style="font-size: 10.59px;">wwdc</a> <a href="/tags/xcode/" style="font-size: 15.88px;">xcode</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">36</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">38</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">49</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">50</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">40</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">47</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">24</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">35</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apple-script/">apple script</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/catalyst/">catalyst</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ci/">ci</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/">cloud</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cocoapods/">cocoapods</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/combine/">combine</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/">csharp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dart/">dart</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/">electron</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firebase/">firebase</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flutter/">flutter</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google/">google</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a><span class="tag-list-count">149</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kotlin/">kotlin</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/layout/">layout</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/links/">links</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macOS/">macOS</a><span class="tag-list-count">72</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/">machine learning</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maps/">maps</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/networking/">networking</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/objc/">objc</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react-native/">react native</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/realm/">realm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rx/">rx</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/script/">script</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spm/">spm</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swift/">swift</a><span class="tag-list-count">219</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swiftUI/">swiftUI</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/">tech</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/terminal/">terminal</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/testing/">testing</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/">tool</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unity/">unity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/voip/">voip</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/watchOS/">watchOS</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wwdc/">wwdc</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xcode/">xcode</a><span class="tag-list-count">19</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2020 onmyway133 All Rights Reserved.
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about/" class="mobile-nav-link">About</a>
  
    <a href="/writing/" class="mobile-nav-link">Writing</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/speaking/" class="mobile-nav-link">Speaking</a>
  
    <a href="/opensource/" class="mobile-nav-link">Open Source</a>
  
    <a href="/projects/" class="mobile-nav-link">Projects</a>
  
    <a href="/news/" class="mobile-nav-link">News</a>
  
    <a href="/gumroad/" class="mobile-nav-link">Gumroad</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-40119591-5', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->












  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
