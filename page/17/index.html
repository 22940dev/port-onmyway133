<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-26T13:23:03.000Z" title="2019-03-26T13:23:03.000Z">2019-03-26</time><span class="level-item">3 minutes read (About 477 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-do-clustering-with-Google-Maps-in-iOS/">How to do clustering with Google Maps in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/191">#191</a></strong></p>
<h2 id="Basic-with-Google-Maps"><a href="#Basic-with-Google-Maps" class="headerlink" title="Basic with Google Maps"></a>Basic with Google Maps</h2><p>Add to Podfile <code>pod &#39;GoogleMaps&#39;</code></p>
<p>Add a custom marker</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> GoogleMaps</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StopMarker</span>: <span class="title">GMSMarker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> stop: <span class="type">Stop</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(stop: <span class="type">Stop</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.stop = stop</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        <span class="keyword">self</span>.title = stop.name</span><br><span class="line">        <span class="keyword">self</span>.position = stop.toCoordinate()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">30</span>, height: <span class="number">30</span>))</span><br><span class="line">        imageView.layer.cornerRadius = <span class="number">15</span></span><br><span class="line">        imageView.image = <span class="type">UIImage</span>(named: <span class="string">"pin"</span>)</span><br><span class="line">        <span class="keyword">self</span>.iconView = imageView</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Show markers</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(stops: [Stop])</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.stops = stops</span><br><span class="line">    stops</span><br><span class="line">        .<span class="built_in">map</span>(&#123; <span class="type">StopMarker</span>(stop: $<span class="number">0</span>) &#125;)</span><br><span class="line">        .forEach &#123;</span><br><span class="line">            $<span class="number">0</span>.<span class="built_in">map</span> = mapView</span><br><span class="line">        &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Assigning <code>$0.map = mapView</code> means telling <code>GMSMapView</code> to start rendering markers</p>
<p>Handle tap</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">GMSMapViewDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapView</span><span class="params">(<span class="number">_</span> mapView: GMSMapView, didTap marker: GMSMarker)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        zoomIn(coordinate: marker.position)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapView</span><span class="params">(<span class="number">_</span> mapView: GMSMapView, didTapInfoWindowOf marker: GMSMarker)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> stopMarker = marker <span class="keyword">as</span>? <span class="type">StopMarker</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> detailViewController = <span class="type">StopDetailViewController</span>(stop: stopMarker.stop)</span><br><span class="line">        presentPanModal(detailViewController)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Clustering"><a href="#Clustering" class="headerlink" title="Clustering"></a>Clustering</h2><p>Add google-maps-ios-utils manually by following <a href="https://github.com/googlemaps/google-maps-ios-utils/blob/master/Swift.md">https://github.com/googlemaps/google-maps-ios-utils/blob/master/Swift.md</a></p>
<p>Otherwise, with CocoaPods, we get error</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[!] The &#39;Pods-MyApp&#39; target has transitive dependencies that include static binaries: (&#x2F;Users&#x2F;khoa&#x2F;Projects&#x2F;MyApp&#x2F;Pods&#x2F;GoogleMaps&#x2F;Base&#x2F;Frameworks&#x2F;GoogleMapsBase.framework, &#x2F;Users&#x2F;khoa&#x2F;Projects&#x2F;MyApp&#x2F;Pods&#x2F;GoogleMaps&#x2F;Maps&#x2F;Frameworks&#x2F;GoogleMaps.framework, and &#x2F;Users&#x2F;khoa&#x2F;Projects&#x2F;MyApp&#x2F;Pods&#x2F;GoogleMaps&#x2F;Maps&#x2F;Frameworks&#x2F;GoogleMapsCore.framework)</span><br></pre></td></tr></table></figure>

<p>Add <code>ClusterItem</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> CoreLocation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClusterItem</span>: <span class="title">NSObject</span>, <span class="title">GMUClusterItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> position: <span class="type">CLLocationCoordinate2D</span></span><br><span class="line">    <span class="keyword">let</span> stop: <span class="type">Stop</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(stop: <span class="type">Stop</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.stop = stop</span><br><span class="line">        <span class="keyword">self</span>.position = stop.toCoordinate()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Set up cluster manager</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iconGenerator = <span class="type">GMUDefaultClusterIconGenerator</span>()</span><br><span class="line"><span class="keyword">let</span> algorithm = <span class="type">GMUNonHierarchicalDistanceBasedAlgorithm</span>()</span><br><span class="line"><span class="keyword">let</span> renderer = <span class="type">GMUDefaultClusterRenderer</span>(mapView: mapView, clusterIconGenerator: iconGenerator)</span><br><span class="line">renderer.delegate = <span class="keyword">self</span></span><br><span class="line">clusterManager = <span class="type">GMUClusterManager</span>(<span class="built_in">map</span>: mapView, algorithm: algorithm, renderer: renderer)</span><br><span class="line">clusterManager.setDelegate(<span class="keyword">self</span>, mapDelegate: <span class="keyword">self</span>)</span><br></pre></td></tr></table></figure>

<p>Default algorithm <code>GMUNonHierarchicalDistanceBasedAlgorithm</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">A simple clustering algorithm with O(nlog n) performance. Resulting clusters are not</span><br><span class="line">* hierarchical.</span><br><span class="line">* High level algorithm:</span><br><span class="line">* 1. Iterate over items in the order they were added (candidate clusters).</span><br><span class="line">* 2. Create a cluster with the center of the item.</span><br><span class="line">* 3. Add all items that are within a certain distance to the cluster.</span><br><span class="line">* 4. Move any items out of an existing cluster if they are closer to another cluster.</span><br><span class="line">* 5. Remove those items from the list of candidate clusters.</span><br><span class="line">* Clusters have the center of the first element (not the centroid of the items within it).</span><br></pre></td></tr></table></figure>


<p>Make <code>ClusterItem</code> and add to <code>clusterManager</code>. In the end, call <code>clusterManager.cluster()</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(stops: [Stop])</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.stops = stops</span><br><span class="line">    stops</span><br><span class="line">        .<span class="built_in">map</span>(&#123; <span class="type">StopMarker</span>(stop: $<span class="number">0</span>) &#125;)</span><br><span class="line">        .forEach &#123;</span><br><span class="line">            <span class="keyword">let</span> item = <span class="type">ClusterItem</span>(stop: $<span class="number">0</span>.stop)</span><br><span class="line">            clusterManager.add(item)</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    clusterManager.cluster()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>By default, clusterManager uses renderer to render default pin marker. Implement <code>GMUClusterRendererDelegate</code> to use our custom <code>StopMarker</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">GMUClusterRendererDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">renderer</span><span class="params">(<span class="number">_</span> renderer: GMUClusterRenderer, markerFor object: <span class="keyword">Any</span>)</span></span> -&gt; <span class="type">GMSMarker?</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> object &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> clusterItem <span class="keyword">as</span> <span class="type">ClusterItem</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">StopMarker</span>(stop: clusterItem.stop)</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Finally handle tapping on cluster and cluster item</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">GMUClusterManagerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">clusterManager</span><span class="params">(<span class="number">_</span> clusterManager: GMUClusterManager, didTap cluster: GMUCluster)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"tap cluster"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">clusterManager</span><span class="params">(<span class="number">_</span> clusterManager: GMUClusterManager, didTap clusterItem: GMUClusterItem)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"tap cluster item"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-25T12:51:01.000Z" title="2019-03-25T12:51:01.000Z">2019-03-25</time><span class="level-item">a few seconds read (About 27 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-file-picker-in-React/">How to handle file picker in React</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/190">#190</a></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  &lt;Button color=<span class="string">"inherit"</span> onClick=&#123;<span class="keyword">this</span>.onImagePress&#125; &gt;Image&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;input ref="fileInput" type="file" id="myFile" multiple accept="image/</span>*<span class="string">" style=&#123;&#123;display: 'none'&#125;&#125; onChange=&#123;this.handleFiles&#125;&gt;&lt;/input&gt;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">onImagePress = () =&gt; &#123;</span></span><br><span class="line"><span class="string">  const fileInput = this.refs.fileInput</span></span><br><span class="line"><span class="string">  fileInput.click()</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">handleFiles = (e) =&gt; &#123;</span></span><br><span class="line"><span class="string">  e.persist()</span></span><br><span class="line"><span class="string">  const file = e.target.files[0]</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-25T07:19:13.000Z" title="2019-03-25T07:19:13.000Z">2019-03-25</time><span class="level-item">a few seconds read (About 23 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/OSS/">OSS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/189">#189</a></strong></p>
<ul>
<li><a href="https://github.com/digipost/ios">https://github.com/digipost/ios</a></li>
<li><a href="https://github.com/wwdc/2019">https://github.com/wwdc/2019</a></li>
<li><a href="https://github.com/google/science-journal-ios">https://github.com/google/science-journal-ios</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-25T07:19:13.000Z" title="2019-03-25T07:19:13.000Z">2019-03-25</time><span class="level-item">a few seconds read (About 23 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Links-for-OSS/">Links for OSS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/189">#189</a></strong></p>
<ul>
<li><a href="https://github.com/digipost/ios">https://github.com/digipost/ios</a></li>
<li><a href="https://github.com/wwdc/2019">https://github.com/wwdc/2019</a></li>
<li><a href="https://github.com/google/science-journal-ios">https://github.com/google/science-journal-ios</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-24T20:17:22.000Z" title="2019-03-24T20:17:22.000Z">2019-03-24</time><span class="level-item">a minute read (About 142 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-ApiException-10-in-Flutter-for-Android/">How to fix ApiException  10 in Flutter for Android</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/188">#188</a></strong></p>
<p>Get error <code>com.google.android.gms.common.api.ApiException: 10</code> with <code>google_sign_in</code> package.</p>
<p>Read <a href="https://developers.google.com/android/guides/client-auth">https://developers.google.com/android/guides/client-auth</a></p>
<blockquote>
<p>Certain Google Play services (such as Google Sign-in and App Invites) require you to provide the SHA-1 of your signing certificate so we can create an OAuth2 client and API key for your app</p>
</blockquote>
<p>console.developers.google.com/apis/credentials</p>
<p>Credentials -&gt; OAuth client id<br>If we specify SHA1 in firebase, then <code>console.developers.google.com</code> will generate an Android oauth for us</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore &#123;keystore_name&#125; -<span class="built_in">alias</span> &#123;alias_name&#125;</span><br></pre></td></tr></table></figure>

<p>Use correct keystore for debug and release</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Add your own signing config for the release build.</span></span><br><span class="line">            <span class="comment">// Signing with the debug keys for now, so `flutter run --release` works.</span></span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">        &#125;</span><br><span class="line">        debug &#123;</span><br><span class="line">            signingConfig signingConfigs.debug</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-24T20:12:58.000Z" title="2019-03-24T20:12:58.000Z">2019-03-24</time><span class="level-item">a minute read (About 123 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-Google-account-photo-in-Flutter/">How to get Google account photo in Flutter</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/187">#187</a></strong></p>
<p>If you use Flutter, then you can access it via <code>people.googleapis.com</code> endpoint, code uses <code>google_sign_in</code> library</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:google_sign_in/google_sign_in.dart'</span>;</span><br><span class="line"></span><br><span class="line">Future&lt;<span class="built_in">String</span>&gt; getPhotoUrl(GoogleSignInAccount account, <span class="built_in">String</span> userId) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="comment">// final authentication = await account.authentication;</span></span><br><span class="line">  <span class="keyword">final</span> url = <span class="string">'https://people.googleapis.com/v1/people/<span class="subst">$&#123;userId&#125;</span>?personFields=photos'</span>;</span><br><span class="line">  <span class="keyword">final</span> response = <span class="keyword">await</span> http.<span class="keyword">get</span>(</span><br><span class="line">    url,</span><br><span class="line">    headers: <span class="keyword">await</span> account.authHeaders</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> data = json.decode(response.body);</span><br><span class="line">  <span class="keyword">return</span> data[<span class="string">'photos'</span>].first[<span class="string">'url'</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You will get something like</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  resourceName: people/<span class="number">998812322529259873423</span>, </span><br><span class="line">  etag: %EgQBAzcabcQBAgUH, </span><br><span class="line">  photos: [&#123;<span class="attr">metadata</span>: &#123;<span class="attr">primary</span>: <span class="literal">true</span>, <span class="attr">source</span>: &#123;<span class="attr">type</span>: PROFILE, <span class="attr">id</span>: <span class="number">107721622529987673423</span>&#125;&#125;, </span><br><span class="line">  url: https:<span class="comment">//lh3.googleusercontent.com/a-/abcdefmB2p1VWxLsNT9WSV0yqwuwo6o2Ba21sh_ra7CnrZ=s100&#125;]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>where url is an accessible image url.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-24T20:08:58.000Z" title="2019-03-24T20:08:58.000Z">2019-03-24</time><span class="level-item">3 minutes read (About 400 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Getting-activity-name-through-HKWorkoutActivityType-in-HealthKit/">Getting activity name through HKWorkoutActivityType in HealthKit</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/186">#186</a></strong></p>
<p>After fetching workouts with HKObjectType.workoutType() , we get <a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype">HKWorkoutActivityType</a> , which is an enum enum HKWorkoutActivityType : <a href="https://developer.apple.com/documentation/swift/uint">UInt</a> . As of Swift 4.2, there are no way to get enum case as String because this enum has type UInt .</p>
<p>Though there will be some manual involved, we can build a generator to get all the enum case names. Here we will write code to generate code, and use that generated code to examine all the values.</p>
<p>Execute this Swift code in our iOS app</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeCode</span><span class="params">(string: String)</span></span> &#123;</span><br><span class="line">   <span class="keyword">let</span> pattern = “<span class="keyword">case</span> \\w*”</span><br><span class="line">   <span class="keyword">let</span> range = <span class="type">NSMakeRange</span>(<span class="number">0</span>, string.<span class="built_in">count</span>-<span class="number">1</span>)</span><br><span class="line">   <span class="keyword">let</span> regex = <span class="keyword">try</span>! <span class="type">NSRegularExpression</span>(pattern: pattern, options: [])</span><br><span class="line">   regex</span><br><span class="line">   .matches(<span class="keyword">in</span>: string, options: [], range: range)</span><br><span class="line">   .forEach(&#123; result <span class="keyword">in</span></span><br><span class="line">   <span class="keyword">let</span> start = string.index(string.startIndex, offsetBy: result.range.lowerBound)</span><br><span class="line">   <span class="keyword">let</span> end = string.index(string.startIndex, offsetBy: result.range.upperBound)</span><br><span class="line">   <span class="keyword">let</span> substring = <span class="type">String</span>(string[start…end])</span><br><span class="line">   <span class="keyword">let</span> name = substring</span><br><span class="line">   .replacingOccurrences(of: “<span class="keyword">case</span>”, with: “”)</span><br><span class="line">   .replacingOccurrences(of: “ “, with: “”)</span><br><span class="line">   .replacingOccurrences(of: “\n”, with: “”</span><br><span class="line">  <span class="built_in">print</span>(“dictionary[<span class="type">HKWorkoutActivityType</span>.\(name).rawValue] = \”\(name)\””)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<p>Where string is all the cases from <a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype">HKWorkoutActivityType</a>, for example</p>
<p><a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype/archery">case archery</a><br>The constant for shooting archery.</p>
<p><a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype/bowling">case bowling</a><br>The constant for bowling</p>
<p><a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype/fencing">case fencing</a><br>The constant for fencing.</p>
<p><a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype/gymnastics">case gymnastics</a><br>Performing gymnastics.</p>
<p><a href="https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype/trackandfield">case trackAndField</a><br>Participating in track and field events, including shot put, javelin, pole vaulting, and related sports.</p>
<p>What the code does is to use regular expression to examine all the names after case , and build our code</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dictionary[<span class="type">HKWorkoutActivityType</span>.americanFootball.rawValue] = “americanFootball”</span><br><span class="line">dictionary[<span class="type">HKWorkoutActivityType</span>.archery.rawValue] = “archery”</span><br><span class="line">dictionary[<span class="type">HKWorkoutActivityType</span>.australianFootball.rawValue] = “australianFootball”</span><br><span class="line">dictionary[<span class="type">HKWorkoutActivityType</span>.badminton.rawValue] = “badminton”</span><br><span class="line">dictionary[<span class="type">HKWorkoutActivityType</span>.baseball.rawValue] = “baseball”</span><br></pre></td></tr></table></figure>

<p>The above generated code with dictionary contains rawValue as key and the enum case name as value .</p>
<p>Later when we get any HKWorkoutActivityType , we can compare with this dictionary to find the actual name. This is better than hardcode activity name with numbers because those rawValue are just implementation detail</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-24T20:08:27.000Z" title="2019-03-24T20:08:27.000Z">2019-03-24</time><span class="level-item">8 minutes read (About 1130 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Curry-in-Swift-and-Javascript/">Curry in Swift and Javascript</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/185">#185</a></strong></p>
<p>You may encounter curry in everyday code without knowing it. Here is a bit of my reflections on curry and how to apply it in Javascript and Swift.</p>
<h2 id="Taking-one-parameter-in-Haskell"><a href="#Taking-one-parameter-in-Haskell" class="headerlink" title="Taking one parameter in Haskell"></a>Taking one parameter in Haskell</h2><p>In Haskell, all function officially takes only 1 parameter. Function with many parameters are just curried, which means they will be partially applied. Calling sum 1 just returns a function with 1 parameter, then 2is passed into this function. The following 2 function calls are the same.</p>
<pre><code>ghci&gt; sum 1 2
3 
ghci&gt; (max 1) 2
3</code></pre><p>I tend to think of curried function or partially applied function as something that carry dependencies at each application step. Each curried function can be assigned to variable or pass around, or as returned value.</p>
<h2 id="Curry-in-Swift-for-predicate"><a href="#Curry-in-Swift-for-predicate" class="headerlink" title="Curry in Swift for predicate"></a>Curry in Swift for predicate</h2><p>When I was trying to make my own <a href="https://github.com/onmyway133/archives/tree/master/Signal">Signal</a> library, I have</p>
<iframe src="https://medium.com/media/f61aae80ae0b6410d6844dbfd961d01e" frameborder=0></iframe>

<p>and Event</p>
<iframe src="https://medium.com/media/4a05bf4ba2a71d096c2ef87a3cd57ec8" frameborder=0></iframe>

<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>Then there should be a filter for Signal. The idea of filter is that we should update signal if the Event is Next with right filtered value</p>
<pre><code>public func filter(f: T -&gt; Bool) -&gt; Signal&lt;T&gt;{
    let signal = Signal&lt;T&gt;()
    subscribe { result in
        switch(result) {
        case let .Success(value):
            if f(value) {
                signal.update(result)
            }
        case let .Error(error): signal.update(.Error(error))
        }
    }
    return signal
}</code></pre><h3 id="2-parameters"><a href="#2-parameters" class="headerlink" title="2 parameters"></a>2 parameters</h3><p>But having Event as another monad, I think it should be more encapsulated if that switching logic gets moved into the Event. Here the filter takes 2 params</p>
<p>Event.swift</p>
<pre><code>func filter(f: T -&gt; Bool, callback: (Event&lt;T&gt; -&gt; Void)) {
        switch self {
        case let .Next(value) where f(value):
            callback(self)
        case .Failed:
            callback(self)
        default:
            break
    }
}</code></pre><p>Signal.swift</p>
<pre><code>public func filter(f: T -&gt; Bool) -&gt; Signal&lt;T&gt; {
    let signal = Signal&lt;T&gt;()

    subscribe { event in
        event.filter(f, callback: signal.update)
    }

    return signal
}</code></pre><h3 id="Currying"><a href="#Currying" class="headerlink" title="Currying"></a>Currying</h3><p>With currying, we can make filter a more abstract function, and defer the decision to pass the callback param. It is a little carried away but I find it helpful this way</p>
<p>Now filter accepts 1 param, and it returns a function that takes callback as its param</p>
<p>Event.swift</p>
<pre><code>func filter(f: T -&gt; Bool) -&gt; ((Event&lt;T&gt; -&gt; Void) -&gt; Void) {
        return { g in
            switch self {
            case let .Next(value) where f(value):
                g(self)
            case .Failed:
                g(self)
            default:
                break
            }
        }
    }</code></pre><p>Signal.swift</p>
<pre><code>public func filter(f: T -&gt; Bool) -&gt; Signal&lt;T&gt; {
        let signal = Signal&lt;T&gt;()

        subscribe { event in
            event.filter(f)(signal.update)
        }

        return signal
    }</code></pre><h3 id="Curry-syntax-in-Swift-2-and-above"><a href="#Curry-syntax-in-Swift-2-and-above" class="headerlink" title="Curry syntax in Swift 2 and above"></a>Curry syntax in Swift 2 and above</h3><p>Swift 2 supports curry syntax function</p>
<pre><code>func sum(a: Int)(b: Int) -&gt; Int {
    return a + b
}

let sumWith5 = sum(5)
let result = sumWith5(b: 10)</code></pre><p>Unfortunately, the syntactic sugar for declaring curry has been dropped since Swift 3. You may want to find out in <a href="http://ericasadun.com/2015/12/18/bidding-farewell-to-currying/">Bidding farewell to currying</a>. But it’s not a big deal as we can easily create curry function. It is just a function that returns another function.</p>
<h2 id="Using-curry-for-partial-application-in-UIKit"><a href="#Using-curry-for-partial-application-in-UIKit" class="headerlink" title="Using curry for partial application in UIKit"></a>Using curry for partial application in UIKit</h2><p>I used this curry technique in my Xkcd app. See <a href="https://github.com/onmyway133/Xkcd/blob/master/Source/Feature/Main/MainController.swift">MainController.swift</a>. MainController is vanilla UITabBarController with ComicsController and FavoriteController , all embedded in UINavigationViewController .</p>
<p>The feature is that when a comic is selected, a comic detail screen should be pushed on top of the navigation stack. For example in <a href="https://github.com/onmyway133/Xkcd/blob/master/Source/Feature/Comics/ComicsContoller.swift#L20">ComicsController</a></p>
<pre><code>/// Called when a comic is selected  
var selectComic: ((Comic) -&gt; Void)?</code></pre><p>All ComicsController needs to know is to call that selectComic closure with the chosen Comic, and someone should know how to handle that selection. Back to the <a href="https://github.com/onmyway133/Xkcd/blob/master/Source/Feature/Main/MainController.swift">handleFlow</a> function inside MainController.</p>
<pre><code>private func handleFlow() {
  typealias Function = (UINavigationController) -&gt; (Comic) -&gt; Void
  let selectComic: Function = { [weak self] navigationController in
    return { (comic: Comic) in
      guard let self = self else {
        return
      }

  let detailController = self.makeDetail(comic: comic)
      navigationController.pushViewController(detailController, animated: true)
    }
  }

  comicsController.selectComic = selectComic(comicNavigationController)
  favoriteController.selectComic = selectComic(favoriteNavigationController)
}</code></pre><p>I declared Function as typealias to explicitly state the curry function that we are going to build</p>
<pre><code>typealias Function = (UINavigationController) -&gt; (Comic) -&gt; Void</code></pre><p>We build selectComic as curried function, that takes UINavigationViewController and returns a function that takes Comic and returns Void . This way when we partially apply selectComic with the a navigationController , we get another function that has navigationController as dependency, and ready to be assigned to selectComic property in comicsController .</p>
<h2 id="Curry-promised-function-in-Javascript"><a href="#Curry-promised-function-in-Javascript" class="headerlink" title="Curry promised function in Javascript"></a>Curry promised function in Javascript</h2><p>I like to work with Promise and async/await in Javascript. It allows chainable style and easy to reason about. So when working with callbacks in Javascript, for example callback from native modules in React Native, I tend to convert them into Promise.</p>
<p>For example when working with HealthKit, we need to expose a native modules around it</p>
<pre><code>// [@flow](http://twitter.com/flow)

import { NativeModules } from &apos;react-native&apos;

type HealthManagerType = {
  checkAuthorisation: ((string) =&gt; void)) =&gt; void,
  authorise: ((boolean) =&gt; void)) =&gt; void,
  readWorkout: (Date, Date, () =&gt; void)) =&gt; void,
  readDailySummary: (Date, Date, () =&gt; void)) =&gt; void,
  readMeasurement: (Date, Date, () =&gt; void)) =&gt; void
}

const HealthManager: HealthManagerType = NativeModules.HealthManager
export default HealthManager</code></pre><p>We can build a toPromise function that can convert a function with callback into Promise</p>
<pre><code>// [@flow](http://twitter.com/flow)

const toPromise = (f: (any) =&gt; void) =&gt; {
  return new Promise&lt;any&gt;((resolve, reject) =&gt; {
    try {
      f((result) =&gt; {
        resolve(result)
      })
    } catch (e) {
      reject(e)
    }
  })
}

export default toPromise</code></pre><p>However, as you can see in the signature, it only works with a callback of type (any) =&gt; void In other words, this callback must have exactly 1 parameter, because a Promise can either returns a value or throws an error.</p>
<p>To remedy this, we can build a curry function that can turns function with either 1, 2, 3 parameters into curried function. Thanks to the dynamic nature of Javascript, we have</p>
<pre><code>// [@flow](http://twitter.com/flow)

function curry0(f: () =&gt; void) {
  return f()
}

function curry1(f: (any) =&gt; void) {
  return (p1: any) =&gt; {
    return f(p1)
  }
}

function curry2(f: (any, any) =&gt; void) {
  return (p1: any) =&gt; {
    return (p2: any) =&gt; {
      return f(p1, p2)
    }
  }
}

function curry3(f: (any, any, any) =&gt; void) {
  return (p1: any) =&gt; {
    return (p2: any) =&gt; {
      return (p3: any) =&gt; {
        return f(p1, p2, p3)
      }
    }
  }
}

export default {
  curry0,
  curry1,
  curry2,
  curry3
}</code></pre><p>So with a function that have 3 parameters, we can use curry3 to partially apply the first 2 parameters. Then we have a function that accepts just a callback, and this is turned into Promise via toPromise</p>
<pre><code>const readWorkout = curry.curry3(HealthManager.readWorkout)(DateUtils.startDate))(DateUtils.endDate))

const workouts = await toPromise(readWorkout)</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Here are some of my favorite posts to read more about curry</p>
<ul>
<li><p><a href="http://learnyouahaskell.com/higher-order-functions">Higher order functions</a></p>
</li>
<li><p><a href="https://robots.thoughtbot.com/introduction-to-function-currying-in-swift">Introduction to Function Currying in Swift</a></p>
</li>
<li><p><a href="http://www.russbishop.net/swift-function-currying">Swift Function Currying</a></p>
</li>
<li><p><a href="https://medium.com/@kevincennis/currying-in-javascript-c66080543528">Currying in JavaScript</a>: I like how he uses memory and slice to gradually build more generic curry function</p>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-24T20:00:49.000Z" title="2019-03-24T20:00:49.000Z">2019-03-24</time><span class="level-item">6 minutes read (About 926 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-SSLPeerUnverifiedException-in-Android/">How to fix SSLPeerUnverifiedException in Android</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/184">#184</a></strong></p>
<p>Get error <code>javax.net.ssl.SSLPeerUnverifiedException: No peer certificate</code> in Android API 16 to API 19</p>
<h2 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h2><p>Read about HTTPS and SSL <a href="https://developer.android.com/training/articles/security-ssl">https://developer.android.com/training/articles/security-ssl</a><br>Check backend TLS <a href="https://www.ssllabs.com/index.html">https://www.ssllabs.com/index.html</a><br>TLS by default in Android P <a href="https://android-developers.googleblog.com/2018/04/protecting-users-with-tls-by-default-in.html">https://android-developers.googleblog.com/2018/04/protecting-users-with-tls-by-default-in.html</a></p>
<h2 id="TLS-version"><a href="#TLS-version" class="headerlink" title="TLS version"></a>TLS version</h2><p>Read <a href="https://developer.android.com/reference/javax/net/ssl/SSLSocket.html">https://developer.android.com/reference/javax/net/ssl/SSLSocket.html</a></p>
<blockquote>
<p>This class extends Sockets and provides secure socket using protocols such as the “Secure Sockets Layer” (SSL) or IETF “Transport Layer Security” (TLS) protocols.</p>
</blockquote>
<img width="903" alt="ssl" src="https://user-images.githubusercontent.com/2284279/54885644-d6e9c080-4e7e-11e9-9f50-0d5a72b76202.png">

<p>TLS 1.1 and 1.2 are supported from API 16, but not enabled by default until API 20.</p>
<h2 id="Install-TLS-1-2-when-needed"><a href="#Install-TLS-1-2-when-needed" class="headerlink" title="Install TLS 1.2 when needed"></a>Install TLS 1.2 when needed</h2><p>Read <a href="https://medium.com/tech-quizlet/working-with-tls-1-2-on-android-4-4-and-lower-f4f5205629a">https://medium.com/tech-quizlet/working-with-tls-1-2-on-android-4-4-and-lower-f4f5205629a</a></p>
<blockquote>
<p>The first thing we realized was that despite documentation suggesting otherwise, not all devices on Android 4.1+ actually support TLS 1.2. Even though it is likely due to device manufacturers not fully following the official Android specs, we had to do what we could to ensure this would work for our users.</p>
</blockquote>
<blockquote>
<p>Luckily, Google Play Services provides a way to do this. The solution is to use ProviderInstaller from Google Play Services to try to update the device to support the latest and greatest security protocols.</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> Context.<span class="title">installTls12</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">      ProviderInstaller.installIfNeeded(<span class="keyword">this</span>)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e: GooglePlayServicesRepairableException) &#123;</span><br><span class="line">      <span class="comment">// Prompt the user to install/update/enable Google Play services.</span></span><br><span class="line">      GoogleApiAvailability.getInstance()</span><br><span class="line">          .showErrorNotification(<span class="keyword">this</span>, e.connectionStatusCode)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e: GooglePlayServicesNotAvailableException) &#123;</span><br><span class="line">      <span class="comment">// Indicates a non-recoverable error: let the user know.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Does not seem to work, as the root problem was that TLS was not enabled</p>
<h2 id="Try-normal-HttpsUrlConnection"><a href="#Try-normal-HttpsUrlConnection" class="headerlink" title="Try normal HttpsUrlConnection"></a>Try normal HttpsUrlConnection</h2><p>If we use any networking library and suspect it is the cause, then try using normal HttpsUrlConnection to check.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHttpRequestTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">String</span>,<span class="title">Integer</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(String... params)</span> </span>&#123;</span><br><span class="line">        String my_url = params[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            URL url = <span class="keyword">new</span> URL(my_url);</span><br><span class="line">            HttpsURLConnection httpURLConnection = (HttpsURLConnection) url.openConnection();</span><br><span class="line">            httpURLConnection.setSSLSocketFactory(<span class="keyword">new</span> MyFactory());</span><br><span class="line">            <span class="comment">// setting the  Request Method Type</span></span><br><span class="line">            httpURLConnection.setRequestMethod(<span class="string">"GET"</span>);</span><br><span class="line">            <span class="comment">// adding the headers for request</span></span><br><span class="line">            httpURLConnection.setRequestProperty(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            String result = readStream(httpURLConnection.getInputStream());</span><br><span class="line">            Log.e(<span class="string">"HttpsURLConnection"</span>, <span class="string">"data"</span> + result.toString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            Log.e(<span class="string">"HttpsURLConnection "</span>, <span class="string">"error"</span> + e.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">readStream</span><span class="params">(InputStream is)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is, Charset.forName(<span class="string">"US-ASCII"</span>)));</span><br><span class="line">        StringBuilder total = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            total.append(line);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (reader != <span class="keyword">null</span>) &#123;</span><br><span class="line">            reader.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFactory</span> <span class="keyword">extends</span> <span class="title">SSLSocketFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> javax.net.ssl.SSLSocketFactory internalSSLSocketFactory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFactory</span><span class="params">()</span> <span class="keyword">throws</span> KeyManagementException, NoSuchAlgorithmException </span>&#123;</span><br><span class="line">        SSLContext context = SSLContext.getInstance(<span class="string">"TLS"</span>);</span><br><span class="line">        context.init(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        internalSSLSocketFactory = context.getSocketFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getDefaultCipherSuites() &#123;</span><br><span class="line">        <span class="keyword">return</span> internalSSLSocketFactory.getDefaultCipherSuites();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getSupportedCipherSuites() &#123;</span><br><span class="line">        <span class="keyword">return</span> internalSSLSocketFactory.getSupportedCipherSuites();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(Socket s, String host, <span class="keyword">int</span> port, <span class="keyword">boolean</span> autoClose)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(s, host, port, autoClose));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(host, port));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port, InetAddress localHost, <span class="keyword">int</span> localPort)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(host, port, localHost, localPort));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(InetAddress host, <span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(host, port));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(InetAddress address, <span class="keyword">int</span> port, InetAddress localAddress, <span class="keyword">int</span> localPort)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(address, port, localAddress, localPort));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Socket <span class="title">enableTLSOnSocket</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(socket != <span class="keyword">null</span> &amp;&amp; (socket <span class="keyword">instanceof</span> SSLSocket)) &#123;</span><br><span class="line">            ((SSLSocket)socket).setEnabledProtocols(<span class="keyword">new</span> String[] &#123;<span class="string">"TLSv1.1"</span>, <span class="string">"TLSv1.2"</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The key is <code>setEnabledProtocols</code>. Then use</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String url = <span class="string">"https://www.myserver.com/data"</span></span><br><span class="line"><span class="keyword">new</span> MyHttpRequestTask().execute(url);</span><br></pre></td></tr></table></figure>

<h2 id="Use-custom-SSLSocketFactory-in-some-networking-libraries"><a href="#Use-custom-SSLSocketFactory-in-some-networking-libraries" class="headerlink" title="Use custom SSLSocketFactory in some networking libraries"></a>Use custom SSLSocketFactory in some networking libraries</h2><p>If our custom <code>MyFactory</code> works for <code>HttpsUrlConnection</code>, then the problem lies in some 3rd party networking libraries.</p>
<p>Read <a href="https://blog.dev-area.net/2015/08/13/android-4-1-enable-tls-1-1-and-tls-1-2/">https://blog.dev-area.net/2015/08/13/android-4-1-enable-tls-1-1-and-tls-1-2/</a></p>
<blockquote>
<p>The Android documentation for SSLSocket says that TLS 1.1 and TLS 1.2 is supported within android starting API level 16+ (Android 4.1, Jelly Bean). But it is by default disabled but starting with API level 20+ (Android 4.4 for watch, Kitkat Watch and Android 5.0 for phone, Lollipop) they are enabled. But it is very hard to find any documentation about how to enable it for phones running 4.1 for example.</p>
</blockquote>
<blockquote>
<p>The first thing you need to do is to make sure that your minimum required API level is 16 to have the following code working in your project.</p>
</blockquote>
<blockquote>
<p>To enable TLS 1.1 and 1.2 you need to create a custom SSLSocketFactory that is going to proxy all calls to a default  SSLSocketFactory implementation. In addition to that do we have to override all createSocket methods and callsetEnabledProtocols on the returned SSLSocket to enable TLS 1.1 and TLS 1.2. For an example implementation just follow the link below.</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFactory</span> <span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">http</span>.<span class="title">conn</span>.<span class="title">ssl</span>.<span class="title">SSLSocketFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> KeyStore <span class="title">getKeyStore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        KeyStore trustStore = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            trustStore = KeyStore.getInstance(KeyStore.getDefaultType());</span><br><span class="line">            trustStore.load(<span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            t.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> trustStore;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SSLSocketFactory internalSSLSocketFactory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFactory</span><span class="params">(KeyStore truststore)</span> <span class="keyword">throws</span> NoSuchAlgorithmException, KeyManagementException, KeyStoreException, UnrecoverableKeyException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(truststore);</span><br><span class="line">        SSLContext context = SSLContext.getInstance(<span class="string">"TLS"</span>);</span><br><span class="line">        context.init(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        internalSSLSocketFactory = context.getSocketFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(Socket socket, String host, <span class="keyword">int</span> port, <span class="keyword">boolean</span> autoClose)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enableTLSOnSocket(internalSSLSocketFactory.createSocket(socket, host, port, autoClose));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Socket <span class="title">enableTLSOnSocket</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(socket != <span class="keyword">null</span> &amp;&amp; (socket <span class="keyword">instanceof</span> SSLSocket)) &#123;</span><br><span class="line">            ((SSLSocket)socket).setEnabledProtocols(<span class="keyword">new</span> String[] &#123;<span class="string">"TLSv1.1"</span>, <span class="string">"TLSv1.2"</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then maybe use it in a library, for example the ancient AsyncHttpClient</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">asyncHttpClient = <span class="keyword">new</span> AsyncHttpClient();</span><br><span class="line">asyncHttpClient.setTimeout(HTTP_GET_TIMEOUT);</span><br><span class="line">asyncHttpClient.setSSLSocketFactory(<span class="keyword">new</span> MyFactory(MyFactory.getKeyStore()));</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-22T10:10:38.000Z" title="2019-03-22T10:10:38.000Z">2019-03-22</time><span class="level-item">a few seconds read (About 37 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-zoom-in-double-in-MapKit/">How to zoom in double in MapKit</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/183">#183</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zoomInDouble</span><span class="params">(coordinate: CLLocationCoordinate2D)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> region = mapView.region</span><br><span class="line">    <span class="keyword">let</span> zoomInRegion = <span class="type">MKCoordinateRegion</span>(</span><br><span class="line">        center: coordinate,</span><br><span class="line">        span: <span class="type">MKCoordinateSpan</span>(</span><br><span class="line">            latitudeDelta: region.span.latitudeDelta * <span class="number">0.5</span>,</span><br><span class="line">            longitudeDelta: region.span.longitudeDelta * <span class="number">0.5</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    mapView.setRegion(zoomInRegion, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-22T10:09:56.000Z" title="2019-03-22T10:09:56.000Z">2019-03-22</time><span class="level-item">a few seconds read (About 31 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-select-cluster-annotation-in-MapKit/">How to select cluster annotation in MapKit</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/182">#182</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mapView</span><span class="params">(<span class="number">_</span> mapView: MKMapView, didSelect view: MKAnnotationView)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> coordinate = view.annotation?.coordinate <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (view.annotation <span class="keyword">is</span> <span class="type">MKClusterAnnotation</span>) &#123;</span><br><span class="line">        zoomInDouble(coordinate: coordinate)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-22T10:09:01.000Z" title="2019-03-22T10:09:01.000Z">2019-03-22</time><span class="level-item">a minute read (About 186 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-cluster-annotations-in-MapKit-in-iOS-11/">How to cluster annotations in MapKit in iOS 11</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/181">#181</a></strong></p>
<p><a href="https://developer.apple.com/documentation/mapkit/mkannotationview/decluttering_a_map_with_mapkit_annotation_clustering">https://developer.apple.com/documentation/mapkit/mkannotationview/decluttering_a_map_with_mapkit_annotation_clustering</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationView</span>: <span class="title">MKMarkerAnnotationView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(annotation: <span class="type">MKAnnotation?</span>, reuseIdentifier: <span class="type">String?</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(annotation: annotation, reuseIdentifier: reuseIdentifier)</span><br><span class="line">        </span><br><span class="line">        clusteringIdentifier = <span class="type">String</span>(describing: <span class="type">ClusterView</span>.<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ClusterView</span>: <span class="title">MKAnnotationView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(annotation: <span class="type">MKAnnotation?</span>, reuseIdentifier: <span class="type">String?</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(annotation: annotation, reuseIdentifier: reuseIdentifier)</span><br><span class="line">        displayPriority = .defaultHigh</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareForDisplay</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.prepareForDisplay()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> annotation = annotation <span class="keyword">as</span>? <span class="type">MKClusterAnnotation</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> <span class="built_in">count</span> = annotation.memberAnnotations.<span class="built_in">count</span></span><br><span class="line">        image = <span class="keyword">self</span>.image(annotation: annotation, <span class="built_in">count</span>: <span class="built_in">count</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">image</span><span class="params">(annotation: MKClusterAnnotation, <span class="built_in">count</span>: Int)</span></span> -&gt; <span class="type">UIImage?</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> renderer = <span class="type">UIGraphicsImageRenderer</span>(size: <span class="type">CGSize</span>(width: <span class="number">40.0</span>, height: <span class="number">40.0</span>))</span><br><span class="line">        image = renderer.image &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="type">UIColor</span>.purple.setFill()</span><br><span class="line">            <span class="type">UIBezierPath</span>(ovalIn: <span class="type">CGRect</span>(x: <span class="number">0.0</span>, y: <span class="number">0.0</span>, width: <span class="number">40.0</span>, height: <span class="number">40.0</span>)).fill()</span><br><span class="line">            <span class="keyword">let</span> attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] = [</span><br><span class="line">                <span class="type">NSAttributedString</span>.<span class="type">Key</span>.foregroundColor: <span class="type">UIColor</span>.white,</span><br><span class="line">                <span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="type">UIFont</span>.boldSystemFont(ofSize: <span class="number">20.0</span>)</span><br><span class="line">            ]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> text = <span class="string">"\(count)"</span></span><br><span class="line">            <span class="keyword">let</span> size = text.size(withAttributes: attributes)</span><br><span class="line">            <span class="keyword">let</span> rect = <span class="type">CGRect</span>(x: <span class="number">20</span> - size.width / <span class="number">2</span>, y: <span class="number">20</span> - size.height / <span class="number">2</span>, width: size.width, height: size.height)</span><br><span class="line">            text.draw(<span class="keyword">in</span>: rect, withAttributes: attributes)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapView.register(<span class="type">ClusterView</span>.<span class="keyword">self</span>, forAnnotationViewWithReuseIdentifier: <span class="type">String</span>(describing: <span class="type">ClusterView</span>.<span class="keyword">self</span>))</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-21T07:30:00.000Z" title="2019-03-21T07:30:00.000Z">2019-03-21</time><span class="level-item">a minute read (About 145 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Understanding-CanvasRenderingContext2D-and-UIBezierPath/">Understanding CanvasRenderingContext2D and UIBezierPath</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/180">#180</a></strong></p>
<h2 id="CanvasRenderingContext2D"><a href="#CanvasRenderingContext2D" class="headerlink" title="CanvasRenderingContext2D"></a>CanvasRenderingContext2D</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/bezierCurveTo">https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/bezierCurveTo</a></p>
<blockquote>
<p>The CanvasRenderingContext2D.bezierCurveTo() method of the Canvas 2D API adds a cubic Bézier curve to the current sub-path. It requires three points: the first two are control points and the third one is the end point. The starting point is the latest point in the current path, which can be changed using moveTo() before creating the Bézier curve.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);</span><br></pre></td></tr></table></figure>

<p>Where order is control point 1, control point 2 and end point</p>
<h2 id="UIBezierPath"><a href="#UIBezierPath" class="headerlink" title="UIBezierPath"></a>UIBezierPath</h2><p><a href="https://developer.apple.com/documentation/uikit/uibezierpath/1624357-addcurve">https://developer.apple.com/documentation/uikit/uibezierpath/1624357-addcurve</a></p>
<blockquote>
<p>Appends a cubic Bézier curve to the receiver’s path.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addCurve(to:controlPoint1:controlPoint2:)</span><br></pre></td></tr></table></figure>

<p>The same for <code>void ctx.quadraticCurveTo(cpx, cpy, x, y);</code> and <code>addQuadCurve(to:controlPoint:)</code></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T10:55:25.000Z" title="2019-03-19T10:55:25.000Z">2019-03-19</time><span class="level-item">a few seconds read (About 15 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-properties-of-JSValue-in-JavascriptCore/">How to get properties of JSValue in JavascriptCore</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/179">#179</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> rough = context.objectForKeyedSubscript(<span class="string">"myObject"</span>)</span><br><span class="line">myObject.toDictionary()</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T08:43:24.000Z" title="2019-03-19T08:43:24.000Z">2019-03-19</time><span class="level-item">a minute read (About 122 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-run-ffmpeg-in-macOS-app/">How to run ffmpeg in macOS app</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/178">#178</a></strong></p>
<p>Install ffmpeg, which installs ffprobe</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ffmpeg</span><br></pre></td></tr></table></figure>

<p>Find location of installed ffmpeg</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">which ffmpeg</span><br></pre></td></tr></table></figure>

<p>Add all executables to project</p>
<p>Get error</p>
<blockquote>
<p>unable to obtain file audio codec with ffprobe</p>
</blockquote>
<p>Run in verbose mode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -v</span><br></pre></td></tr></table></figure>

<p>Get</p>
<blockquote>
<p>[debug] Encodings: locale US-ASCII, fs utf-8, out None, pref US-ASCII<br>[debug] Python version 2.7.10 (CPython) - Darwin-18.2.0-x86_64-i386-64bit<br>[debug] exe versions: ffmpeg present, ffprobe present</p>
</blockquote>
<p>Run version of ffprobe</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe --version</span><br></pre></td></tr></table></figure>

<p>Get dylb not found</p>
<blockquote>
<p>dyld: Library not loaded: /usr/local/Cellar/ffmpeg/4.1.1/lib/libavdevice.58.dylib</p>
</blockquote>
<p>Similar issue <a href="https://techglimpse.com/ffprobe-command-error-linux-solution/">https://techglimpse.com/ffprobe-command-error-linux-solution/</a><br>Read dylib path <a href="https://stackoverflow.com/questions/23777191/dyld-library-not-loaded-when-trying-to-run-fortran-executable-from-objective-c">https://stackoverflow.com/questions/23777191/dyld-library-not-loaded-when-trying-to-run-fortran-executable-from-objective-c</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T08:11:19.000Z" title="2019-03-19T08:11:19.000Z">2019-03-19</time><span class="level-item">a few seconds read (About 28 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-path-to-resource-in-running-macOS-app/">How to get path to resource in running macOS app</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/177">#177</a></strong></p>
<p>This is useful to refer to another executable in a running executable in <code>Process</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Bundle</span>.main.path(forResource: <span class="string">"ffmpeg"</span>, ofType: <span class="string">""</span>)!</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T07:58:44.000Z" title="2019-03-19T07:58:44.000Z">2019-03-19</time><span class="level-item">a minute read (About 200 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-run-executable-in-macOS/">How to run executable in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/176">#176</a></strong></p>
<p>Enable executable</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x executable</span><br></pre></td></tr></table></figure>

<p>Add executable file to target<br>Use <code>Process</code> with correct <code>launchPad</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">TaskDelegate</span>: <span class="title">class</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">task</span><span class="params">(task: Task, didOutput string: String)</span></span></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">taskDidComplete</span><span class="params">(task: Task)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">TaskDelegate?</span></span><br><span class="line">  <span class="keyword">let</span> process = <span class="type">Process</span>()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">(arguments: [String])</span></span> &#123;</span><br><span class="line">    <span class="type">DispatchQueue</span>.background.async &#123;</span><br><span class="line">      <span class="keyword">let</span> launchPath = <span class="type">Bundle</span>.main.path(forResource: <span class="string">"executable"</span>, ofType: <span class="string">""</span>)!</span><br><span class="line">      <span class="keyword">self</span>.run(launchPath: launchPath, arguments: arguments)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="type">DispatchQueue</span>.background.async &#123;</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">self</span>.process.isRunning &#123;</span><br><span class="line">        <span class="keyword">self</span>.process.terminate()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// MARK: - Helper</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">(launchPath: String, arguments: [String])</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> process = <span class="type">Process</span>()</span><br><span class="line">    process.launchPath = launchPath</span><br><span class="line">    process.arguments = arguments</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stdOut = <span class="type">Pipe</span>()</span><br><span class="line">    process.standardOutput = stdOut</span><br><span class="line">    <span class="keyword">let</span> stdErr = <span class="type">Pipe</span>()</span><br><span class="line">    process.standardError = stdErr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> handler =  &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] (file: <span class="type">FileHandle!</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">let</span> data = file.availableData</span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> output = <span class="type">NSString</span>(data: data, encoding: <span class="type">String</span>.<span class="type">Encoding</span>.utf8.rawValue) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> strongSelf = <span class="keyword">self</span>,</span><br><span class="line">        <span class="keyword">let</span> string = output.components(separatedBy: <span class="string">"\n"</span>).first <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">        strongSelf.delegate?.task(task: strongSelf, didOutput: string)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stdErr.fileHandleForReading.readabilityHandler = handler</span><br><span class="line">    stdOut.fileHandleForReading.readabilityHandler = handler</span><br><span class="line"></span><br><span class="line">    process.terminationHandler = &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] (task: <span class="type">Process?</span>) -&gt; () <span class="keyword">in</span></span><br><span class="line">      stdErr.fileHandleForReading.readabilityHandler = <span class="literal">nil</span></span><br><span class="line">      stdOut.fileHandleForReading.readabilityHandler = <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> strongSelf = <span class="keyword">self</span> <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">        strongSelf.delegate?.taskDidComplete(task: strongSelf)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    process.launch()</span><br><span class="line">    process.waitUntilExit()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T07:56:00.000Z" title="2019-03-19T07:56:00.000Z">2019-03-19</time><span class="level-item">a few seconds read (About 25 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-print-current-directory-using-Process-in-macOS/">How to print current directory using Process in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/175">#175</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> process = <span class="type">Process</span>()</span><br><span class="line">process.launchPath = <span class="string">"/bin/pwd"</span></span><br><span class="line">process.arguments = []</span><br></pre></td></tr></table></figure>

<p>Should be the same as <code>FileManager.default.currentDirectoryPath</code></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-19T07:05:27.000Z" title="2019-03-19T07:05:27.000Z">2019-03-19</time><span class="level-item">a few seconds read (About 23 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-change-NSTextField-backgroundColor-in-NSPopover/">How to change NSTextField backgroundColor in NSPopover</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/174">#174</a></strong></p>
<p>Disable vibrancy mode of NSPopover</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> popover = <span class="type">NSPopover</span>()</span><br><span class="line">popover.appearance = <span class="type">NSAppearance</span>(named: <span class="type">NSAppearance</span>.<span class="type">Name</span>.aqua)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-18T13:59:00.000Z" title="2019-03-18T13:59:00.000Z">2019-03-18</time><span class="level-item">a minute read (About 126 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-scrollable-vertical-NSStackView/">How to make scrollable vertical NSStackView</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/173">#173</a></strong></p>
<p>You might need to flip <code>NSClipView</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> AppKit</span><br><span class="line"><span class="keyword">import</span> Anchors</span><br><span class="line"><span class="keyword">import</span> Omnia</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ScrollableStackView</span>: <span class="title">NSView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">FlippedClipView</span>: <span class="title">NSClipView</span> </span>&#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="keyword">var</span> isFlipped: <span class="type">Bool</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame frameRect: <span class="type">NSRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frameRect)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder decoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stackView: <span class="type">NSStackView</span> = withObject(<span class="type">NSStackView</span>()) &#123;</span><br><span class="line">        $<span class="number">0</span>.orientation = .vertical</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> scrollView: <span class="type">NSScrollView</span> = <span class="type">NSScrollView</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubview(scrollView)</span><br><span class="line">        scrollView.hasVerticalScroller = <span class="literal">true</span></span><br><span class="line">        scrollView.drawsBackground = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">        activate(</span><br><span class="line">            scrollView.anchor.edges</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> clipView = <span class="type">FlippedClipView</span>()</span><br><span class="line">        clipView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">        clipView.drawsBackground = <span class="literal">false</span></span><br><span class="line">        scrollView.contentView = clipView</span><br><span class="line"></span><br><span class="line">        activate(</span><br><span class="line">            clipView.anchor.edges.<span class="built_in">equal</span>.to(scrollView.anchor)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        scrollView.documentView = stackView</span><br><span class="line">        stackView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">        activate(</span><br><span class="line">            clipView.anchor.<span class="keyword">left</span>.top.<span class="keyword">right</span>.<span class="built_in">equal</span>.to(stackView.anchor)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://stackoverflow.com/questions/10016475/create-nsscrollview-programmatically-in-an-nsview-cocoa/55219153#55219153">https://stackoverflow.com/questions/10016475/create-nsscrollview-programmatically-in-an-nsview-cocoa/55219153#55219153</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-18T13:58:20.000Z" title="2019-03-18T13:58:20.000Z">2019-03-18</time><span class="level-item">a few seconds read (About 68 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-view-take-up-full-width-in-vertical-NSStackView/">How to make view take up full width in vertical NSStackView</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/172">#172</a></strong></p>
<p><a href="https://stackoverflow.com/questions/51644692/nsstackview-subviews-not-resizing-sub-stack-views/55220837#55220837">https://stackoverflow.com/questions/51644692/nsstackview-subviews-not-resizing-sub-stack-views/55220837#55220837</a></p>
<p>If you want child view inside vertical NSStackView to fill its parent width, then <code>reduce contentCompressionResistancePriority</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">myChildView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">myChildView.setContentCompressionResistancePriority(</span><br><span class="line">  <span class="type">NSLayoutConstraint</span>.<span class="type">Priority</span>(rawValue: <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">for</span>: .horizontal</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="type">NSLayoutConstraint</span>.activate([</span><br><span class="line">  myChildView.heightAnchor.constraint(equalToConstant: <span class="number">50</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="type">NSAnimationContext</span>.runAnimationGroup(&#123;context <span class="keyword">in</span></span><br><span class="line">  context.duration = <span class="number">0.25</span></span><br><span class="line">  context.allowsImplicitAnimation = <span class="literal">true</span></span><br><span class="line">  stackView.insertArrangedSubview(myChildView, at: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">  view.layoutSubtreeIfNeeded()</span><br><span class="line">&#125;, completionHandler: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-18T13:57:09.000Z" title="2019-03-18T13:57:09.000Z">2019-03-18</time><span class="level-item">a few seconds read (About 30 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-load-top-level-view-from-xib-in-macOS/">How to load top level view from xib in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/171">#171</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> views: <span class="type">NSArray?</span></span><br><span class="line"><span class="type">NSNib</span>(nibNamed: <span class="type">NSNib</span>.<span class="type">Name</span>(<span class="string">"ProfileView"</span>), bundle: <span class="literal">nil</span>)?.instantiate(withOwner: <span class="literal">nil</span>, topLevelObjects: &amp;views)</span><br><span class="line"><span class="keyword">let</span> profileView = views!.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">ProfileView</span> &#125;).first!</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-02-25T13:55:08.000Z" title="2019-02-25T13:55:08.000Z">2019-02-25</time><span class="level-item">3 minutes read (About 405 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-MethodError-undefined-method-real_path-with-CocoaPods/">How to fix MethodError - undefined method `real_path` with CocoaPods?</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/170">#170</a></strong></p>
<p><img src="https://user-images.githubusercontent.com/2284279/53346190-d3622880-3916-11e9-9028-ad0a6a37b277.jpg" alt="abc"></p>
<p>I’m using cocoapods 1.6.0.beta.2 in a React Native apps and it has been working fine. The pods that I need is <code>Firebase</code> and <code>FacebookSDK</code>. Today after pod install, I got error</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NoMethodError - undefined method &#96;real_path&#39; for nil:NilClass</span><br></pre></td></tr></table></figure>

<p>I then tried running <code>pod deintegrate</code> to start from scratch, but that command fails as well.</p>
<p>My next try is with <code>cocoapods 1.6.0</code> and <code>cocoapods 1.6.1</code> but the problem still persists.</p>
<p><code>undefined method</code> in Ruby means that we are calling a method on an object that is nil. I like to track down problems via reading code, but this error is very vague.</p>
<p>Looking thorough at the log, I see CocoaPods has done fetching dependencies, but fails at the integration step, so it must be something wrong with my project file.</p>
<p>Then I trace back commits to <code>project.pbxproj</code> to see if there’s anything wrong. It turns out that there was a commit that accidentally removes <code>Pods-MyApp Staging.release.xcconfig</code> from project. That also comes with removal of</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baseConfigurationReference &#x3D; B7FC69316CC27F11022F8A82 &#x2F;* Pods-MyApp Staging.release.xcconfig *&#x2F;;</span><br></pre></td></tr></table></figure>

<h2 id="CocoaPods-uses-xcconfig"><a href="#CocoaPods-uses-xcconfig" class="headerlink" title="CocoaPods uses xcconfig"></a>CocoaPods uses xcconfig</h2><p>As you know, CocoaPods uses <code>xcconfig</code> files to declare pod related information like  <code>FRAMEWORK_SEARCH_PATHS</code>, <code>OTHER_LDFLAGS</code> and other variables like</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PODS_BUILD_DIR &#x3D; $&#123;BUILD_DIR&#125;</span><br><span class="line">PODS_CONFIGURATION_BUILD_DIR &#x3D; $&#123;PODS_BUILD_DIR&#125;&#x2F;$(CONFIGURATION)$(EFFECTIVE_PLATFORM_NAME)</span><br><span class="line">PODS_PODFILE_DIR_PATH &#x3D; $&#123;SRCROOT&#125;&#x2F;.</span><br><span class="line">PODS_ROOT &#x3D; $&#123;SRCROOT&#125;&#x2F;Pods</span><br></pre></td></tr></table></figure>

<p>And for a normal <code>pod install</code>, CocoaPods adds some <code>xcconfig</code> files to your project, and the path is <code>Pods/Target Support Files/Pods-DeepDiffDemo</code>. There will always be <code>debug.xcconfig</code> and <code>release.xcconfig</code> for each of your project target.</p>
<img width="1678" alt="xcconfig" src="https://user-images.githubusercontent.com/2284279/53345363-0dcac600-3915-11e9-975f-e6a7207912d0.png">

<p>If your project MyApp has a production target called <code>MyApp Production</code> and <code>MyApp Staging</code>, then you should have these files</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Pods-MyApp Staging.debug.xcconfig</span><br><span class="line">Pods-MyApp Staging.release.xcconfig</span><br><span class="line">Pods-MyApp Production.debug.xcconfig</span><br><span class="line">Pods-MyApp Production.release.xcconfig</span><br></pre></td></tr></table></figure>

<p>These are added to projects but not checked to any targets. Just like plist, you don’t need to add xcconfig files to target.</p>
<p>If you go to project Info page, you will see that these xcconfig files are selected</p>
<img width="824" alt="project" src="https://user-images.githubusercontent.com/2284279/53345592-93e70c80-3915-11e9-9826-3d1b9f30b900.png">

<h2 id="Missing-xcconfig"><a href="#Missing-xcconfig" class="headerlink" title="Missing xcconfig"></a>Missing xcconfig</h2><p>In my case, <code>Pods-MyApp Staging.release.xcconfig</code> was somehow missing from project, hence all pod commands fail.</p>
<p>The fix is to re-add that file and select that xcconfig in project Info page</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-12-18T16:16:33.000Z" title="2018-12-18T16:16:33.000Z">2018-12-18</time><span class="level-item">a few seconds read (About 60 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Testimonial/">Testimonial</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/169">#169</a></strong></p>
<p><a href="https://medium.com/@kylpo/wow-i-learned-so-much-from-this-article-thank-you-595f29077633">https://medium.com/@kylpo/wow-i-learned-so-much-from-this-article-thank-you-595f29077633</a></p>
<img width="534" alt="xcode" src="https://user-images.githubusercontent.com/2284279/50170685-ca3e5500-02f0-11e9-81fe-86aa08207735.png">

<p><a href="https://stackoverflow.com/questions/34990175/test-target-x-encountered-an-error-early-unexpected-exit-operation-never-finis/36343395?noredirect=1#comment94467666_36343395">https://stackoverflow.com/questions/34990175/test-target-x-encountered-an-error-early-unexpected-exit-operation-never-finis/36343395?noredirect=1#comment94467666_36343395</a></p>
<img width="690" alt="test" src="https://user-images.githubusercontent.com/2284279/50170737-e5a96000-02f0-11e9-8608-ee434869e232.png">

<p><a href="https://github.com/onmyway133/notes/issues/2">https://github.com/onmyway133/notes/issues/2</a></p>
<img width="581" alt="rotation" src="https://user-images.githubusercontent.com/2284279/50170776-feb21100-02f0-11e9-9bd0-e88703c84abf.png">

<p><a href="https://stackoverflow.com/questions/49478/git-ignore-file-for-xcode-projects/26034755#26034755">https://stackoverflow.com/questions/49478/git-ignore-file-for-xcode-projects/26034755#26034755</a></p>
<img width="695" alt="example" src="https://user-images.githubusercontent.com/2284279/50208156-c0f4cd00-0370-11e9-8926-05cf66f39bc5.png">

<p><a href="https://stackoverflow.com/a/46122458/1418457">https://stackoverflow.com/a/46122458/1418457</a></p>
<img width="719" alt="push" src="https://user-images.githubusercontent.com/2284279/52259951-ad072980-2924-11e9-8756-ada74e1f739e.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-05-31T10:41:57.000Z" title="2018-05-31T10:41:57.000Z">2018-05-31</time><span class="level-item">5 minutes read (About 742 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Understanding-weak-and-strong-in-Objective-C/">Understanding weak and strong in Objective C</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/164">#164</a></strong></p>
<p>From my own blog post <a href="https://github.com/Fantageek/fantageek.github.io/blob/source/source/_posts/2014-06-27-understanding-weak-self-and-strong-self.markdown">https://github.com/Fantageek/fantageek.github.io/blob/source/source/_posts/2014-06-27-understanding-weak-self-and-strong-self.markdown</a></p>
<hr>
<p>Blocks are wonderful. To avoid retain cycle you often see the weakSelf - strongSelf dance like this</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__<span class="keyword">weak</span> __typeof__(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line">    <span class="keyword">self</span>.block = ^&#123;</span><br><span class="line">        __typeof__(<span class="keyword">self</span>) strongSelf = weakSelf;</span><br><span class="line">        [strongSelf doSomething];</span><br><span class="line">        [strongSelf doSomethingElse];</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<h2 id="When-block-is-created"><a href="#When-block-is-created" class="headerlink" title="When block is created"></a>When block is created</h2><h4 id="Block-is-object-when-it-is-copied"><a href="#Block-is-object-when-it-is-copied" class="headerlink" title="Block is object when it is copied"></a>Block is object when it is copied</h4><p>Blocks are created on the stack and will go away when their stack frame returns. While on the stack, a block has no effect on the storage or lifetime of anything it accesses.</p>
<p>If blocks need to exist after the stack frame returns, they can be copied to the heap and this action is an explicit operation. This way, a block will gain reference-counting as all objects in Cocoa. When they are copied, they take their captured scope with them, retaining any objects they refer</p>
<h4 id="Blocks-can-capture-values-from-the-enclosing-scope"><a href="#Blocks-can-capture-values-from-the-enclosing-scope" class="headerlink" title="Blocks can capture values from the enclosing scope"></a>Blocks can capture values from the enclosing scope</h4><p>As well as containing executable code, a block also has the ability to capture state from its enclosing scope. Note that block captures the variable along with its decorators (i.e. weak qualifier),</p>
<p>=&gt; This explains why you need to declare self as __weak</p>
<h2 id="When-block-is-executed"><a href="#When-block-is-executed" class="headerlink" title="When block is executed"></a>When block is executed</h2><p>When block is executed, it is possible for weakSelf to be non-nil for the first method (doSomething), but not for the second (doSomethingElse)</p>
<p>You may think, at first, this is a trick to use self inside the block avoiding the retain cycle warning. This is not the case. The strong reference to self is created at block execution time while using self in the block is evaluated at block declaration time, thus retaining the object.</p>
<p>For best practice, however, you should create a strong reference of your object using the weak one. This won’t create a retain cycle either as the strong pointer within the block will only exist until the block completes (it’s only scope is the block itself).</p>
<p>=&gt; This explains why you need to declare another __strong self</p>
<h2 id="More-explanation"><a href="#More-explanation" class="headerlink" title="More explanation"></a>More explanation</h2><p>This is my answer to reader Nikita</p>
<ol>
<li><p>As many people point out, “Blocks are created on the stack and will go away when their stack frame returns. While on the stack, a block has no effect on the storage or lifetime of anything it accesses.”<br>Even if block (declared on the stack) increase reference count to all the object it accesses, this would be useless, because this block will be discard when function returns</p>
</li>
<li><p>When block are copied (You see that people usually declare property (copy) for block), it will increase reference count to all the objects it accesses.</p>
</li>
</ol>
<p>Why? because block are mean to be executed at a later time, so it need to keep strong reference to all the object it access. Block can be executed MANY TIMES, so IT WON’T RELEASE self AFTER this ran.</p>
<p>When you nil out the block, it will be dealloc, hence it will decrease the reference count to all the objects it access.</p>
<p>AFNetworking nil out the block after it is called, so you don’t have to use weakself inside block <a href="http://www.fantageek.com/1376/afnetworking-gotcha-2/">http://www.fantageek.com/1376/afnetworking-gotcha-2/</a></p>
<ol>
<li>So there are cases when you don’t have to use weakself inside block<br>a. Make sure the block is not copied, you simply declare and run it<br>b. Make sure the block is nil out after it is called</li>
</ol>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://dhoerl.wordpress.com/2013/04/23/i-finally-figured-out-weakself-and-strongself/">I finally figured out weakSelf and strongSelf</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithBlocks/WorkingwithBlocks.html">Working with Blocks</a></li>
<li><a href="http://albertodebortoli.github.io/blog/2013/08/03/objective-c-blocks-caveat/">Objective-C Blocks Caveat</a></li>
<li><a href="http://albertodebortoli.github.io/blog/2013/04/21/objective-c-blocks-under-the-hood/">Objective-C Blocks Under the Hood</a></li>
<li><a href="http://www.galloway.me.uk/2012/10/a-look-inside-blocks-episode-1/">A look inside blocks: Episode 1</a></li>
<li><a href="http://www.galloway.me.uk/2012/10/a-look-inside-blocks-episode-2/">A look inside blocks: Episode 2</a></li>
<li><a href="http://www.galloway.me.uk/2013/05/a-look-inside-blocks-episode-3-block-copy/">A look inside blocks: Episode 3</a></li>
<li><a href="http://nilsou.com/blog/2013/08/21/objective-c-blocks-syntax/">From C Declarators to Objective-C Blocks Syntax</a></li>
<li><a href="http://arigrant.com/blog/2014/1/18/the-syntax-of-objective-c-blocks">The Syntax of Objective-C Blocks</a></li>
<li><a href="http://stackoverflow.com/a/17105368/1418457">Referring to weak self inside a nested block</a></li>
<li><a href="http://blackpixel.com/blog/2014/03/capturing-myself.html">Capturing My(self)</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-05-26T20:14:56.000Z" title="2018-05-26T20:14:56.000Z">2018-05-26</time><span class="level-item">a few seconds read (About 40 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Interesting-how-did-you-managed-to-plug-GitHub-issues-into-the-dev.to-platform/">Interesting, how did you managed to plug GitHub issues into the dev.to platform</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/163">#163</a></strong></p>
<p>I’ve found your post <a href="https://dev.to/onmyway133/changing-electron-app-icon">https://dev.to/onmyway133/changing-electron-app-icon</a> and fist thought there is some static site generator which uses GitHub’s issues as a datasource.</p>
<p>Am I right?</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-05-02T11:46:54.000Z" title="2018-05-02T11:46:54.000Z">2018-05-02</time><span class="level-item">a few seconds read (About 7 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Trying-IBM-Watson/">Trying IBM Watson</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/162">#162</a></strong></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-05-02T08:50:05.000Z" title="2018-05-02T08:50:05.000Z">2018-05-02</time><span class="level-item">a few seconds read (About 20 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Request-and-Task/">Request and Task</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/161">#161</a></strong></p>
<p><a href="https://developer.apple.com/documentation/foundation/urlsession">https://developer.apple.com/documentation/foundation/urlsession</a><br><a href="https://developer.apple.com/documentation/speech">https://developer.apple.com/documentation/speech</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-04-12T06:55:32.000Z" title="2018-04-12T06:55:32.000Z">2018-04-12</time><span class="level-item">a few seconds read (About 55 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Learning-from-Open-Source-Colocate-test-files/">Learning from Open Source  Colocate test files</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/160">#160</a></strong></p>
<ul>
<li><a href="https://kickstarter.engineering/why-you-should-co-locate-your-xcode-tests-c69f79211411">Why you should co-locate your Xcode tests</a></li>
<li>Files</li>
</ul>
<p><a href="https://github.com/kickstarter/ios-oss/blob/master/Kickstarter-iOS/ViewModels/RootViewModel.swift">https://github.com/kickstarter/ios-oss/blob/master/Kickstarter-iOS/ViewModels/RootViewModel.swift</a><br><a href="https://github.com/kickstarter/ios-oss/blob/master/Kickstarter-iOS/ViewModels/RootViewModelTests.swift">https://github.com/kickstarter/ios-oss/blob/master/Kickstarter-iOS/ViewModels/RootViewModelTests.swift</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-04-03T11:29:58.000Z" title="2018-04-03T11:29:58.000Z">2018-04-03</time><span class="level-item">4 minutes read (About 563 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Using-CircleCI-2.0/">Using CircleCI 2.0</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/158">#158</a></strong></p>
<p>We ‘ve been using CircleCI for many of our open source projects. Since the end of last year 2017, version 2.0 began to come out, and we think it’s good time to try it now together with <a href="https://swift.org/blog/swift-4-1-released/">Swift 4.1</a> and <a href="https://developer.apple.com/news/?id=01242018d">Xcode 9.3</a></p>
<p>The problem with <a href="https://circleci.com/docs/2.0/">version 2.0</a> is it’s so powerful and has lots of cool new features like jobs and workflows, but that requires going to documentation for how to <a href="https://circleci.com/docs/2.0/migrating-from-1-2/">migrate</a> configuration file, especially <a href="https://circleci.com/docs/2.0/migrating-from-1-2/#search-and-replace-deprecated-20-keys">Search and Replace Deprecated 2.0 Keys</a></p>
<h3 id="Creating-config-yml"><a href="#Creating-config-yml" class="headerlink" title="Creating config.yml"></a>Creating <code>config.yml</code></h3><p>The first thing is to create a new <code>config.yml</code> inside folder <code>.circleci</code></p>
<blockquote>
<p>Copy your existing circle.yml file into a new directory called .circleci at the root of your project repository.</p>
</blockquote>
<p>Next is to declare version and jobs</p>
<blockquote>
<p>Add version: 2 to the top of the .circleci/config.yml file.</p>
</blockquote>
<h3 id="Checking-xcodebuild"><a href="#Checking-xcodebuild" class="headerlink" title="Checking xcodebuild"></a>Checking <code>xcodebuild</code></h3><p>For simple cases, we just use <code>xcodebuild</code> to build and test the project, so it’s good to try it locally to avoid lots of trial commits to trigger CircleCI. You can take a look at this PR <a href="https://github.com/hyperoslo/Cheers/pull/20">https://github.com/hyperoslo/Cheers/pull/20</a></p>
<p>Before our configuration file for version 1.0 looks like this</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="built_in">set</span> -o pipefail &amp;&amp; xcodebuild -project Cheers.xcodeproj -scheme <span class="string">"Cheers-iOS"</span> -sdk iphonesimulator -destination <span class="string">'platform=iOS Simulator,name=iPhone 8,OS=11.0'</span> -enableCodeCoverage YES <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>Now we should put <code>pipefail</code> inside <code>shell</code>, follow <a href="https://github.com/CircleCI-Public/circleci-demo-ios/blob/master/.circleci/config.yml">https://github.com/CircleCI-Public/circleci-demo-ios/blob/master/.circleci/config.yml</a></p>
<blockquote>
<p>shell: /bin/bash –login -o pipefail</p>
</blockquote>
<p>Now is the actual trying <code>xcodebuild</code>, after many failures due to <code>destination</code> param</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild: error: Unable to find a destination matching the provided destination specifier:</span><br><span class="line">		&#123; platform:iOS Simulator, OS:11.3 &#125;</span><br><span class="line"></span><br><span class="line">	Missing required device specifier option.</span><br><span class="line">	The device type “iOS Simulator” requires that either “name” or “id” be specified.</span><br><span class="line">	Please supply either “name” or “id”.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild: error: option &#39;Destination&#39; requires at least one parameter of the form &#39;key&#x3D;value&#39;</span><br></pre></td></tr></table></figure>

<p>I found this to work, run this in the same folder as your <code>xcodeproj</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild -project Cheers.xcodeproj -scheme <span class="string">"Cheers-iOS"</span> -sdk iphonesimulator -destination <span class="string">"platform=iOS Simulator,OS=11.3,name=iPhone X"</span> -enableCodeCoverage YES <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<h3 id="Adding-workflow"><a href="#Adding-workflow" class="headerlink" title="Adding workflow"></a>Adding workflow</h3><p>Version 2.0 introduces <a href="https://circleci.com/docs/2.0/workflows/">workflow</a> which helps organising jobs</p>
<blockquote>
<p>A workflow is a set of rules for defining a collection of jobs and their run order. Workflows support complex job orchestration using a simple set of configuration keys to help you resolve failures sooner.</p>
</blockquote>
<p>For our simple use cases, we add this workflow</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line"><span class="attr">  version:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">  build-and-test:</span></span><br><span class="line"><span class="attr">    jobs:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">build-and-test</span></span><br></pre></td></tr></table></figure>

<h2 id="Collecting-Test-Metadata"><a href="#Collecting-Test-Metadata" class="headerlink" title="Collecting Test Metadata"></a>Collecting Test Metadata</h2><ul>
<li><a href="https://circleci.com/docs/2.0/collect-test-data/">https://circleci.com/docs/2.0/collect-test-data/</a></li>
</ul>
<blockquote>
<p>CircleCI collects test metadata from XML files and uses it to provide insights into your job</p>
</blockquote>
<h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>Use below as template</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="number">2.1</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line"><span class="attr">  build_test:</span></span><br><span class="line"><span class="attr">    macos:</span></span><br><span class="line"><span class="attr">      xcode:</span> <span class="string">"11.0"</span></span><br><span class="line"><span class="attr">    shell:</span> <span class="string">/bin/bash</span> <span class="bullet">--login</span> <span class="bullet">-o</span> <span class="string">pipefail</span></span><br><span class="line"><span class="attr">    steps:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">checkout</span></span><br><span class="line"><span class="attr">      - run:</span></span><br><span class="line"><span class="attr">          command:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            curl https://cocoapods-specs.circleci.com/fetch-cocoapods-repo-from-s3.sh | bash -s cf</span></span><br><span class="line"><span class="string">            pod install</span></span><br><span class="line"><span class="string"></span><span class="attr">      - run:</span></span><br><span class="line"><span class="attr">          command:</span> <span class="string">xcodebuild</span> <span class="bullet">-workspace</span> <span class="string">MyApp.xcworkspace</span> <span class="bullet">-scheme</span> <span class="string">"MyApp"</span> <span class="bullet">-sdk</span> <span class="string">iphonesimulator</span> <span class="bullet">-destination</span> <span class="string">"platform=iOS Simulator,name=iPhone X,OS=12.2"</span> <span class="bullet">-enableCodeCoverage</span> <span class="literal">YES</span> <span class="string">test</span></span><br><span class="line"><span class="attr">      - store_test_results:</span></span><br><span class="line"><span class="attr">          path:</span> <span class="string">test-results</span></span><br><span class="line"></span><br><span class="line"><span class="attr">workflows:</span></span><br><span class="line"><span class="attr">  version:</span> <span class="number">2.1</span></span><br><span class="line"><span class="attr">  primary:</span></span><br><span class="line"><span class="attr">    jobs:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">build_test</span></span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://circleci.com/docs/2.0/ios-migrating-from-1-2/">https://circleci.com/docs/2.0/ios-migrating-from-1-2/</a></li>
</ul>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/16/">Previous</a></div><div class="pagination-next"><a href="/page/18/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/16/">16</a></li><li><a class="pagination-link is-current" href="/page/17/">17</a></li><li><a class="pagination-link" href="/page/18/">18</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/22/">22</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">652</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">52</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-05T04:31:35.000Z">2020-12-05</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-declare-Error-in-Swift/">How to declare Error in Swift</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-30T19:26:10.000Z">2020-11-30</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-convert-from-paid-to-free-with-IAP/">How to convert from paid to free with IAP</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-27T11:24:13.000Z">2020-11-27</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-disable-NSTextView-in-SwiftUI/">How to disable NSTextView in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-20T04:22:58.000Z">2020-11-20</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-add-under-highlight-to-text-in-css/">How to add under highlight to text in css</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-18T05:29:22.000Z">2020-11-18</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-default-system-fonts-in-React-apps/">How to use default system fonts in React apps</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">165</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">49</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">107</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">302</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">66</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2020 Khoa Pham</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>